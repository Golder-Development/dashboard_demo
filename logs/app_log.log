2025-12-07 08:33:02 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 08:33:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:33:02 +0000 INFO:get_git_version executed successfully
2025-12-07 08:33:05 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:33:05 +0000 INFO:get_git_version executed successfully
2025-12-07 08:50:43 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 08:50:43 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:50:44 +0000 INFO:get_git_version executed successfully
2025-12-07 08:50:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:50:49 +0000 INFO:get_git_version executed successfully
2025-12-07 08:55:20 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 08:55:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:55:21 +0000 INFO:get_git_version executed successfully
2025-12-07 08:55:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:55:21 +0000 INFO:get_git_version executed successfully
2025-12-07 08:55:22 +0000 INFO:Streamlit App Starting...
2025-12-07 08:55:22 +0000 INFO:Streamlit App Starting...
2025-12-07 08:55:22 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 08:55:22 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 08:55:22 +0000 INFO:Running App setup...
2025-12-07 08:55:22 +0000 INFO:Running App setup...
2025-12-07 08:55:22 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 INFO:Setting up the package
2025-12-07 08:55:22 +0000 INFO:Setting up the package
2025-12-07 08:55:22 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 INFO:get_git_version executed successfully
2025-12-07 08:55:22 +0000 INFO:get_git_version executed successfully
2025-12-07 08:55:22 +0000 INFO:Version: v50.190
2025-12-07 08:55:22 +0000 INFO:Version: v50.190
2025-12-07 08:55:22 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 08:55:22 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 08:55:22 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 08:55:22 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 08:55:22 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 08:55:22 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 08:55:22 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 08:55:22 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 08:55:22 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 08:55:22 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 08:55:22 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 08:55:22 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 08:55:22 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 08:55:22 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 08:55:22 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 08:55:22 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 08:55:22 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 08:55:22 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 08:55:22 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 08:55:22 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 08:55:22 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 08:55:22 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 08:55:22 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 08:55:22 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 08:55:22 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 08:55:22 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 08:55:22 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 08:55:22 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 08:55:22 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 08:55:22 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 08:55:22 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 08:55:22 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 08:55:22 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 08:55:22 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 08:55:22 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 08:55:22 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 08:55:22 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 08:55:22 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 08:55:22 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 08:55:22 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 08:55:22 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 08:55:22 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 08:55:22 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 08:55:22 +0000 INFO:Session_state variables initialized
2025-12-07 08:55:22 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:22 +0000 DEBUG:utils_dir: utils
2025-12-07 08:55:22 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 08:55:22 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 08:55:22 +0000 INFO:Session_state variables initialized
2025-12-07 08:55:22 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 08:55:22 +0000 DEBUG:utils_dir: utils
2025-12-07 08:55:22 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 08:55:22 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 08:55:22 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 08:55:22 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 08:55:22 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 08:55:22 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 08:55:22 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 08:55:22 +0000 DEBUG:reference_dir: reference_files
2025-12-07 08:55:22 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 08:55:22 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 08:55:22 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 08:55:22 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 08:55:22 +0000 DEBUG:reference_dir: reference_files
2025-12-07 08:55:22 +0000 DEBUG:perc_target: 0.5
2025-12-07 08:55:22 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 08:55:22 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 08:55:22 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 08:55:22 +0000 DEBUG:data_dir: data
2025-12-07 08:55:22 +0000 DEBUG:perc_target: 0.5
2025-12-07 08:55:22 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 08:55:22 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 08:55:22 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 08:55:22 +0000 DEBUG:data_dir: data
2025-12-07 08:55:22 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 08:55:22 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 08:55:22 +0000 DEBUG:output_dir: output
2025-12-07 08:55:22 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 08:55:22 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 08:55:22 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 08:55:22 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 08:55:22 +0000 DEBUG:output_dir: output
2025-12-07 08:55:22 +0000 DEBUG:Cash_ftr: None
2025-12-07 08:55:22 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 08:55:22 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 08:55:22 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 08:55:22 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 08:55:22 +0000 DEBUG:Cash_ftr: None
2025-12-07 08:55:22 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:22 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 08:55:22 +0000 DEBUG:components_dir: components
2025-12-07 08:55:22 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 08:55:22 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 08:55:22 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:22 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 08:55:22 +0000 DEBUG:components_dir: components
2025-12-07 08:55:22 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 08:55:22 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 08:55:22 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 08:55:22 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 08:55:22 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 08:55:22 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 08:55:22 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 08:55:22 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 08:55:22 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 08:55:22 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 08:55:22 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 08:55:22 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 08:55:22 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 08:55:22 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 08:55:22 +0000 DEBUG:logs_dir: logs
2025-12-07 08:55:22 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 08:55:22 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 08:55:22 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 08:55:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 08:55:22 +0000 DEBUG:logs_dir: logs
2025-12-07 08:55:22 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 08:55:22 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 08:55:22 +0000 INFO:Session state Setup complete
2025-12-07 08:55:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 08:55:22 +0000 INFO:initialize_session_state executed successfully
2025-12-07 08:55:22 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 08:55:22 +0000 INFO:Package setup complete
2025-12-07 08:55:22 +0000 INFO:Session state Setup complete
2025-12-07 08:55:22 +0000 INFO:setup_package executed successfully
2025-12-07 08:55:22 +0000 INFO:initialize_session_state executed successfully
2025-12-07 08:55:22 +0000 INFO:Setup completed successfully.
2025-12-07 08:55:22 +0000 INFO:Package setup complete
2025-12-07 08:55:22 +0000 INFO:setup_package executed successfully
2025-12-07 08:55:22 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 INFO:Setup completed successfully.
2025-12-07 08:55:22 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 INFO:get_git_version executed successfully
2025-12-07 08:55:22 +0000 INFO:Running first load function.
2025-12-07 08:55:22 +0000 INFO:Running first load function.
2025-12-07 08:55:22 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 08:55:22 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 08:55:22 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:22 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 08:55:22 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 08:55:22 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 08:55:22 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:22 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 08:55:22 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 08:55:22 +0000 INFO:Last modification time: 1765054682.9311745
2025-12-07 08:55:22 +0000 INFO:is_file_updated executed successfully
2025-12-07 08:55:22 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765054682.9311745 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:22 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 08:55:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 08:55:23 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 08:55:23 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 08:55:23 +0000 INFO:Cleaning up raw data
2025-12-07 08:55:23 +0000 ERROR:Session state variables not initialized!
2025-12-07 08:55:23 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:23 +0000 INFO:Original file path: None
2025-12-07 08:55:23 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 08:55:23 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 08:55:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 08:55:23 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 08:55:25 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 08:55:25 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 08:55:25 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 08:55:25 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 08:55:25 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 08:55:25 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 08:55:25 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 08:55:25 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 08:55:25 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 08:55:26 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 08:55:26 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 08:55:26 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 08:55:26 +0000 INFO:Raw Data cleanup completed
2025-12-07 08:55:26 +0000 INFO:Data shape: (91651, 37)
2025-12-07 08:55:27 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 08:55:27 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 08:55:27 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 08:55:27 +0000 INFO:load_raw_data executed successfully
2025-12-07 08:55:27 +0000 INFO:get_raw_data executed successfully
2025-12-07 08:55:27 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 08:55:27 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:27 +0000 INFO:get_raw_data executed successfully
2025-12-07 08:55:27 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:27 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 08:55:27 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 08:55:27 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:27 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:27 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 08:55:27 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 08:55:27 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 08:55:27 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 08:55:27 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 08:55:27 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 08:55:27 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 08:55:27 +0000 INFO:Current modification time: 1765097727.53566
2025-12-07 08:55:27 +0000 INFO:Last modification time: 1765054682.9311745
2025-12-07 08:55:27 +0000 INFO:is_file_updated executed successfully
2025-12-07 08:55:27 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 08:55:27 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 08:55:27 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 08:55:27 +0000 DEBUG:Clean Data Prep: streamlitdata load: 91651
2025-12-07 08:55:28 +0000 DEBUG:Clean Data Prep 123: streamlitdata load: 91651
2025-12-07 08:55:29 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 08:55:30 +0000 DEBUG:Clean Data Prep 150: Map Party: 91651
2025-12-07 08:55:30 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2557
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Name: count, dtype: int64
2025-12-07 08:55:30 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  9
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 08:55:30 +0000 DEBUG:Clean Data Prep 235: RegEntity_Map: 91651
2025-12-07 08:55:30 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Medium Large Entity                 2269
Small Medium Entity                 2047
Large Entity                        2038
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 08:55:30 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 08:55:30 +0000 DEBUG:Clean Data Prep 235: Party_Group: 91651
2025-12-07 08:55:30 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 08:55:30 +0000 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025-12-07 08:55:30 +0000 DEBUG:try to load previous election dates from file.
2025-12-07 08:55:30 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 08:55:30 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:30 +0000 INFO:Saved file path: reference_files\elections.csv
2025-12-07 08:55:30 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 08:55:30 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 08:55:30 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 08:55:30 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:30 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 08:55:30 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 08:55:30 +0000 INFO:Last modification time: 1765052688.9370306
2025-12-07 08:55:30 +0000 INFO:is_file_updated executed successfully
2025-12-07 08:55:30 +0000 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1765052688.9370306 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 08:55:30 +0000 INFO:Importing file from reference_files\elections.csv
2025-12-07 08:55:30 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 09:12:53 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 09:12:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:12:54 +0000 INFO:get_git_version executed successfully
2025-12-07 09:12:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 INFO:get_git_version executed successfully
2025-12-07 09:12:55 +0000 INFO:Streamlit App Starting...
2025-12-07 09:12:55 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:12:55 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 09:12:55 +0000 INFO:Running App setup...
2025-12-07 09:12:55 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 INFO:Setting up the package
2025-12-07 09:12:55 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:12:55 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 INFO:get_git_version executed successfully
2025-12-07 09:12:55 +0000 INFO:Version: v50.190
2025-12-07 09:12:55 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:12:55 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 09:12:55 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:12:55 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 09:12:55 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 09:12:55 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:12:55 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:12:55 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:12:55 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:12:55 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 09:12:55 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 09:12:55 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:12:55 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 09:12:55 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 09:12:55 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 09:12:55 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 09:12:55 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 09:12:55 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 09:12:55 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 09:12:55 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 09:12:55 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 09:12:55 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 09:12:55 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:12:55 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 09:12:55 +0000 INFO:Session_state variables initialized
2025-12-07 09:12:55 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:12:55 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:12:55 +0000 DEBUG:data_dir: data
2025-12-07 09:12:55 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:12:55 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:12:55 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:12:55 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:12:55 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:12:55 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:12:55 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:12:55 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:12:55 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:12:55 +0000 DEBUG:components_dir: components
2025-12-07 09:12:55 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:12:55 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:12:55 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:12:55 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:12:55 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:12:55 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:12:55 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:12:55 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:12:55 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:12:55 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:12:55 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:12:55 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:12:55 +0000 DEBUG:logs_dir: logs
2025-12-07 09:12:55 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:12:55 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:12:55 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:12:55 +0000 DEBUG:output_dir: output
2025-12-07 09:12:55 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:12:55 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:12:55 +0000 DEBUG:utils_dir: utils
2025-12-07 09:12:55 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:12:55 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:12:55 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:12:55 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:12:55 +0000 INFO:Session state Setup complete
2025-12-07 09:12:55 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:12:55 +0000 INFO:Package setup complete
2025-12-07 09:12:55 +0000 INFO:setup_package executed successfully
2025-12-07 09:12:55 +0000 INFO:Setup completed successfully.
2025-12-07 09:12:55 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 INFO:get_git_version executed successfully
2025-12-07 09:12:55 +0000 INFO:Running first load function.
2025-12-07 09:12:55 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 09:12:55 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 09:12:55 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:12:55 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 09:12:55 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 09:12:55 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:12:55 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 09:12:55 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:12:55 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 09:12:55 +0000 INFO:Last modification time: 1765097727.53566
2025-12-07 09:12:55 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:12:55 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765097727.53566 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 09:12:55 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 09:12:56 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:12:56 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 09:12:56 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 09:12:56 +0000 INFO:Cleaning up raw data
2025-12-07 09:12:56 +0000 ERROR:Session state variables not initialized!
2025-12-07 09:12:56 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:12:56 +0000 INFO:Original file path: None
2025-12-07 09:12:56 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 09:12:56 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 09:12:56 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:12:56 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 09:12:57 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:12:57 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:12:57 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:12:57 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:12:57 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 09:12:57 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:12:57 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:12:57 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 09:12:58 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 09:12:58 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 09:12:58 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 09:12:58 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:12:58 +0000 INFO:Raw Data cleanup completed
2025-12-07 09:12:58 +0000 INFO:Data shape: (91651, 37)
2025-12-07 09:12:59 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 09:12:59 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 09:12:59 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 09:12:59 +0000 INFO:load_raw_data executed successfully
2025-12-07 09:13:00 +0000 INFO:get_raw_data executed successfully
2025-12-07 09:13:00 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:13:00 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:13:00 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:13:00 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 09:13:00 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:13:00 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 09:13:00 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 09:13:00 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:13:00 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 09:13:00 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:13:00 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 09:13:00 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:13:00 +0000 INFO:Current modification time: 1765098779.9223416
2025-12-07 09:13:00 +0000 INFO:Last modification time: 1765097727.53566
2025-12-07 09:13:00 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:13:00 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:13:00 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 09:13:00 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 09:13:00 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 09:13:00 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 09:13:02 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:13:02 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 09:13:02 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2557
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Name: count, dtype: int64
2025-12-07 09:13:02 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  9
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:13:02 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 09:13:02 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Medium Large Entity                 2269
Small Medium Entity                 2047
Large Entity                        2038
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 09:13:02 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:13:02 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 09:13:02 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 09:13:02 +0000 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:13:02 +0000 DEBUG:try to load previous election dates from file.
2025-12-07 09:13:02 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:13:02 +0000 INFO:Original file path: reference_files\elections.csv
2025-12-07 09:13:02 +0000 INFO:Saved file path: reference_files\elections.csv
2025-12-07 09:13:02 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:13:02 +0000 INFO:Checking if reference_files\elections.csv has been updated.
2025-12-07 09:13:02 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:13:02 +0000 INFO:Getting modification time for reference_files\elections.csv
2025-12-07 09:13:02 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:13:02 +0000 INFO:Current modification time: 1765052688.8430274
2025-12-07 09:13:02 +0000 INFO:Last modification time: 1765052688.9370306
2025-12-07 09:13:02 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:13:02 +0000 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1765052688.9370306 instead of reference_files\elections.csv
2025-12-07 09:13:02 +0000 INFO:Importing file from reference_files\elections.csv
2025-12-07 09:13:02 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 09:15:47 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 09:15:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:15:47 +0000 INFO:get_git_version executed successfully
2025-12-07 09:15:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:15:48 +0000 INFO:get_git_version executed successfully
2025-12-07 09:15:48 +0000 INFO:Streamlit App Starting...
2025-12-07 09:15:48 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:15:48 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 09:15:48 +0000 INFO:Running App setup...
2025-12-07 09:15:48 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:15:48 +0000 INFO:Setting up the package
2025-12-07 09:15:48 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:15:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 INFO:get_git_version executed successfully
2025-12-07 09:15:49 +0000 INFO:Version: v50.190
2025-12-07 09:15:49 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:15:49 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 09:15:49 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:15:49 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 09:15:49 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 09:15:49 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:15:49 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:15:49 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:15:49 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:15:49 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 09:15:49 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 09:15:49 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:15:49 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 09:15:49 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 09:15:49 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 09:15:49 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 09:15:49 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 09:15:49 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 09:15:49 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 09:15:49 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 09:15:49 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 09:15:49 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 09:15:49 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:15:49 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 09:15:49 +0000 INFO:Session_state variables initialized
2025-12-07 09:15:49 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:15:49 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:15:49 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:15:49 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:15:49 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:15:49 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:15:49 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:15:49 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:15:49 +0000 DEBUG:output_dir: output
2025-12-07 09:15:49 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:15:49 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:15:49 +0000 DEBUG:data_dir: data
2025-12-07 09:15:49 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:15:49 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:15:49 +0000 DEBUG:components_dir: components
2025-12-07 09:15:49 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:15:49 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:15:49 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:15:49 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:15:49 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:15:49 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:15:49 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:15:49 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:15:49 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:15:49 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:15:49 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:15:49 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:15:49 +0000 DEBUG:logs_dir: logs
2025-12-07 09:15:49 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:15:49 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:15:49 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:15:49 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:15:49 +0000 DEBUG:utils_dir: utils
2025-12-07 09:15:49 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:15:49 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:15:49 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:15:49 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:15:49 +0000 INFO:Session state Setup complete
2025-12-07 09:15:49 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:15:49 +0000 INFO:Package setup complete
2025-12-07 09:15:49 +0000 INFO:setup_package executed successfully
2025-12-07 09:15:49 +0000 INFO:Setup completed successfully.
2025-12-07 09:15:49 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 INFO:get_git_version executed successfully
2025-12-07 09:15:49 +0000 INFO:Running first load function.
2025-12-07 09:15:49 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 09:15:49 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 09:15:49 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:15:49 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 09:15:49 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 09:15:49 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:15:49 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 09:15:49 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:15:49 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 09:15:49 +0000 INFO:Last modification time: 1765098779.9223416
2025-12-07 09:15:49 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:15:49 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765098779.9223416 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 09:15:49 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 09:15:49 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:15:50 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 09:15:50 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 09:15:50 +0000 INFO:Cleaning up raw data
2025-12-07 09:15:50 +0000 ERROR:Session state variables not initialized!
2025-12-07 09:15:50 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:15:50 +0000 INFO:Original file path: None
2025-12-07 09:15:50 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 09:15:50 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 09:15:50 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:15:50 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 09:15:54 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:15:54 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:15:54 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:15:54 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:15:54 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 09:15:54 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:15:54 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:15:54 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 09:15:55 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 09:15:55 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 09:15:55 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 09:15:55 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:15:55 +0000 INFO:Raw Data cleanup completed
2025-12-07 09:15:55 +0000 INFO:Data shape: (91651, 37)
2025-12-07 09:15:56 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 09:15:56 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 09:15:56 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 09:15:56 +0000 INFO:load_raw_data executed successfully
2025-12-07 09:15:56 +0000 INFO:get_raw_data executed successfully
2025-12-07 09:15:56 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:15:56 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:15:56 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:15:56 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 09:15:56 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:15:56 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 09:15:56 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 09:15:56 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:15:56 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 09:15:56 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:15:56 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 09:15:56 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:15:56 +0000 INFO:Current modification time: 1765098956.5987647
2025-12-07 09:15:56 +0000 INFO:Last modification time: 1765098779.9223416
2025-12-07 09:15:56 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:15:56 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:15:56 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 09:15:56 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 09:15:56 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 09:15:57 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 09:16:03 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:16:03 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 09:16:04 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2557
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Name: count, dtype: int64
2025-12-07 09:16:04 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  9
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:16:04 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 09:16:04 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Medium Large Entity                 2269
Small Medium Entity                 2047
Large Entity                        2038
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 09:16:04 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:16:04 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 09:16:04 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 09:16:04 +0000 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:16:04 +0000 DEBUG:try to load previous election dates from file.
2025-12-07 09:16:04 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:16:04 +0000 INFO:Original file path: reference_files\elections.csv
2025-12-07 09:16:04 +0000 INFO:Saved file path: reference_files\elections.csv
2025-12-07 09:16:04 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:16:04 +0000 INFO:Checking if reference_files\elections.csv has been updated.
2025-12-07 09:16:04 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:16:04 +0000 INFO:Getting modification time for reference_files\elections.csv
2025-12-07 09:16:04 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:16:04 +0000 INFO:Current modification time: 1765052688.8430274
2025-12-07 09:16:04 +0000 INFO:Last modification time: 1765052688.9370306
2025-12-07 09:16:04 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:16:04 +0000 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1765052688.9370306 instead of reference_files\elections.csv
2025-12-07 09:16:04 +0000 INFO:Importing file from reference_files\elections.csv
2025-12-07 09:16:04 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 09:18:11 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 09:18:11 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:12 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:13 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:13 +0000 INFO:Streamlit App Starting...
2025-12-07 09:18:13 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:18:13 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:18:13 +0000 INFO:Running App setup...
2025-12-07 09:18:13 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:18:13 +0000 INFO:Setting up the package
2025-12-07 09:18:13 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:18:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:13 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:13 +0000 INFO:Version: v50.190
2025-12-07 09:18:13 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:18:13 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:18:13 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 09:18:13 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:18:13 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 09:18:13 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 09:18:13 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:18:13 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:18:13 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:18:13 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:18:13 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 09:18:13 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 09:18:13 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:18:13 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 09:18:13 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 09:18:13 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 09:18:13 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 09:18:13 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 09:18:13 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 09:18:13 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 09:18:13 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 09:18:13 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 09:18:13 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 09:18:13 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:18:13 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 09:18:13 +0000 INFO:Session_state variables initialized
2025-12-07 09:18:13 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:18:13 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:18:13 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:18:13 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:18:13 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:18:13 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:18:13 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:18:13 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:18:13 +0000 DEBUG:components_dir: components
2025-12-07 09:18:13 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:18:13 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:18:13 +0000 DEBUG:utils_dir: utils
2025-12-07 09:18:13 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:18:13 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:18:13 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:18:13 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:18:13 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:18:13 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:18:13 +0000 DEBUG:logs_dir: logs
2025-12-07 09:18:13 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:18:13 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:18:13 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:18:13 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:18:13 +0000 DEBUG:output_dir: output
2025-12-07 09:18:13 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:18:13 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:18:13 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:18:13 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:18:13 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:18:13 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:18:13 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:18:13 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:18:13 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:18:13 +0000 DEBUG:data_dir: data
2025-12-07 09:18:13 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:18:13 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:18:13 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:18:13 +0000 INFO:Session state Setup complete
2025-12-07 09:18:13 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:18:13 +0000 INFO:Package setup complete
2025-12-07 09:18:13 +0000 INFO:setup_package executed successfully
2025-12-07 09:18:13 +0000 INFO:Setup completed successfully.
2025-12-07 09:18:13 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:13 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:14 +0000 INFO:Running first load function.
2025-12-07 09:18:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:18:14 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:14 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:14 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 09:18:14 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 09:18:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:14 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:18:14 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 09:18:14 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:18:14 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 09:18:14 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:18:14 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 09:18:14 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:18:14 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 09:18:14 +0000 INFO:Last modification time: 1765098956.5987647
2025-12-07 09:18:14 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:18:14 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765098956.5987647 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 09:18:14 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 09:18:14 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:18:14 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 09:18:14 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 09:18:14 +0000 INFO:Cleaning up raw data
2025-12-07 09:18:14 +0000 ERROR:Session state variables not initialized!
2025-12-07 09:18:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:14 +0000 INFO:Original file path: None
2025-12-07 09:18:14 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 09:18:14 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 09:18:14 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:18:14 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 09:18:16 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:18:16 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:18:16 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:18:16 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:18:16 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 09:18:16 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:18:16 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:18:16 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 09:18:17 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 09:18:17 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 09:18:17 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 09:18:17 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:18:17 +0000 INFO:Raw Data cleanup completed
2025-12-07 09:18:17 +0000 INFO:Data shape: (91651, 37)
2025-12-07 09:18:19 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 09:18:19 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 09:18:19 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 09:18:19 +0000 INFO:load_raw_data executed successfully
2025-12-07 09:18:19 +0000 INFO:get_raw_data executed successfully
2025-12-07 09:18:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:18:19 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:19 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:19 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 09:18:19 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:19 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 09:18:19 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 09:18:19 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:18:19 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 09:18:19 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:18:19 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 09:18:19 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:18:19 +0000 INFO:Current modification time: 1765099099.3339787
2025-12-07 09:18:19 +0000 INFO:Last modification time: 1765098956.5987647
2025-12-07 09:18:19 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:18:19 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:18:19 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 09:18:19 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 09:18:19 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 09:18:19 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 09:18:21 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:18:21 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 09:18:22 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2557
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Name: count, dtype: int64
2025-12-07 09:18:22 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  9
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:18:22 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 09:18:22 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Medium Large Entity                 2269
Small Medium Entity                 2047
Large Entity                        2038
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 09:18:22 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:18:22 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 09:18:22 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 09:18:22 +0000 INFO:Loading election dates from pdpy.
2025-12-07 09:18:22 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 09:18:22 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 09:18:22 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 09:18:22 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 09:18:22 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 09:18:22 +0000 INFO:load_election_dates executed successfully
2025-12-07 09:18:22 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 09:18:22 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 09:18:24 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 09:18:24 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 09:18:24 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 09:18:24 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:18:24 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:24 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:24 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:24 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 09:18:24 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 09:18:24 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:18:24 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 09:18:24 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:18:24 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 09:18:24 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:18:24 +0000 INFO:Current modification time: 1765099104.7364204
2025-12-07 09:18:24 +0000 INFO:Last modification time: 1765054688.549695
2025-12-07 09:18:24 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:18:24 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:18:25 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 09:18:25 +0000 INFO:Donor Data summary completed
2025-12-07 09:18:25 +0000 INFO:Data shape: (31905, 5)
2025-12-07 09:18:25 +0000 INFO:load_donorList_data executed successfully
2025-12-07 09:18:25 +0000 INFO:get_donor_data executed successfully
2025-12-07 09:18:25 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:18:25 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:18:25 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:25 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:25 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:25 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 09:18:25 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 09:18:25 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:18:25 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 09:18:25 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:18:25 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 09:18:25 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:18:25 +0000 INFO:Current modification time: 1765099104.7364204
2025-12-07 09:18:25 +0000 INFO:Last modification time: 1765099104.7364204
2025-12-07 09:18:25 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:18:25 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765099104.7364204 instead of output\cleaned_data.csv
2025-12-07 09:18:25 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 09:18:25 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 09:18:25 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:18:25 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 09:18:25 +0000 INFO:Raw Data cleanup completed
2025-12-07 09:18:25 +0000 INFO:Data shape: (1719, 6)
2025-12-07 09:18:25 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 09:18:25 +0000 INFO:get_regentity_data executed successfully
2025-12-07 09:18:25 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 09:18:25 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:18:25 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:18:25 +0000 INFO:firstload executed successfully
2025-12-07 09:18:25 +0000 INFO:Data first load completed successfully.
2025-12-07 09:18:25 +0000 INFO:initialise_data executed successfully
2025-12-07 09:18:25 +0000 INFO:Running Menu setup...
2025-12-07 09:18:25 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 09:18:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:25 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:25 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:26 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:26 +0000 INFO:App Version: v50.228
2025-12-07 09:18:26 +0000 INFO:Switched to page: Introduction
2025-12-07 09:18:26 +0000 INFO:pagesetup executed successfully
2025-12-07 09:18:26 +0000 INFO:Menu setup completed successfully.
2025-12-07 09:18:26 +0000 INFO:App is fully loaded and ready!
2025-12-07 09:18:31 +0000 INFO:Streamlit App Starting...
2025-12-07 09:18:31 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:18:31 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:18:31 +0000 INFO:Running App setup...
2025-12-07 09:18:31 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:18:31 +0000 INFO:Setting up the package
2025-12-07 09:18:31 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:18:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:31 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:31 +0000 INFO:Version: v50.190
2025-12-07 09:18:31 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:18:31 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:18:31 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:filenames already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:thresholds already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:filter_def already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:security already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:perc_target already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:directories already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:data_dir already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:output_dir already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:components_dir already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 09:18:31 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 09:18:31 +0000 INFO:Session_state variables initialized
2025-12-07 09:18:31 +0000 DEBUG:load_raw_data_last_modified: 1765099099.3339787
2025-12-07 09:18:31 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:18:31 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:18:31 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:18:31 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:18:32 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 09:18:32 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:18:32 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 09:18:32 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:18:32 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:18:32 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:18:32 +0000 DEBUG:components_dir: components
2025-12-07 09:18:32 +0000 DEBUG:load_donorlist_data_last_modified: 1765099104.7364204
2025-12-07 09:18:32 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:18:32 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:18:32 +0000 DEBUG:utils_dir: utils
2025-12-07 09:18:32 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:18:32 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:18:32 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:18:32 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:18:32 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:18:32 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:18:32 +0000 DEBUG:logs_dir: logs
2025-12-07 09:18:32 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:18:32 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:18:32 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:18:32 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:18:32 +0000 DEBUG:output_dir: output
2025-12-07 09:18:32 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:18:32 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:18:32 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 09:18:32 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:18:32 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:18:32 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:18:32 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:18:32 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 09:18:32 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:18:32 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 09:18:32 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:18:32 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000029B8E5DEF80>}
2025-12-07 09:18:32 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:18:32 +0000 DEBUG:data_dir: data
2025-12-07 09:18:32 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 09:18:32 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:18:32 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:18:32 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:18:32 +0000 INFO:Session state Setup complete
2025-12-07 09:18:32 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:18:32 +0000 INFO:Package setup complete
2025-12-07 09:18:32 +0000 INFO:setup_package executed successfully
2025-12-07 09:18:32 +0000 INFO:Setup completed successfully.
2025-12-07 09:18:32 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:32 +0000 INFO:Running first load function.
2025-12-07 09:18:32 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:18:32 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:18:32 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:18:32 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:18:32 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:18:32 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 09:18:32 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:18:32 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:18:32 +0000 INFO:firstload executed successfully
2025-12-07 09:18:32 +0000 INFO:Data first load completed successfully.
2025-12-07 09:18:32 +0000 INFO:initialise_data executed successfully
2025-12-07 09:18:32 +0000 INFO:Running Menu setup...
2025-12-07 09:18:32 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 09:18:32 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:32 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:32 +0000 INFO:App Version: v50.228
2025-12-07 09:18:32 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 09:18:32 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 09:18:32 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:32 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 09:18:32 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:18:32 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:18:34 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20131.118739
1                       Green Party   6023.742231
2                      Labour Party  20650.882442
3                      Large Entity  29763.708881
4                  Liberal Democrat   8504.706244
5                     Medium Entity  15666.034757
6               Medium Large Entity  38493.144337
7            Single Donation Entity  12207.983689
8                      Small Entity  16114.092989
9               Small Medium Entity  21512.571099
10     Uk Independence Party (Ukip)   9919.127250
11                Very Small Entity  24966.683550
2025-12-07 09:18:34 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
6               Medium Large Entity  38493.144337
3                      Large Entity  29763.708881
11                Very Small Entity  24966.683550
9               Small Medium Entity  21512.571099
2                      Labour Party  20650.882442
0   Conservative And Unionist Party  20131.118739
8                      Small Entity  16114.092989
5                     Medium Entity  15666.034757
7            Single Donation Entity  12207.983689
10     Uk Independence Party (Ukip)   9919.127250
4                  Liberal Democrat   8504.706244
1                       Green Party   6023.742231
2025-12-07 09:18:34 +0000 DEBUG:Unique XValues: ['Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 'Green Party']
2025-12-07 09:18:34 +0000 DEBUG:Final color_discrete_map: {'Medium Large Entity': '#636efa', 'Large Entity': '#9467bd', 'Very Small Entity': '#bcbd22', 'Small Medium Entity': '#17becf', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#e377c2', 'Medium Entity': '#8c564b', 'Single Donation Entity': '#7f7f7f', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', 'Green Party': '#78B943'}
2025-12-07 09:18:34 +0000 DEBUG:Missing color mappings for: ['Medium Large Entity']
2025-12-07 09:18:34 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Large Entity',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Medium Large Entity',
              'offsetgroup': 'Medium Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'UQZonqTL4kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#9467bd', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9nxPXu0Q3UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Very Small Entity',
              'marker': {'color': '#bcbd22', 'pattern': {'shape': ''}},
              'name': 'Very Small Entity',
              'offsetgroup': 'Very Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Very Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'typIv6th2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Medium Entity',
              'marker': {'color': '#17becf', 'pattern': {'shape': ''}},
              'name': 'Small Medium Entity',
              'offsetgroup': 'Small Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9ofjjCQC1UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AHzuebgq1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '1f1qmceo00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#e377c2', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LAkU5wt5z0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#8c564b', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'zM7ocgSZzkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#7f7f7f', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nHuE6f3Xx0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'QIC7SZBfw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Democrat',
              'marker': {'color': '#FDBB30', 'pattern': {'shape': ''}},
              'name': 'Liberal Democrat',
              'offsetgroup': 'Liberal Democrat',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Democrat'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AMMxZlqcwEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7u/VAr6Ht0A=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Medium Large Entity, Large Entity, Very
                                           Small Entity, Small Medium Entity,
                                           Labour Party, Conservative And Unionist
                                           Party, Small Entity, Medium Entity,
                                           Single Donation Entity, Uk Independence
                                           Party (Ukip), Liberal Democrat, Green
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2025-12-07 09:18:34 +0000 INFO:Bar chart displayed successfully.
2025-12-07 09:18:34 +0000 INFO:hlf_body executed successfully
2025-12-07 09:18:34 +0000 INFO:pagesetup executed successfully
2025-12-07 09:18:34 +0000 INFO:Menu setup completed successfully.
2025-12-07 09:18:34 +0000 INFO:App is fully loaded and ready!
2025-12-07 09:18:54 +0000 INFO:Streamlit App Starting...
2025-12-07 09:18:54 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:18:54 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:18:54 +0000 INFO:Running App setup...
2025-12-07 09:18:54 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 INFO:Setting up the package
2025-12-07 09:18:54 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:18:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:54 +0000 INFO:Version: v50.190
2025-12-07 09:18:54 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:18:54 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:filenames already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:thresholds already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:filter_def already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:security already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:perc_target already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:directories already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:data_dir already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:output_dir already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:components_dir already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 09:18:54 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 09:18:54 +0000 INFO:Session_state variables initialized
2025-12-07 09:18:54 +0000 DEBUG:load_raw_data_last_modified: 1765099099.3339787
2025-12-07 09:18:54 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:18:54 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:18:54 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:18:54 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:18:54 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 09:18:54 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:18:54 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 09:18:54 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:18:54 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:18:54 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:18:54 +0000 DEBUG:components_dir: components
2025-12-07 09:18:54 +0000 DEBUG:load_donorlist_data_last_modified: 1765099104.7364204
2025-12-07 09:18:54 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:18:54 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:18:54 +0000 DEBUG:utils_dir: utils
2025-12-07 09:18:54 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:18:54 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:18:54 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:18:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:18:54 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:18:54 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:18:54 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 09:18:54 +0000 DEBUG:logs_dir: logs
2025-12-07 09:18:54 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:18:54 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:18:54 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:18:54 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:18:54 +0000 DEBUG:output_dir: output
2025-12-07 09:18:54 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:18:54 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:18:54 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 09:18:54 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 09:18:54 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:18:54 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:18:54 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:18:54 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:18:54 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 09:18:54 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:18:54 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 09:18:54 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:18:54 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x0000029B8E5DFB50>}
2025-12-07 09:18:54 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:18:54 +0000 DEBUG:data_dir: data
2025-12-07 09:18:54 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 09:18:54 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:18:54 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:18:54 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:18:54 +0000 INFO:Session state Setup complete
2025-12-07 09:18:54 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:18:54 +0000 INFO:Package setup complete
2025-12-07 09:18:54 +0000 INFO:setup_package executed successfully
2025-12-07 09:18:54 +0000 INFO:Setup completed successfully.
2025-12-07 09:18:54 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 INFO:Running first load function.
2025-12-07 09:18:54 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:18:54 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:18:54 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:18:54 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:18:54 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 09:18:54 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:18:54 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:18:54 +0000 INFO:firstload executed successfully
2025-12-07 09:18:54 +0000 INFO:Data first load completed successfully.
2025-12-07 09:18:54 +0000 INFO:initialise_data executed successfully
2025-12-07 09:18:54 +0000 INFO:Running Menu setup...
2025-12-07 09:18:54 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:54 +0000 INFO:App Version: v50.228
2025-12-07 09:18:54 +0000 INFO:Switched to page: Cash Donations
2025-12-07 09:18:54 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 09:18:54 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:18:54 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 09:18:54 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2025-12-07 09:18:54 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2025-12-07 09:18:54 +0000 DEBUG:Not logged in as admin.
2025-12-07 09:18:54 +0000 INFO:manage_text_elements executed successfully
2025-12-07 09:18:54 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 09:18:54 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 09:18:55 +0000 INFO:display_visualizations executed successfully
2025-12-07 09:18:55 +0000 INFO:display_data_page executed successfully
2025-12-07 09:18:55 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 09:18:55 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:18:55 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:18:55 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 09:18:55 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 09:18:55 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 09:18:55 +0000 DEBUG:Page texts: {}
2025-12-07 09:18:55 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 09:18:55 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 09:18:55 +0000 INFO:display_visualizations executed successfully
2025-12-07 09:18:55 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 09:18:55 +0000 INFO:pagesetup executed successfully
2025-12-07 09:18:55 +0000 INFO:Menu setup completed successfully.
2025-12-07 09:18:55 +0000 INFO:App is fully loaded and ready!
2025-12-07 09:18:58 +0000 INFO:Streamlit App Starting...
2025-12-07 09:18:58 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:18:58 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:18:58 +0000 INFO:Running App setup...
2025-12-07 09:18:58 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 INFO:Setting up the package
2025-12-07 09:18:58 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:18:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:58 +0000 INFO:Version: v50.190
2025-12-07 09:18:58 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:18:58 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:filenames already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:thresholds already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:filter_def already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:security already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:perc_target already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:directories already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:data_dir already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:output_dir already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:components_dir already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 09:18:58 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 09:18:58 +0000 INFO:Session_state variables initialized
2025-12-07 09:18:58 +0000 DEBUG:load_raw_data_last_modified: 1765099099.3339787
2025-12-07 09:18:58 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:18:58 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:18:58 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:18:58 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:18:58 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 09:18:58 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:18:58 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 09:18:58 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:18:58 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:18:58 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:18:58 +0000 DEBUG:components_dir: components
2025-12-07 09:18:58 +0000 DEBUG:load_donorlist_data_last_modified: 1765099104.7364204
2025-12-07 09:18:58 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:18:58 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:18:58 +0000 DEBUG:utils_dir: utils
2025-12-07 09:18:58 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:18:58 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:18:58 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:18:58 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:18:58 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:18:58 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:18:58 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 09:18:58 +0000 DEBUG:logs_dir: logs
2025-12-07 09:18:58 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:18:58 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:18:58 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:18:58 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:18:58 +0000 DEBUG:output_dir: output
2025-12-07 09:18:58 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:18:58 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:18:58 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 09:18:58 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 09:18:58 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:18:58 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 09:18:58 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:18:58 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:18:58 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:18:58 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 09:18:58 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:18:58 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 09:18:58 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:18:58 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x0000029B8E5DF880>}
2025-12-07 09:18:58 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:18:58 +0000 DEBUG:data_dir: data
2025-12-07 09:18:58 +0000 DEBUG:selected_entity_name: All
2025-12-07 09:18:58 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 09:18:58 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:18:58 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:18:58 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:18:58 +0000 INFO:Session state Setup complete
2025-12-07 09:18:58 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:18:58 +0000 INFO:Package setup complete
2025-12-07 09:18:58 +0000 INFO:setup_package executed successfully
2025-12-07 09:18:58 +0000 INFO:Setup completed successfully.
2025-12-07 09:18:58 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 INFO:Running first load function.
2025-12-07 09:18:58 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:18:58 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:18:58 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:18:58 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:18:58 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 09:18:58 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:18:58 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:18:58 +0000 INFO:firstload executed successfully
2025-12-07 09:18:58 +0000 INFO:Data first load completed successfully.
2025-12-07 09:18:58 +0000 INFO:initialise_data executed successfully
2025-12-07 09:18:58 +0000 INFO:Running Menu setup...
2025-12-07 09:18:58 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 INFO:get_git_version executed successfully
2025-12-07 09:18:58 +0000 INFO:App Version: v50.228
2025-12-07 09:18:58 +0000 INFO:Switched to page: Corporate Donations
2025-12-07 09:18:58 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 09:18:58 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:18:58 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 09:18:58 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 09:18:58 +0000 DEBUG:Page texts: {}
2025-12-07 09:18:58 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 09:18:58 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 09:18:59 +0000 INFO:display_visualizations executed successfully
2025-12-07 09:18:59 +0000 INFO:display_data_page executed successfully
2025-12-07 09:18:59 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 09:18:59 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:18:59 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:18:59 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 09:18:59 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 09:18:59 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 09:18:59 +0000 DEBUG:Page texts: {}
2025-12-07 09:18:59 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 09:18:59 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 09:18:59 +0000 INFO:display_visualizations executed successfully
2025-12-07 09:18:59 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 09:18:59 +0000 INFO:pagesetup executed successfully
2025-12-07 09:18:59 +0000 INFO:Menu setup completed successfully.
2025-12-07 09:18:59 +0000 INFO:App is fully loaded and ready!
2025-12-07 09:19:06 +0000 INFO:Streamlit App Starting...
2025-12-07 09:19:06 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:19:06 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:19:06 +0000 INFO:Running App setup...
2025-12-07 09:19:06 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:Setting up the package
2025-12-07 09:19:06 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:19:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:get_git_version executed successfully
2025-12-07 09:19:06 +0000 INFO:Version: v50.190
2025-12-07 09:19:06 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:19:06 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:filenames already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:thresholds already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:filter_def already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:security already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:perc_target already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:directories already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:data_dir already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:output_dir already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:components_dir already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 09:19:06 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 09:19:06 +0000 INFO:Session_state variables initialized
2025-12-07 09:19:06 +0000 DEBUG:load_raw_data_last_modified: 1765099099.3339787
2025-12-07 09:19:06 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:19:06 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:19:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:19:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:19:06 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 09:19:06 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:19:06 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 09:19:06 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:19:06 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:19:06 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:19:06 +0000 DEBUG:components_dir: components
2025-12-07 09:19:06 +0000 DEBUG:load_donorlist_data_last_modified: 1765099104.7364204
2025-12-07 09:19:06 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:19:06 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:19:06 +0000 DEBUG:utils_dir: utils
2025-12-07 09:19:06 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:19:06 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:19:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:19:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:19:06 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:19:06 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:19:06 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 09:19:06 +0000 DEBUG:logs_dir: logs
2025-12-07 09:19:06 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:19:06 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:19:06 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:19:06 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:19:06 +0000 DEBUG:output_dir: output
2025-12-07 09:19:06 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:19:06 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:19:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 09:19:06 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 09:19:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:19:06 +0000 DEBUG:selected_group_entity: Party Affiliation
2025-12-07 09:19:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:19:06 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:19:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:19:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 09:19:06 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:19:06 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 09:19:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:19:06 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x0000029B8E5DF880>}
2025-12-07 09:19:06 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:19:06 +0000 DEBUG:data_dir: data
2025-12-07 09:19:06 +0000 DEBUG:selected_entity_name: All
2025-12-07 09:19:06 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 09:19:06 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:19:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:19:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:19:06 +0000 INFO:Session state Setup complete
2025-12-07 09:19:06 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:19:06 +0000 INFO:Package setup complete
2025-12-07 09:19:06 +0000 INFO:setup_package executed successfully
2025-12-07 09:19:06 +0000 INFO:Setup completed successfully.
2025-12-07 09:19:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:Running first load function.
2025-12-07 09:19:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:19:06 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:19:06 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:19:06 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:19:06 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 09:19:06 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:19:06 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:19:06 +0000 INFO:firstload executed successfully
2025-12-07 09:19:06 +0000 INFO:Data first load completed successfully.
2025-12-07 09:19:06 +0000 INFO:initialise_data executed successfully
2025-12-07 09:19:06 +0000 INFO:Running Menu setup...
2025-12-07 09:19:06 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:get_git_version executed successfully
2025-12-07 09:19:06 +0000 INFO:App Version: v50.228
2025-12-07 09:19:06 +0000 INFO:Switched to page: Corporate Donations
2025-12-07 09:19:06 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 09:19:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:19:06 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 09:19:06 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 DEBUG:Page texts: {}
2025-12-07 09:19:06 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 09:19:06 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 09:19:06 +0000 INFO:display_visualizations executed successfully
2025-12-07 09:19:06 +0000 INFO:display_data_page executed successfully
2025-12-07 09:19:06 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 09:19:07 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:19:07 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:19:07 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 09:19:07 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 09:19:07 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 09:19:07 +0000 DEBUG:Page texts: {}
2025-12-07 09:19:07 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 09:19:07 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 09:19:07 +0000 INFO:display_visualizations executed successfully
2025-12-07 09:19:07 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 09:19:07 +0000 INFO:pagesetup executed successfully
2025-12-07 09:19:07 +0000 INFO:Menu setup completed successfully.
2025-12-07 09:19:07 +0000 INFO:App is fully loaded and ready!
2025-12-07 09:19:11 +0000 INFO:Streamlit App Starting...
2025-12-07 09:19:11 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:19:11 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:19:11 +0000 INFO:Running App setup...
2025-12-07 09:19:11 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 INFO:Setting up the package
2025-12-07 09:19:11 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:19:11 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 INFO:get_git_version executed successfully
2025-12-07 09:19:11 +0000 INFO:Version: v50.190
2025-12-07 09:19:11 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:19:11 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:filenames already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:thresholds already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:filter_def already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:security already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:perc_target already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:directories already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:data_dir already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:output_dir already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:components_dir already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 09:19:11 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 09:19:11 +0000 INFO:Session_state variables initialized
2025-12-07 09:19:11 +0000 DEBUG:load_raw_data_last_modified: 1765099099.3339787
2025-12-07 09:19:11 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:19:11 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:19:11 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:19:11 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:19:11 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 09:19:11 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:19:11 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 09:19:11 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:19:11 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:19:11 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:19:11 +0000 DEBUG:components_dir: components
2025-12-07 09:19:11 +0000 DEBUG:load_donorlist_data_last_modified: 1765099104.7364204
2025-12-07 09:19:11 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:19:11 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:19:11 +0000 DEBUG:utils_dir: utils
2025-12-07 09:19:11 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:19:11 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:19:11 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:19:11 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:19:11 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:19:11 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:19:11 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 09:19:11 +0000 DEBUG:logs_dir: logs
2025-12-07 09:19:11 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:19:11 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:19:11 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:19:11 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:19:11 +0000 DEBUG:output_dir: output
2025-12-07 09:19:11 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:19:11 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:19:11 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 09:19:11 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 09:19:11 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:19:11 +0000 DEBUG:selected_group_entity: Party Affiliation
2025-12-07 09:19:11 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:19:11 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:19:11 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:19:11 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 09:19:11 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:19:11 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 09:19:11 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:19:11 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x0000029B8E5DF880>}
2025-12-07 09:19:11 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:19:11 +0000 DEBUG:data_dir: data
2025-12-07 09:19:11 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 09:19:11 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:19:11 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:19:11 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:19:11 +0000 DEBUG:selected_entity_name: Reform UK
2025-12-07 09:19:11 +0000 INFO:Session state Setup complete
2025-12-07 09:19:11 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:19:11 +0000 INFO:Package setup complete
2025-12-07 09:19:11 +0000 INFO:setup_package executed successfully
2025-12-07 09:19:11 +0000 INFO:Setup completed successfully.
2025-12-07 09:19:11 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 INFO:Running first load function.
2025-12-07 09:19:11 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:19:11 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:19:11 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:19:11 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:19:11 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 09:19:11 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:19:11 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:19:11 +0000 INFO:firstload executed successfully
2025-12-07 09:19:11 +0000 INFO:Data first load completed successfully.
2025-12-07 09:19:11 +0000 INFO:initialise_data executed successfully
2025-12-07 09:19:11 +0000 INFO:Running Menu setup...
2025-12-07 09:19:11 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 INFO:get_git_version executed successfully
2025-12-07 09:19:11 +0000 INFO:App Version: v50.228
2025-12-07 09:19:11 +0000 INFO:Switched to page: Corporate Donations
2025-12-07 09:19:11 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 09:19:11 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 09:19:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:19:12 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 09:19:12 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 DEBUG:Page texts: {}
2025-12-07 09:19:12 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 09:19:12 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 INFO:display_visualizations executed successfully
2025-12-07 09:19:12 +0000 INFO:display_data_page executed successfully
2025-12-07 09:19:12 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:19:12 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 09:19:12 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 DEBUG:Page texts: {}
2025-12-07 09:19:12 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 09:19:12 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 09:19:12 +0000 INFO:display_visualizations executed successfully
2025-12-07 09:19:12 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 09:19:12 +0000 INFO:pagesetup executed successfully
2025-12-07 09:19:12 +0000 INFO:Menu setup completed successfully.
2025-12-07 09:19:12 +0000 INFO:App is fully loaded and ready!
2025-12-07 09:27:03 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 09:27:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:27:04 +0000 INFO:get_git_version executed successfully
2025-12-07 09:27:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 INFO:get_git_version executed successfully
2025-12-07 09:27:05 +0000 INFO:Streamlit App Starting...
2025-12-07 09:27:05 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:27:05 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:27:05 +0000 INFO:Running App setup...
2025-12-07 09:27:05 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 INFO:Setting up the package
2025-12-07 09:27:05 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:27:05 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 INFO:get_git_version executed successfully
2025-12-07 09:27:05 +0000 INFO:Version: v50.190
2025-12-07 09:27:05 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:27:05 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 09:27:05 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:27:05 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 09:27:05 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 09:27:05 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:27:05 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:27:05 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:27:05 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:27:05 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 09:27:05 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 09:27:05 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:27:05 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 09:27:05 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 09:27:05 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 09:27:05 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 09:27:05 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 09:27:05 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 09:27:05 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 09:27:05 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 09:27:05 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 09:27:05 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 09:27:05 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:27:05 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 09:27:05 +0000 INFO:Session_state variables initialized
2025-12-07 09:27:05 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:27:05 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:27:05 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:27:05 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:27:05 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:27:05 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:27:05 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:27:05 +0000 DEBUG:utils_dir: utils
2025-12-07 09:27:05 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:27:05 +0000 DEBUG:output_dir: output
2025-12-07 09:27:05 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:27:05 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:27:05 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:27:05 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:27:05 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:27:05 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:27:05 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:27:05 +0000 DEBUG:logs_dir: logs
2025-12-07 09:27:05 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:27:05 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:27:05 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:27:05 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:27:05 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:27:05 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:27:05 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:27:05 +0000 DEBUG:components_dir: components
2025-12-07 09:27:05 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:27:05 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:27:05 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:27:05 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:27:05 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:27:05 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:27:05 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:27:05 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:27:05 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:27:05 +0000 DEBUG:data_dir: data
2025-12-07 09:27:05 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:27:05 +0000 INFO:Session state Setup complete
2025-12-07 09:27:05 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:27:05 +0000 INFO:Package setup complete
2025-12-07 09:27:05 +0000 INFO:setup_package executed successfully
2025-12-07 09:27:05 +0000 INFO:Setup completed successfully.
2025-12-07 09:27:05 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 INFO:get_git_version executed successfully
2025-12-07 09:27:05 +0000 INFO:Running first load function.
2025-12-07 09:27:05 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 09:27:05 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 09:27:05 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:27:05 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 09:27:05 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 09:27:05 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:27:05 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 09:27:05 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:27:05 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 09:27:05 +0000 INFO:Last modification time: 1765099099.3339787
2025-12-07 09:27:05 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:27:05 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765099099.3339787 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 09:27:05 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 09:27:06 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:27:06 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 09:27:06 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 09:27:06 +0000 INFO:Cleaning up raw data
2025-12-07 09:27:06 +0000 ERROR:Session state variables not initialized!
2025-12-07 09:27:06 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:27:06 +0000 INFO:Original file path: None
2025-12-07 09:27:06 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 09:27:06 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 09:27:06 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:27:06 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 09:27:07 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:27:07 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:27:08 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:27:08 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:27:08 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 09:27:08 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:27:08 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:27:08 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 09:27:08 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 09:27:08 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 09:27:08 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 09:27:08 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:27:08 +0000 INFO:Raw Data cleanup completed
2025-12-07 09:27:08 +0000 INFO:Data shape: (91651, 37)
2025-12-07 09:27:10 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 09:27:10 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 09:27:10 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 09:27:10 +0000 INFO:load_raw_data executed successfully
2025-12-07 09:27:10 +0000 INFO:get_raw_data executed successfully
2025-12-07 09:27:10 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:27:10 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:27:10 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:27:10 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 09:27:10 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:27:10 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 09:27:10 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 09:27:10 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:27:10 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 09:27:10 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:27:10 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 09:27:10 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:27:10 +0000 INFO:Current modification time: 1765099630.301114
2025-12-07 09:27:10 +0000 INFO:Last modification time: 1765099099.3339787
2025-12-07 09:27:10 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:27:10 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:27:10 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 09:27:10 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 09:27:10 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 09:27:10 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 09:27:12 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:27:12 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 09:27:12 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2557
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Name: count, dtype: int64
2025-12-07 09:27:12 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  9
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:27:12 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 09:44:13 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 09:44:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:13 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:14 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:14 +0000 INFO:Streamlit App Starting...
2025-12-07 09:44:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:44:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 09:44:14 +0000 INFO:Running App setup...
2025-12-07 09:44:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:44:14 +0000 INFO:Setting up the package
2025-12-07 09:44:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:44:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:15 +0000 INFO:Version: v50.190
2025-12-07 09:44:15 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:44:15 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 09:44:15 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:44:15 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 09:44:15 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 09:44:15 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:44:15 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:44:15 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:44:15 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:44:15 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 09:44:15 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 09:44:15 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:44:15 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 09:44:15 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 09:44:15 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 09:44:15 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 09:44:15 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 09:44:15 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 09:44:15 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 09:44:15 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 09:44:15 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 09:44:15 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 09:44:15 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:44:15 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 09:44:15 +0000 INFO:Session_state variables initialized
2025-12-07 09:44:15 +0000 DEBUG:components_dir: components
2025-12-07 09:44:15 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:44:15 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:44:15 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:44:15 +0000 DEBUG:data_dir: data
2025-12-07 09:44:15 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:44:15 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:44:15 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:44:15 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:44:15 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:44:15 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:44:15 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:44:15 +0000 DEBUG:output_dir: output
2025-12-07 09:44:15 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:44:15 +0000 DEBUG:utils_dir: utils
2025-12-07 09:44:15 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:44:15 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:44:15 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:44:15 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:44:15 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:44:15 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:44:15 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:44:15 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:44:15 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:44:15 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:44:15 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:44:15 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:44:15 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:44:15 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:44:15 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:44:15 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:44:15 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:44:15 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:44:15 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:44:15 +0000 DEBUG:logs_dir: logs
2025-12-07 09:44:15 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:44:15 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:44:15 +0000 INFO:Session state Setup complete
2025-12-07 09:44:15 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:44:15 +0000 INFO:Package setup complete
2025-12-07 09:44:15 +0000 INFO:setup_package executed successfully
2025-12-07 09:44:15 +0000 INFO:Setup completed successfully.
2025-12-07 09:44:15 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:15 +0000 INFO:Running first load function.
2025-12-07 09:44:15 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 09:44:15 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 09:44:15 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:44:15 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 09:44:15 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 09:44:15 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:44:15 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 09:44:15 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:44:15 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 09:44:15 +0000 INFO:Last modification time: 1765099630.301114
2025-12-07 09:44:15 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:44:15 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765099630.301114 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 09:44:15 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 09:44:16 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:44:16 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 09:44:16 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 09:44:16 +0000 INFO:Cleaning up raw data
2025-12-07 09:44:16 +0000 ERROR:Session state variables not initialized!
2025-12-07 09:44:16 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:16 +0000 INFO:Original file path: None
2025-12-07 09:44:16 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 09:44:16 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 09:44:16 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:44:16 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 09:44:21 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:44:21 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:44:21 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:44:21 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:44:21 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 09:44:21 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:44:21 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:44:21 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 09:44:21 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 09:44:21 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 09:44:21 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 09:44:21 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:44:21 +0000 INFO:Raw Data cleanup completed
2025-12-07 09:44:21 +0000 INFO:Data shape: (91651, 37)
2025-12-07 09:44:23 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 09:44:23 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 09:44:23 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 09:44:23 +0000 INFO:load_raw_data executed successfully
2025-12-07 09:44:23 +0000 INFO:get_raw_data executed successfully
2025-12-07 09:44:23 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:44:23 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:23 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:23 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 09:44:23 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:23 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 09:44:23 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 09:44:23 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:44:23 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 09:44:23 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:44:23 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 09:44:23 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:44:23 +0000 INFO:Current modification time: 1765100663.5197592
2025-12-07 09:44:23 +0000 INFO:Last modification time: 1765099630.301114
2025-12-07 09:44:23 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:44:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:44:23 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 09:44:23 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 09:44:23 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 09:44:24 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 09:44:30 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:44:30 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 09:44:30 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2557
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Name: count, dtype: int64
2025-12-07 09:44:30 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  9
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:44:30 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 09:44:30 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Medium Large Entity                 2269
Small Medium Entity                 2047
Large Entity                        2038
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 09:44:30 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 09:44:30 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 09:44:30 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 09:44:30 +0000 INFO:Loading election dates from pdpy.
2025-12-07 09:44:30 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 09:44:30 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 09:44:30 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 09:44:30 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 09:44:30 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 09:44:30 +0000 INFO:load_election_dates executed successfully
2025-12-07 09:44:31 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 09:44:31 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 09:44:33 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 09:44:33 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 09:44:33 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 09:44:33 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:44:33 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 09:44:33 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 09:44:33 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 09:44:33 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 09:44:33 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:44:33 +0000 INFO:Current modification time: 1765100673.5888715
2025-12-07 09:44:33 +0000 INFO:Last modification time: 1765099104.7364204
2025-12-07 09:44:33 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:44:33 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:44:33 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 09:44:33 +0000 INFO:Donor Data summary completed
2025-12-07 09:44:33 +0000 INFO:Data shape: (31905, 5)
2025-12-07 09:44:33 +0000 INFO:load_donorList_data executed successfully
2025-12-07 09:44:33 +0000 INFO:get_donor_data executed successfully
2025-12-07 09:44:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:44:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:44:33 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 09:44:33 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 09:44:33 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 09:44:33 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 09:44:33 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:44:33 +0000 INFO:Current modification time: 1765100673.5888715
2025-12-07 09:44:33 +0000 INFO:Last modification time: 1765100673.5888715
2025-12-07 09:44:33 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:44:33 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765100673.5888715 instead of output\cleaned_data.csv
2025-12-07 09:44:33 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 09:44:33 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 09:44:33 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:44:33 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 09:44:33 +0000 INFO:Raw Data cleanup completed
2025-12-07 09:44:33 +0000 INFO:Data shape: (1719, 6)
2025-12-07 09:44:33 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 09:44:33 +0000 INFO:get_regentity_data executed successfully
2025-12-07 09:44:33 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 09:44:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:44:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:44:33 +0000 INFO:firstload executed successfully
2025-12-07 09:44:33 +0000 INFO:Data first load completed successfully.
2025-12-07 09:44:33 +0000 INFO:initialise_data executed successfully
2025-12-07 09:44:33 +0000 INFO:Running Menu setup...
2025-12-07 09:44:33 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 09:44:33 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:34 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:34 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:34 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:34 +0000 INFO:App Version: v50.228
2025-12-07 09:44:34 +0000 INFO:Switched to page: Introduction
2025-12-07 09:44:34 +0000 INFO:pagesetup executed successfully
2025-12-07 09:44:34 +0000 INFO:Menu setup completed successfully.
2025-12-07 09:44:34 +0000 INFO:App is fully loaded and ready!
2025-12-07 09:44:40 +0000 INFO:Streamlit App Starting...
2025-12-07 09:44:40 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:44:40 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 09:44:40 +0000 INFO:Running App setup...
2025-12-07 09:44:40 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 INFO:Setting up the package
2025-12-07 09:44:40 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:44:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:40 +0000 INFO:Version: v50.190
2025-12-07 09:44:40 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:44:40 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:filenames already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:thresholds already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:filter_def already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:security already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:perc_target already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:directories already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:data_dir already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:output_dir already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:components_dir already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 09:44:40 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 09:44:40 +0000 INFO:Session_state variables initialized
2025-12-07 09:44:40 +0000 DEBUG:components_dir: components
2025-12-07 09:44:40 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:44:40 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:44:40 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:44:40 +0000 DEBUG:data_dir: data
2025-12-07 09:44:40 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:44:40 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:44:40 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:44:40 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 09:44:40 +0000 DEBUG:load_donorlist_data_last_modified: 1765100673.5888715
2025-12-07 09:44:40 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:44:40 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:44:40 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:44:40 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:44:40 +0000 DEBUG:output_dir: output
2025-12-07 09:44:40 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 09:44:40 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:44:40 +0000 DEBUG:utils_dir: utils
2025-12-07 09:44:40 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:44:40 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:44:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:44:40 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:44:40 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:44:40 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 09:44:40 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:44:40 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:44:40 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:44:40 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:44:40 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:44:40 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:44:40 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:44:40 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:44:40 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:44:40 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 09:44:40 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:44:40 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:44:40 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 09:44:40 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:44:40 +0000 DEBUG:load_raw_data_last_modified: 1765100663.5197592
2025-12-07 09:44:40 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:44:40 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:44:40 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 09:44:40 +0000 DEBUG:logs_dir: logs
2025-12-07 09:44:40 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:44:40 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:44:40 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001D452DC0820>}
2025-12-07 09:44:40 +0000 INFO:Session state Setup complete
2025-12-07 09:44:40 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:44:40 +0000 INFO:Package setup complete
2025-12-07 09:44:40 +0000 INFO:setup_package executed successfully
2025-12-07 09:44:40 +0000 INFO:Setup completed successfully.
2025-12-07 09:44:40 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 INFO:Running first load function.
2025-12-07 09:44:40 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:44:40 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:44:40 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:44:40 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:44:40 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 09:44:40 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 09:44:40 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 09:44:40 +0000 INFO:firstload executed successfully
2025-12-07 09:44:40 +0000 INFO:Data first load completed successfully.
2025-12-07 09:44:40 +0000 INFO:initialise_data executed successfully
2025-12-07 09:44:40 +0000 INFO:Running Menu setup...
2025-12-07 09:44:40 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 INFO:get_git_version executed successfully
2025-12-07 09:44:40 +0000 INFO:App Version: v50.228
2025-12-07 09:44:40 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 09:44:40 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 09:44:40 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 09:44:40 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 09:44:41 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 09:44:42 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20131.118739
1                       Green Party   6023.742231
2                      Labour Party  20650.882442
3                      Large Entity  29763.708881
4                  Liberal Democrat   8504.706244
5                     Medium Entity  15666.034757
6               Medium Large Entity  38493.144337
7            Single Donation Entity  12207.983689
8                      Small Entity  16114.092989
9               Small Medium Entity  21512.571099
10     Uk Independence Party (Ukip)   9919.127250
11                Very Small Entity  24966.683550
2025-12-07 09:44:42 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
6               Medium Large Entity  38493.144337
3                      Large Entity  29763.708881
11                Very Small Entity  24966.683550
9               Small Medium Entity  21512.571099
2                      Labour Party  20650.882442
0   Conservative And Unionist Party  20131.118739
8                      Small Entity  16114.092989
5                     Medium Entity  15666.034757
7            Single Donation Entity  12207.983689
10     Uk Independence Party (Ukip)   9919.127250
4                  Liberal Democrat   8504.706244
1                       Green Party   6023.742231
2025-12-07 09:44:42 +0000 DEBUG:Unique XValues: ['Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 'Green Party']
2025-12-07 09:44:42 +0000 DEBUG:Final color_discrete_map: {'Medium Large Entity': '#636efa', 'Large Entity': '#9467bd', 'Very Small Entity': '#bcbd22', 'Small Medium Entity': '#17becf', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#e377c2', 'Medium Entity': '#8c564b', 'Single Donation Entity': '#7f7f7f', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', 'Green Party': '#78B943'}
2025-12-07 09:44:42 +0000 DEBUG:Missing color mappings for: ['Medium Large Entity']
2025-12-07 09:44:42 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Large Entity',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Medium Large Entity',
              'offsetgroup': 'Medium Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'UQZonqTL4kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#9467bd', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9nxPXu0Q3UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Very Small Entity',
              'marker': {'color': '#bcbd22', 'pattern': {'shape': ''}},
              'name': 'Very Small Entity',
              'offsetgroup': 'Very Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Very Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'typIv6th2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Medium Entity',
              'marker': {'color': '#17becf', 'pattern': {'shape': ''}},
              'name': 'Small Medium Entity',
              'offsetgroup': 'Small Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9ofjjCQC1UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AHzuebgq1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '1f1qmceo00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#e377c2', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LAkU5wt5z0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#8c564b', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'zM7ocgSZzkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#7f7f7f', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nHuE6f3Xx0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'QIC7SZBfw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Democrat',
              'marker': {'color': '#FDBB30', 'pattern': {'shape': ''}},
              'name': 'Liberal Democrat',
              'offsetgroup': 'Liberal Democrat',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Democrat'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AMMxZlqcwEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7u/VAr6Ht0A=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Medium Large Entity, Large Entity, Very
                                           Small Entity, Small Medium Entity,
                                           Labour Party, Conservative And Unionist
                                           Party, Small Entity, Medium Entity,
                                           Single Donation Entity, Uk Independence
                                           Party (Ukip), Liberal Democrat, Green
                                           Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2025-12-07 09:44:43 +0000 INFO:Bar chart displayed successfully.
2025-12-07 09:44:43 +0000 INFO:hlf_body executed successfully
2025-12-07 09:44:43 +0000 INFO:pagesetup executed successfully
2025-12-07 09:44:43 +0000 INFO:Menu setup completed successfully.
2025-12-07 09:44:43 +0000 INFO:App is fully loaded and ready!
2025-12-07 09:54:20 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 09:54:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:54:20 +0000 INFO:get_git_version executed successfully
2025-12-07 09:54:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 INFO:get_git_version executed successfully
2025-12-07 09:54:21 +0000 INFO:Streamlit App Starting...
2025-12-07 09:54:21 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:54:21 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:54:21 +0000 INFO:Running App setup...
2025-12-07 09:54:21 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 INFO:Setting up the package
2025-12-07 09:54:21 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 09:54:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 INFO:get_git_version executed successfully
2025-12-07 09:54:21 +0000 INFO:Version: v50.190
2025-12-07 09:54:21 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:54:21 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 09:54:21 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:54:21 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 09:54:21 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 09:54:21 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:54:21 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:54:21 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:54:21 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:54:21 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 09:54:21 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 09:54:21 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:54:21 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 09:54:21 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 09:54:21 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 09:54:21 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 09:54:21 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 09:54:21 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 09:54:21 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 09:54:21 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 09:54:21 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 09:54:21 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 09:54:21 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:54:21 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 09:54:21 +0000 INFO:Session_state variables initialized
2025-12-07 09:54:21 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 09:54:21 +0000 DEBUG:reference_dir: reference_files
2025-12-07 09:54:21 +0000 DEBUG:logs_dir: logs
2025-12-07 09:54:21 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 09:54:21 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 09:54:21 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 09:54:21 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 09:54:21 +0000 DEBUG:Cash_ftr: None
2025-12-07 09:54:21 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 09:54:21 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 09:54:21 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 09:54:21 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 09:54:21 +0000 DEBUG:perc_target: 0.5
2025-12-07 09:54:21 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 09:54:21 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 09:54:21 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 09:54:21 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 09:54:21 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 09:54:21 +0000 DEBUG:utils_dir: utils
2025-12-07 09:54:21 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 09:54:21 +0000 DEBUG:output_dir: output
2025-12-07 09:54:21 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 09:54:21 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 09:54:21 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 09:54:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 09:54:21 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 09:54:21 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 09:54:21 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 09:54:21 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 09:54:21 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 09:54:21 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 09:54:21 +0000 DEBUG:data_dir: data
2025-12-07 09:54:21 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 09:54:21 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:54:21 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 09:54:21 +0000 DEBUG:components_dir: components
2025-12-07 09:54:21 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 09:54:21 +0000 INFO:Session state Setup complete
2025-12-07 09:54:21 +0000 INFO:initialize_session_state executed successfully
2025-12-07 09:54:21 +0000 INFO:Package setup complete
2025-12-07 09:54:21 +0000 INFO:setup_package executed successfully
2025-12-07 09:54:21 +0000 INFO:Setup completed successfully.
2025-12-07 09:54:21 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 INFO:get_git_version executed successfully
2025-12-07 09:54:21 +0000 INFO:Running first load function.
2025-12-07 09:54:21 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 09:54:21 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 09:54:21 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 09:54:21 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 09:54:21 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 09:54:21 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:54:21 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 09:54:21 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:54:21 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 09:54:21 +0000 INFO:Last modification time: 1765100663.5197592
2025-12-07 09:54:21 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:54:21 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765100663.5197592 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 09:54:21 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 09:54:22 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:54:22 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 09:54:22 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 09:54:22 +0000 INFO:Cleaning up raw data
2025-12-07 09:54:22 +0000 ERROR:Session state variables not initialized!
2025-12-07 09:54:22 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:54:22 +0000 INFO:Original file path: None
2025-12-07 09:54:22 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 09:54:22 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 09:54:22 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:54:22 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 09:54:24 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:54:24 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:54:24 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:54:24 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 09:54:24 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 09:54:24 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:54:24 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 09:54:24 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 09:54:24 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 09:54:24 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 09:54:24 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 09:54:24 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 09:54:24 +0000 INFO:Raw Data cleanup completed
2025-12-07 09:54:24 +0000 INFO:Data shape: (91651, 37)
2025-12-07 09:54:26 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 09:54:26 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 09:54:26 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 09:54:26 +0000 INFO:load_raw_data executed successfully
2025-12-07 09:54:26 +0000 INFO:get_raw_data executed successfully
2025-12-07 09:54:26 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 09:54:26 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:54:26 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 09:54:26 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 09:54:26 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 09:54:26 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 09:54:26 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 09:54:26 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 09:54:26 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 09:54:26 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 09:54:26 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 09:54:26 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 09:54:26 +0000 INFO:Current modification time: 1765101266.6231523
2025-12-07 09:54:26 +0000 INFO:Last modification time: 1765100663.5197592
2025-12-07 09:54:26 +0000 INFO:is_file_updated executed successfully
2025-12-07 09:54:26 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 09:54:26 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 09:54:26 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 09:54:26 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 09:54:27 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 09:54:28 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 09:54:28 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 09:54:29 +0000 ERROR:Error in load_cleaned_data: st.session_state has no attribute "party_parents". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state.py", line 471, in __getitem__
    base_value = self._getitem(widget_id, key)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state.py", line 524, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 104, in __getitem__
    return self._state[key]
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state.py", line 478, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "party_parents". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\clean_and_enhance.py", line 322, in load_cleaned_data
    party_parents = st.session_state.party_parents
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "party_parents". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025-12-07 09:54:29 +0000 CRITICAL:First load crashed: st.session_state has no attribute "party_parents". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state.py", line 471, in __getitem__
    base_value = self._getitem(widget_id, key)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state.py", line 524, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 104, in __getitem__
    return self._state[key]
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state.py", line 478, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "party_parents". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py", line 45, in <module>
    initialise_data()  # Load the data
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 77, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 65, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 228, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 270, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 329, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 26, in get_cleaned_data
    return load_cleaned_data(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\clean_and_enhance.py", line 322, in load_cleaned_data
    party_parents = st.session_state.party_parents
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "party_parents". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025-12-07 09:57:41 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 09:57:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:57:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:57:42 +0000 INFO:get_git_version executed successfully
2025-12-07 09:57:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 09:57:42 +0000 INFO:get_git_version executed successfully
2025-12-07 09:57:43 +0000 INFO:Streamlit App Starting...
2025-12-07 09:57:43 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 09:57:43 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 09:57:43 +0000 INFO:Running App setup...
2025-12-07 10:00:06 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 10:00:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:00:06 +0000 INFO:get_git_version executed successfully
2025-12-07 10:00:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 INFO:get_git_version executed successfully
2025-12-07 10:00:07 +0000 INFO:Streamlit App Starting...
2025-12-07 10:00:07 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:00:07 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:00:07 +0000 INFO:Running App setup...
2025-12-07 10:00:07 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 INFO:Setting up the package
2025-12-07 10:00:07 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:00:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 INFO:get_git_version executed successfully
2025-12-07 10:00:07 +0000 INFO:Version: v50.190
2025-12-07 10:00:07 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:00:07 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:00:07 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:00:07 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:00:07 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:00:07 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:00:07 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:00:07 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:00:07 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:00:07 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:00:07 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:00:07 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:00:07 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:00:07 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:00:07 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:00:07 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:00:07 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:00:07 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:00:07 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:00:07 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:00:07 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:00:07 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:00:07 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:00:07 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:00:07 +0000 INFO:Session_state variables initialized
2025-12-07 10:00:07 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:00:07 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:00:07 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:00:07 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:00:07 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:00:07 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:00:07 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:00:07 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:00:07 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:00:07 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:00:07 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:00:07 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:00:07 +0000 DEBUG:data_dir: data
2025-12-07 10:00:07 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:00:07 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:00:07 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:00:07 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:00:07 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:00:07 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:00:07 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:00:07 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:00:07 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:00:07 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:00:07 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:00:07 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:00:07 +0000 DEBUG:utils_dir: utils
2025-12-07 10:00:07 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:00:07 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:00:07 +0000 DEBUG:output_dir: output
2025-12-07 10:00:07 +0000 DEBUG:logs_dir: logs
2025-12-07 10:00:07 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:00:07 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:00:07 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:00:07 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:00:07 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:00:07 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:00:07 +0000 DEBUG:components_dir: components
2025-12-07 10:00:07 +0000 INFO:Session state Setup complete
2025-12-07 10:00:07 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:00:07 +0000 INFO:Package setup complete
2025-12-07 10:00:07 +0000 INFO:setup_package executed successfully
2025-12-07 10:00:07 +0000 INFO:Setup completed successfully.
2025-12-07 10:00:07 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 INFO:get_git_version executed successfully
2025-12-07 10:00:07 +0000 INFO:Running first load function.
2025-12-07 10:00:07 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 10:00:07 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 10:00:07 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:00:07 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 10:00:07 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 10:00:07 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:00:07 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 10:00:07 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:00:07 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 10:00:07 +0000 INFO:Last modification time: 1765101266.6231523
2025-12-07 10:00:07 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:00:07 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765101266.6231523 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 10:00:07 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 10:00:08 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:00:08 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 10:00:08 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 10:00:08 +0000 INFO:Cleaning up raw data
2025-12-07 10:00:08 +0000 ERROR:Session state variables not initialized!
2025-12-07 10:00:08 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:00:08 +0000 INFO:Original file path: None
2025-12-07 10:00:08 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 10:00:08 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 10:00:08 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:00:08 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 10:00:10 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:00:10 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:00:10 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:00:10 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:00:10 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 10:00:10 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:00:10 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:00:10 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 10:00:10 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 10:00:10 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 10:00:10 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 10:00:10 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:00:10 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:00:10 +0000 INFO:Data shape: (91651, 37)
2025-12-07 10:00:12 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 10:00:12 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 10:00:12 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 10:00:12 +0000 INFO:load_raw_data executed successfully
2025-12-07 10:00:12 +0000 INFO:get_raw_data executed successfully
2025-12-07 10:00:12 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:00:12 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:00:12 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:00:12 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 10:00:12 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:00:12 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 10:00:12 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 10:00:12 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:00:12 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 10:00:12 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:00:12 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 10:00:12 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:00:12 +0000 INFO:Current modification time: 1765101612.1129372
2025-12-07 10:00:12 +0000 INFO:Last modification time: 1765101266.6231523
2025-12-07 10:00:12 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:00:12 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:00:12 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 10:00:12 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 10:00:12 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 10:00:12 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 10:00:14 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:00:14 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 10:00:14 +0000 ERROR:Error in load_cleaned_data: 'party_parents'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\clean_and_enhance.py", line 322, in load_cleaned_data
    party_parents = st.session_state.data_remappings["party_parents"]
KeyError: 'party_parents'
2025-12-07 10:00:14 +0000 CRITICAL:First load crashed: 'party_parents'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py", line 45, in <module>
    initialise_data()  # Load the data
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 77, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 65, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 228, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 270, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 329, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 26, in get_cleaned_data
    return load_cleaned_data(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\clean_and_enhance.py", line 322, in load_cleaned_data
    party_parents = st.session_state.data_remappings["party_parents"]
KeyError: 'party_parents'
2025-12-07 10:01:21 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 10:01:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:01:21 +0000 INFO:get_git_version executed successfully
2025-12-07 10:01:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 INFO:get_git_version executed successfully
2025-12-07 10:01:22 +0000 INFO:Streamlit App Starting...
2025-12-07 10:01:22 +0000 INFO:Streamlit App Starting...
2025-12-07 10:01:22 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:01:22 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:01:22 +0000 INFO:Running App setup...
2025-12-07 10:01:22 +0000 INFO:Running App setup...
2025-12-07 10:01:22 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 INFO:Setting up the package
2025-12-07 10:01:22 +0000 INFO:Setting up the package
2025-12-07 10:01:22 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 INFO:get_git_version executed successfully
2025-12-07 10:01:22 +0000 INFO:get_git_version executed successfully
2025-12-07 10:01:22 +0000 INFO:Version: v50.190
2025-12-07 10:01:22 +0000 INFO:Version: v50.190
2025-12-07 10:01:22 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:01:22 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:01:22 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:01:22 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:01:22 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:01:22 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:01:22 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:01:22 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:01:22 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:01:22 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:01:22 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:01:22 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:01:22 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:01:22 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:01:22 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:01:22 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:01:22 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:01:22 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:01:22 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:01:22 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:01:22 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:01:22 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:01:22 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:01:22 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:01:22 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:01:22 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:01:22 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:01:22 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:01:22 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:01:22 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:01:22 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:01:22 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:01:22 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:01:22 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:01:22 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:01:22 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:01:22 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:01:22 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:01:22 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:01:22 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:01:22 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:01:22 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:01:22 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:01:22 +0000 INFO:Session_state variables initialized
2025-12-07 10:01:22 +0000 INFO:Session_state variables initialized
2025-12-07 10:01:22 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:01:22 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:01:22 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:01:22 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:01:22 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:01:22 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:01:22 +0000 DEBUG:components_dir: components
2025-12-07 10:01:22 +0000 DEBUG:components_dir: components
2025-12-07 10:01:22 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:01:22 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:01:22 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:01:22 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:01:22 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:01:22 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:01:22 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:01:22 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:01:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:01:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:01:22 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:01:22 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:01:22 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:01:22 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:01:22 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:01:22 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:01:22 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:01:22 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:01:22 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:01:22 +0000 DEBUG:logs_dir: logs
2025-12-07 10:01:22 +0000 DEBUG:logs_dir: logs
2025-12-07 10:01:22 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:01:22 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:01:22 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:01:22 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:01:22 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:01:22 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:01:22 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:01:22 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:01:22 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:01:22 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:01:22 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:01:22 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:01:22 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:01:22 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:01:22 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:01:22 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:01:22 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:01:22 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:01:22 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:01:22 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:01:22 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:01:22 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:01:22 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:01:22 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:01:22 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:01:22 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:01:22 +0000 DEBUG:utils_dir: utils
2025-12-07 10:01:22 +0000 DEBUG:utils_dir: utils
2025-12-07 10:01:22 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:01:22 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:01:22 +0000 DEBUG:output_dir: output
2025-12-07 10:01:22 +0000 DEBUG:output_dir: output
2025-12-07 10:01:22 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:01:22 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:01:22 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:01:22 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:01:22 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:01:22 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:01:22 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:01:22 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:01:22 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:01:22 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:01:22 +0000 DEBUG:data_dir: data
2025-12-07 10:01:22 +0000 DEBUG:data_dir: data
2025-12-07 10:01:22 +0000 INFO:Session state Setup complete
2025-12-07 10:01:22 +0000 INFO:Session state Setup complete
2025-12-07 10:01:22 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:01:22 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:01:22 +0000 INFO:Package setup complete
2025-12-07 10:01:22 +0000 INFO:Package setup complete
2025-12-07 10:01:22 +0000 INFO:setup_package executed successfully
2025-12-07 10:01:22 +0000 INFO:setup_package executed successfully
2025-12-07 10:01:22 +0000 INFO:Setup completed successfully.
2025-12-07 10:01:22 +0000 INFO:Setup completed successfully.
2025-12-07 10:01:22 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 INFO:get_git_version executed successfully
2025-12-07 10:01:22 +0000 INFO:Running first load function.
2025-12-07 10:01:22 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 10:01:22 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 10:01:22 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:01:22 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 10:01:22 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 10:01:22 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:01:22 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 10:01:23 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:01:23 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 10:01:23 +0000 INFO:Last modification time: 1765101612.1129372
2025-12-07 10:01:23 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:01:23 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765101612.1129372 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 10:01:23 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 10:01:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:01:23 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 10:01:23 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 10:01:23 +0000 INFO:Cleaning up raw data
2025-12-07 10:01:23 +0000 ERROR:Session state variables not initialized!
2025-12-07 10:01:23 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:23 +0000 INFO:Original file path: None
2025-12-07 10:01:23 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 10:01:23 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 10:01:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:01:23 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 10:01:25 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:01:25 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:01:25 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:01:25 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:01:25 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 10:01:25 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:01:25 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:01:25 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 10:01:25 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 10:01:25 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 10:01:25 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 10:01:25 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:01:25 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:01:25 +0000 INFO:Data shape: (91651, 37)
2025-12-07 10:01:27 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 10:01:27 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 10:01:27 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 10:01:27 +0000 INFO:load_raw_data executed successfully
2025-12-07 10:01:27 +0000 INFO:get_raw_data executed successfully
2025-12-07 10:01:27 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:01:27 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:27 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:27 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 10:01:27 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:01:27 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 10:01:27 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 10:01:27 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:01:27 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 10:01:27 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:01:27 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 10:01:27 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:01:27 +0000 INFO:Current modification time: 1765101687.2781775
2025-12-07 10:01:27 +0000 INFO:Last modification time: 1765101612.1129372
2025-12-07 10:01:27 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:01:27 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:01:27 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 10:01:27 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 10:01:27 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 10:01:27 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 10:01:29 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:01:29 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 10:01:29 +0000 ERROR:Error in load_cleaned_data: 'PARTYPARENTS'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\clean_and_enhance.py", line 322, in load_cleaned_data
    party_parents = st.session_state.data_remappings["PARTYPARENTS"]
KeyError: 'PARTYPARENTS'
2025-12-07 10:01:29 +0000 CRITICAL:First load crashed: 'PARTYPARENTS'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py", line 45, in <module>
    initialise_data()  # Load the data
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 77, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 65, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 228, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 270, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 329, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\GitHub\dashboard_demo\data\data_loader.py", line 26, in get_cleaned_data
    return load_cleaned_data(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\clean_and_enhance.py", line 322, in load_cleaned_data
    party_parents = st.session_state.data_remappings["PARTYPARENTS"]
KeyError: 'PARTYPARENTS'
2025-12-07 10:03:17 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 10:03:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:18 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:19 +0000 INFO:Streamlit App Starting...
2025-12-07 10:03:19 +0000 INFO:Streamlit App Starting...
2025-12-07 10:03:19 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:03:19 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:03:19 +0000 INFO:Running App setup...
2025-12-07 10:03:19 +0000 INFO:Running App setup...
2025-12-07 10:03:19 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 INFO:Setting up the package
2025-12-07 10:03:19 +0000 INFO:Setting up the package
2025-12-07 10:03:19 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:19 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:19 +0000 INFO:Version: v50.190
2025-12-07 10:03:19 +0000 INFO:Version: v50.190
2025-12-07 10:03:19 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:03:19 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:03:19 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:03:19 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:03:19 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:03:19 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:03:19 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:03:19 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:03:19 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:03:19 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:03:19 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:03:19 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:03:19 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:03:19 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:03:19 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:03:19 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:03:19 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:03:19 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:03:19 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:03:19 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:03:19 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:03:19 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:03:19 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:03:19 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:03:19 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:03:19 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:03:19 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:03:19 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:03:19 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:03:19 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:03:19 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:03:19 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:03:19 +0000 INFO:Session_state variables initialized
2025-12-07 10:03:19 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:03:19 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:03:19 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:03:19 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:03:19 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:03:19 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:03:19 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:03:19 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:03:19 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:03:19 +0000 DEBUG:utils_dir: utils
2025-12-07 10:03:19 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:03:19 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:03:19 +0000 DEBUG:data_dir: data
2025-12-07 10:03:19 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:03:19 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:03:19 +0000 DEBUG:output_dir: output
2025-12-07 10:03:19 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:03:19 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:03:19 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:03:19 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:03:19 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:03:19 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:03:19 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:03:19 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:03:19 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:03:19 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:03:19 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:03:19 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:03:19 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:03:19 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:03:19 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:03:19 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:03:19 +0000 DEBUG:logs_dir: logs
2025-12-07 10:03:19 +0000 DEBUG:components_dir: components
2025-12-07 10:03:19 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:03:19 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:03:19 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:03:19 +0000 INFO:Session state Setup complete
2025-12-07 10:03:19 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:03:19 +0000 INFO:Package setup complete
2025-12-07 10:03:19 +0000 INFO:setup_package executed successfully
2025-12-07 10:03:19 +0000 INFO:Setup completed successfully.
2025-12-07 10:03:19 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:19 +0000 INFO:Running first load function.
2025-12-07 10:03:19 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 10:03:19 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 10:03:19 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:03:19 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 10:03:19 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 10:03:19 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:03:19 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 10:03:19 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:03:19 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 10:03:19 +0000 INFO:Last modification time: 1765101687.2781775
2025-12-07 10:03:19 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:03:19 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765101687.2781775 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 10:03:19 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 10:03:20 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:03:20 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 10:03:20 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 10:03:20 +0000 INFO:Cleaning up raw data
2025-12-07 10:03:20 +0000 ERROR:Session state variables not initialized!
2025-12-07 10:03:20 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:20 +0000 INFO:Original file path: None
2025-12-07 10:03:20 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 10:03:20 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 10:03:20 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:03:20 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 10:03:22 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:03:22 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:03:22 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:03:22 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:03:22 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 10:03:22 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:03:22 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:03:22 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 10:03:22 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 10:03:22 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 10:03:22 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 10:03:22 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:03:22 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:03:22 +0000 INFO:Data shape: (91651, 37)
2025-12-07 10:03:24 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 10:03:24 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 10:03:24 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 10:03:24 +0000 INFO:load_raw_data executed successfully
2025-12-07 10:03:24 +0000 INFO:get_raw_data executed successfully
2025-12-07 10:03:24 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:03:24 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:24 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:24 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 10:03:24 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:24 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 10:03:24 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 10:03:24 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:03:24 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 10:03:24 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:03:24 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 10:03:24 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:03:24 +0000 INFO:Current modification time: 1765101804.1850684
2025-12-07 10:03:24 +0000 INFO:Last modification time: 1765101687.2781775
2025-12-07 10:03:24 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:03:24 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:03:24 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 10:03:24 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 10:03:24 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 10:03:24 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 10:03:26 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:03:26 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 10:03:26 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:03:26 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
90                                 19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
63                                  1669
Medium Entity                       1591
Single Donation Entity               584
7931                                 367
Name: count, dtype: int64
2025-12-07 10:03:26 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
63                                   1
Labour Party                         1
90                                   1
7931                                 1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:03:26 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 10:03:26 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:03:26 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
63                                  1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
7931                                 367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 10:03:26 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
63                                   1
Labour Party                         1
Liberal Democrat                     1
7931                                 1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:03:26 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 10:03:26 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 10:03:26 +0000 INFO:Loading election dates from pdpy.
2025-12-07 10:03:26 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 10:03:26 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 10:03:26 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 10:03:26 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:03:26 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:03:26 +0000 INFO:load_election_dates executed successfully
2025-12-07 10:03:27 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 10:03:27 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 10:03:29 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 10:03:29 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 10:03:29 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 10:03:29 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:03:29 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:03:29 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 10:03:29 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:03:29 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:03:29 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:03:29 +0000 INFO:Current modification time: 1765101809.1224897
2025-12-07 10:03:29 +0000 INFO:Last modification time: 1765100673.5888715
2025-12-07 10:03:29 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:03:29 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:03:29 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 10:03:29 +0000 INFO:Donor Data summary completed
2025-12-07 10:03:29 +0000 INFO:Data shape: (31905, 5)
2025-12-07 10:03:29 +0000 INFO:load_donorList_data executed successfully
2025-12-07 10:03:29 +0000 INFO:get_donor_data executed successfully
2025-12-07 10:03:29 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:03:29 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:03:29 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:03:29 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 10:03:29 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:03:29 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:03:29 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:03:29 +0000 INFO:Current modification time: 1765101809.1224897
2025-12-07 10:03:29 +0000 INFO:Last modification time: 1765101809.1224897
2025-12-07 10:03:29 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:03:29 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765101809.1224897 instead of output\cleaned_data.csv
2025-12-07 10:03:29 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 10:03:29 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 10:03:29 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:03:29 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 10:03:29 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:03:29 +0000 INFO:Data shape: (1719, 6)
2025-12-07 10:03:29 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 10:03:29 +0000 INFO:get_regentity_data executed successfully
2025-12-07 10:03:29 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:03:29 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:03:29 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:03:29 +0000 INFO:firstload executed successfully
2025-12-07 10:03:29 +0000 INFO:Data first load completed successfully.
2025-12-07 10:03:29 +0000 INFO:initialise_data executed successfully
2025-12-07 10:03:29 +0000 INFO:Running Menu setup...
2025-12-07 10:03:29 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:29 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:29 +0000 INFO:App Version: v50.228
2025-12-07 10:03:29 +0000 INFO:Switched to page: Introduction
2025-12-07 10:03:29 +0000 INFO:pagesetup executed successfully
2025-12-07 10:03:29 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:03:29 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:03:33 +0000 INFO:Streamlit App Starting...
2025-12-07 10:03:33 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:03:33 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:03:33 +0000 INFO:Running App setup...
2025-12-07 10:03:33 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 INFO:Setting up the package
2025-12-07 10:03:33 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:03:33 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:33 +0000 INFO:Version: v50.190
2025-12-07 10:03:33 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:03:33 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:security already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:directories already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:03:33 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:03:33 +0000 INFO:Session_state variables initialized
2025-12-07 10:03:33 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:03:33 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:03:33 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:03:33 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:03:33 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:03:33 +0000 DEBUG:load_raw_data_last_modified: 1765101804.1850684
2025-12-07 10:03:33 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:03:33 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:03:33 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:03:33 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:03:33 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:03:33 +0000 DEBUG:utils_dir: utils
2025-12-07 10:03:33 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:03:33 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:03:33 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:03:33 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:03:33 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:03:33 +0000 DEBUG:data_dir: data
2025-12-07 10:03:33 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:03:33 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:03:33 +0000 DEBUG:output_dir: output
2025-12-07 10:03:33 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:03:33 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:03:33 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:03:33 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:03:33 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:03:33 +0000 DEBUG:load_donorlist_data_last_modified: 1765101809.1224897
2025-12-07 10:03:33 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:03:33 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000025779E977F0>}
2025-12-07 10:03:33 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:03:33 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:03:33 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:03:33 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:03:33 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:03:33 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:03:33 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:03:33 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:03:33 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:03:33 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:03:33 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:03:33 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:03:33 +0000 DEBUG:logs_dir: logs
2025-12-07 10:03:33 +0000 DEBUG:components_dir: components
2025-12-07 10:03:33 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:03:33 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:03:33 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:03:33 +0000 INFO:Session state Setup complete
2025-12-07 10:03:33 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:03:33 +0000 INFO:Package setup complete
2025-12-07 10:03:33 +0000 INFO:setup_package executed successfully
2025-12-07 10:03:33 +0000 INFO:Setup completed successfully.
2025-12-07 10:03:33 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 INFO:Running first load function.
2025-12-07 10:03:33 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:03:33 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:03:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:03:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:03:33 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:03:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:03:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:03:33 +0000 INFO:firstload executed successfully
2025-12-07 10:03:33 +0000 INFO:Data first load completed successfully.
2025-12-07 10:03:33 +0000 INFO:initialise_data executed successfully
2025-12-07 10:03:33 +0000 INFO:Running Menu setup...
2025-12-07 10:03:33 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 INFO:get_git_version executed successfully
2025-12-07 10:03:33 +0000 INFO:App Version: v50.228
2025-12-07 10:03:33 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 10:03:33 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:03:33 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:03:33 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:03:34 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0                                63   6023.742231
1                              7931  74374.940899
2   Conservative And Unionist Party  20131.118739
3                      Labour Party  20650.882442
4                      Large Entity  29763.708881
5                  Liberal Democrat   8504.706244
6                     Medium Entity  15666.034757
7               Medium Large Entity  31569.580016
8            Single Donation Entity  12207.983689
9                      Small Entity  16114.092989
10              Small Medium Entity  21512.571099
11     Uk Independence Party (Ukip)   9919.127250
12                Very Small Entity  24966.683550
2025-12-07 10:03:34 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
1                              7931  74374.940899
7               Medium Large Entity  31569.580016
4                      Large Entity  29763.708881
12                Very Small Entity  24966.683550
10              Small Medium Entity  21512.571099
3                      Labour Party  20650.882442
2   Conservative And Unionist Party  20131.118739
9                      Small Entity  16114.092989
6                     Medium Entity  15666.034757
8            Single Donation Entity  12207.983689
11     Uk Independence Party (Ukip)   9919.127250
5                  Liberal Democrat   8504.706244
0                                63   6023.742231
2025-12-07 10:03:34 +0000 DEBUG:Unique XValues: [7931 'Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 63]
2025-12-07 10:03:34 +0000 DEBUG:Final color_discrete_map: {'7931': '#636efa', 'Medium Large Entity': '#636efa', 'Large Entity': '#9467bd', 'Very Small Entity': '#bcbd22', 'Small Medium Entity': '#17becf', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#e377c2', 'Medium Entity': '#8c564b', 'Single Donation Entity': '#7f7f7f', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', '63': '#636efa'}
2025-12-07 10:03:34 +0000 ERROR:Error in hlf_body: 0
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\headlinefigures.py", line 303, in hlf_body
    plot_bar_chart.plot_custom_bar_chart(
  File "H:\GitHub\dashboard_demo\Visualisations\plot_bar_chart.py", line 102, in plot_custom_bar_chart
    fig = px.bar(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\plotly\express\_chart_types.py", line 381, in bar
    return make_figure(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\plotly\express\_core.py", line 2528, in make_figure
    m.val_map[val] = m.sequence[len(m.val_map) % len(m.sequence)]
KeyError: 0
2025-12-07 10:03:34 +0000 CRITICAL:Menu setup crashed: 0
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 50, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\headlinefigures.py", line 303, in hlf_body
    plot_bar_chart.plot_custom_bar_chart(
  File "H:\GitHub\dashboard_demo\Visualisations\plot_bar_chart.py", line 102, in plot_custom_bar_chart
    fig = px.bar(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\plotly\express\_chart_types.py", line 381, in bar
    return make_figure(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\plotly\express\_core.py", line 2528, in make_figure
    m.val_map[val] = m.sequence[len(m.val_map) % len(m.sequence)]
KeyError: 0
2025-12-07 10:19:15 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 10:19:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:16 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:17 +0000 INFO:Streamlit App Starting...
2025-12-07 10:19:17 +0000 INFO:Streamlit App Starting...
2025-12-07 10:19:17 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:19:17 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:19:17 +0000 INFO:Running App setup...
2025-12-07 10:19:17 +0000 INFO:Running App setup...
2025-12-07 10:19:17 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 INFO:Setting up the package
2025-12-07 10:19:17 +0000 INFO:Setting up the package
2025-12-07 10:19:17 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:17 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:17 +0000 INFO:Version: v50.190
2025-12-07 10:19:17 +0000 INFO:Version: v50.190
2025-12-07 10:19:17 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:19:17 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:19:17 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:19:17 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:19:17 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:19:17 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:19:17 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:19:17 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:19:17 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:19:17 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:19:17 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:19:17 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:19:17 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:19:17 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:19:17 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:19:17 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:19:17 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:19:17 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:19:17 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:19:17 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:19:17 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:19:17 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:19:17 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:19:17 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:19:17 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:19:17 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:19:17 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:19:17 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:19:17 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:19:17 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:19:17 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:19:17 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:19:17 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:19:17 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:19:17 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:19:17 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:19:17 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:19:17 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:19:17 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:19:17 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:19:17 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:19:17 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:19:17 +0000 INFO:Session_state variables initialized
2025-12-07 10:19:17 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:19:17 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:19:17 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:19:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:19:17 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:19:17 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:19:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:19:17 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:19:17 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:19:17 +0000 DEBUG:data_dir: data
2025-12-07 10:19:17 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:19:17 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:19:17 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:19:17 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:19:17 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:19:17 +0000 DEBUG:logs_dir: logs
2025-12-07 10:19:17 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:19:17 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:19:17 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:19:17 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:19:17 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:19:17 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:19:17 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:19:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:19:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:19:17 +0000 DEBUG:components_dir: components
2025-12-07 10:19:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:19:17 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:19:17 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:19:17 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:19:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:19:17 +0000 DEBUG:output_dir: output
2025-12-07 10:19:17 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:19:17 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:19:17 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:19:17 +0000 DEBUG:utils_dir: utils
2025-12-07 10:19:17 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:19:17 +0000 INFO:Session state Setup complete
2025-12-07 10:19:17 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:19:17 +0000 INFO:Package setup complete
2025-12-07 10:19:17 +0000 INFO:setup_package executed successfully
2025-12-07 10:19:17 +0000 INFO:Setup completed successfully.
2025-12-07 10:19:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:17 +0000 INFO:Running first load function.
2025-12-07 10:19:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 10:19:17 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 10:19:17 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:19:17 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 10:19:17 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 10:19:17 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:19:17 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 10:19:17 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:19:17 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 10:19:17 +0000 INFO:Last modification time: 1765101804.1850684
2025-12-07 10:19:17 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:19:17 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765101804.1850684 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 10:19:17 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 10:19:18 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:19:18 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 10:19:18 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 10:19:18 +0000 INFO:Cleaning up raw data
2025-12-07 10:19:18 +0000 ERROR:Session state variables not initialized!
2025-12-07 10:19:18 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:18 +0000 INFO:Original file path: None
2025-12-07 10:19:18 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 10:19:18 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 10:19:18 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:19:18 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 10:19:19 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:19:19 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:19:20 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:19:20 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:19:20 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 10:19:20 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:19:20 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:19:20 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 10:19:20 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 10:19:20 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 10:19:20 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 10:19:20 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:19:20 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:19:20 +0000 INFO:Data shape: (91651, 37)
2025-12-07 10:19:22 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 10:19:22 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 10:19:22 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 10:19:22 +0000 INFO:load_raw_data executed successfully
2025-12-07 10:19:22 +0000 INFO:get_raw_data executed successfully
2025-12-07 10:19:22 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:19:22 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:22 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:22 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 10:19:22 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:22 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 10:19:22 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 10:19:22 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:19:22 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 10:19:22 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:19:22 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 10:19:22 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:19:22 +0000 INFO:Current modification time: 1765102762.0046408
2025-12-07 10:19:22 +0000 INFO:Last modification time: 1765101804.1850684
2025-12-07 10:19:22 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:19:22 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:19:22 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 10:19:22 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 10:19:22 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 10:19:22 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 10:19:24 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:19:24 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 10:19:24 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:19:24 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 10:19:24 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:19:24 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 10:19:24 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:19:24 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 10:19:24 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:19:24 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 10:19:24 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 10:19:24 +0000 INFO:Loading election dates from pdpy.
2025-12-07 10:19:24 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 10:19:24 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 10:19:24 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 10:19:24 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:19:24 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:19:24 +0000 INFO:load_election_dates executed successfully
2025-12-07 10:19:24 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 10:19:24 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 10:19:26 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 10:19:26 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 10:19:26 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 10:19:26 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:19:26 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:26 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:26 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:26 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:19:26 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 10:19:26 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:19:26 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:19:26 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:19:26 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:19:26 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:19:26 +0000 INFO:Current modification time: 1765102766.8495173
2025-12-07 10:19:26 +0000 INFO:Last modification time: 1765101809.1224897
2025-12-07 10:19:26 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:19:26 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:19:27 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 10:19:27 +0000 INFO:Donor Data summary completed
2025-12-07 10:19:27 +0000 INFO:Data shape: (31905, 5)
2025-12-07 10:19:27 +0000 INFO:load_donorList_data executed successfully
2025-12-07 10:19:27 +0000 INFO:get_donor_data executed successfully
2025-12-07 10:19:27 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:19:27 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:19:27 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:19:27 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 10:19:27 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:19:27 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:19:27 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:19:27 +0000 INFO:Current modification time: 1765102766.8495173
2025-12-07 10:19:27 +0000 INFO:Last modification time: 1765102766.8495173
2025-12-07 10:19:27 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:19:27 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765102766.8495173 instead of output\cleaned_data.csv
2025-12-07 10:19:27 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 10:19:27 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 10:19:27 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:19:27 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 10:19:27 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:19:27 +0000 INFO:Data shape: (1719, 6)
2025-12-07 10:19:27 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 10:19:27 +0000 INFO:get_regentity_data executed successfully
2025-12-07 10:19:27 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:19:27 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:19:27 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:19:27 +0000 INFO:firstload executed successfully
2025-12-07 10:19:27 +0000 INFO:Data first load completed successfully.
2025-12-07 10:19:27 +0000 INFO:initialise_data executed successfully
2025-12-07 10:19:27 +0000 INFO:Running Menu setup...
2025-12-07 10:19:27 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:27 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:27 +0000 INFO:App Version: v50.228
2025-12-07 10:19:27 +0000 INFO:Switched to page: Introduction
2025-12-07 10:19:27 +0000 INFO:pagesetup executed successfully
2025-12-07 10:19:27 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:19:27 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:19:30 +0000 INFO:Streamlit App Starting...
2025-12-07 10:19:30 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:19:30 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:19:30 +0000 INFO:Running App setup...
2025-12-07 10:19:30 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:19:30 +0000 INFO:Setting up the package
2025-12-07 10:19:30 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:19:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:30 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:30 +0000 INFO:Version: v50.190
2025-12-07 10:19:30 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:19:30 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:19:30 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:security already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:directories already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:19:30 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:19:30 +0000 INFO:Session_state variables initialized
2025-12-07 10:19:30 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:19:30 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:19:30 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:19:30 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:19:30 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:19:30 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:19:30 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:19:30 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:19:30 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:19:30 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:19:30 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:19:30 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:19:30 +0000 DEBUG:data_dir: data
2025-12-07 10:19:30 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:19:30 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:19:30 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:19:30 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000022E0FCFF400>}
2025-12-07 10:19:30 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:19:30 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:19:30 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:19:30 +0000 DEBUG:logs_dir: logs
2025-12-07 10:19:30 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:19:30 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:19:30 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:19:30 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:19:30 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:19:30 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:19:30 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:19:30 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:19:30 +0000 DEBUG:load_donorlist_data_last_modified: 1765102766.8495173
2025-12-07 10:19:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:19:30 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:19:30 +0000 DEBUG:components_dir: components
2025-12-07 10:19:30 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:19:30 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:19:30 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:19:30 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:19:30 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:19:30 +0000 DEBUG:output_dir: output
2025-12-07 10:19:30 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:19:30 +0000 DEBUG:load_raw_data_last_modified: 1765102762.0046408
2025-12-07 10:19:30 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:19:30 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:19:30 +0000 DEBUG:utils_dir: utils
2025-12-07 10:19:30 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:19:30 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:19:30 +0000 INFO:Session state Setup complete
2025-12-07 10:19:30 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:19:30 +0000 INFO:Package setup complete
2025-12-07 10:19:30 +0000 INFO:setup_package executed successfully
2025-12-07 10:19:30 +0000 INFO:Setup completed successfully.
2025-12-07 10:19:30 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:30 +0000 INFO:Running first load function.
2025-12-07 10:19:30 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:19:30 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:19:30 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:19:30 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:19:30 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:19:30 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:19:30 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:19:30 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:19:30 +0000 INFO:firstload executed successfully
2025-12-07 10:19:30 +0000 INFO:Data first load completed successfully.
2025-12-07 10:19:30 +0000 INFO:initialise_data executed successfully
2025-12-07 10:19:30 +0000 INFO:Running Menu setup...
2025-12-07 10:19:30 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:19:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:19:30 +0000 INFO:get_git_version executed successfully
2025-12-07 10:19:30 +0000 INFO:App Version: v50.228
2025-12-07 10:19:30 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 10:19:30 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 10:19:30 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:19:31 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:19:31 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:19:31 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:19:32 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20131.118739
1                       Green Party   6023.742231
2                      Labour Party  20650.882442
3                      Large Entity  29763.708881
4                  Liberal Democrat   8504.706244
5                     Medium Entity  15666.034757
6               Medium Large Entity  31569.580016
7                         Reform UK  74374.940899
8            Single Donation Entity  12207.983689
9                      Small Entity  16114.092989
10              Small Medium Entity  21512.571099
11     Uk Independence Party (Ukip)   9919.127250
12                Very Small Entity  24966.683550
2025-12-07 10:19:32 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
7                         Reform UK  74374.940899
6               Medium Large Entity  31569.580016
3                      Large Entity  29763.708881
12                Very Small Entity  24966.683550
10              Small Medium Entity  21512.571099
2                      Labour Party  20650.882442
0   Conservative And Unionist Party  20131.118739
9                      Small Entity  16114.092989
5                     Medium Entity  15666.034757
8            Single Donation Entity  12207.983689
11     Uk Independence Party (Ukip)   9919.127250
4                  Liberal Democrat   8504.706244
1                       Green Party   6023.742231
2025-12-07 10:19:32 +0000 DEBUG:Unique XValues: ['Reform UK' 'Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 'Green Party']
2025-12-07 10:19:32 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Medium Large Entity': '#636efa', 'Large Entity': '#9467bd', 'Very Small Entity': '#bcbd22', 'Small Medium Entity': '#17becf', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#e377c2', 'Medium Entity': '#8c564b', 'Single Donation Entity': '#7f7f7f', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', 'Green Party': '#78B943'}
2025-12-07 10:19:32 +0000 DEBUG:Missing color mappings for: ['Medium Large Entity']
2025-12-07 10:19:32 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'H03sDW8o8kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Large Entity',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Medium Large Entity',
              'offsetgroup': 'Medium Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '6Xn6HmXU3kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#9467bd', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9nxPXu0Q3UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Very Small Entity',
              'marker': {'color': '#bcbd22', 'pattern': {'shape': ''}},
              'name': 'Very Small Entity',
              'offsetgroup': 'Very Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Very Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'typIv6th2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Medium Entity',
              'marker': {'color': '#17becf', 'pattern': {'shape': ''}},
              'name': 'Small Medium Entity',
              'offsetgroup': 'Small Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9ofjjCQC1UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AHzuebgq1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '1f1qmceo00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#e377c2', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LAkU5wt5z0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#8c564b', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'zM7ocgSZzkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#7f7f7f', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nHuE6f3Xx0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'QIC7SZBfw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Democrat',
              'marker': {'color': '#FDBB30', 'pattern': {'shape': ''}},
              'name': 'Liberal Democrat',
              'offsetgroup': 'Liberal Democrat',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Democrat'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AMMxZlqcwEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7u/VAr6Ht0A=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Medium Large Entity, Large
                                           Entity, Very Small Entity, Small Medium
                                           Entity, Labour Party, Conservative And
                                           Unionist Party, Small Entity, Medium
                                           Entity, Single Donation Entity, Uk
                                           Independence Party (Ukip), Liberal
                                           Democrat, Green Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2025-12-07 10:19:32 +0000 INFO:Bar chart displayed successfully.
2025-12-07 10:19:32 +0000 INFO:hlf_body executed successfully
2025-12-07 10:19:32 +0000 INFO:pagesetup executed successfully
2025-12-07 10:19:32 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:19:32 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:25:29 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 10:25:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:30 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:31 +0000 INFO:Streamlit App Starting...
2025-12-07 10:25:31 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:25:31 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:25:31 +0000 INFO:Running App setup...
2025-12-07 10:25:31 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 INFO:Setting up the package
2025-12-07 10:25:31 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:25:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:31 +0000 INFO:Version: v50.190
2025-12-07 10:25:31 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:25:31 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:25:31 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:25:31 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:25:31 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:25:31 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:25:31 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:25:31 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:25:31 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:25:31 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:25:31 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:25:31 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:25:31 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:25:31 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:25:31 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:25:31 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:25:31 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:25:31 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:25:31 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:25:31 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:25:31 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:25:31 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:25:31 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:25:31 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:25:31 +0000 INFO:Session_state variables initialized
2025-12-07 10:25:31 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:25:31 +0000 DEBUG:output_dir: output
2025-12-07 10:25:31 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:25:31 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:25:31 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:25:31 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:25:31 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:25:31 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:25:31 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:25:31 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:25:31 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:25:31 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:25:31 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:25:31 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:25:31 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:25:31 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:25:31 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:25:31 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:25:31 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:25:31 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:25:31 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:25:31 +0000 DEBUG:components_dir: components
2025-12-07 10:25:31 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:25:31 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:25:31 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:25:31 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:25:31 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:25:31 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:25:31 +0000 DEBUG:data_dir: data
2025-12-07 10:25:31 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:25:31 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:25:31 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:25:31 +0000 DEBUG:utils_dir: utils
2025-12-07 10:25:31 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:25:31 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:25:31 +0000 DEBUG:logs_dir: logs
2025-12-07 10:25:31 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:25:31 +0000 INFO:Session state Setup complete
2025-12-07 10:25:31 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:25:31 +0000 INFO:Package setup complete
2025-12-07 10:25:31 +0000 INFO:setup_package executed successfully
2025-12-07 10:25:31 +0000 INFO:Setup completed successfully.
2025-12-07 10:25:31 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:31 +0000 INFO:Running first load function.
2025-12-07 10:25:31 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 10:25:31 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 10:25:31 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:25:31 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 10:25:31 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 10:25:31 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:25:31 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 10:25:31 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:25:31 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 10:25:31 +0000 INFO:Last modification time: 1765102762.0046408
2025-12-07 10:25:31 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:25:31 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765102762.0046408 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 10:25:31 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 10:25:32 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:25:32 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 10:25:32 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 10:25:32 +0000 INFO:Cleaning up raw data
2025-12-07 10:25:32 +0000 ERROR:Session state variables not initialized!
2025-12-07 10:25:32 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:32 +0000 INFO:Original file path: None
2025-12-07 10:25:32 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 10:25:32 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 10:25:32 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:25:32 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 10:25:34 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:25:34 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:25:34 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:25:34 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:25:34 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 10:25:34 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:25:34 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:25:34 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 10:25:35 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 10:25:35 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 10:25:35 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 10:25:35 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:25:35 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:25:35 +0000 INFO:Data shape: (91651, 37)
2025-12-07 10:25:36 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 10:25:36 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 10:25:36 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 10:25:36 +0000 INFO:load_raw_data executed successfully
2025-12-07 10:25:37 +0000 INFO:get_raw_data executed successfully
2025-12-07 10:25:37 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:25:37 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:37 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:37 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 10:25:37 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:37 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 10:25:37 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 10:25:37 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:25:37 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 10:25:37 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:25:37 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 10:25:37 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:25:37 +0000 INFO:Current modification time: 1765103136.9675498
2025-12-07 10:25:37 +0000 INFO:Last modification time: 1765102762.0046408
2025-12-07 10:25:37 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:25:37 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:25:37 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 10:25:37 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 10:25:37 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 10:25:37 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 10:25:39 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:25:39 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 10:25:39 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:25:39 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 10:25:39 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:25:39 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 10:25:39 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:25:39 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 10:25:39 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:25:39 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 10:25:40 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 10:25:40 +0000 INFO:Loading election dates from pdpy.
2025-12-07 10:25:40 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 10:25:40 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 10:25:40 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 10:25:40 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:25:40 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:25:40 +0000 INFO:load_election_dates executed successfully
2025-12-07 10:25:40 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 10:25:40 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 10:25:42 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 10:25:42 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 10:25:42 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 10:25:42 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:25:42 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:25:42 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 10:25:42 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:25:42 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:25:42 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:25:42 +0000 INFO:Current modification time: 1765103142.1942189
2025-12-07 10:25:42 +0000 INFO:Last modification time: 1765102766.8495173
2025-12-07 10:25:42 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:25:42 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:25:42 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 10:25:42 +0000 INFO:Donor Data summary completed
2025-12-07 10:25:42 +0000 INFO:Data shape: (31905, 5)
2025-12-07 10:25:42 +0000 INFO:load_donorList_data executed successfully
2025-12-07 10:25:42 +0000 INFO:get_donor_data executed successfully
2025-12-07 10:25:42 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:25:42 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:25:42 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:25:42 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 10:25:42 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:25:42 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:25:42 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:25:42 +0000 INFO:Current modification time: 1765103142.1942189
2025-12-07 10:25:42 +0000 INFO:Last modification time: 1765103142.1942189
2025-12-07 10:25:42 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:25:42 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765103142.1942189 instead of output\cleaned_data.csv
2025-12-07 10:25:42 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 10:25:42 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 10:25:42 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:25:42 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 10:25:42 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:25:42 +0000 INFO:Data shape: (1719, 6)
2025-12-07 10:25:42 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 10:25:42 +0000 INFO:get_regentity_data executed successfully
2025-12-07 10:25:42 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:25:42 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:25:42 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:25:42 +0000 INFO:firstload executed successfully
2025-12-07 10:25:42 +0000 INFO:Data first load completed successfully.
2025-12-07 10:25:42 +0000 INFO:initialise_data executed successfully
2025-12-07 10:25:42 +0000 INFO:Running Menu setup...
2025-12-07 10:25:42 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:42 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:42 +0000 INFO:App Version: v50.228
2025-12-07 10:25:42 +0000 INFO:Switched to page: Introduction
2025-12-07 10:25:42 +0000 INFO:pagesetup executed successfully
2025-12-07 10:25:42 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:25:42 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:25:49 +0000 INFO:Streamlit App Starting...
2025-12-07 10:25:49 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:25:49 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:25:49 +0000 INFO:Running App setup...
2025-12-07 10:25:49 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:25:49 +0000 INFO:Setting up the package
2025-12-07 10:25:49 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:25:49 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:49 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:49 +0000 INFO:Version: v50.190
2025-12-07 10:25:49 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:25:49 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:25:49 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:security already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:directories already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:25:49 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:25:49 +0000 INFO:Session_state variables initialized
2025-12-07 10:25:49 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:25:49 +0000 DEBUG:output_dir: output
2025-12-07 10:25:49 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:25:49 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:25:49 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:25:49 +0000 DEBUG:menu_selection: {'title': 'Login', 'function': <function loginpage at 0x0000027B6D9C8670>}
2025-12-07 10:25:49 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:25:49 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:25:49 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:25:49 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:25:49 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:25:49 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:25:49 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:25:49 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:25:49 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:25:49 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:25:49 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:25:49 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:25:49 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:25:49 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:25:49 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:25:49 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:25:49 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:25:49 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:25:49 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:25:49 +0000 DEBUG:components_dir: components
2025-12-07 10:25:49 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:25:49 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:25:49 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:25:49 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:25:49 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:25:49 +0000 DEBUG:load_donorlist_data_last_modified: 1765103142.1942189
2025-12-07 10:25:49 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:25:49 +0000 DEBUG:load_raw_data_last_modified: 1765103136.9675498
2025-12-07 10:25:49 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:25:49 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:25:49 +0000 DEBUG:data_dir: data
2025-12-07 10:25:49 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:25:49 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:25:49 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:25:49 +0000 DEBUG:utils_dir: utils
2025-12-07 10:25:49 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:25:49 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:25:49 +0000 DEBUG:logs_dir: logs
2025-12-07 10:25:49 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:25:49 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:25:49 +0000 INFO:Session state Setup complete
2025-12-07 10:25:49 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:25:49 +0000 INFO:Package setup complete
2025-12-07 10:25:49 +0000 INFO:setup_package executed successfully
2025-12-07 10:25:49 +0000 INFO:Setup completed successfully.
2025-12-07 10:25:49 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:49 +0000 INFO:Running first load function.
2025-12-07 10:25:49 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:25:49 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:25:49 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:25:49 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:25:49 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:25:49 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:25:49 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:25:49 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:25:49 +0000 INFO:firstload executed successfully
2025-12-07 10:25:49 +0000 INFO:Data first load completed successfully.
2025-12-07 10:25:49 +0000 INFO:initialise_data executed successfully
2025-12-07 10:25:49 +0000 INFO:Running Menu setup...
2025-12-07 10:25:49 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:25:49 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:49 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:49 +0000 INFO:App Version: v50.228
2025-12-07 10:25:49 +0000 INFO:Switched to page: Login
2025-12-07 10:25:49 +0000 DEBUG:Calling loginpage with args={args}, kwargs={kwargs}
2025-12-07 10:25:49 +0000 INFO:loginpage executed successfully
2025-12-07 10:25:49 +0000 INFO:pagesetup executed successfully
2025-12-07 10:25:49 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:25:49 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:25:52 +0000 INFO:Streamlit App Starting...
2025-12-07 10:25:52 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:25:52 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:25:52 +0000 INFO:Running App setup...
2025-12-07 10:25:52 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:25:52 +0000 INFO:Setting up the package
2025-12-07 10:25:52 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:25:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:52 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:52 +0000 INFO:Version: v50.190
2025-12-07 10:25:52 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:25:52 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:25:52 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:security already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:directories already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:25:52 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:25:52 +0000 INFO:Session_state variables initialized
2025-12-07 10:25:52 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:25:52 +0000 DEBUG:output_dir: output
2025-12-07 10:25:52 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:25:52 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:25:52 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:25:52 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000027B6D6677F0>}
2025-12-07 10:25:52 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:25:52 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:25:52 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:25:52 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:25:52 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:25:52 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:25:52 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:25:52 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:25:52 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:25:52 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:25:52 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:25:52 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:25:52 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:25:52 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:25:52 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:25:52 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:25:52 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:25:52 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:25:52 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:25:52 +0000 DEBUG:components_dir: components
2025-12-07 10:25:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:25:52 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:25:52 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:25:52 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:25:52 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:25:52 +0000 DEBUG:load_donorlist_data_last_modified: 1765103142.1942189
2025-12-07 10:25:52 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:25:52 +0000 DEBUG:load_raw_data_last_modified: 1765103136.9675498
2025-12-07 10:25:53 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:25:53 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:25:53 +0000 DEBUG:data_dir: data
2025-12-07 10:25:53 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:25:53 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:25:53 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:25:53 +0000 DEBUG:utils_dir: utils
2025-12-07 10:25:53 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:25:53 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:25:53 +0000 DEBUG:logs_dir: logs
2025-12-07 10:25:53 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:25:53 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:25:53 +0000 INFO:Session state Setup complete
2025-12-07 10:25:53 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:25:53 +0000 INFO:Package setup complete
2025-12-07 10:25:53 +0000 INFO:setup_package executed successfully
2025-12-07 10:25:53 +0000 INFO:Setup completed successfully.
2025-12-07 10:25:53 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:53 +0000 INFO:Running first load function.
2025-12-07 10:25:53 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:25:53 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:25:53 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:25:53 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:25:53 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:25:53 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:25:53 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:25:53 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:25:53 +0000 INFO:firstload executed successfully
2025-12-07 10:25:53 +0000 INFO:Data first load completed successfully.
2025-12-07 10:25:53 +0000 INFO:initialise_data executed successfully
2025-12-07 10:25:53 +0000 INFO:Running Menu setup...
2025-12-07 10:25:53 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:25:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:25:53 +0000 INFO:get_git_version executed successfully
2025-12-07 10:25:53 +0000 INFO:App Version: v50.228
2025-12-07 10:25:53 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 10:25:53 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 10:25:53 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:25:53 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:25:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:25:53 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:25:54 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20131.118739
1                       Green Party   6023.742231
2                      Labour Party  20650.882442
3                      Large Entity  29763.708881
4                  Liberal Democrat   8504.706244
5                     Medium Entity  15666.034757
6               Medium Large Entity  31569.580016
7                         Reform UK  74374.940899
8            Single Donation Entity  12207.983689
9                      Small Entity  16114.092989
10              Small Medium Entity  21512.571099
11     Uk Independence Party (Ukip)   9919.127250
12                Very Small Entity  24966.683550
2025-12-07 10:25:54 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
7                         Reform UK  74374.940899
6               Medium Large Entity  31569.580016
3                      Large Entity  29763.708881
12                Very Small Entity  24966.683550
10              Small Medium Entity  21512.571099
2                      Labour Party  20650.882442
0   Conservative And Unionist Party  20131.118739
9                      Small Entity  16114.092989
5                     Medium Entity  15666.034757
8            Single Donation Entity  12207.983689
11     Uk Independence Party (Ukip)   9919.127250
4                  Liberal Democrat   8504.706244
1                       Green Party   6023.742231
2025-12-07 10:25:54 +0000 DEBUG:Unique XValues: ['Reform UK' 'Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 'Green Party']
2025-12-07 10:25:54 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Medium Large Entity': '#636efa', 'Large Entity': '#333333', 'Very Small Entity': '#bbbbbb', 'Small Medium Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#888888', 'Medium Entity': '#555555', 'Single Donation Entity': '#dddddd', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', 'Green Party': '#78B943'}
2025-12-07 10:25:54 +0000 DEBUG:Missing color mappings for: ['Medium Large Entity']
2025-12-07 10:25:54 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'H03sDW8o8kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Large Entity',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Medium Large Entity',
              'offsetgroup': 'Medium Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '6Xn6HmXU3kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#333333', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9nxPXu0Q3UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Very Small Entity',
              'marker': {'color': '#bbbbbb', 'pattern': {'shape': ''}},
              'name': 'Very Small Entity',
              'offsetgroup': 'Very Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Very Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'typIv6th2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Medium Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Medium Entity',
              'offsetgroup': 'Small Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9ofjjCQC1UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AHzuebgq1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '1f1qmceo00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#888888', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LAkU5wt5z0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#555555', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'zM7ocgSZzkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#dddddd', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nHuE6f3Xx0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'QIC7SZBfw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Democrat',
              'marker': {'color': '#FDBB30', 'pattern': {'shape': ''}},
              'name': 'Liberal Democrat',
              'offsetgroup': 'Liberal Democrat',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Democrat'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AMMxZlqcwEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7u/VAr6Ht0A=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Medium Large Entity, Large
                                           Entity, Very Small Entity, Small Medium
                                           Entity, Labour Party, Conservative And
                                           Unionist Party, Small Entity, Medium
                                           Entity, Single Donation Entity, Uk
                                           Independence Party (Ukip), Liberal
                                           Democrat, Green Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2025-12-07 10:25:54 +0000 INFO:Bar chart displayed successfully.
2025-12-07 10:25:54 +0000 INFO:hlf_body executed successfully
2025-12-07 10:25:54 +0000 INFO:pagesetup executed successfully
2025-12-07 10:25:54 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:25:54 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:26:55 +0000 INFO:Streamlit App Starting...
2025-12-07 10:26:55 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:26:55 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:26:55 +0000 INFO:Running App setup...
2025-12-07 10:26:55 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 INFO:Setting up the package
2025-12-07 10:26:55 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:26:55 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 INFO:get_git_version executed successfully
2025-12-07 10:26:55 +0000 INFO:Version: v50.190
2025-12-07 10:26:55 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:26:55 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:security already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:directories already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:26:55 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:26:55 +0000 INFO:Session_state variables initialized
2025-12-07 10:26:55 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:26:55 +0000 DEBUG:output_dir: output
2025-12-07 10:26:55 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:26:55 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:26:55 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:26:55 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x0000027B6D9C8430>}
2025-12-07 10:26:55 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:26:55 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:26:55 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:26:55 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:26:55 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:26:55 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:26:55 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:26:55 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:26:55 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:26:55 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:26:55 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:26:55 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:26:55 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:26:55 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:26:55 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:26:55 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:26:55 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:26:55 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:26:55 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:26:55 +0000 DEBUG:components_dir: components
2025-12-07 10:26:55 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:26:55 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:26:55 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:26:55 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:26:55 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:26:55 +0000 DEBUG:load_donorlist_data_last_modified: 1765103142.1942189
2025-12-07 10:26:55 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:26:55 +0000 DEBUG:load_raw_data_last_modified: 1765103136.9675498
2025-12-07 10:26:55 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:26:55 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:26:55 +0000 DEBUG:data_dir: data
2025-12-07 10:26:55 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:26:55 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:26:55 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:26:55 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:26:55 +0000 DEBUG:utils_dir: utils
2025-12-07 10:26:55 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:26:55 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:26:55 +0000 DEBUG:logs_dir: logs
2025-12-07 10:26:55 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:26:55 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:26:55 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:26:55 +0000 INFO:Session state Setup complete
2025-12-07 10:26:55 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:26:55 +0000 INFO:Package setup complete
2025-12-07 10:26:55 +0000 INFO:setup_package executed successfully
2025-12-07 10:26:55 +0000 INFO:Setup completed successfully.
2025-12-07 10:26:55 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 INFO:Running first load function.
2025-12-07 10:26:55 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:26:55 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:26:55 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:26:55 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:26:55 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:26:55 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:26:55 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:26:55 +0000 INFO:firstload executed successfully
2025-12-07 10:26:55 +0000 INFO:Data first load completed successfully.
2025-12-07 10:26:55 +0000 INFO:initialise_data executed successfully
2025-12-07 10:26:55 +0000 INFO:Running Menu setup...
2025-12-07 10:26:55 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 INFO:get_git_version executed successfully
2025-12-07 10:26:55 +0000 INFO:App Version: v50.228
2025-12-07 10:26:55 +0000 INFO:Switched to page: Cash Donations
2025-12-07 10:26:55 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:26:55 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:26:55 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:26:56 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:26:56 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:26:56 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:26:56 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:26:56 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2025-12-07 10:26:56 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2025-12-07 10:26:56 +0000 DEBUG:Not logged in as admin.
2025-12-07 10:26:56 +0000 INFO:manage_text_elements executed successfully
2025-12-07 10:26:56 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:26:56 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:26:56 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:26:56 +0000 INFO:display_data_page executed successfully
2025-12-07 10:26:56 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:26:56 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:26:56 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:26:56 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:26:57 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:26:57 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:26:57 +0000 DEBUG:Page texts: {}
2025-12-07 10:26:57 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:26:57 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:26:57 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:26:57 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:26:57 +0000 INFO:pagesetup executed successfully
2025-12-07 10:26:57 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:26:57 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:27:21 +0000 INFO:Streamlit App Starting...
2025-12-07 10:27:21 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:27:21 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:27:21 +0000 INFO:Running App setup...
2025-12-07 10:27:21 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:Setting up the package
2025-12-07 10:27:21 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:27:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:get_git_version executed successfully
2025-12-07 10:27:21 +0000 INFO:Version: v50.190
2025-12-07 10:27:21 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:27:21 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:security already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:directories already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:27:21 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:27:21 +0000 INFO:Session_state variables initialized
2025-12-07 10:27:21 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:27:21 +0000 DEBUG:output_dir: output
2025-12-07 10:27:21 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:27:21 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:27:21 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:27:21 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x0000027B6D9C8430>}
2025-12-07 10:27:21 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:27:21 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:27:21 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:27:21 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:27:21 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:27:21 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:27:21 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:27:21 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:27:21 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:27:21 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:27:21 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:27:21 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:27:21 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:27:21 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:27:21 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:27:21 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:27:21 +0000 DEBUG:selected_group_entity: Donor Classification
2025-12-07 10:27:21 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:27:21 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:27:21 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:27:21 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:27:21 +0000 DEBUG:components_dir: components
2025-12-07 10:27:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:27:21 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:27:21 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:27:21 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:27:21 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:27:21 +0000 DEBUG:load_donorlist_data_last_modified: 1765103142.1942189
2025-12-07 10:27:21 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:27:21 +0000 DEBUG:load_raw_data_last_modified: 1765103136.9675498
2025-12-07 10:27:21 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:27:21 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:27:21 +0000 DEBUG:data_dir: data
2025-12-07 10:27:21 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:27:21 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:27:21 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:27:21 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:27:21 +0000 DEBUG:utils_dir: utils
2025-12-07 10:27:21 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:27:21 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:27:21 +0000 DEBUG:logs_dir: logs
2025-12-07 10:27:21 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:27:21 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:27:21 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:27:21 +0000 INFO:Session state Setup complete
2025-12-07 10:27:21 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:27:21 +0000 INFO:Package setup complete
2025-12-07 10:27:21 +0000 INFO:setup_package executed successfully
2025-12-07 10:27:21 +0000 INFO:Setup completed successfully.
2025-12-07 10:27:21 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:Running first load function.
2025-12-07 10:27:21 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:27:21 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:27:21 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:27:21 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:27:21 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:27:21 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:27:21 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:27:21 +0000 INFO:firstload executed successfully
2025-12-07 10:27:21 +0000 INFO:Data first load completed successfully.
2025-12-07 10:27:21 +0000 INFO:initialise_data executed successfully
2025-12-07 10:27:21 +0000 INFO:Running Menu setup...
2025-12-07 10:27:21 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:get_git_version executed successfully
2025-12-07 10:27:21 +0000 INFO:App Version: v50.228
2025-12-07 10:27:21 +0000 INFO:Switched to page: Cash Donations
2025-12-07 10:27:21 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:27:21 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:27:21 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:27:21 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2025-12-07 10:27:21 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 DEBUG:Not logged in as admin.
2025-12-07 10:27:21 +0000 INFO:manage_text_elements executed successfully
2025-12-07 10:27:21 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:27:21 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:27:21 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:27:21 +0000 INFO:display_data_page executed successfully
2025-12-07 10:27:21 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:27:22 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:27:22 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:27:22 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:27:22 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:27:22 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:27:22 +0000 DEBUG:Page texts: {}
2025-12-07 10:27:22 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:27:22 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:27:22 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:27:22 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:27:22 +0000 INFO:pagesetup executed successfully
2025-12-07 10:27:22 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:27:22 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:27:25 +0000 INFO:Streamlit App Starting...
2025-12-07 10:27:25 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:27:25 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:27:25 +0000 INFO:Running App setup...
2025-12-07 10:27:25 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:Setting up the package
2025-12-07 10:27:25 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:27:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:get_git_version executed successfully
2025-12-07 10:27:25 +0000 INFO:Version: v50.190
2025-12-07 10:27:25 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:27:25 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:security already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:directories already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:27:25 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:27:25 +0000 INFO:Session_state variables initialized
2025-12-07 10:27:25 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:27:25 +0000 DEBUG:output_dir: output
2025-12-07 10:27:25 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:27:25 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:27:25 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:27:25 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x0000027B6D9C8430>}
2025-12-07 10:27:25 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:27:25 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:27:25 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:27:25 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:27:25 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:27:25 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:27:25 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:27:25 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:27:25 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:27:25 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:27:25 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:27:25 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:27:25 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:27:25 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:27:25 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:27:25 +0000 DEBUG:selected_group_entity: Donor Classification
2025-12-07 10:27:25 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:27:25 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:27:25 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:27:25 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:27:25 +0000 DEBUG:components_dir: components
2025-12-07 10:27:25 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:27:25 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:27:25 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:27:25 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:27:25 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:27:25 +0000 DEBUG:load_donorlist_data_last_modified: 1765103142.1942189
2025-12-07 10:27:25 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:27:25 +0000 DEBUG:load_raw_data_last_modified: 1765103136.9675498
2025-12-07 10:27:25 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:27:25 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:27:25 +0000 DEBUG:data_dir: data
2025-12-07 10:27:25 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:27:25 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:27:25 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:27:25 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:27:25 +0000 DEBUG:utils_dir: utils
2025-12-07 10:27:25 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:27:25 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:27:25 +0000 DEBUG:logs_dir: logs
2025-12-07 10:27:25 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:27:25 +0000 DEBUG:selected_entity_name: Company
2025-12-07 10:27:25 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:27:25 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:27:25 +0000 INFO:Session state Setup complete
2025-12-07 10:27:25 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:27:25 +0000 INFO:Package setup complete
2025-12-07 10:27:25 +0000 INFO:setup_package executed successfully
2025-12-07 10:27:25 +0000 INFO:Setup completed successfully.
2025-12-07 10:27:25 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:Running first load function.
2025-12-07 10:27:25 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:27:25 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:27:25 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:27:25 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:27:25 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:27:25 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:27:25 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:27:25 +0000 INFO:firstload executed successfully
2025-12-07 10:27:25 +0000 INFO:Data first load completed successfully.
2025-12-07 10:27:25 +0000 INFO:initialise_data executed successfully
2025-12-07 10:27:25 +0000 INFO:Running Menu setup...
2025-12-07 10:27:25 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:get_git_version executed successfully
2025-12-07 10:27:25 +0000 INFO:App Version: v50.228
2025-12-07 10:27:25 +0000 INFO:Switched to page: Cash Donations
2025-12-07 10:27:25 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:27:25 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:27:25 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:27:25 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2025-12-07 10:27:25 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 DEBUG:Not logged in as admin.
2025-12-07 10:27:25 +0000 INFO:manage_text_elements executed successfully
2025-12-07 10:27:25 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:27:25 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:27:25 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:27:25 +0000 INFO:display_data_page executed successfully
2025-12-07 10:27:25 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:27:26 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:27:26 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:27:26 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:27:26 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:27:26 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:27:26 +0000 DEBUG:Page texts: {}
2025-12-07 10:27:26 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:27:26 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:27:26 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:27:26 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:27:26 +0000 INFO:pagesetup executed successfully
2025-12-07 10:27:26 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:27:26 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:27:41 +0000 INFO:Streamlit App Starting...
2025-12-07 10:27:41 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:27:41 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:27:41 +0000 INFO:Running App setup...
2025-12-07 10:27:41 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 INFO:Setting up the package
2025-12-07 10:27:41 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:27:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 INFO:get_git_version executed successfully
2025-12-07 10:27:41 +0000 INFO:Version: v50.190
2025-12-07 10:27:41 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:27:41 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:security already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:directories already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:27:41 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:27:41 +0000 INFO:Session_state variables initialized
2025-12-07 10:27:41 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:27:41 +0000 DEBUG:output_dir: output
2025-12-07 10:27:41 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:27:41 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:27:41 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:27:41 +0000 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations at 0x0000027B6D9C84C0>}
2025-12-07 10:27:41 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:27:41 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:27:41 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:27:41 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:27:41 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:27:41 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:27:41 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:27:41 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:27:41 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:27:41 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:27:41 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:27:41 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:27:41 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:27:41 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:27:41 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:27:41 +0000 DEBUG:selected_group_entity: Donor Classification
2025-12-07 10:27:41 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:27:41 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:27:41 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:27:41 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:27:41 +0000 DEBUG:components_dir: components
2025-12-07 10:27:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:27:41 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:27:41 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:27:41 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:27:41 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:27:41 +0000 DEBUG:load_donorlist_data_last_modified: 1765103142.1942189
2025-12-07 10:27:41 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:27:41 +0000 DEBUG:load_raw_data_last_modified: 1765103136.9675498
2025-12-07 10:27:41 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:27:41 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:27:41 +0000 DEBUG:data_dir: data
2025-12-07 10:27:41 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:27:41 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:27:41 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:27:41 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:27:41 +0000 DEBUG:utils_dir: utils
2025-12-07 10:27:41 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:27:41 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:27:41 +0000 DEBUG:logs_dir: logs
2025-12-07 10:27:41 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:27:41 +0000 DEBUG:selected_entity_name: Company
2025-12-07 10:27:41 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:27:41 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:27:41 +0000 INFO:Session state Setup complete
2025-12-07 10:27:41 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:27:41 +0000 INFO:Package setup complete
2025-12-07 10:27:41 +0000 INFO:setup_package executed successfully
2025-12-07 10:27:41 +0000 INFO:Setup completed successfully.
2025-12-07 10:27:41 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 INFO:Running first load function.
2025-12-07 10:27:41 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:27:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:27:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:27:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:27:41 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:27:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:27:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:27:41 +0000 INFO:firstload executed successfully
2025-12-07 10:27:41 +0000 INFO:Data first load completed successfully.
2025-12-07 10:27:41 +0000 INFO:initialise_data executed successfully
2025-12-07 10:27:41 +0000 INFO:Running Menu setup...
2025-12-07 10:27:41 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 INFO:get_git_version executed successfully
2025-12-07 10:27:41 +0000 INFO:App Version: v50.228
2025-12-07 10:27:41 +0000 INFO:Switched to page: Non Cash Donations
2025-12-07 10:27:41 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:27:41 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:27:41 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:27:41 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:27:41 +0000 DEBUG:Page texts: {}
2025-12-07 10:27:41 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:27:41 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:27:42 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:27:42 +0000 INFO:display_data_page executed successfully
2025-12-07 10:27:42 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:27:42 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:27:42 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:27:42 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:27:42 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:27:42 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:27:42 +0000 DEBUG:Page texts: {}
2025-12-07 10:27:42 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:27:42 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:27:42 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:27:42 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:27:42 +0000 INFO:pagesetup executed successfully
2025-12-07 10:27:42 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:27:42 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:27:55 +0000 INFO:Streamlit App Starting...
2025-12-07 10:27:55 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:27:55 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py
2025-12-07 10:27:55 +0000 INFO:Running App setup...
2025-12-07 10:27:55 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:Setting up the package
2025-12-07 10:27:55 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:27:55 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:get_git_version executed successfully
2025-12-07 10:27:55 +0000 INFO:Version: v50.190
2025-12-07 10:27:55 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:27:55 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:security already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:directories already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:27:55 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:27:55 +0000 INFO:Session_state variables initialized
2025-12-07 10:27:55 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:27:55 +0000 DEBUG:output_dir: output
2025-12-07 10:27:55 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:27:55 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:27:55 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:27:55 +0000 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations at 0x0000027B6D9C8550>}
2025-12-07 10:27:55 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:27:55 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:27:55 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:27:55 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:27:55 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:27:55 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:27:55 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:27:55 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:27:55 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:27:55 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:27:55 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:27:55 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:27:55 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:27:55 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:27:55 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:27:55 +0000 DEBUG:selected_group_entity: Donor Classification
2025-12-07 10:27:55 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:27:55 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:27:55 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:27:55 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:27:55 +0000 DEBUG:components_dir: components
2025-12-07 10:27:55 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:27:55 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:27:55 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:27:55 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:27:55 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:27:55 +0000 DEBUG:load_donorlist_data_last_modified: 1765103142.1942189
2025-12-07 10:27:55 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:27:55 +0000 DEBUG:load_raw_data_last_modified: 1765103136.9675498
2025-12-07 10:27:55 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:27:55 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:27:55 +0000 DEBUG:data_dir: data
2025-12-07 10:27:55 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:27:55 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:27:55 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:27:55 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:27:55 +0000 DEBUG:utils_dir: utils
2025-12-07 10:27:55 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:27:55 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:27:55 +0000 DEBUG:logs_dir: logs
2025-12-07 10:27:55 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:27:55 +0000 DEBUG:selected_entity_name: Company
2025-12-07 10:27:55 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:27:55 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:27:55 +0000 INFO:Session state Setup complete
2025-12-07 10:27:55 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:27:55 +0000 INFO:Package setup complete
2025-12-07 10:27:55 +0000 INFO:setup_package executed successfully
2025-12-07 10:27:55 +0000 INFO:Setup completed successfully.
2025-12-07 10:27:55 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:Running first load function.
2025-12-07 10:27:55 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:27:55 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:27:55 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:27:55 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:27:55 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:27:55 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:27:55 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:27:55 +0000 INFO:firstload executed successfully
2025-12-07 10:27:55 +0000 INFO:Data first load completed successfully.
2025-12-07 10:27:55 +0000 INFO:initialise_data executed successfully
2025-12-07 10:27:55 +0000 INFO:Running Menu setup...
2025-12-07 10:27:55 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:get_git_version executed successfully
2025-12-07 10:27:55 +0000 INFO:App Version: v50.228
2025-12-07 10:27:55 +0000 INFO:Switched to page: Public Fund Donations
2025-12-07 10:27:55 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:27:55 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:27:55 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:27:55 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 DEBUG:Page texts: {}
2025-12-07 10:27:55 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:27:55 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:27:55 +0000 INFO:display_data_page executed successfully
2025-12-07 10:27:55 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:27:55 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:27:55 +0000 ERROR:Error in display_per_group_data_page: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 41, in display_per_group_data_page
    (min_date,
TypeError: cannot unpack non-iterable NoneType object
2025-12-07 10:27:55 +0000 CRITICAL:Menu setup crashed: cannot unpack non-iterable NoneType object
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\politicalpartyanalysisdashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 50, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 177, in mod_publicfund_donations
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 41, in display_per_group_data_page
    (min_date,
TypeError: cannot unpack non-iterable NoneType object
2025-12-07 10:35:40 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 10:35:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:35:40 +0000 INFO:get_git_version executed successfully
2025-12-07 10:35:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 INFO:get_git_version executed successfully
2025-12-07 10:35:41 +0000 INFO:Streamlit App Starting...
2025-12-07 10:35:41 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:35:41 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:35:41 +0000 INFO:Running App setup...
2025-12-07 10:35:41 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 INFO:Setting up the package
2025-12-07 10:35:41 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:35:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 INFO:get_git_version executed successfully
2025-12-07 10:35:41 +0000 INFO:Version: v50.190
2025-12-07 10:35:41 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:35:41 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:35:41 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:35:41 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:35:41 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:35:41 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:35:41 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:35:41 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:35:41 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:35:41 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:35:41 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:35:41 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:35:41 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:35:41 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:35:41 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:35:41 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:35:41 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:35:41 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:35:41 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:35:41 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:35:41 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:35:41 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:35:41 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:35:41 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:35:41 +0000 INFO:Session_state variables initialized
2025-12-07 10:35:41 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:35:41 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:35:41 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:35:41 +0000 DEBUG:data_dir: data
2025-12-07 10:35:41 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:35:41 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:35:41 +0000 DEBUG:utils_dir: utils
2025-12-07 10:35:41 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:35:41 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:35:41 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:35:41 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:35:41 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:35:41 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:35:41 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:35:41 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:35:41 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:35:41 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:35:41 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:35:41 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:35:41 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:35:41 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:35:41 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:35:41 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:35:41 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:35:41 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:35:41 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:35:41 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:35:41 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:35:41 +0000 DEBUG:components_dir: components
2025-12-07 10:35:41 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:35:41 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:35:41 +0000 DEBUG:output_dir: output
2025-12-07 10:35:41 +0000 DEBUG:logs_dir: logs
2025-12-07 10:35:41 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:35:41 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:35:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:35:41 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:35:41 +0000 INFO:Session state Setup complete
2025-12-07 10:35:41 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:35:41 +0000 INFO:Package setup complete
2025-12-07 10:35:41 +0000 INFO:setup_package executed successfully
2025-12-07 10:35:41 +0000 INFO:Setup completed successfully.
2025-12-07 10:35:41 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 INFO:get_git_version executed successfully
2025-12-07 10:35:41 +0000 INFO:Running first load function.
2025-12-07 10:35:41 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 10:35:41 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 10:35:41 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:35:41 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 10:35:41 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 10:35:41 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:35:41 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 10:35:41 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:35:41 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 10:35:41 +0000 INFO:Last modification time: 1765103136.9675498
2025-12-07 10:35:41 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:35:41 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765103136.9675498 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 10:35:41 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 10:35:42 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:35:42 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 10:35:42 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 10:35:42 +0000 INFO:Cleaning up raw data
2025-12-07 10:35:42 +0000 ERROR:Session state variables not initialized!
2025-12-07 10:35:42 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:42 +0000 INFO:Original file path: None
2025-12-07 10:35:42 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 10:35:42 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 10:35:42 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:35:42 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 10:35:44 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:35:44 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:35:44 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:35:44 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:35:44 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 10:35:44 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:35:44 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:35:44 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 10:35:44 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 10:35:44 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 10:35:44 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 10:35:44 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:35:44 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:35:44 +0000 INFO:Data shape: (91651, 37)
2025-12-07 10:35:46 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 10:35:46 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 10:35:46 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 10:35:46 +0000 INFO:load_raw_data executed successfully
2025-12-07 10:35:46 +0000 INFO:get_raw_data executed successfully
2025-12-07 10:35:46 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:35:46 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:46 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:46 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 10:35:46 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:46 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 10:35:46 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 10:35:46 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:35:46 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 10:35:46 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:35:46 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 10:35:46 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:35:46 +0000 INFO:Current modification time: 1765103746.229115
2025-12-07 10:35:46 +0000 INFO:Last modification time: 1765103136.9675498
2025-12-07 10:35:46 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:35:46 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:35:46 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 10:35:46 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 10:35:46 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 10:35:46 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 10:35:48 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:35:48 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 10:35:48 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:35:48 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 10:35:48 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:35:48 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 10:35:48 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:35:48 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 10:35:48 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:35:48 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 10:35:49 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 10:35:49 +0000 INFO:Loading election dates from pdpy.
2025-12-07 10:35:49 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 10:35:49 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 10:35:49 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 10:35:49 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:35:49 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:35:49 +0000 INFO:load_election_dates executed successfully
2025-12-07 10:35:49 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 10:35:49 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 10:35:51 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 10:35:51 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 10:35:51 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 10:35:51 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:35:51 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:35:51 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 10:35:51 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:35:51 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:35:51 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:35:51 +0000 INFO:Current modification time: 1765103751.4579606
2025-12-07 10:35:51 +0000 INFO:Last modification time: 1765103142.1942189
2025-12-07 10:35:51 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:35:51 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:35:51 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 10:35:51 +0000 INFO:Donor Data summary completed
2025-12-07 10:35:51 +0000 INFO:Data shape: (31905, 5)
2025-12-07 10:35:51 +0000 INFO:load_donorList_data executed successfully
2025-12-07 10:35:51 +0000 INFO:get_donor_data executed successfully
2025-12-07 10:35:51 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:35:51 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:35:51 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:35:51 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 10:35:51 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:35:51 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:35:51 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:35:51 +0000 INFO:Current modification time: 1765103751.4579606
2025-12-07 10:35:51 +0000 INFO:Last modification time: 1765103751.4579606
2025-12-07 10:35:51 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:35:51 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765103751.4579606 instead of output\cleaned_data.csv
2025-12-07 10:35:51 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 10:35:51 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 10:35:51 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:35:51 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 10:35:51 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:35:51 +0000 INFO:Data shape: (1719, 6)
2025-12-07 10:35:51 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 10:35:51 +0000 INFO:get_regentity_data executed successfully
2025-12-07 10:35:51 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:35:51 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:35:51 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:35:51 +0000 INFO:firstload executed successfully
2025-12-07 10:35:51 +0000 INFO:Data first load completed successfully.
2025-12-07 10:35:51 +0000 INFO:initialise_data executed successfully
2025-12-07 10:35:51 +0000 INFO:Running Menu setup...
2025-12-07 10:35:51 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:35:51 +0000 INFO:get_git_version executed successfully
2025-12-07 10:35:51 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:35:52 +0000 INFO:get_git_version executed successfully
2025-12-07 10:35:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:35:52 +0000 INFO:get_git_version executed successfully
2025-12-07 10:35:52 +0000 INFO:App Version: v50.228
2025-12-07 10:35:52 +0000 INFO:Switched to page: Introduction
2025-12-07 10:35:52 +0000 INFO:pagesetup executed successfully
2025-12-07 10:35:52 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:35:52 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:36:00 +0000 INFO:Streamlit App Starting...
2025-12-07 10:36:00 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:00 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:36:00 +0000 INFO:Running App setup...
2025-12-07 10:36:00 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:36:00 +0000 INFO:Setting up the package
2025-12-07 10:36:00 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:00 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:00 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:00 +0000 INFO:Version: v50.190
2025-12-07 10:36:00 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:36:00 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:00 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:security already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:directories already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:36:00 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:36:00 +0000 INFO:Session_state variables initialized
2025-12-07 10:36:00 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:36:00 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:00 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:36:00 +0000 DEBUG:data_dir: data
2025-12-07 10:36:00 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:36:00 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:36:00 +0000 DEBUG:utils_dir: utils
2025-12-07 10:36:00 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:36:00 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:36:00 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001853D76B5B0>}
2025-12-07 10:36:00 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:36:00 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:36:00 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:36:00 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:36:00 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:36:00 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:36:00 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:36:00 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:36:00 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:36:00 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:36:00 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:36:00 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:36:00 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:36:00 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:36:00 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:36:00 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:36:00 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:36:00 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:36:00 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:36:00 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:36:00 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:36:00 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:36:00 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:36:00 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:36:00 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:36:00 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:36:00 +0000 DEBUG:components_dir: components
2025-12-07 10:36:00 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:36:00 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:36:00 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:36:00 +0000 DEBUG:output_dir: output
2025-12-07 10:36:00 +0000 DEBUG:logs_dir: logs
2025-12-07 10:36:00 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:36:00 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:36:00 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:36:00 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:36:00 +0000 INFO:Session state Setup complete
2025-12-07 10:36:00 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:36:00 +0000 INFO:Package setup complete
2025-12-07 10:36:00 +0000 INFO:setup_package executed successfully
2025-12-07 10:36:00 +0000 INFO:Setup completed successfully.
2025-12-07 10:36:00 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:00 +0000 INFO:Running first load function.
2025-12-07 10:36:00 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:36:00 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:00 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:00 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:00 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:00 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:36:00 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:00 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:00 +0000 INFO:firstload executed successfully
2025-12-07 10:36:00 +0000 INFO:Data first load completed successfully.
2025-12-07 10:36:00 +0000 INFO:initialise_data executed successfully
2025-12-07 10:36:00 +0000 INFO:Running Menu setup...
2025-12-07 10:36:00 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:36:00 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:00 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:00 +0000 INFO:App Version: v50.228
2025-12-07 10:36:00 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 10:36:00 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 10:36:00 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:01 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:36:01 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:01 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:02 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20131.118739
1                       Green Party   6023.742231
2                      Labour Party  20650.882442
3                      Large Entity  29763.708881
4                  Liberal Democrat   8504.706244
5                     Medium Entity  15666.034757
6               Medium Large Entity  31569.580016
7                         Reform UK  74374.940899
8            Single Donation Entity  12207.983689
9                      Small Entity  16114.092989
10              Small Medium Entity  21512.571099
11     Uk Independence Party (Ukip)   9919.127250
12                Very Small Entity  24966.683550
2025-12-07 10:36:02 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
7                         Reform UK  74374.940899
6               Medium Large Entity  31569.580016
3                      Large Entity  29763.708881
12                Very Small Entity  24966.683550
10              Small Medium Entity  21512.571099
2                      Labour Party  20650.882442
0   Conservative And Unionist Party  20131.118739
9                      Small Entity  16114.092989
5                     Medium Entity  15666.034757
8            Single Donation Entity  12207.983689
11     Uk Independence Party (Ukip)   9919.127250
4                  Liberal Democrat   8504.706244
1                       Green Party   6023.742231
2025-12-07 10:36:02 +0000 DEBUG:Unique XValues: ['Reform UK' 'Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 'Green Party']
2025-12-07 10:36:02 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Medium Large Entity': '#636efa', 'Large Entity': '#333333', 'Very Small Entity': '#bbbbbb', 'Small Medium Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#888888', 'Medium Entity': '#555555', 'Single Donation Entity': '#dddddd', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', 'Green Party': '#78B943'}
2025-12-07 10:36:02 +0000 DEBUG:Missing color mappings for: ['Medium Large Entity']
2025-12-07 10:36:02 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'H03sDW8o8kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Large Entity',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Medium Large Entity',
              'offsetgroup': 'Medium Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '6Xn6HmXU3kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#333333', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9nxPXu0Q3UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Very Small Entity',
              'marker': {'color': '#bbbbbb', 'pattern': {'shape': ''}},
              'name': 'Very Small Entity',
              'offsetgroup': 'Very Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Very Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'typIv6th2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Medium Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Medium Entity',
              'offsetgroup': 'Small Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9ofjjCQC1UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AHzuebgq1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '1f1qmceo00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#888888', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LAkU5wt5z0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#555555', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'zM7ocgSZzkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#dddddd', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nHuE6f3Xx0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'QIC7SZBfw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Democrat',
              'marker': {'color': '#FDBB30', 'pattern': {'shape': ''}},
              'name': 'Liberal Democrat',
              'offsetgroup': 'Liberal Democrat',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Democrat'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AMMxZlqcwEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7u/VAr6Ht0A=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Medium Large Entity, Large
                                           Entity, Very Small Entity, Small Medium
                                           Entity, Labour Party, Conservative And
                                           Unionist Party, Small Entity, Medium
                                           Entity, Single Donation Entity, Uk
                                           Independence Party (Ukip), Liberal
                                           Democrat, Green Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2025-12-07 10:36:02 +0000 INFO:Bar chart displayed successfully.
2025-12-07 10:36:02 +0000 INFO:hlf_body executed successfully
2025-12-07 10:36:02 +0000 INFO:pagesetup executed successfully
2025-12-07 10:36:02 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:36:02 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:36:17 +0000 INFO:Streamlit App Starting...
2025-12-07 10:36:17 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:17 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:36:17 +0000 INFO:Running App setup...
2025-12-07 10:36:17 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:36:17 +0000 INFO:Setting up the package
2025-12-07 10:36:17 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:17 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:17 +0000 INFO:Version: v50.190
2025-12-07 10:36:17 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:36:17 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:17 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:security already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:directories already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:36:17 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:36:17 +0000 INFO:Session_state variables initialized
2025-12-07 10:36:17 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:36:17 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:17 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:36:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:36:17 +0000 DEBUG:data_dir: data
2025-12-07 10:36:17 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:36:17 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:36:17 +0000 DEBUG:utils_dir: utils
2025-12-07 10:36:17 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:36:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:36:17 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:36:17 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000001853D7AC160>}
2025-12-07 10:36:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:36:17 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:36:17 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:36:17 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:36:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:36:17 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:36:17 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:36:17 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:36:17 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:36:17 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:36:17 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:36:17 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:36:17 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:36:17 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:36:17 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:36:17 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:36:17 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:36:17 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:36:17 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:36:17 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:36:17 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:36:17 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:36:17 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:36:17 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:36:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:36:17 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:36:17 +0000 DEBUG:components_dir: components
2025-12-07 10:36:17 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:36:17 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:36:17 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:36:17 +0000 DEBUG:output_dir: output
2025-12-07 10:36:17 +0000 DEBUG:logs_dir: logs
2025-12-07 10:36:17 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:36:17 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:36:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:36:17 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:36:17 +0000 INFO:Session state Setup complete
2025-12-07 10:36:17 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:36:17 +0000 INFO:Package setup complete
2025-12-07 10:36:17 +0000 INFO:setup_package executed successfully
2025-12-07 10:36:17 +0000 INFO:Setup completed successfully.
2025-12-07 10:36:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:17 +0000 INFO:Running first load function.
2025-12-07 10:36:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:36:17 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:17 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:17 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:17 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:17 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:36:17 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:17 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:17 +0000 INFO:firstload executed successfully
2025-12-07 10:36:17 +0000 INFO:Data first load completed successfully.
2025-12-07 10:36:17 +0000 INFO:initialise_data executed successfully
2025-12-07 10:36:17 +0000 INFO:Running Menu setup...
2025-12-07 10:36:17 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:36:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:17 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:17 +0000 INFO:App Version: v50.228
2025-12-07 10:36:17 +0000 INFO:Switched to page: Cash Donations
2025-12-07 10:36:17 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:36:17 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:18 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:36:18 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:18 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:18 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:36:18 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:36:18 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:36:18 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2025-12-07 10:36:18 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2025-12-07 10:36:18 +0000 DEBUG:Not logged in as admin.
2025-12-07 10:36:18 +0000 INFO:manage_text_elements executed successfully
2025-12-07 10:36:18 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:36:18 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:36:18 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:36:18 +0000 INFO:display_data_page executed successfully
2025-12-07 10:36:18 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:36:18 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:19 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:19 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:36:19 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:36:19 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:36:19 +0000 DEBUG:Page texts: {}
2025-12-07 10:36:19 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:36:19 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:36:19 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:36:19 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:36:19 +0000 INFO:pagesetup executed successfully
2025-12-07 10:36:19 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:36:19 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:36:23 +0000 INFO:Streamlit App Starting...
2025-12-07 10:36:23 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:23 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:36:23 +0000 INFO:Running App setup...
2025-12-07 10:36:23 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 INFO:Setting up the package
2025-12-07 10:36:23 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:23 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:23 +0000 INFO:Version: v50.190
2025-12-07 10:36:23 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:23 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:security already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:directories already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:36:23 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:36:23 +0000 INFO:Session_state variables initialized
2025-12-07 10:36:23 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:36:23 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:36:23 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:23 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:36:23 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:36:23 +0000 DEBUG:data_dir: data
2025-12-07 10:36:23 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:36:23 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:36:23 +0000 DEBUG:utils_dir: utils
2025-12-07 10:36:23 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:36:23 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:36:23 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:36:23 +0000 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations at 0x000001853D7AC1F0>}
2025-12-07 10:36:23 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:36:23 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:36:23 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:36:23 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:36:23 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:36:23 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:36:23 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:36:23 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:36:23 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:36:23 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:36:23 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:36:23 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:36:23 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:36:23 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:36:23 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:36:23 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:36:23 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:36:23 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:36:23 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:36:23 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:36:23 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:36:23 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:36:23 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:36:23 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:36:23 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:36:23 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:36:23 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:36:23 +0000 DEBUG:components_dir: components
2025-12-07 10:36:23 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:36:23 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:36:23 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:36:23 +0000 DEBUG:output_dir: output
2025-12-07 10:36:23 +0000 DEBUG:logs_dir: logs
2025-12-07 10:36:23 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:36:23 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:36:23 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:36:23 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:36:23 +0000 INFO:Session state Setup complete
2025-12-07 10:36:23 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:36:23 +0000 INFO:Package setup complete
2025-12-07 10:36:23 +0000 INFO:setup_package executed successfully
2025-12-07 10:36:23 +0000 INFO:Setup completed successfully.
2025-12-07 10:36:23 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 INFO:Running first load function.
2025-12-07 10:36:23 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:23 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:23 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:23 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:23 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:36:23 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:23 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:23 +0000 INFO:firstload executed successfully
2025-12-07 10:36:23 +0000 INFO:Data first load completed successfully.
2025-12-07 10:36:23 +0000 INFO:initialise_data executed successfully
2025-12-07 10:36:23 +0000 INFO:Running Menu setup...
2025-12-07 10:36:23 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:23 +0000 INFO:App Version: v50.228
2025-12-07 10:36:23 +0000 INFO:Switched to page: Non Cash Donations
2025-12-07 10:36:23 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:36:23 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:23 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:36:23 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:36:23 +0000 DEBUG:Page texts: {}
2025-12-07 10:36:23 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:36:23 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:36:24 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:36:24 +0000 INFO:display_data_page executed successfully
2025-12-07 10:36:24 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:36:24 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:24 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:24 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:36:24 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:36:24 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:36:24 +0000 DEBUG:Page texts: {}
2025-12-07 10:36:24 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:36:24 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:36:24 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:36:24 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:36:24 +0000 INFO:pagesetup executed successfully
2025-12-07 10:36:24 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:36:24 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:36:38 +0000 INFO:Streamlit App Starting...
2025-12-07 10:36:38 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:38 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:36:38 +0000 INFO:Running App setup...
2025-12-07 10:36:38 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:Setting up the package
2025-12-07 10:36:38 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:38 +0000 INFO:Version: v50.190
2025-12-07 10:36:38 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:38 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:security already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:directories already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:36:38 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:36:38 +0000 INFO:Session_state variables initialized
2025-12-07 10:36:38 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:36:38 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:36:38 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:38 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:36:38 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:36:38 +0000 DEBUG:data_dir: data
2025-12-07 10:36:38 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:36:38 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:36:38 +0000 DEBUG:utils_dir: utils
2025-12-07 10:36:38 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:36:38 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:36:38 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:36:38 +0000 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations at 0x000001853D7AC280>}
2025-12-07 10:36:38 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:36:38 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:36:38 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:36:38 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:36:38 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:36:38 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:36:38 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:36:38 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:36:38 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:36:38 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:36:38 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:36:38 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:36:38 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:36:38 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:36:38 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:36:38 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:36:38 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:36:38 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:36:38 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:36:38 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:36:38 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:36:38 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:36:38 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:36:38 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:36:38 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:36:38 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:36:38 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:36:38 +0000 DEBUG:components_dir: components
2025-12-07 10:36:38 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:36:38 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:36:38 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:36:38 +0000 DEBUG:output_dir: output
2025-12-07 10:36:38 +0000 DEBUG:logs_dir: logs
2025-12-07 10:36:38 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:36:38 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:36:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:36:38 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:36:38 +0000 INFO:Session state Setup complete
2025-12-07 10:36:38 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:36:38 +0000 INFO:Package setup complete
2025-12-07 10:36:38 +0000 INFO:setup_package executed successfully
2025-12-07 10:36:38 +0000 INFO:Setup completed successfully.
2025-12-07 10:36:38 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:Running first load function.
2025-12-07 10:36:38 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:38 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:38 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:38 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:38 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:36:38 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:38 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:38 +0000 INFO:firstload executed successfully
2025-12-07 10:36:38 +0000 INFO:Data first load completed successfully.
2025-12-07 10:36:38 +0000 INFO:initialise_data executed successfully
2025-12-07 10:36:38 +0000 INFO:Running Menu setup...
2025-12-07 10:36:38 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:38 +0000 INFO:App Version: v50.228
2025-12-07 10:36:38 +0000 INFO:Switched to page: Public Fund Donations
2025-12-07 10:36:38 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:36:38 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:38 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:36:38 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 DEBUG:Page texts: {}
2025-12-07 10:36:38 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:36:38 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:36:38 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:36:38 +0000 INFO:display_data_page executed successfully
2025-12-07 10:36:38 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:36:39 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:39 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:39 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:36:39 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:36:39 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:36:39 +0000 DEBUG:Page texts: {}
2025-12-07 10:36:39 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:36:39 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:36:39 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:36:39 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:36:39 +0000 INFO:pagesetup executed successfully
2025-12-07 10:36:39 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:36:39 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:36:46 +0000 INFO:Streamlit App Starting...
2025-12-07 10:36:46 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:46 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:36:46 +0000 INFO:Running App setup...
2025-12-07 10:36:46 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:Setting up the package
2025-12-07 10:36:46 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:36:46 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:46 +0000 INFO:Version: v50.190
2025-12-07 10:36:46 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:46 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:security already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:directories already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:36:46 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:36:46 +0000 INFO:Session_state variables initialized
2025-12-07 10:36:46 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:36:46 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:36:46 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:36:46 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:36:46 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:36:46 +0000 DEBUG:data_dir: data
2025-12-07 10:36:46 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:36:46 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:36:46 +0000 DEBUG:utils_dir: utils
2025-12-07 10:36:46 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:36:46 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:36:46 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:36:46 +0000 DEBUG:menu_selection: {'title': 'Bequests', 'function': <function mod_bequeths at 0x000001853D76BD90>}
2025-12-07 10:36:46 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:36:46 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:36:46 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:36:46 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:36:46 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:36:46 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:36:46 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:36:46 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:36:46 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:36:46 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:36:46 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:36:46 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:36:46 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:36:46 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:36:46 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:36:46 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:36:46 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:36:46 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:36:46 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:36:46 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:36:46 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:36:46 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:36:46 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:36:46 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:36:46 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:36:46 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:36:46 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:36:46 +0000 DEBUG:components_dir: components
2025-12-07 10:36:46 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:36:46 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:36:46 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:36:46 +0000 DEBUG:output_dir: output
2025-12-07 10:36:46 +0000 DEBUG:logs_dir: logs
2025-12-07 10:36:46 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:36:46 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:36:46 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:36:46 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:36:46 +0000 INFO:Session state Setup complete
2025-12-07 10:36:46 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:36:46 +0000 INFO:Package setup complete
2025-12-07 10:36:46 +0000 INFO:setup_package executed successfully
2025-12-07 10:36:46 +0000 INFO:Setup completed successfully.
2025-12-07 10:36:46 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:Running first load function.
2025-12-07 10:36:46 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:46 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:36:46 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:46 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:46 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:36:46 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:36:46 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:36:46 +0000 INFO:firstload executed successfully
2025-12-07 10:36:46 +0000 INFO:Data first load completed successfully.
2025-12-07 10:36:46 +0000 INFO:initialise_data executed successfully
2025-12-07 10:36:46 +0000 INFO:Running Menu setup...
2025-12-07 10:36:46 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:get_git_version executed successfully
2025-12-07 10:36:46 +0000 INFO:App Version: v50.228
2025-12-07 10:36:46 +0000 INFO:Switched to page: Bequests
2025-12-07 10:36:46 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:36:46 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:46 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:36:46 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 DEBUG:Page texts: {}
2025-12-07 10:36:46 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:36:46 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:36:46 +0000 INFO:display_data_page executed successfully
2025-12-07 10:36:46 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:36:46 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:36:47 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:36:47 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:36:47 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:36:47 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:36:47 +0000 DEBUG:Page texts: {}
2025-12-07 10:36:47 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:36:47 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:36:47 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:36:47 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:36:47 +0000 INFO:pagesetup executed successfully
2025-12-07 10:36:47 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:36:47 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:37:06 +0000 INFO:Streamlit App Starting...
2025-12-07 10:37:06 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:37:06 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:37:06 +0000 INFO:Running App setup...
2025-12-07 10:37:06 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:Setting up the package
2025-12-07 10:37:06 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:37:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:get_git_version executed successfully
2025-12-07 10:37:06 +0000 INFO:Version: v50.190
2025-12-07 10:37:06 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:37:06 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:security already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:directories already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:37:06 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:37:06 +0000 INFO:Session_state variables initialized
2025-12-07 10:37:06 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:37:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:37:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:37:06 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:37:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:37:06 +0000 DEBUG:data_dir: data
2025-12-07 10:37:06 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:37:06 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:37:06 +0000 DEBUG:utils_dir: utils
2025-12-07 10:37:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:37:06 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:37:06 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:37:06 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x000001853D76BE20>}
2025-12-07 10:37:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:37:06 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:37:06 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:37:06 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:37:06 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:37:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:37:06 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:37:06 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:37:06 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:37:06 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:37:06 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:37:06 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:37:06 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:37:06 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:37:06 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:37:06 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:37:06 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:37:06 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:37:06 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:37:06 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:37:06 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:37:06 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:37:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:37:06 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:37:06 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:37:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:37:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:37:06 +0000 DEBUG:components_dir: components
2025-12-07 10:37:06 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:37:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:37:06 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:37:06 +0000 DEBUG:output_dir: output
2025-12-07 10:37:06 +0000 DEBUG:logs_dir: logs
2025-12-07 10:37:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:37:06 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:37:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:37:06 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:37:06 +0000 INFO:Session state Setup complete
2025-12-07 10:37:06 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:37:06 +0000 INFO:Package setup complete
2025-12-07 10:37:06 +0000 INFO:setup_package executed successfully
2025-12-07 10:37:06 +0000 INFO:Setup completed successfully.
2025-12-07 10:37:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:Running first load function.
2025-12-07 10:37:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:37:06 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:37:06 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:37:06 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:37:06 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:37:06 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:37:06 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:37:06 +0000 INFO:firstload executed successfully
2025-12-07 10:37:06 +0000 INFO:Data first load completed successfully.
2025-12-07 10:37:06 +0000 INFO:initialise_data executed successfully
2025-12-07 10:37:06 +0000 INFO:Running Menu setup...
2025-12-07 10:37:06 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:get_git_version executed successfully
2025-12-07 10:37:06 +0000 INFO:App Version: v50.228
2025-12-07 10:37:06 +0000 INFO:Switched to page: Corporate Donations
2025-12-07 10:37:06 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:37:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:37:06 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:37:06 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 DEBUG:Page texts: {}
2025-12-07 10:37:06 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:37:06 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:37:06 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:37:06 +0000 INFO:display_data_page executed successfully
2025-12-07 10:37:06 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:37:07 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:37:07 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:37:07 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:37:07 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:37:07 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:37:07 +0000 DEBUG:Page texts: {}
2025-12-07 10:37:07 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:37:07 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:37:07 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:37:07 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:37:07 +0000 INFO:pagesetup executed successfully
2025-12-07 10:37:07 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:37:07 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:38:40 +0000 INFO:Streamlit App Starting...
2025-12-07 10:38:40 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:38:40 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:38:40 +0000 INFO:Running App setup...
2025-12-07 10:38:40 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:38:40 +0000 INFO:Setting up the package
2025-12-07 10:38:40 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:38:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:38:40 +0000 INFO:get_git_version executed successfully
2025-12-07 10:38:40 +0000 INFO:Version: v50.190
2025-12-07 10:38:40 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:38:40 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:38:40 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:security already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:directories already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:38:40 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:38:40 +0000 INFO:Session_state variables initialized
2025-12-07 10:38:40 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:38:40 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:38:40 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:38:40 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:38:40 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:38:40 +0000 DEBUG:data_dir: data
2025-12-07 10:38:40 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:38:40 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:38:40 +0000 DEBUG:utils_dir: utils
2025-12-07 10:38:40 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:38:40 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:38:40 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:38:40 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001853D76B5B0>}
2025-12-07 10:38:40 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:38:40 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:38:40 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:38:40 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:38:41 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:38:41 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:38:41 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:38:41 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:38:41 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:38:41 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:38:41 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:38:41 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:38:41 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:38:41 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:38:41 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:38:41 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:38:41 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:38:41 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:38:41 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:38:41 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:38:41 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:38:41 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:38:41 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:38:41 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:38:41 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:38:41 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:38:41 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:38:41 +0000 DEBUG:components_dir: components
2025-12-07 10:38:41 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:38:41 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:38:41 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:38:41 +0000 DEBUG:output_dir: output
2025-12-07 10:38:41 +0000 DEBUG:logs_dir: logs
2025-12-07 10:38:41 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:38:41 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:38:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:38:41 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:38:41 +0000 INFO:Session state Setup complete
2025-12-07 10:38:41 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:38:41 +0000 INFO:Package setup complete
2025-12-07 10:38:41 +0000 INFO:setup_package executed successfully
2025-12-07 10:38:41 +0000 INFO:Setup completed successfully.
2025-12-07 10:38:41 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:38:41 +0000 INFO:Running first load function.
2025-12-07 10:38:41 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:38:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:38:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:38:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:38:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:38:41 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:38:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:38:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:38:41 +0000 INFO:firstload executed successfully
2025-12-07 10:38:41 +0000 INFO:Data first load completed successfully.
2025-12-07 10:38:41 +0000 INFO:initialise_data executed successfully
2025-12-07 10:38:41 +0000 INFO:Running Menu setup...
2025-12-07 10:38:41 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:38:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:38:41 +0000 INFO:get_git_version executed successfully
2025-12-07 10:38:41 +0000 INFO:App Version: v50.228
2025-12-07 10:38:41 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 10:38:41 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 10:38:41 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:38:41 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:38:41 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:38:41 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:38:42 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20131.118739
1                       Green Party   6023.742231
2                      Labour Party  20650.882442
3                      Large Entity  29763.708881
4                  Liberal Democrat   8504.706244
5                     Medium Entity  15666.034757
6               Medium Large Entity  31569.580016
7                         Reform UK  74374.940899
8            Single Donation Entity  12207.983689
9                      Small Entity  16114.092989
10              Small Medium Entity  21512.571099
11     Uk Independence Party (Ukip)   9919.127250
12                Very Small Entity  24966.683550
2025-12-07 10:38:42 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
7                         Reform UK  74374.940899
6               Medium Large Entity  31569.580016
3                      Large Entity  29763.708881
12                Very Small Entity  24966.683550
10              Small Medium Entity  21512.571099
2                      Labour Party  20650.882442
0   Conservative And Unionist Party  20131.118739
9                      Small Entity  16114.092989
5                     Medium Entity  15666.034757
8            Single Donation Entity  12207.983689
11     Uk Independence Party (Ukip)   9919.127250
4                  Liberal Democrat   8504.706244
1                       Green Party   6023.742231
2025-12-07 10:38:42 +0000 DEBUG:Unique XValues: ['Reform UK' 'Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 'Green Party']
2025-12-07 10:38:42 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Medium Large Entity': '#636efa', 'Large Entity': '#333333', 'Very Small Entity': '#bbbbbb', 'Small Medium Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#888888', 'Medium Entity': '#555555', 'Single Donation Entity': '#dddddd', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', 'Green Party': '#78B943'}
2025-12-07 10:38:42 +0000 DEBUG:Missing color mappings for: ['Medium Large Entity']
2025-12-07 10:38:42 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'H03sDW8o8kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Large Entity',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Medium Large Entity',
              'offsetgroup': 'Medium Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '6Xn6HmXU3kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#333333', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9nxPXu0Q3UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Very Small Entity',
              'marker': {'color': '#bbbbbb', 'pattern': {'shape': ''}},
              'name': 'Very Small Entity',
              'offsetgroup': 'Very Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Very Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'typIv6th2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Medium Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Medium Entity',
              'offsetgroup': 'Small Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9ofjjCQC1UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AHzuebgq1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '1f1qmceo00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#888888', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LAkU5wt5z0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#555555', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'zM7ocgSZzkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#dddddd', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nHuE6f3Xx0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'QIC7SZBfw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Democrat',
              'marker': {'color': '#FDBB30', 'pattern': {'shape': ''}},
              'name': 'Liberal Democrat',
              'offsetgroup': 'Liberal Democrat',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Democrat'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AMMxZlqcwEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7u/VAr6Ht0A=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Medium Large Entity, Large
                                           Entity, Very Small Entity, Small Medium
                                           Entity, Labour Party, Conservative And
                                           Unionist Party, Small Entity, Medium
                                           Entity, Single Donation Entity, Uk
                                           Independence Party (Ukip), Liberal
                                           Democrat, Green Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2025-12-07 10:38:42 +0000 INFO:Bar chart displayed successfully.
2025-12-07 10:38:42 +0000 INFO:hlf_body executed successfully
2025-12-07 10:38:42 +0000 INFO:pagesetup executed successfully
2025-12-07 10:38:42 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:38:42 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:41:28 +0000 INFO:Streamlit App Starting...
2025-12-07 10:41:28 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:41:28 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:41:28 +0000 INFO:Running App setup...
2025-12-07 10:41:28 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:41:28 +0000 INFO:Setting up the package
2025-12-07 10:41:28 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:41:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:41:28 +0000 INFO:get_git_version executed successfully
2025-12-07 10:41:28 +0000 INFO:Version: v50.190
2025-12-07 10:41:28 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:41:28 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:41:28 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:security already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:directories already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:41:28 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:41:28 +0000 INFO:Session_state variables initialized
2025-12-07 10:41:28 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:41:28 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:41:28 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:41:28 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:41:28 +0000 DEBUG:data_dir: data
2025-12-07 10:41:28 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:41:28 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:41:28 +0000 DEBUG:utils_dir: utils
2025-12-07 10:41:28 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:41:28 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:41:28 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:41:28 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001853D76BF40>}
2025-12-07 10:41:28 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:41:28 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:41:28 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:41:28 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:41:28 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:41:28 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:41:28 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:41:28 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:41:28 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:41:28 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:41:28 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:41:28 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:41:28 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:41:28 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:41:28 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:41:28 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:41:28 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:41:28 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:41:28 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:41:28 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:41:28 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:41:28 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:41:28 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:41:28 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:41:28 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:41:28 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:41:28 +0000 DEBUG:components_dir: components
2025-12-07 10:41:28 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:41:28 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:41:28 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:41:28 +0000 DEBUG:output_dir: output
2025-12-07 10:41:28 +0000 DEBUG:logs_dir: logs
2025-12-07 10:41:28 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:41:28 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:41:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:41:28 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:41:28 +0000 INFO:Session state Setup complete
2025-12-07 10:41:28 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:41:28 +0000 INFO:Package setup complete
2025-12-07 10:41:28 +0000 INFO:setup_package executed successfully
2025-12-07 10:41:28 +0000 INFO:Setup completed successfully.
2025-12-07 10:41:28 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:41:28 +0000 INFO:Running first load function.
2025-12-07 10:41:28 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:41:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:41:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:41:28 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:41:28 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:41:28 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:41:28 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:41:28 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:41:28 +0000 INFO:firstload executed successfully
2025-12-07 10:41:28 +0000 INFO:Data first load completed successfully.
2025-12-07 10:41:28 +0000 INFO:initialise_data executed successfully
2025-12-07 10:41:28 +0000 INFO:Running Menu setup...
2025-12-07 10:41:28 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:41:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:41:28 +0000 INFO:get_git_version executed successfully
2025-12-07 10:41:28 +0000 INFO:App Version: v50.228
2025-12-07 10:41:28 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:41:28 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:41:29 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:41:29 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:41:29 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:41:29 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:41:29 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:41:29 +0000 DEBUG:Page texts: {}
2025-12-07 10:41:29 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:41:29 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:41:29 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:41:29 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:41:29 +0000 INFO:pagesetup executed successfully
2025-12-07 10:41:29 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:41:29 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:41:34 +0000 INFO:Streamlit App Starting...
2025-12-07 10:41:34 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:41:34 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:41:34 +0000 INFO:Running App setup...
2025-12-07 10:41:34 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 INFO:Setting up the package
2025-12-07 10:41:34 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:41:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 INFO:get_git_version executed successfully
2025-12-07 10:41:34 +0000 INFO:Version: v50.190
2025-12-07 10:41:34 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:41:34 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:security already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:directories already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:41:34 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:41:34 +0000 INFO:Session_state variables initialized
2025-12-07 10:41:34 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:41:34 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:41:34 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:41:34 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:41:34 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:41:34 +0000 DEBUG:data_dir: data
2025-12-07 10:41:34 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:41:34 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:41:34 +0000 DEBUG:utils_dir: utils
2025-12-07 10:41:34 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:41:34 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:41:34 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:41:34 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001853D76B5B0>}
2025-12-07 10:41:34 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:41:34 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:41:34 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:41:34 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:41:34 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:41:34 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:41:34 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:41:34 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:41:34 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:41:34 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:41:34 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:41:34 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:41:34 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:41:34 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:41:34 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:41:34 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:41:34 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:41:34 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:41:34 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:41:34 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:41:34 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:41:34 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:41:34 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:41:34 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:41:34 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:41:34 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:41:34 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:41:34 +0000 DEBUG:components_dir: components
2025-12-07 10:41:34 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:41:34 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:41:34 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:41:34 +0000 DEBUG:output_dir: output
2025-12-07 10:41:34 +0000 DEBUG:logs_dir: logs
2025-12-07 10:41:34 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:41:34 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:41:34 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:41:34 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:41:34 +0000 INFO:Session state Setup complete
2025-12-07 10:41:34 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:41:34 +0000 INFO:Package setup complete
2025-12-07 10:41:34 +0000 INFO:setup_package executed successfully
2025-12-07 10:41:34 +0000 INFO:Setup completed successfully.
2025-12-07 10:41:34 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 INFO:Running first load function.
2025-12-07 10:41:34 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:41:34 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:41:34 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:41:34 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:41:34 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:41:34 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:41:34 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:41:34 +0000 INFO:firstload executed successfully
2025-12-07 10:41:34 +0000 INFO:Data first load completed successfully.
2025-12-07 10:41:34 +0000 INFO:initialise_data executed successfully
2025-12-07 10:41:34 +0000 INFO:Running Menu setup...
2025-12-07 10:41:34 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 INFO:get_git_version executed successfully
2025-12-07 10:41:34 +0000 INFO:App Version: v50.228
2025-12-07 10:41:34 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 10:41:34 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:41:34 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:41:34 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:41:35 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20131.118739
1                       Green Party   6023.742231
2                      Labour Party  20650.882442
3                      Large Entity  29763.708881
4                  Liberal Democrat   8504.706244
5                     Medium Entity  15666.034757
6               Medium Large Entity  31569.580016
7                         Reform UK  74374.940899
8            Single Donation Entity  12207.983689
9                      Small Entity  16114.092989
10              Small Medium Entity  21512.571099
11     Uk Independence Party (Ukip)   9919.127250
12                Very Small Entity  24966.683550
2025-12-07 10:41:35 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
7                         Reform UK  74374.940899
6               Medium Large Entity  31569.580016
3                      Large Entity  29763.708881
12                Very Small Entity  24966.683550
10              Small Medium Entity  21512.571099
2                      Labour Party  20650.882442
0   Conservative And Unionist Party  20131.118739
9                      Small Entity  16114.092989
5                     Medium Entity  15666.034757
8            Single Donation Entity  12207.983689
11     Uk Independence Party (Ukip)   9919.127250
4                  Liberal Democrat   8504.706244
1                       Green Party   6023.742231
2025-12-07 10:41:35 +0000 DEBUG:Unique XValues: ['Reform UK' 'Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 'Green Party']
2025-12-07 10:41:35 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Medium Large Entity': '#636efa', 'Large Entity': '#333333', 'Very Small Entity': '#bbbbbb', 'Small Medium Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#888888', 'Medium Entity': '#555555', 'Single Donation Entity': '#dddddd', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', 'Green Party': '#78B943'}
2025-12-07 10:41:36 +0000 DEBUG:Missing color mappings for: ['Medium Large Entity']
2025-12-07 10:41:36 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'H03sDW8o8kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Large Entity',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Medium Large Entity',
              'offsetgroup': 'Medium Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '6Xn6HmXU3kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#333333', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9nxPXu0Q3UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Very Small Entity',
              'marker': {'color': '#bbbbbb', 'pattern': {'shape': ''}},
              'name': 'Very Small Entity',
              'offsetgroup': 'Very Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Very Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'typIv6th2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Medium Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Medium Entity',
              'offsetgroup': 'Small Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9ofjjCQC1UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AHzuebgq1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '1f1qmceo00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#888888', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LAkU5wt5z0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#555555', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'zM7ocgSZzkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#dddddd', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nHuE6f3Xx0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'QIC7SZBfw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Democrat',
              'marker': {'color': '#FDBB30', 'pattern': {'shape': ''}},
              'name': 'Liberal Democrat',
              'offsetgroup': 'Liberal Democrat',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Democrat'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AMMxZlqcwEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7u/VAr6Ht0A=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Medium Large Entity, Large
                                           Entity, Very Small Entity, Small Medium
                                           Entity, Labour Party, Conservative And
                                           Unionist Party, Small Entity, Medium
                                           Entity, Single Donation Entity, Uk
                                           Independence Party (Ukip), Liberal
                                           Democrat, Green Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2025-12-07 10:41:36 +0000 INFO:Bar chart displayed successfully.
2025-12-07 10:41:36 +0000 INFO:hlf_body executed successfully
2025-12-07 10:41:36 +0000 INFO:pagesetup executed successfully
2025-12-07 10:41:36 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:41:36 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:41:54 +0000 INFO:Streamlit App Starting...
2025-12-07 10:41:54 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:41:54 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:41:54 +0000 INFO:Running App setup...
2025-12-07 10:41:54 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 INFO:Setting up the package
2025-12-07 10:41:54 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:41:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 INFO:get_git_version executed successfully
2025-12-07 10:41:54 +0000 INFO:Version: v50.190
2025-12-07 10:41:54 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:41:54 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:security already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:directories already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:41:54 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:41:54 +0000 INFO:Session_state variables initialized
2025-12-07 10:41:54 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:41:54 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:41:54 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:41:54 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:41:54 +0000 DEBUG:data_dir: data
2025-12-07 10:41:54 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:41:54 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:41:54 +0000 DEBUG:utils_dir: utils
2025-12-07 10:41:54 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:41:54 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:41:54 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:41:54 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x000001853D7AC160>}
2025-12-07 10:41:54 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:41:54 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:41:54 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:41:54 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:41:54 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:41:54 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:41:54 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:41:54 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:41:54 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:41:54 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:41:54 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:41:54 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:41:54 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:41:54 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:41:54 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:41:54 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:41:54 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:41:54 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:41:54 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:41:54 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:41:54 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:41:54 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:41:54 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:41:54 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:41:54 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:41:54 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:41:54 +0000 DEBUG:components_dir: components
2025-12-07 10:41:54 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:41:54 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:41:54 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:41:54 +0000 DEBUG:output_dir: output
2025-12-07 10:41:54 +0000 DEBUG:logs_dir: logs
2025-12-07 10:41:54 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:41:54 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:41:54 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:41:54 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:41:54 +0000 INFO:Session state Setup complete
2025-12-07 10:41:54 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:41:54 +0000 INFO:Package setup complete
2025-12-07 10:41:54 +0000 INFO:setup_package executed successfully
2025-12-07 10:41:54 +0000 INFO:Setup completed successfully.
2025-12-07 10:41:54 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 INFO:Running first load function.
2025-12-07 10:41:54 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:41:54 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:41:54 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:41:54 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:41:54 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:41:54 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:41:54 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:41:54 +0000 INFO:firstload executed successfully
2025-12-07 10:41:54 +0000 INFO:Data first load completed successfully.
2025-12-07 10:41:54 +0000 INFO:initialise_data executed successfully
2025-12-07 10:41:54 +0000 INFO:Running Menu setup...
2025-12-07 10:41:54 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 INFO:get_git_version executed successfully
2025-12-07 10:41:54 +0000 INFO:App Version: v50.228
2025-12-07 10:41:54 +0000 INFO:Switched to page: Cash Donations
2025-12-07 10:41:54 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:41:54 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:41:54 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:41:55 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:41:55 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2025-12-07 10:41:55 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 DEBUG:Not logged in as admin.
2025-12-07 10:41:55 +0000 INFO:manage_text_elements executed successfully
2025-12-07 10:41:55 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:41:55 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:41:55 +0000 INFO:display_data_page executed successfully
2025-12-07 10:41:55 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:41:55 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:41:55 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:41:55 +0000 DEBUG:Page texts: {}
2025-12-07 10:41:55 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:41:55 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:41:56 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:41:56 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:41:56 +0000 INFO:pagesetup executed successfully
2025-12-07 10:41:56 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:41:56 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:02 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:02 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:02 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:02 +0000 INFO:Running App setup...
2025-12-07 10:42:02 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:Setting up the package
2025-12-07 10:42:02 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:02 +0000 INFO:Version: v50.190
2025-12-07 10:42:02 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:02 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:02 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:02 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:02 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:02 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:02 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:02 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:02 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:02 +0000 DEBUG:data_dir: data
2025-12-07 10:42:02 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:02 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:02 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:02 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:02 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:02 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:02 +0000 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations at 0x000001853D7AC1F0>}
2025-12-07 10:42:02 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:02 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:02 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:02 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:02 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:02 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:02 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:02 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:02 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:02 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:02 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:02 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:02 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:02 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:02 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:02 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:02 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:02 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:02 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:02 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:02 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:02 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:02 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:02 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:02 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:02 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:02 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:02 +0000 DEBUG:components_dir: components
2025-12-07 10:42:02 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:02 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:02 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:02 +0000 DEBUG:output_dir: output
2025-12-07 10:42:02 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:02 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:02 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:02 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:02 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:02 +0000 INFO:Session state Setup complete
2025-12-07 10:42:02 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:02 +0000 INFO:Package setup complete
2025-12-07 10:42:02 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:02 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:02 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:Running first load function.
2025-12-07 10:42:02 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:02 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:02 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:02 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:02 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:02 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:02 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:02 +0000 INFO:firstload executed successfully
2025-12-07 10:42:02 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:02 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:02 +0000 INFO:Running Menu setup...
2025-12-07 10:42:02 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:02 +0000 INFO:App Version: v50.228
2025-12-07 10:42:02 +0000 INFO:Switched to page: Non Cash Donations
2025-12-07 10:42:02 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:42:02 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:02 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:02 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:02 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:02 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:02 +0000 INFO:display_data_page executed successfully
2025-12-07 10:42:02 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:02 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:03 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:03 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:03 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:03 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:03 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:03 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:03 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:03 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:03 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:03 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:03 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:03 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:04 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:04 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:04 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:04 +0000 INFO:Running App setup...
2025-12-07 10:42:04 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:04 +0000 INFO:Setting up the package
2025-12-07 10:42:04 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:04 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:04 +0000 INFO:Version: v50.190
2025-12-07 10:42:04 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:04 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:04 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:04 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:04 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:04 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:04 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:04 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:04 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:04 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:04 +0000 DEBUG:data_dir: data
2025-12-07 10:42:04 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:04 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:04 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:04 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:04 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:04 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:04 +0000 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations at 0x000001853D7AC280>}
2025-12-07 10:42:04 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:04 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:04 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:04 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:04 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:04 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:04 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:04 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:04 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:04 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:04 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:04 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:04 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:04 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:04 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:04 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:04 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:04 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:04 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:04 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:04 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:04 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:04 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:04 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:04 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:04 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:04 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:04 +0000 DEBUG:components_dir: components
2025-12-07 10:42:04 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:04 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:04 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:04 +0000 DEBUG:output_dir: output
2025-12-07 10:42:04 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:04 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:04 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:04 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:04 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:04 +0000 INFO:Session state Setup complete
2025-12-07 10:42:04 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:04 +0000 INFO:Package setup complete
2025-12-07 10:42:04 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:04 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:04 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:04 +0000 INFO:Running first load function.
2025-12-07 10:42:04 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:04 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:04 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:04 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:04 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:04 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:04 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:04 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:04 +0000 INFO:firstload executed successfully
2025-12-07 10:42:04 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:04 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:04 +0000 INFO:Running Menu setup...
2025-12-07 10:42:04 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:04 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:04 +0000 INFO:App Version: v50.228
2025-12-07 10:42:04 +0000 INFO:Switched to page: Public Fund Donations
2025-12-07 10:42:04 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:04 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:42:05 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:05 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:05 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:05 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:05 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:05 +0000 INFO:display_data_page executed successfully
2025-12-07 10:42:05 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:05 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:05 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:05 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:05 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:05 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:05 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:05 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:05 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:05 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:08 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:08 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:08 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:08 +0000 INFO:Running App setup...
2025-12-07 10:42:08 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:Setting up the package
2025-12-07 10:42:08 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:08 +0000 INFO:Version: v50.190
2025-12-07 10:42:08 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:08 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:08 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:08 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:08 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:08 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:08 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:08 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:08 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:08 +0000 DEBUG:data_dir: data
2025-12-07 10:42:08 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:08 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:08 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:08 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:08 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:08 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:08 +0000 DEBUG:menu_selection: {'title': 'Bequests', 'function': <function mod_bequeths at 0x000001853D76BD90>}
2025-12-07 10:42:08 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:08 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:08 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:08 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:08 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:08 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:08 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:08 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:08 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:08 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:08 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:08 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:08 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:08 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:08 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:08 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:08 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:08 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:08 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:08 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:08 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:08 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:08 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:08 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:08 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:08 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:08 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:08 +0000 DEBUG:components_dir: components
2025-12-07 10:42:08 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:08 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:08 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:08 +0000 DEBUG:output_dir: output
2025-12-07 10:42:08 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:08 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:08 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:08 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:08 +0000 INFO:Session state Setup complete
2025-12-07 10:42:08 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:08 +0000 INFO:Package setup complete
2025-12-07 10:42:08 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:08 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:08 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:Running first load function.
2025-12-07 10:42:08 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:08 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:08 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:08 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:08 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:08 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:08 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:08 +0000 INFO:firstload executed successfully
2025-12-07 10:42:08 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:08 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:08 +0000 INFO:Running Menu setup...
2025-12-07 10:42:08 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:08 +0000 INFO:App Version: v50.228
2025-12-07 10:42:08 +0000 INFO:Switched to page: Bequests
2025-12-07 10:42:08 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:42:08 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:08 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:08 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:08 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:08 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:08 +0000 INFO:display_data_page executed successfully
2025-12-07 10:42:08 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:08 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:09 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:09 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:09 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:09 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:09 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:09 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:09 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:09 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:09 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:09 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:09 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:09 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:10 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:10 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:10 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:10 +0000 INFO:Running App setup...
2025-12-07 10:42:10 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 INFO:Setting up the package
2025-12-07 10:42:10 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:10 +0000 INFO:Version: v50.190
2025-12-07 10:42:10 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:10 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:10 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:10 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:10 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:10 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:10 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:10 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:10 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:10 +0000 DEBUG:data_dir: data
2025-12-07 10:42:10 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:10 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:10 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:10 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:10 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:10 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:10 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x000001853D76BE20>}
2025-12-07 10:42:10 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:10 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:10 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:10 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:10 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:10 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:10 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:10 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:10 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:10 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:10 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:10 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:10 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:10 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:10 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:10 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:10 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:10 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:10 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:10 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:10 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:10 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:10 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:10 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:10 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:10 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:10 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:10 +0000 DEBUG:components_dir: components
2025-12-07 10:42:10 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:10 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:10 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:10 +0000 DEBUG:output_dir: output
2025-12-07 10:42:10 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:10 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:10 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:10 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:10 +0000 INFO:Session state Setup complete
2025-12-07 10:42:10 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:10 +0000 INFO:Package setup complete
2025-12-07 10:42:10 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:10 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:10 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 INFO:Running first load function.
2025-12-07 10:42:10 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:10 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:10 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:10 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:10 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:10 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:10 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:10 +0000 INFO:firstload executed successfully
2025-12-07 10:42:10 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:10 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:10 +0000 INFO:Running Menu setup...
2025-12-07 10:42:10 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:10 +0000 INFO:App Version: v50.228
2025-12-07 10:42:10 +0000 INFO:Switched to page: Corporate Donations
2025-12-07 10:42:10 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:42:10 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:10 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:10 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:10 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:10 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:10 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:11 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:11 +0000 INFO:display_data_page executed successfully
2025-12-07 10:42:11 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:11 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:11 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:11 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:11 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:11 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:11 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:11 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:11 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:11 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:11 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:11 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:11 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:14 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:14 +0000 INFO:Running App setup...
2025-12-07 10:42:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:Setting up the package
2025-12-07 10:42:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:14 +0000 INFO:Version: v50.190
2025-12-07 10:42:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:14 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:14 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:14 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:14 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:14 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:14 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:14 +0000 DEBUG:data_dir: data
2025-12-07 10:42:14 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:14 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:14 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:14 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:14 +0000 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorships at 0x000001853D76BD00>}
2025-12-07 10:42:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:14 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:14 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:14 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:14 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:14 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:14 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:14 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:14 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:14 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:14 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:14 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:14 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:14 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:14 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:14 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:14 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:14 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:14 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:14 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:14 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:14 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:14 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:14 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:14 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:14 +0000 DEBUG:components_dir: components
2025-12-07 10:42:14 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:14 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:14 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:14 +0000 DEBUG:output_dir: output
2025-12-07 10:42:14 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:14 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:14 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:14 +0000 INFO:Session state Setup complete
2025-12-07 10:42:14 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:14 +0000 INFO:Package setup complete
2025-12-07 10:42:14 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:14 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:14 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:Running first load function.
2025-12-07 10:42:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:14 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:14 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:14 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:14 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:14 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:14 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:14 +0000 INFO:firstload executed successfully
2025-12-07 10:42:14 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:14 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:14 +0000 INFO:Running Menu setup...
2025-12-07 10:42:14 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:14 +0000 INFO:App Version: v50.228
2025-12-07 10:42:14 +0000 INFO:Switched to page: Sponsorships
2025-12-07 10:42:14 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:42:14 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:14 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:14 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:14 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:14 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:14 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:14 +0000 INFO:display_data_page executed successfully
2025-12-07 10:42:14 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:15 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:15 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:15 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:15 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:15 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:15 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:15 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:15 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:15 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:15 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:15 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:15 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:15 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:16 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:16 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:16 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:16 +0000 INFO:Running App setup...
2025-12-07 10:42:16 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:Setting up the package
2025-12-07 10:42:17 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:17 +0000 INFO:Version: v50.190
2025-12-07 10:42:17 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:17 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:17 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:17 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:17 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:17 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:17 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:17 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:17 +0000 DEBUG:data_dir: data
2025-12-07 10:42:17 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:17 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:17 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:17 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:17 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:17 +0000 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits at 0x000001853D76B760>}
2025-12-07 10:42:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:17 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:17 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:17 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:17 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:17 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:17 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:17 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:17 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:17 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:17 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:17 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:17 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:17 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:17 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:17 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:17 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:17 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:17 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:17 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:17 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:17 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:17 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:17 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:17 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:17 +0000 DEBUG:components_dir: components
2025-12-07 10:42:17 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:17 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:17 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:17 +0000 DEBUG:output_dir: output
2025-12-07 10:42:17 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:17 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:17 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:17 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:17 +0000 INFO:Session state Setup complete
2025-12-07 10:42:17 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:17 +0000 INFO:Package setup complete
2025-12-07 10:42:17 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:17 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:Running first load function.
2025-12-07 10:42:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:17 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:17 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:17 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:17 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:17 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:17 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:17 +0000 INFO:firstload executed successfully
2025-12-07 10:42:17 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:17 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:17 +0000 INFO:Running Menu setup...
2025-12-07 10:42:17 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:17 +0000 INFO:App Version: v50.228
2025-12-07 10:42:17 +0000 INFO:Switched to page: Paid Visits
2025-12-07 10:42:17 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:42:17 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:17 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:17 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:17 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:17 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:17 +0000 INFO:display_data_page executed successfully
2025-12-07 10:42:17 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:17 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:17 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:17 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:17 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:17 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:18 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:18 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:18 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:18 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:18 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:19 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:19 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:19 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:19 +0000 INFO:Running App setup...
2025-12-07 10:42:19 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 INFO:Setting up the package
2025-12-07 10:42:19 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:19 +0000 INFO:Version: v50.190
2025-12-07 10:42:19 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:19 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:19 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:19 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:19 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:19 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:19 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:19 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:19 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:19 +0000 DEBUG:data_dir: data
2025-12-07 10:42:19 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:19 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:19 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:19 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:19 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:19 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:19 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001853D7AC0D0>}
2025-12-07 10:42:19 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:19 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:19 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:19 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:19 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:19 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:19 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:19 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:19 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:19 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:19 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:19 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:19 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:19 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:19 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:19 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:19 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:19 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:19 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:19 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:19 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:19 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:19 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:19 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:19 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:19 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:19 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:19 +0000 DEBUG:components_dir: components
2025-12-07 10:42:19 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:19 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:19 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:19 +0000 DEBUG:output_dir: output
2025-12-07 10:42:19 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:19 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:19 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:19 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:19 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:19 +0000 INFO:Session state Setup complete
2025-12-07 10:42:19 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:19 +0000 INFO:Package setup complete
2025-12-07 10:42:19 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:19 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:19 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 INFO:Running first load function.
2025-12-07 10:42:19 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:19 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:19 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:19 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:19 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:19 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:19 +0000 INFO:firstload executed successfully
2025-12-07 10:42:19 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:19 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:19 +0000 INFO:Running Menu setup...
2025-12-07 10:42:19 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:19 +0000 INFO:App Version: v50.228
2025-12-07 10:42:19 +0000 INFO:Switched to page: Dubious Donors
2025-12-07 10:42:19 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:42:19 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:19 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:19 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:19 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:19 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:19 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:20 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:20 +0000 INFO:display_data_page executed successfully
2025-12-07 10:42:20 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:20 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:20 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:20 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:20 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:20 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:20 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:20 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:20 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:20 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:20 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:20 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:20 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:20 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:22 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:22 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:22 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:22 +0000 INFO:Running App setup...
2025-12-07 10:42:22 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 INFO:Setting up the package
2025-12-07 10:42:22 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:22 +0000 INFO:Version: v50.190
2025-12-07 10:42:22 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:22 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:22 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:22 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:22 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:22 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:22 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:22 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:22 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:22 +0000 DEBUG:data_dir: data
2025-12-07 10:42:22 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:22 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:22 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:22 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:22 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:22 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:22 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000001853D76BEB0>}
2025-12-07 10:42:22 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:22 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:22 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:22 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:22 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:22 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:22 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:22 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:22 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:22 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:22 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:22 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:22 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:22 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:22 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:22 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:22 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:22 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:22 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:22 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:22 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:22 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:22 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:22 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:22 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:22 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:22 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:22 +0000 DEBUG:components_dir: components
2025-12-07 10:42:22 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:22 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:22 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:22 +0000 DEBUG:output_dir: output
2025-12-07 10:42:22 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:22 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:22 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:22 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:22 +0000 INFO:Session state Setup complete
2025-12-07 10:42:22 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:22 +0000 INFO:Package setup complete
2025-12-07 10:42:22 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:22 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:22 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 INFO:Running first load function.
2025-12-07 10:42:22 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:22 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:22 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:22 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:22 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:22 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:22 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:22 +0000 INFO:firstload executed successfully
2025-12-07 10:42:22 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:22 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:22 +0000 INFO:Running Menu setup...
2025-12-07 10:42:22 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:22 +0000 INFO:App Version: v50.228
2025-12-07 10:42:22 +0000 INFO:Switched to page: Dubious Donations
2025-12-07 10:42:22 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:42:22 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:22 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:22 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:22 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:22 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:22 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:23 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:23 +0000 INFO:display_data_page executed successfully
2025-12-07 10:42:23 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:23 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:23 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:23 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:23 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:23 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:23 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:23 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:23 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:23 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:23 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:23 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:23 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:23 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:24 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:24 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:24 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:24 +0000 INFO:Running App setup...
2025-12-07 10:42:24 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:24 +0000 INFO:Setting up the package
2025-12-07 10:42:24 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:24 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:24 +0000 INFO:Version: v50.190
2025-12-07 10:42:24 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:24 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:24 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:24 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:24 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:24 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 10:42:24 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:24 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:24 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:24 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:24 +0000 DEBUG:data_dir: data
2025-12-07 10:42:24 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:24 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:24 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:24 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:24 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:24 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:24 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001853D76BF40>}
2025-12-07 10:42:24 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:24 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:24 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:24 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:24 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:24 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:24 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:24 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:24 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:24 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:24 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:24 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:24 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:24 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:24 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:24 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:24 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:24 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:24 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:24 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:24 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:24 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:24 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:24 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:24 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:24 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:24 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:24 +0000 DEBUG:components_dir: components
2025-12-07 10:42:24 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:24 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:24 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:24 +0000 DEBUG:output_dir: output
2025-12-07 10:42:24 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:24 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:24 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:24 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:24 +0000 INFO:Session state Setup complete
2025-12-07 10:42:24 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:24 +0000 INFO:Package setup complete
2025-12-07 10:42:24 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:24 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:24 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:24 +0000 INFO:Running first load function.
2025-12-07 10:42:24 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:24 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:24 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:24 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:24 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:24 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:24 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:24 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:24 +0000 INFO:firstload executed successfully
2025-12-07 10:42:24 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:24 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:24 +0000 INFO:Running Menu setup...
2025-12-07 10:42:24 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:24 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:24 +0000 INFO:App Version: v50.228
2025-12-07 10:42:24 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:42:24 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:25 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:25 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:25 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:25 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:25 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:25 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:25 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:25 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:25 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:25 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:25 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:25 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:25 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:29 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:29 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:29 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:29 +0000 INFO:Running App setup...
2025-12-07 10:42:29 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 INFO:Setting up the package
2025-12-07 10:42:29 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:29 +0000 INFO:Version: v50.190
2025-12-07 10:42:29 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:29 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:29 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:29 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:29 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:42:29 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:29 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:29 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:29 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:29 +0000 DEBUG:data_dir: data
2025-12-07 10:42:29 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:29 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:29 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:29 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:29 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:29 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:29 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001853D76BF40>}
2025-12-07 10:42:29 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:29 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:29 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:42:29 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:29 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:29 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:29 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:29 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:29 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:29 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:29 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:29 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:29 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:29 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:29 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:29 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:29 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:29 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:29 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:29 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:29 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:29 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:29 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:29 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:29 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:29 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:29 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:29 +0000 DEBUG:components_dir: components
2025-12-07 10:42:29 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:29 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:29 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:29 +0000 DEBUG:output_dir: output
2025-12-07 10:42:29 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:29 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:29 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:29 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:29 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:29 +0000 INFO:Session state Setup complete
2025-12-07 10:42:29 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:29 +0000 INFO:Package setup complete
2025-12-07 10:42:29 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:29 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:29 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 INFO:Running first load function.
2025-12-07 10:42:29 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:29 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:29 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:29 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:29 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:29 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:29 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:29 +0000 INFO:firstload executed successfully
2025-12-07 10:42:29 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:29 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:29 +0000 INFO:Running Menu setup...
2025-12-07 10:42:29 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:29 +0000 INFO:App Version: v50.228
2025-12-07 10:42:29 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:42:29 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:29 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:29 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:29 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:29 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:29 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:29 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:29 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:29 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:29 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:32 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:32 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:32 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:32 +0000 INFO:Running App setup...
2025-12-07 10:42:32 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:32 +0000 INFO:Setting up the package
2025-12-07 10:42:32 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:32 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:32 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:32 +0000 INFO:Version: v50.190
2025-12-07 10:42:32 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:32 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:32 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:32 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:32 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:32 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:42:32 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:32 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:32 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:32 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:32 +0000 DEBUG:data_dir: data
2025-12-07 10:42:32 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:32 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:32 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:32 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:32 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:32 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:32 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001853D76BF40>}
2025-12-07 10:42:32 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:32 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:32 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:33 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:33 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 10:42:33 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:33 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:33 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:33 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:33 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:33 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:33 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:33 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:33 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:33 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:33 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:33 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:33 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:33 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:33 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:33 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:33 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:33 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:33 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:33 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:33 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:33 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:33 +0000 DEBUG:components_dir: components
2025-12-07 10:42:33 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:33 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:33 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:33 +0000 DEBUG:output_dir: output
2025-12-07 10:42:33 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:33 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:33 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:33 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:33 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:33 +0000 INFO:Session state Setup complete
2025-12-07 10:42:33 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:33 +0000 INFO:Package setup complete
2025-12-07 10:42:33 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:33 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:33 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 INFO:Running first load function.
2025-12-07 10:42:33 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:33 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:33 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:33 +0000 INFO:firstload executed successfully
2025-12-07 10:42:33 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:33 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:33 +0000 INFO:Running Menu setup...
2025-12-07 10:42:33 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:33 +0000 INFO:App Version: v50.228
2025-12-07 10:42:33 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:42:33 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:33 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:42:33 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 DEBUG:Page texts: {}
2025-12-07 10:42:33 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:42:33 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:42:33 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:42:33 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:42:33 +0000 INFO:pagesetup executed successfully
2025-12-07 10:42:33 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:42:33 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:42:48 +0000 INFO:Streamlit App Starting...
2025-12-07 10:42:48 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:48 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:42:48 +0000 INFO:Running App setup...
2025-12-07 10:42:48 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 INFO:Setting up the package
2025-12-07 10:42:48 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:42:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:48 +0000 INFO:Version: v50.190
2025-12-07 10:42:48 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:48 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:security already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:directories already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:42:48 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:42:48 +0000 INFO:Session_state variables initialized
2025-12-07 10:42:48 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:42:48 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:42:48 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:42:48 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:42:48 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:42:48 +0000 DEBUG:data_dir: data
2025-12-07 10:42:48 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:42:48 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:42:48 +0000 DEBUG:utils_dir: utils
2025-12-07 10:42:48 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:42:48 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:42:48 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:42:48 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001853D76BF40>}
2025-12-07 10:42:48 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:42:48 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:42:48 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:42:48 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:42:48 +0000 DEBUG:selected_entity_name: Reform UK
2025-12-07 10:42:48 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:42:48 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:42:48 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:42:48 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:42:48 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:42:48 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:42:48 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:42:48 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:42:48 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:42:48 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:42:48 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:42:48 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:42:48 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:42:48 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:42:48 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:42:48 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:42:48 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:42:48 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:42:48 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:42:48 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:42:48 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:42:48 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:42:48 +0000 DEBUG:components_dir: components
2025-12-07 10:42:48 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:42:48 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:42:48 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:42:48 +0000 DEBUG:output_dir: output
2025-12-07 10:42:48 +0000 DEBUG:logs_dir: logs
2025-12-07 10:42:48 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:42:48 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:42:48 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:42:48 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:42:48 +0000 INFO:Session state Setup complete
2025-12-07 10:42:48 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:42:48 +0000 INFO:Package setup complete
2025-12-07 10:42:48 +0000 INFO:setup_package executed successfully
2025-12-07 10:42:48 +0000 INFO:Setup completed successfully.
2025-12-07 10:42:48 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 INFO:Running first load function.
2025-12-07 10:42:48 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:48 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:42:48 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:48 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:48 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:42:48 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:42:48 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:42:48 +0000 INFO:firstload executed successfully
2025-12-07 10:42:48 +0000 INFO:Data first load completed successfully.
2025-12-07 10:42:48 +0000 INFO:initialise_data executed successfully
2025-12-07 10:42:48 +0000 INFO:Running Menu setup...
2025-12-07 10:42:48 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 INFO:get_git_version executed successfully
2025-12-07 10:42:48 +0000 INFO:App Version: v50.228
2025-12-07 10:42:48 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:42:48 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:42:48 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:42:48 +0000 ERROR:Error in display_textual_insights_predefined: 'unique_donations'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 153, in display_textual_insights_predefined
    st.write(f"* Between {min_date} and {max_date}, {format_number(tstats['unique_donations'])} {target_label}s "
KeyError: 'unique_donations'
2025-12-07 10:42:48 +0000 CRITICAL:Menu setup crashed: 'unique_donations'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 50, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 93, in mod_donations_per_political_party
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 55, in display_per_group_data_page
    display_textual_insights_predefined(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 153, in display_textual_insights_predefined
    st.write(f"* Between {min_date} and {max_date}, {format_number(tstats['unique_donations'])} {target_label}s "
KeyError: 'unique_donations'
2025-12-07 10:43:18 +0000 INFO:Streamlit App Starting...
2025-12-07 10:43:18 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:43:18 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:43:18 +0000 INFO:Running App setup...
2025-12-07 10:43:18 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 INFO:Setting up the package
2025-12-07 10:43:18 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:43:18 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 INFO:get_git_version executed successfully
2025-12-07 10:43:18 +0000 INFO:Version: v50.190
2025-12-07 10:43:18 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:43:18 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:security already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:directories already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:43:18 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:43:18 +0000 INFO:Session_state variables initialized
2025-12-07 10:43:18 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:43:18 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:43:18 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:43:18 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:43:18 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:43:18 +0000 DEBUG:data_dir: data
2025-12-07 10:43:18 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:43:18 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:43:18 +0000 DEBUG:utils_dir: utils
2025-12-07 10:43:18 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:43:18 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:43:18 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:43:18 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001853D76BF40>}
2025-12-07 10:43:18 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:43:18 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:43:18 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:43:18 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:43:18 +0000 DEBUG:selected_entity_name: Green Party
2025-12-07 10:43:18 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:43:18 +0000 DEBUG:load_donorlist_data_last_modified: 1765103751.4579606
2025-12-07 10:43:18 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:43:18 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:43:18 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:43:18 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:43:18 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:43:18 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:43:18 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:43:18 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:43:18 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:43:18 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:43:18 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:43:18 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:43:18 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:43:18 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:43:18 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:43:18 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:43:18 +0000 DEBUG:load_raw_data_last_modified: 1765103746.229115
2025-12-07 10:43:18 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:43:18 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:43:18 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:43:18 +0000 DEBUG:error_logged: True
2025-12-07 10:43:18 +0000 DEBUG:components_dir: components
2025-12-07 10:43:18 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:43:18 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:43:18 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:43:18 +0000 DEBUG:output_dir: output
2025-12-07 10:43:18 +0000 DEBUG:logs_dir: logs
2025-12-07 10:43:18 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:43:18 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:43:18 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:43:18 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:43:18 +0000 INFO:Session state Setup complete
2025-12-07 10:43:18 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:43:18 +0000 INFO:Package setup complete
2025-12-07 10:43:18 +0000 INFO:setup_package executed successfully
2025-12-07 10:43:18 +0000 INFO:Setup completed successfully.
2025-12-07 10:43:18 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 INFO:Running first load function.
2025-12-07 10:43:18 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:43:18 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:43:18 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:43:18 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:43:18 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:43:18 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:43:18 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:43:18 +0000 INFO:firstload executed successfully
2025-12-07 10:43:18 +0000 INFO:Data first load completed successfully.
2025-12-07 10:43:18 +0000 INFO:initialise_data executed successfully
2025-12-07 10:43:18 +0000 INFO:Running Menu setup...
2025-12-07 10:43:18 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 INFO:get_git_version executed successfully
2025-12-07 10:43:18 +0000 INFO:App Version: v50.228
2025-12-07 10:43:18 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:43:18 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:43:18 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:43:18 +0000 CRITICAL:Menu setup crashed: 'unique_donations'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 50, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 93, in mod_donations_per_political_party
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 55, in display_per_group_data_page
    display_textual_insights_predefined(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 153, in display_textual_insights_predefined
    st.write(f"* Between {min_date} and {max_date}, {format_number(tstats['unique_donations'])} {target_label}s "
KeyError: 'unique_donations'
2025-12-07 10:46:35 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 10:46:35 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:36 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:36 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:36 +0000 INFO:Streamlit App Starting...
2025-12-07 10:46:36 +0000 INFO:Streamlit App Starting...
2025-12-07 10:46:36 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:46:36 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:46:36 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:46:36 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:46:36 +0000 INFO:Running App setup...
2025-12-07 10:46:36 +0000 INFO:Running App setup...
2025-12-07 10:46:36 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:46:36 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:46:36 +0000 INFO:Setting up the package
2025-12-07 10:46:36 +0000 INFO:Setting up the package
2025-12-07 10:46:36 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:46:36 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:46:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:37 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:37 +0000 INFO:Version: v50.190
2025-12-07 10:46:37 +0000 INFO:Version: v50.190
2025-12-07 10:46:37 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:46:37 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:46:37 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:46:37 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 10:46:37 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:46:37 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:46:37 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:46:37 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 10:46:37 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:46:37 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 10:46:37 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:46:37 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:46:37 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:46:37 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:46:37 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:46:37 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:46:37 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:46:37 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:46:37 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:46:37 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 10:46:37 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:46:37 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 10:46:37 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:46:37 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:46:37 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:46:37 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 10:46:37 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:46:37 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 10:46:37 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:46:37 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 10:46:37 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:46:37 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 10:46:37 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:46:37 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 10:46:37 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:46:37 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 10:46:37 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:46:37 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 10:46:37 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:46:37 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 10:46:37 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:46:37 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 10:46:37 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:46:37 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 10:46:37 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:37 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:46:37 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 10:46:37 +0000 INFO:Session_state variables initialized
2025-12-07 10:46:37 +0000 INFO:Session_state variables initialized
2025-12-07 10:46:37 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:46:37 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:46:37 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:46:37 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:46:37 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:46:37 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:46:37 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:46:37 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:46:37 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:37 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:37 +0000 DEBUG:output_dir: output
2025-12-07 10:46:37 +0000 DEBUG:output_dir: output
2025-12-07 10:46:37 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:46:37 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:46:37 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:46:37 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:46:37 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:46:37 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:46:37 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:46:37 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:46:37 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:46:37 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:46:37 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:46:37 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:46:37 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:46:37 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:46:37 +0000 DEBUG:data_dir: data
2025-12-07 10:46:37 +0000 DEBUG:data_dir: data
2025-12-07 10:46:37 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:46:37 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:46:37 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:46:37 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:46:37 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:46:37 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:46:37 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:46:37 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:46:37 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:46:37 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:46:37 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:46:37 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:46:37 +0000 DEBUG:components_dir: components
2025-12-07 10:46:37 +0000 DEBUG:components_dir: components
2025-12-07 10:46:37 +0000 DEBUG:logs_dir: logs
2025-12-07 10:46:37 +0000 DEBUG:logs_dir: logs
2025-12-07 10:46:37 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:46:37 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:46:37 +0000 DEBUG:utils_dir: utils
2025-12-07 10:46:37 +0000 DEBUG:utils_dir: utils
2025-12-07 10:46:37 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:46:37 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:46:37 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:46:37 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:46:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:46:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:46:37 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:46:37 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:46:37 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:46:37 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:46:37 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:46:37 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:46:37 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:46:37 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:46:37 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:46:37 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:46:37 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:46:37 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:46:37 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:46:37 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:46:37 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:46:37 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:46:37 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:46:37 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:46:37 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:46:37 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:46:37 +0000 INFO:Session state Setup complete
2025-12-07 10:46:37 +0000 INFO:Session state Setup complete
2025-12-07 10:46:37 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:46:37 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:46:37 +0000 INFO:Package setup complete
2025-12-07 10:46:37 +0000 INFO:Package setup complete
2025-12-07 10:46:37 +0000 INFO:setup_package executed successfully
2025-12-07 10:46:37 +0000 INFO:setup_package executed successfully
2025-12-07 10:46:37 +0000 INFO:Setup completed successfully.
2025-12-07 10:46:37 +0000 INFO:Setup completed successfully.
2025-12-07 10:46:37 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:37 +0000 INFO:Running first load function.
2025-12-07 10:46:37 +0000 INFO:Running first load function.
2025-12-07 10:46:37 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 10:46:37 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 10:46:37 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:37 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 10:46:37 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 10:46:37 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:37 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:46:37 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 10:46:37 +0000 INFO:Last modification time: 1765103746.229115
2025-12-07 10:46:37 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:46:37 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765103746.229115 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:37 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 10:46:37 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:46:37 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 10:46:37 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 INFO:Cleaning up raw data
2025-12-07 10:46:37 +0000 ERROR:Session state variables not initialized!
2025-12-07 10:46:37 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:37 +0000 INFO:Original file path: None
2025-12-07 10:46:37 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 10:46:37 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 10:46:37 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:46:37 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 10:46:39 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:46:39 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:46:39 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:46:39 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 10:46:39 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 10:46:39 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:46:39 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 10:46:39 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 10:46:40 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 10:46:40 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 10:46:40 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 10:46:40 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 10:46:40 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:46:40 +0000 INFO:Data shape: (91651, 37)
2025-12-07 10:46:41 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 10:46:41 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 10:46:41 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 10:46:41 +0000 INFO:load_raw_data executed successfully
2025-12-07 10:46:42 +0000 INFO:get_raw_data executed successfully
2025-12-07 10:46:42 +0000 INFO:get_raw_data executed successfully
2025-12-07 10:46:42 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:46:42 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:46:42 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:42 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:42 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:42 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 10:46:42 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:42 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 10:46:42 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 10:46:42 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:46:42 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 10:46:42 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:46:42 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 10:46:42 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:46:42 +0000 INFO:Current modification time: 1765104401.7030835
2025-12-07 10:46:42 +0000 INFO:Last modification time: 1765103746.229115
2025-12-07 10:46:42 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:46:42 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:46:42 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 10:46:42 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 10:46:42 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 10:46:42 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 10:46:44 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 10:46:44 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 10:46:44 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:46:44 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 10:46:44 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:46:44 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 10:46:44 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 10:46:44 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 10:46:44 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 10:46:44 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 10:46:44 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 10:46:44 +0000 INFO:Loading election dates from pdpy.
2025-12-07 10:46:44 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 10:46:44 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 10:46:44 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 10:46:44 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 10:46:44 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 10:46:44 +0000 INFO:load_election_dates executed successfully
2025-12-07 10:46:44 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 10:46:44 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 10:46:47 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 10:46:47 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 10:46:47 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:46:47 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 10:46:47 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:46:47 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:46:47 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 10:46:47 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:46:47 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:46:47 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:46:47 +0000 INFO:Current modification time: 1765104407.016888
2025-12-07 10:46:47 +0000 INFO:Last modification time: 1765103751.4579606
2025-12-07 10:46:47 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:46:47 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:46:47 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 10:46:47 +0000 INFO:Donor Data summary completed
2025-12-07 10:46:47 +0000 INFO:Data shape: (31905, 5)
2025-12-07 10:46:47 +0000 INFO:load_donorList_data executed successfully
2025-12-07 10:46:47 +0000 INFO:get_donor_data executed successfully
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:46:47 +0000 INFO:get_donor_data executed successfully
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:46:47 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:46:47 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 10:46:47 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 10:46:47 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 10:46:47 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 10:46:47 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 10:46:47 +0000 INFO:Current modification time: 1765104407.016888
2025-12-07 10:46:47 +0000 INFO:Last modification time: 1765104407.016888
2025-12-07 10:46:47 +0000 INFO:is_file_updated executed successfully
2025-12-07 10:46:47 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765104407.016888 instead of output\cleaned_data.csv
2025-12-07 10:46:47 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 10:46:47 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 10:46:47 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 10:46:47 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 10:46:47 +0000 INFO:Raw Data cleanup completed
2025-12-07 10:46:47 +0000 INFO:Data shape: (1719, 6)
2025-12-07 10:46:47 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 10:46:47 +0000 INFO:get_regentity_data executed successfully
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:46:47 +0000 INFO:get_regentity_data executed successfully
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:46:47 +0000 INFO:firstload executed successfully
2025-12-07 10:46:47 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:46:47 +0000 INFO:Data first load completed successfully.
2025-12-07 10:46:47 +0000 INFO:firstload executed successfully
2025-12-07 10:46:47 +0000 INFO:initialise_data executed successfully
2025-12-07 10:46:47 +0000 INFO:Data first load completed successfully.
2025-12-07 10:46:47 +0000 INFO:Running Menu setup...
2025-12-07 10:46:47 +0000 INFO:initialise_data executed successfully
2025-12-07 10:46:47 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:Running Menu setup...
2025-12-07 10:46:47 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:48 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:48 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:48 +0000 INFO:App Version: v50.228
2025-12-07 10:46:48 +0000 INFO:App Version: v50.228
2025-12-07 10:46:48 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:46:48 +0000 INFO:Switched to page: Introduction
2025-12-07 10:46:48 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:46:48 +0000 INFO:pagesetup executed successfully
2025-12-07 10:46:48 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:46:48 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:46:48 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:46:48 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:46:48 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:46:48 +0000 ERROR:Error in display_textual_insights_predefined: 'most_common_donor'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 164, in display_textual_insights_predefined
    st.write(f"* The most active donor of {target_label} was {tstats['most_common_donor'][0]}. "
KeyError: 'most_common_donor'
2025-12-07 10:46:48 +0000 CRITICAL:Menu setup crashed: 'most_common_donor'
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 50, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 93, in mod_donations_per_political_party
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 55, in display_per_group_data_page
    display_textual_insights_predefined(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 164, in display_textual_insights_predefined
    st.write(f"* The most active donor of {target_label} was {tstats['most_common_donor'][0]}. "
KeyError: 'most_common_donor'
2025-12-07 10:46:52 +0000 INFO:Streamlit App Starting...
2025-12-07 10:46:52 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:46:52 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:46:52 +0000 INFO:Running App setup...
2025-12-07 10:46:52 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:46:52 +0000 INFO:Setting up the package
2025-12-07 10:46:52 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:46:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:52 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:52 +0000 INFO:Version: v50.190
2025-12-07 10:46:52 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:46:52 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:46:52 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:security already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:directories already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:46:52 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:46:52 +0000 INFO:Session_state variables initialized
2025-12-07 10:46:52 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001E61C9D9A20>}
2025-12-07 10:46:52 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:46:52 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:46:52 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:46:52 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:46:52 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:52 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:46:52 +0000 DEBUG:output_dir: output
2025-12-07 10:46:52 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:46:52 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:46:53 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:46:53 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:46:53 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:46:53 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:46:53 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:46:53 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:46:53 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:46:53 +0000 DEBUG:data_dir: data
2025-12-07 10:46:53 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:46:53 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:46:53 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:46:53 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:46:53 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:46:53 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:46:53 +0000 DEBUG:components_dir: components
2025-12-07 10:46:53 +0000 DEBUG:logs_dir: logs
2025-12-07 10:46:53 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:46:53 +0000 DEBUG:utils_dir: utils
2025-12-07 10:46:53 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:46:53 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:46:53 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:46:53 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:46:53 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:46:53 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:46:53 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:46:53 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:46:53 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:46:53 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:46:53 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:46:53 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:46:53 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:46:53 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:46:53 +0000 INFO:Session state Setup complete
2025-12-07 10:46:53 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:46:53 +0000 INFO:Package setup complete
2025-12-07 10:46:53 +0000 INFO:setup_package executed successfully
2025-12-07 10:46:53 +0000 INFO:Setup completed successfully.
2025-12-07 10:46:53 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 INFO:Running first load function.
2025-12-07 10:46:53 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:46:53 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:46:53 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:46:53 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:46:53 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:46:53 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:46:53 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:46:53 +0000 INFO:firstload executed successfully
2025-12-07 10:46:53 +0000 INFO:Data first load completed successfully.
2025-12-07 10:46:53 +0000 INFO:initialise_data executed successfully
2025-12-07 10:46:53 +0000 INFO:Running Menu setup...
2025-12-07 10:46:53 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:53 +0000 INFO:App Version: v50.228
2025-12-07 10:46:53 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:46:53 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:46:53 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:46:53 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 DEBUG:Page texts: {}
2025-12-07 10:46:53 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:46:53 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:46:53 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:46:53 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:46:53 +0000 INFO:pagesetup executed successfully
2025-12-07 10:46:53 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:46:53 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:46:59 +0000 INFO:Streamlit App Starting...
2025-12-07 10:46:59 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:46:59 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:46:59 +0000 INFO:Running App setup...
2025-12-07 10:46:59 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 INFO:Setting up the package
2025-12-07 10:46:59 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:46:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:59 +0000 INFO:Version: v50.190
2025-12-07 10:46:59 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:46:59 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:security already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:directories already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:46:59 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:46:59 +0000 INFO:Session_state variables initialized
2025-12-07 10:46:59 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001E61C9D9A20>}
2025-12-07 10:46:59 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:46:59 +0000 DEBUG:selected_entity_name: All
2025-12-07 10:46:59 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:46:59 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:46:59 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:46:59 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:46:59 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:46:59 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:46:59 +0000 DEBUG:output_dir: output
2025-12-07 10:46:59 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:46:59 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:46:59 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:46:59 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:46:59 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:46:59 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:46:59 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:46:59 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:46:59 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:46:59 +0000 DEBUG:data_dir: data
2025-12-07 10:46:59 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:46:59 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:46:59 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:46:59 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:46:59 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:46:59 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:46:59 +0000 DEBUG:components_dir: components
2025-12-07 10:46:59 +0000 DEBUG:logs_dir: logs
2025-12-07 10:46:59 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:46:59 +0000 DEBUG:utils_dir: utils
2025-12-07 10:46:59 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:46:59 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:46:59 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:46:59 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:46:59 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:46:59 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:46:59 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:46:59 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:46:59 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:46:59 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:46:59 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:46:59 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:46:59 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:46:59 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:46:59 +0000 INFO:Session state Setup complete
2025-12-07 10:46:59 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:46:59 +0000 INFO:Package setup complete
2025-12-07 10:46:59 +0000 INFO:setup_package executed successfully
2025-12-07 10:46:59 +0000 INFO:Setup completed successfully.
2025-12-07 10:46:59 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 INFO:Running first load function.
2025-12-07 10:46:59 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:46:59 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:46:59 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:46:59 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:46:59 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:46:59 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:46:59 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:46:59 +0000 INFO:firstload executed successfully
2025-12-07 10:46:59 +0000 INFO:Data first load completed successfully.
2025-12-07 10:46:59 +0000 INFO:initialise_data executed successfully
2025-12-07 10:46:59 +0000 INFO:Running Menu setup...
2025-12-07 10:46:59 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 INFO:get_git_version executed successfully
2025-12-07 10:46:59 +0000 INFO:App Version: v50.228
2025-12-07 10:46:59 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:46:59 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:46:59 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:46:59 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 DEBUG:Page texts: {}
2025-12-07 10:46:59 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:46:59 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:46:59 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:46:59 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:46:59 +0000 INFO:pagesetup executed successfully
2025-12-07 10:46:59 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:46:59 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:47:05 +0000 INFO:Streamlit App Starting...
2025-12-07 10:47:05 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:05 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:47:05 +0000 INFO:Running App setup...
2025-12-07 10:47:05 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:47:05 +0000 INFO:Setting up the package
2025-12-07 10:47:05 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:05 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:05 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:05 +0000 INFO:Version: v50.190
2025-12-07 10:47:05 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:47:05 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:05 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:security already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:directories already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:47:05 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:47:05 +0000 INFO:Session_state variables initialized
2025-12-07 10:47:05 +0000 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party at 0x000001E61C9D9A20>}
2025-12-07 10:47:05 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:47:05 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:47:05 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:47:05 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:47:05 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:47:05 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:47:05 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:47:05 +0000 DEBUG:output_dir: output
2025-12-07 10:47:05 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:47:05 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:47:06 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:47:06 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:47:06 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:47:06 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:47:06 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:47:06 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:47:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:47:06 +0000 DEBUG:data_dir: data
2025-12-07 10:47:06 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:47:06 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 10:47:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:47:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:47:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:47:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:47:06 +0000 DEBUG:components_dir: components
2025-12-07 10:47:06 +0000 DEBUG:logs_dir: logs
2025-12-07 10:47:06 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:47:06 +0000 DEBUG:utils_dir: utils
2025-12-07 10:47:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:47:06 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:47:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:47:06 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:47:06 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:47:06 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:47:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:47:06 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:47:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:47:06 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:47:06 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:47:06 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:47:06 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:47:06 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:47:06 +0000 INFO:Session state Setup complete
2025-12-07 10:47:06 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:47:06 +0000 INFO:Package setup complete
2025-12-07 10:47:06 +0000 INFO:setup_package executed successfully
2025-12-07 10:47:06 +0000 INFO:Setup completed successfully.
2025-12-07 10:47:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 INFO:Running first load function.
2025-12-07 10:47:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:06 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:06 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:06 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:06 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:47:06 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:06 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:06 +0000 INFO:firstload executed successfully
2025-12-07 10:47:06 +0000 INFO:Data first load completed successfully.
2025-12-07 10:47:06 +0000 INFO:initialise_data executed successfully
2025-12-07 10:47:06 +0000 INFO:Running Menu setup...
2025-12-07 10:47:06 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:06 +0000 INFO:App Version: v50.228
2025-12-07 10:47:06 +0000 INFO:Switched to page: Donations by Political Party
2025-12-07 10:47:06 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:06 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:06 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:06 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:06 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:06 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:06 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:47:06 +0000 INFO:pagesetup executed successfully
2025-12-07 10:47:06 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:47:06 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:47:36 +0000 INFO:Streamlit App Starting...
2025-12-07 10:47:36 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:36 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:47:36 +0000 INFO:Running App setup...
2025-12-07 10:47:36 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:47:36 +0000 INFO:Setting up the package
2025-12-07 10:47:36 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:36 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:36 +0000 INFO:Version: v50.190
2025-12-07 10:47:36 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:47:36 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:36 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:security already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:directories already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:47:36 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:47:36 +0000 INFO:Session_state variables initialized
2025-12-07 10:47:36 +0000 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations at 0x000001E61C9D9990>}
2025-12-07 10:47:36 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:47:36 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:47:36 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:47:36 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:47:36 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:47:36 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:47:36 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:47:36 +0000 DEBUG:output_dir: output
2025-12-07 10:47:36 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:47:36 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:47:37 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:47:37 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:47:37 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:47:37 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:47:37 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:47:37 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:47:37 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:47:37 +0000 DEBUG:data_dir: data
2025-12-07 10:47:37 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:47:37 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 10:47:37 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:47:37 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:47:37 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:37 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:47:37 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:47:37 +0000 DEBUG:components_dir: components
2025-12-07 10:47:37 +0000 DEBUG:logs_dir: logs
2025-12-07 10:47:37 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:47:37 +0000 DEBUG:utils_dir: utils
2025-12-07 10:47:37 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:47:37 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:47:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:47:37 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:47:37 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:47:37 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:47:37 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:47:37 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:47:37 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:47:37 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:47:37 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:47:37 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:47:37 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:47:37 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:47:37 +0000 INFO:Session state Setup complete
2025-12-07 10:47:37 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:47:37 +0000 INFO:Package setup complete
2025-12-07 10:47:37 +0000 INFO:setup_package executed successfully
2025-12-07 10:47:37 +0000 INFO:Setup completed successfully.
2025-12-07 10:47:37 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:Running first load function.
2025-12-07 10:47:37 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:37 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:37 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:37 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:37 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:47:37 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:37 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:37 +0000 INFO:firstload executed successfully
2025-12-07 10:47:37 +0000 INFO:Data first load completed successfully.
2025-12-07 10:47:37 +0000 INFO:initialise_data executed successfully
2025-12-07 10:47:37 +0000 INFO:Running Menu setup...
2025-12-07 10:47:37 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:37 +0000 INFO:App Version: v50.228
2025-12-07 10:47:37 +0000 INFO:Switched to page: Dubious Donations
2025-12-07 10:47:37 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:47:37 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:37 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:37 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:37 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:37 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:37 +0000 INFO:display_data_page executed successfully
2025-12-07 10:47:37 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:37 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:37 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:37 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:37 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:37 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:37 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:47:37 +0000 INFO:pagesetup executed successfully
2025-12-07 10:47:37 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:47:37 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:47:40 +0000 INFO:Streamlit App Starting...
2025-12-07 10:47:40 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:40 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:47:40 +0000 INFO:Running App setup...
2025-12-07 10:47:40 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 INFO:Setting up the package
2025-12-07 10:47:40 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:40 +0000 INFO:Version: v50.190
2025-12-07 10:47:40 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:40 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:security already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:directories already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:47:40 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:47:40 +0000 INFO:Session_state variables initialized
2025-12-07 10:47:40 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000001E61C9D9B40>}
2025-12-07 10:47:40 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:47:40 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:47:40 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:47:40 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:47:40 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:47:40 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:47:40 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:47:40 +0000 DEBUG:output_dir: output
2025-12-07 10:47:40 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:47:40 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:47:40 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:47:40 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:47:40 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:47:40 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:47:40 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:47:40 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:47:40 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:47:40 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:47:40 +0000 DEBUG:data_dir: data
2025-12-07 10:47:40 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:47:40 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 10:47:40 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:47:40 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:47:40 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:40 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:47:40 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:47:40 +0000 DEBUG:components_dir: components
2025-12-07 10:47:40 +0000 DEBUG:logs_dir: logs
2025-12-07 10:47:40 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:47:40 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:47:40 +0000 DEBUG:utils_dir: utils
2025-12-07 10:47:40 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:47:40 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:47:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:47:40 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:47:40 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:47:40 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:47:40 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:47:40 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:47:40 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:47:40 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:47:40 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:47:40 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:47:40 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:47:40 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:47:40 +0000 INFO:Session state Setup complete
2025-12-07 10:47:40 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:47:40 +0000 INFO:Package setup complete
2025-12-07 10:47:40 +0000 INFO:setup_package executed successfully
2025-12-07 10:47:40 +0000 INFO:Setup completed successfully.
2025-12-07 10:47:40 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 INFO:Running first load function.
2025-12-07 10:47:40 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:40 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:40 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:40 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:40 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:47:40 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:40 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:40 +0000 INFO:firstload executed successfully
2025-12-07 10:47:40 +0000 INFO:Data first load completed successfully.
2025-12-07 10:47:40 +0000 INFO:initialise_data executed successfully
2025-12-07 10:47:40 +0000 INFO:Running Menu setup...
2025-12-07 10:47:40 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:40 +0000 INFO:App Version: v50.228
2025-12-07 10:47:40 +0000 INFO:Switched to page: Dubious Donors
2025-12-07 10:47:40 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:47:40 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:40 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:40 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:40 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:40 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:40 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:41 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:41 +0000 INFO:display_data_page executed successfully
2025-12-07 10:47:41 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:41 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:41 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:41 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:41 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:41 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:41 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:41 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:41 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:41 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:41 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:47:41 +0000 INFO:pagesetup executed successfully
2025-12-07 10:47:41 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:47:41 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:47:42 +0000 INFO:Streamlit App Starting...
2025-12-07 10:47:42 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:42 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:47:42 +0000 INFO:Running App setup...
2025-12-07 10:47:42 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:Setting up the package
2025-12-07 10:47:42 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:42 +0000 INFO:Version: v50.190
2025-12-07 10:47:42 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:42 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:security already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:directories already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:47:42 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:47:42 +0000 INFO:Session_state variables initialized
2025-12-07 10:47:42 +0000 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits at 0x000001E61387A5F0>}
2025-12-07 10:47:42 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:47:42 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:47:42 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:47:42 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:47:42 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:47:42 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:47:42 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:47:42 +0000 DEBUG:output_dir: output
2025-12-07 10:47:42 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:47:42 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:47:42 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:47:42 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:47:42 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:47:42 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:47:42 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:47:42 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:47:42 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:47:42 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:47:42 +0000 DEBUG:data_dir: data
2025-12-07 10:47:42 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:47:42 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 10:47:42 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:47:42 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:47:42 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:42 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:47:42 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:47:42 +0000 DEBUG:components_dir: components
2025-12-07 10:47:42 +0000 DEBUG:logs_dir: logs
2025-12-07 10:47:42 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:47:42 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:47:42 +0000 DEBUG:utils_dir: utils
2025-12-07 10:47:42 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:47:42 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:47:42 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:47:42 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:47:42 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:47:42 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:47:42 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:47:42 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:47:42 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:47:42 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:47:42 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:47:42 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:47:42 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:47:42 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:47:42 +0000 INFO:Session state Setup complete
2025-12-07 10:47:42 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:47:42 +0000 INFO:Package setup complete
2025-12-07 10:47:42 +0000 INFO:setup_package executed successfully
2025-12-07 10:47:42 +0000 INFO:Setup completed successfully.
2025-12-07 10:47:42 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:Running first load function.
2025-12-07 10:47:42 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:42 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:42 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:42 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:42 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:47:42 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:42 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:42 +0000 INFO:firstload executed successfully
2025-12-07 10:47:42 +0000 INFO:Data first load completed successfully.
2025-12-07 10:47:42 +0000 INFO:initialise_data executed successfully
2025-12-07 10:47:42 +0000 INFO:Running Menu setup...
2025-12-07 10:47:42 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:42 +0000 INFO:App Version: v50.228
2025-12-07 10:47:42 +0000 INFO:Switched to page: Paid Visits
2025-12-07 10:47:42 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:47:42 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:42 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:42 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:42 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:42 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:42 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:42 +0000 INFO:display_data_page executed successfully
2025-12-07 10:47:42 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:43 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:43 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:43 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:43 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:43 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:43 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:43 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:43 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:43 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:43 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:47:43 +0000 INFO:pagesetup executed successfully
2025-12-07 10:47:43 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:47:43 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:47:44 +0000 INFO:Streamlit App Starting...
2025-12-07 10:47:44 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:44 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:47:44 +0000 INFO:Running App setup...
2025-12-07 10:47:44 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:Setting up the package
2025-12-07 10:47:44 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:44 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:44 +0000 INFO:Version: v50.190
2025-12-07 10:47:44 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:44 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:security already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:directories already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:47:44 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:47:44 +0000 INFO:Session_state variables initialized
2025-12-07 10:47:44 +0000 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorships at 0x000001E61C9D97E0>}
2025-12-07 10:47:44 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:47:44 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:47:44 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:47:44 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:47:44 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:47:44 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:47:44 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:47:44 +0000 DEBUG:output_dir: output
2025-12-07 10:47:44 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:47:44 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:47:44 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:47:44 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:47:44 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:47:44 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:47:44 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:47:44 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:47:44 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:47:44 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:47:44 +0000 DEBUG:data_dir: data
2025-12-07 10:47:44 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:47:44 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 10:47:44 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:47:44 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:47:44 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:44 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:47:44 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:47:44 +0000 DEBUG:components_dir: components
2025-12-07 10:47:44 +0000 DEBUG:logs_dir: logs
2025-12-07 10:47:44 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:47:44 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:47:44 +0000 DEBUG:utils_dir: utils
2025-12-07 10:47:44 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:47:44 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:47:44 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:47:44 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:47:44 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:47:44 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:47:44 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:47:44 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:47:44 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:47:44 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:47:44 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:47:44 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:47:44 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:47:44 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:47:44 +0000 INFO:Session state Setup complete
2025-12-07 10:47:44 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:47:44 +0000 INFO:Package setup complete
2025-12-07 10:47:44 +0000 INFO:setup_package executed successfully
2025-12-07 10:47:44 +0000 INFO:Setup completed successfully.
2025-12-07 10:47:44 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:Running first load function.
2025-12-07 10:47:44 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:44 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:44 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:44 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:44 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:47:44 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:44 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:44 +0000 INFO:firstload executed successfully
2025-12-07 10:47:44 +0000 INFO:Data first load completed successfully.
2025-12-07 10:47:44 +0000 INFO:initialise_data executed successfully
2025-12-07 10:47:44 +0000 INFO:Running Menu setup...
2025-12-07 10:47:44 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:44 +0000 INFO:App Version: v50.228
2025-12-07 10:47:44 +0000 INFO:Switched to page: Sponsorships
2025-12-07 10:47:44 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:47:44 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:44 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:44 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:44 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:44 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:44 +0000 INFO:display_data_page executed successfully
2025-12-07 10:47:44 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:44 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:45 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:45 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:45 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:45 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:45 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:45 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:45 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:45 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:45 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:47:45 +0000 INFO:pagesetup executed successfully
2025-12-07 10:47:45 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:47:45 +0000 INFO:App is fully loaded and ready!
2025-12-07 10:47:46 +0000 INFO:Streamlit App Starting...
2025-12-07 10:47:46 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:46 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 10:47:46 +0000 INFO:Running App setup...
2025-12-07 10:47:46 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:Setting up the package
2025-12-07 10:47:46 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 10:47:46 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:46 +0000 INFO:Version: v50.190
2025-12-07 10:47:46 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:46 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:filenames already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:thresholds already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:filter_def already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:security already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:perc_target already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:directories already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:data_dir already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:output_dir already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:components_dir already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 10:47:46 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 10:47:46 +0000 INFO:Session_state variables initialized
2025-12-07 10:47:46 +0000 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations at 0x000001E61C9D9900>}
2025-12-07 10:47:46 +0000 DEBUG:perc_target: 0.5
2025-12-07 10:47:46 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 10:47:46 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 10:47:46 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 10:47:46 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 10:47:46 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 10:47:46 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 10:47:46 +0000 DEBUG:output_dir: output
2025-12-07 10:47:46 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 10:47:46 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 10:47:46 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 10:47:46 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 10:47:46 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 10:47:46 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 10:47:46 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 10:47:46 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 10:47:46 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 10:47:46 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 10:47:46 +0000 DEBUG:data_dir: data
2025-12-07 10:47:46 +0000 DEBUG:Cash_ftr: None
2025-12-07 10:47:46 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 10:47:46 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 10:47:46 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 10:47:46 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 10:47:46 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 10:47:46 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 10:47:46 +0000 DEBUG:components_dir: components
2025-12-07 10:47:46 +0000 DEBUG:logs_dir: logs
2025-12-07 10:47:46 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 10:47:46 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 10:47:46 +0000 DEBUG:utils_dir: utils
2025-12-07 10:47:46 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 10:47:46 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 10:47:46 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 10:47:46 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 10:47:46 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 10:47:46 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 10:47:46 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 10:47:46 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 10:47:46 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 10:47:46 +0000 DEBUG:reference_dir: reference_files
2025-12-07 10:47:46 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 10:47:46 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 10:47:46 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 10:47:46 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 10:47:46 +0000 INFO:Session state Setup complete
2025-12-07 10:47:46 +0000 INFO:initialize_session_state executed successfully
2025-12-07 10:47:46 +0000 INFO:Package setup complete
2025-12-07 10:47:46 +0000 INFO:setup_package executed successfully
2025-12-07 10:47:46 +0000 INFO:Setup completed successfully.
2025-12-07 10:47:46 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:Running first load function.
2025-12-07 10:47:46 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:46 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 10:47:46 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:46 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:46 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 10:47:46 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 10:47:46 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 10:47:46 +0000 INFO:firstload executed successfully
2025-12-07 10:47:46 +0000 INFO:Data first load completed successfully.
2025-12-07 10:47:46 +0000 INFO:initialise_data executed successfully
2025-12-07 10:47:46 +0000 INFO:Running Menu setup...
2025-12-07 10:47:46 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:get_git_version executed successfully
2025-12-07 10:47:46 +0000 INFO:App Version: v50.228
2025-12-07 10:47:46 +0000 INFO:Switched to page: Corporate Donations
2025-12-07 10:47:46 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 10:47:46 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:46 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:46 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:46 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:46 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:46 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:46 +0000 INFO:display_data_page executed successfully
2025-12-07 10:47:46 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 10:47:47 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 10:47:47 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 10:47:47 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 10:47:47 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 10:47:47 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 10:47:47 +0000 DEBUG:Page texts: {}
2025-12-07 10:47:47 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 10:47:47 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 10:47:47 +0000 INFO:display_visualizations executed successfully
2025-12-07 10:47:47 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 10:47:47 +0000 INFO:pagesetup executed successfully
2025-12-07 10:47:47 +0000 INFO:Menu setup completed successfully.
2025-12-07 10:47:47 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:26:13 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:26:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:13 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:14 +0000 INFO:Streamlit App Starting...
2025-12-07 11:26:14 +0000 INFO:Streamlit App Starting...
2025-12-07 11:26:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:26:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:26:14 +0000 INFO:Running App setup...
2025-12-07 11:26:14 +0000 INFO:Running App setup...
2025-12-07 11:26:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 INFO:Setting up the package
2025-12-07 11:26:14 +0000 INFO:Setting up the package
2025-12-07 11:26:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:14 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:14 +0000 INFO:Version: v50.191
2025-12-07 11:26:14 +0000 INFO:Version: v50.191
2025-12-07 11:26:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:26:14 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:26:14 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:26:14 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:26:14 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:26:14 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:26:14 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:26:14 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:26:14 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:26:14 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:26:14 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:26:14 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:26:14 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:26:14 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:26:14 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:26:14 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:26:14 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:26:14 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:26:14 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:26:14 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:26:14 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:26:14 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:26:14 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:26:14 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:26:14 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:26:14 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:26:14 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:26:14 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:26:14 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:26:14 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:26:14 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:26:14 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:26:14 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:26:14 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:26:14 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:26:14 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:26:14 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:26:14 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:26:14 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:26:14 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:26:14 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:26:14 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:26:14 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:26:14 +0000 INFO:Session_state variables initialized
2025-12-07 11:26:14 +0000 INFO:Session_state variables initialized
2025-12-07 11:26:14 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:26:14 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:26:14 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:26:14 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:26:14 +0000 DEBUG:utils_dir: utils
2025-12-07 11:26:14 +0000 DEBUG:utils_dir: utils
2025-12-07 11:26:14 +0000 DEBUG:data_dir: data
2025-12-07 11:26:14 +0000 DEBUG:data_dir: data
2025-12-07 11:26:14 +0000 DEBUG:logs_dir: logs
2025-12-07 11:26:14 +0000 DEBUG:logs_dir: logs
2025-12-07 11:26:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:26:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:26:14 +0000 DEBUG:output_dir: output
2025-12-07 11:26:14 +0000 DEBUG:output_dir: output
2025-12-07 11:26:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:26:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:26:14 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:26:14 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:26:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:26:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:26:14 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:26:14 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:26:14 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:26:14 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:26:14 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:26:14 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:26:14 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:26:14 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:26:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:26:14 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:26:14 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:26:14 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:26:14 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:26:14 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:26:14 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:26:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:26:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:26:14 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:26:14 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:26:14 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:26:14 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:26:14 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:26:14 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:26:14 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:26:14 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:26:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:26:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:26:14 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:26:14 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:26:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:26:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:26:14 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:26:14 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:26:14 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:26:14 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:26:14 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:26:14 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:26:14 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:26:14 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:26:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:26:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:26:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:26:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:26:14 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:26:14 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:26:14 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:26:14 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:26:14 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:26:14 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:26:14 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:26:14 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:26:14 +0000 DEBUG:components_dir: components
2025-12-07 11:26:14 +0000 DEBUG:components_dir: components
2025-12-07 11:26:14 +0000 INFO:Session state Setup complete
2025-12-07 11:26:14 +0000 INFO:Session state Setup complete
2025-12-07 11:26:14 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:26:14 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:26:14 +0000 INFO:Package setup complete
2025-12-07 11:26:14 +0000 INFO:Package setup complete
2025-12-07 11:26:14 +0000 INFO:setup_package executed successfully
2025-12-07 11:26:14 +0000 INFO:setup_package executed successfully
2025-12-07 11:26:14 +0000 INFO:Setup completed successfully.
2025-12-07 11:26:14 +0000 INFO:Setup completed successfully.
2025-12-07 11:26:14 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:14 +0000 INFO:Running first load function.
2025-12-07 11:26:14 +0000 INFO:Running first load function.
2025-12-07 11:26:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:26:14 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:26:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:26:14 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:26:14 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:26:14 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:26:14 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:26:14 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:26:14 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:26:14 +0000 INFO:Last modification time: 1765104401.7030835
2025-12-07 11:26:14 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:26:14 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765104401.7030835 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:26:14 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:26:15 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:26:15 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:26:15 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:26:15 +0000 INFO:Cleaning up raw data
2025-12-07 11:26:15 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:26:15 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:15 +0000 INFO:Original file path: None
2025-12-07 11:26:15 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:26:15 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:26:15 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:26:15 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:26:17 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:26:17 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:26:17 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:26:17 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:26:17 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:26:17 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:26:17 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:26:17 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:26:17 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:26:17 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:26:17 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:26:17 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:26:17 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:26:17 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:26:19 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:26:19 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:26:19 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:26:19 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:26:19 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:26:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:26:19 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:19 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:26:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:26:19 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:19 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:19 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:19 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:26:19 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:19 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:26:19 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:26:19 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:26:19 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:26:19 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:26:19 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:26:19 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:26:19 +0000 INFO:Current modification time: 1765106779.1883552
2025-12-07 11:26:19 +0000 INFO:Last modification time: 1765104401.7030835
2025-12-07 11:26:19 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:26:19 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:26:19 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:26:19 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:26:19 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:26:19 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:26:21 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:26:21 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:26:21 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:26:22 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:26:22 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:26:22 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:26:22 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:26:22 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:26:22 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:26:22 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:26:22 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:26:22 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:26:22 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:26:22 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:26:22 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:26:22 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:26:22 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:26:22 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:26:22 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:26:22 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:26:24 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:26:24 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:26:24 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:26:24 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:26:24 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:24 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:24 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:24 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:26:24 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:26:24 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:26:24 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:26:24 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:26:24 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:26:24 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:26:24 +0000 INFO:Current modification time: 1765106784.7241917
2025-12-07 11:26:24 +0000 INFO:Last modification time: 1765104407.016888
2025-12-07 11:26:24 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:26:24 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:26:25 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:26:25 +0000 INFO:Donor Data summary completed
2025-12-07 11:26:25 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:26:25 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:26:25 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:26:25 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:26:25 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:26:25 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:26:25 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:26:25 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:26:25 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:26:25 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:26:25 +0000 INFO:Current modification time: 1765106784.7241917
2025-12-07 11:26:25 +0000 INFO:Last modification time: 1765106784.7241917
2025-12-07 11:26:25 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:26:25 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765106784.7241917 instead of output\cleaned_data.csv
2025-12-07 11:26:25 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:26:25 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:26:25 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:26:25 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:26:25 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:26:25 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:26:25 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:26:25 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:26:25 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:26:25 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:26:25 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:26:25 +0000 INFO:firstload executed successfully
2025-12-07 11:26:25 +0000 INFO:Data first load completed successfully.
2025-12-07 11:26:25 +0000 INFO:initialise_data executed successfully
2025-12-07 11:26:25 +0000 INFO:Running Menu setup...
2025-12-07 11:26:25 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:25 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:25 +0000 INFO:App Version: v50.229
2025-12-07 11:26:25 +0000 INFO:Switched to page: Introduction
2025-12-07 11:26:25 +0000 INFO:pagesetup executed successfully
2025-12-07 11:26:25 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:26:25 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:26:41 +0000 INFO:Streamlit App Starting...
2025-12-07 11:26:41 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:26:41 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:26:41 +0000 INFO:Running App setup...
2025-12-07 11:26:41 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 INFO:Setting up the package
2025-12-07 11:26:41 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:26:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:41 +0000 INFO:Version: v50.191
2025-12-07 11:26:41 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:26:41 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:security already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:directories already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:26:41 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:26:41 +0000 INFO:Session_state variables initialized
2025-12-07 11:26:41 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:26:41 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:26:41 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:26:41 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:26:41 +0000 DEBUG:utils_dir: utils
2025-12-07 11:26:41 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000025F765E6680>}
2025-12-07 11:26:41 +0000 DEBUG:data_dir: data
2025-12-07 11:26:41 +0000 DEBUG:logs_dir: logs
2025-12-07 11:26:41 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:26:41 +0000 DEBUG:output_dir: output
2025-12-07 11:26:41 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:26:41 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:26:41 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:26:41 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:26:41 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:26:41 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:26:41 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:26:41 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:26:41 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:26:41 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:26:41 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:26:41 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:26:41 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:26:41 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:26:41 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:26:41 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:26:41 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:26:41 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:26:41 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:26:41 +0000 DEBUG:load_raw_data_last_modified: 1765106779.1883552
2025-12-07 11:26:41 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:26:41 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:26:41 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:26:41 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:26:41 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:26:41 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:26:41 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:26:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:26:41 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:26:41 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:26:41 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:26:41 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:26:41 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:26:41 +0000 DEBUG:load_donorlist_data_last_modified: 1765106784.7241917
2025-12-07 11:26:41 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:26:41 +0000 DEBUG:components_dir: components
2025-12-07 11:26:41 +0000 INFO:Session state Setup complete
2025-12-07 11:26:41 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:26:41 +0000 INFO:Package setup complete
2025-12-07 11:26:41 +0000 INFO:setup_package executed successfully
2025-12-07 11:26:41 +0000 INFO:Setup completed successfully.
2025-12-07 11:26:41 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 INFO:Running first load function.
2025-12-07 11:26:41 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:26:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:26:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:26:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:26:41 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:26:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:26:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:26:41 +0000 INFO:firstload executed successfully
2025-12-07 11:26:41 +0000 INFO:Data first load completed successfully.
2025-12-07 11:26:41 +0000 INFO:initialise_data executed successfully
2025-12-07 11:26:41 +0000 INFO:Running Menu setup...
2025-12-07 11:26:41 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 INFO:get_git_version executed successfully
2025-12-07 11:26:41 +0000 INFO:App Version: v50.229
2025-12-07 11:26:41 +0000 INFO:Switched to page: Head Line Figures
2025-12-07 11:26:41 +0000 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 11:26:41 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:26:41 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:26:42 +0000 DEBUG:Aggregated DataFrame:                         Party_Group         Value
0   Conservative And Unionist Party  20131.118739
1                       Green Party   6023.742231
2                      Labour Party  20650.882442
3                      Large Entity  29763.708881
4                  Liberal Democrat   8504.706244
5                     Medium Entity  15666.034757
6               Medium Large Entity  31569.580016
7                         Reform UK  74374.940899
8            Single Donation Entity  12207.983689
9                      Small Entity  16114.092989
10              Small Medium Entity  21512.571099
11     Uk Independence Party (Ukip)   9919.127250
12                Very Small Entity  24966.683550
2025-12-07 11:26:42 +0000 DEBUG:Sorted DataFrame:                         Party_Group         Value
7                         Reform UK  74374.940899
6               Medium Large Entity  31569.580016
3                      Large Entity  29763.708881
12                Very Small Entity  24966.683550
10              Small Medium Entity  21512.571099
2                      Labour Party  20650.882442
0   Conservative And Unionist Party  20131.118739
9                      Small Entity  16114.092989
5                     Medium Entity  15666.034757
8            Single Donation Entity  12207.983689
11     Uk Independence Party (Ukip)   9919.127250
4                  Liberal Democrat   8504.706244
1                       Green Party   6023.742231
2025-12-07 11:26:42 +0000 DEBUG:Unique XValues: ['Reform UK' 'Medium Large Entity' 'Large Entity' 'Very Small Entity'
 'Small Medium Entity' 'Labour Party' 'Conservative And Unionist Party'
 'Small Entity' 'Medium Entity' 'Single Donation Entity'
 'Uk Independence Party (Ukip)' 'Liberal Democrat' 'Green Party']
2025-12-07 11:26:42 +0000 DEBUG:Final color_discrete_map: {'Reform UK': '#12B6CF', 'Medium Large Entity': '#636efa', 'Large Entity': '#333333', 'Very Small Entity': '#bbbbbb', 'Small Medium Entity': '#aaaaaa', 'Labour Party': '#DC241F', 'Conservative And Unionist Party': '#0087DC', 'Small Entity': '#888888', 'Medium Entity': '#555555', 'Single Donation Entity': '#dddddd', 'Uk Independence Party (Ukip)': '#70147A', 'Liberal Democrat': '#FDBB30', 'Green Party': '#78B943'}
2025-12-07 11:26:43 +0000 DEBUG:Missing color mappings for: ['Medium Large Entity']
2025-12-07 11:26:43 +0000 DEBUG:Generated Figure: Figure({
    'data': [{'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Reform UK',
              'marker': {'color': '#12B6CF', 'pattern': {'shape': ''}},
              'name': 'Reform UK',
              'offsetgroup': 'Reform UK',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Reform UK'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'H03sDW8o8kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Large Entity',
              'marker': {'color': '#636efa', 'pattern': {'shape': ''}},
              'name': 'Medium Large Entity',
              'offsetgroup': 'Medium Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '6Xn6HmXU3kA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Large Entity',
              'marker': {'color': '#333333', 'pattern': {'shape': ''}},
              'name': 'Large Entity',
              'offsetgroup': 'Large Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Large Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9nxPXu0Q3UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Very Small Entity',
              'marker': {'color': '#bbbbbb', 'pattern': {'shape': ''}},
              'name': 'Very Small Entity',
              'offsetgroup': 'Very Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Very Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'typIv6th2EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Medium Entity',
              'marker': {'color': '#aaaaaa', 'pattern': {'shape': ''}},
              'name': 'Small Medium Entity',
              'offsetgroup': 'Small Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '9ofjjCQC1UA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Labour Party',
              'marker': {'color': '#DC241F', 'pattern': {'shape': ''}},
              'name': 'Labour Party',
              'offsetgroup': 'Labour Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Labour Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AHzuebgq1EA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Conservative And Unionist Party',
              'marker': {'color': '#0087DC', 'pattern': {'shape': ''}},
              'name': 'Conservative And Unionist Party',
              'offsetgroup': 'Conservative And Unionist Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Conservative And Unionist Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '1f1qmceo00A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Small Entity',
              'marker': {'color': '#888888', 'pattern': {'shape': ''}},
              'name': 'Small Entity',
              'offsetgroup': 'Small Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Small Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'LAkU5wt5z0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Medium Entity',
              'marker': {'color': '#555555', 'pattern': {'shape': ''}},
              'name': 'Medium Entity',
              'offsetgroup': 'Medium Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Medium Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'zM7ocgSZzkA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Single Donation Entity',
              'marker': {'color': '#dddddd', 'pattern': {'shape': ''}},
              'name': 'Single Donation Entity',
              'offsetgroup': 'Single Donation Entity',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Single Donation Entity'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'nHuE6f3Xx0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Uk Independence Party (Ukip)',
              'marker': {'color': '#70147A', 'pattern': {'shape': ''}},
              'name': 'Uk Independence Party (Ukip)',
              'offsetgroup': 'Uk Independence Party (Ukip)',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Uk Independence Party (Ukip)'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'QIC7SZBfw0A=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Liberal Democrat',
              'marker': {'color': '#FDBB30', 'pattern': {'shape': ''}},
              'name': 'Liberal Democrat',
              'offsetgroup': 'Liberal Democrat',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Liberal Democrat'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': 'AMMxZlqcwEA=', 'dtype': 'f8'},
              'yaxis': 'y'},
             {'alignmentgroup': 'True',
              'hovertemplate': 'Political Party=%{x}<br>Average Donation GBP=%{y}<extra></extra>',
              'legendgroup': 'Green Party',
              'marker': {'color': '#78B943', 'pattern': {'shape': ''}},
              'name': 'Green Party',
              'offsetgroup': 'Green Party',
              'orientation': 'v',
              'showlegend': True,
              'textposition': 'auto',
              'type': 'bar',
              'width': 0.9,
              'x': array(['Green Party'], dtype=object),
              'xaxis': 'x',
              'y': {'bdata': '7u/VAr6Ht0A=', 'dtype': 'f8'},
              'yaxis': 'y'}],
    'layout': {'barmode': 'group',
               'legend': {'title': {'text': 'Political Party'}, 'tracegroupgap': 0},
               'template': '...',
               'title': {'text': 'Average Donation per Party'},
               'xaxis': {'anchor': 'y',
                         'categoryarray': [Reform UK, Medium Large Entity, Large
                                           Entity, Very Small Entity, Small Medium
                                           Entity, Labour Party, Conservative And
                                           Unionist Party, Small Entity, Medium
                                           Entity, Single Donation Entity, Uk
                                           Independence Party (Ukip), Liberal
                                           Democrat, Green Party],
                         'categoryorder': 'array',
                         'domain': [0.0, 1.0],
                         'title': {'text': 'Political Party'}},
               'yaxis': {'anchor': 'x', 'domain': [0.0, 1.0], 'title': {'text': 'Average Donation GBP'}}}
})
2025-12-07 11:26:43 +0000 INFO:Bar chart displayed successfully.
2025-12-07 11:26:43 +0000 INFO:hlf_body executed successfully
2025-12-07 11:26:43 +0000 INFO:pagesetup executed successfully
2025-12-07 11:26:43 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:26:43 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:27:11 +0000 INFO:Streamlit App Starting...
2025-12-07 11:27:11 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:27:11 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:27:11 +0000 INFO:Running App setup...
2025-12-07 11:27:11 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:Setting up the package
2025-12-07 11:27:11 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:27:11 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:get_git_version executed successfully
2025-12-07 11:27:11 +0000 INFO:Version: v50.191
2025-12-07 11:27:11 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:27:11 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:security already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:directories already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:27:11 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:27:11 +0000 INFO:Session_state variables initialized
2025-12-07 11:27:11 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 11:27:11 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:27:11 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:27:11 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:27:11 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:27:11 +0000 DEBUG:utils_dir: utils
2025-12-07 11:27:11 +0000 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations at 0x0000025F765E7250>}
2025-12-07 11:27:11 +0000 DEBUG:data_dir: data
2025-12-07 11:27:11 +0000 DEBUG:logs_dir: logs
2025-12-07 11:27:11 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:27:11 +0000 DEBUG:output_dir: output
2025-12-07 11:27:11 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:27:11 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:27:11 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:27:11 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:27:11 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:27:11 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:27:11 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:27:11 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:27:11 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:27:11 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:27:11 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:27:11 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:27:11 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:27:11 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:27:11 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:27:11 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:27:11 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:27:11 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:27:11 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:27:11 +0000 DEBUG:load_raw_data_last_modified: 1765106779.1883552
2025-12-07 11:27:11 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:27:11 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:27:11 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:27:11 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 11:27:11 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:27:11 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:27:11 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:27:11 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:27:11 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:27:11 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:27:11 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:27:11 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:27:11 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:27:11 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:27:11 +0000 DEBUG:load_donorlist_data_last_modified: 1765106784.7241917
2025-12-07 11:27:11 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:27:11 +0000 DEBUG:components_dir: components
2025-12-07 11:27:11 +0000 INFO:Session state Setup complete
2025-12-07 11:27:11 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:27:11 +0000 INFO:Package setup complete
2025-12-07 11:27:11 +0000 INFO:setup_package executed successfully
2025-12-07 11:27:11 +0000 INFO:Setup completed successfully.
2025-12-07 11:27:11 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:Running first load function.
2025-12-07 11:27:11 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:27:11 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:27:11 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:27:11 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:27:11 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:27:11 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:27:11 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:27:11 +0000 INFO:firstload executed successfully
2025-12-07 11:27:11 +0000 INFO:Data first load completed successfully.
2025-12-07 11:27:11 +0000 INFO:initialise_data executed successfully
2025-12-07 11:27:11 +0000 INFO:Running Menu setup...
2025-12-07 11:27:11 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:get_git_version executed successfully
2025-12-07 11:27:11 +0000 INFO:App Version: v50.229
2025-12-07 11:27:11 +0000 INFO:Switched to page: Cash Donations
2025-12-07 11:27:11 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 11:27:11 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:27:11 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:27:11 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 DEBUG:Page texts: {'Para1': {'text': 'Except for in 2016', 'is_deleted': False}, 'Para 2': {'text': 'More useful information', 'is_deleted': False}}
2025-12-07 11:27:11 +0000 DEBUG:Calling manage_text_elements with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 DEBUG:Not logged in as admin.
2025-12-07 11:27:11 +0000 INFO:manage_text_elements executed successfully
2025-12-07 11:27:11 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:27:11 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:27:11 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:27:11 +0000 INFO:display_data_page executed successfully
2025-12-07 11:27:11 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:27:12 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:27:12 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:27:12 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:27:12 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:27:12 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:27:12 +0000 DEBUG:Page texts: {}
2025-12-07 11:27:12 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:27:12 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:27:12 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:27:12 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:27:12 +0000 INFO:pagesetup executed successfully
2025-12-07 11:27:12 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:27:12 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:27:15 +0000 INFO:Streamlit App Starting...
2025-12-07 11:27:15 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:27:15 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:27:15 +0000 INFO:Running App setup...
2025-12-07 11:27:15 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:27:15 +0000 INFO:Setting up the package
2025-12-07 11:27:15 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:27:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:27:15 +0000 INFO:get_git_version executed successfully
2025-12-07 11:27:15 +0000 INFO:Version: v50.191
2025-12-07 11:27:15 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:27:15 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:27:15 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:security already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:directories already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:27:15 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:27:15 +0000 INFO:Session_state variables initialized
2025-12-07 11:27:15 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 11:27:15 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:27:15 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:27:15 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:27:15 +0000 DEBUG:selected_entity_name: All
2025-12-07 11:27:15 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:27:15 +0000 DEBUG:utils_dir: utils
2025-12-07 11:27:15 +0000 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations at 0x0000025F765E72E0>}
2025-12-07 11:27:15 +0000 DEBUG:data_dir: data
2025-12-07 11:27:15 +0000 DEBUG:logs_dir: logs
2025-12-07 11:27:15 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:27:15 +0000 DEBUG:output_dir: output
2025-12-07 11:27:15 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:27:15 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:27:15 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:27:15 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:27:15 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:27:15 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:27:15 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:27:15 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:27:15 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:27:15 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:27:15 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:27:15 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:27:15 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:27:15 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:27:15 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:27:16 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:27:16 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:27:16 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:27:16 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:27:16 +0000 DEBUG:load_raw_data_last_modified: 1765106779.1883552
2025-12-07 11:27:16 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:27:16 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:27:16 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:27:16 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 11:27:16 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 11:27:16 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:27:16 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:27:16 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:27:16 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:27:16 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:27:16 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:27:16 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:27:16 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:27:16 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:27:16 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:27:16 +0000 DEBUG:load_donorlist_data_last_modified: 1765106784.7241917
2025-12-07 11:27:16 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:27:16 +0000 DEBUG:components_dir: components
2025-12-07 11:27:16 +0000 INFO:Session state Setup complete
2025-12-07 11:27:16 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:27:16 +0000 INFO:Package setup complete
2025-12-07 11:27:16 +0000 INFO:setup_package executed successfully
2025-12-07 11:27:16 +0000 INFO:Setup completed successfully.
2025-12-07 11:27:16 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 INFO:Running first load function.
2025-12-07 11:27:16 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:27:16 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:27:16 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:27:16 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:27:16 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:27:16 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:27:16 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:27:16 +0000 INFO:firstload executed successfully
2025-12-07 11:27:16 +0000 INFO:Data first load completed successfully.
2025-12-07 11:27:16 +0000 INFO:initialise_data executed successfully
2025-12-07 11:27:16 +0000 INFO:Running Menu setup...
2025-12-07 11:27:16 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 INFO:get_git_version executed successfully
2025-12-07 11:27:16 +0000 INFO:App Version: v50.229
2025-12-07 11:27:16 +0000 INFO:Switched to page: Non Cash Donations
2025-12-07 11:27:16 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 11:27:16 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:27:16 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:27:16 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 DEBUG:Page texts: {}
2025-12-07 11:27:16 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:27:16 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:27:16 +0000 INFO:display_data_page executed successfully
2025-12-07 11:27:16 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:27:16 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:27:16 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:27:16 +0000 DEBUG:Page texts: {}
2025-12-07 11:27:16 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:27:16 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:27:17 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:27:17 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:27:17 +0000 INFO:pagesetup executed successfully
2025-12-07 11:27:17 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:27:17 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:27:22 +0000 INFO:Streamlit App Starting...
2025-12-07 11:27:22 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:27:22 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:27:22 +0000 INFO:Running App setup...
2025-12-07 11:27:22 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:Setting up the package
2025-12-07 11:27:22 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:27:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:get_git_version executed successfully
2025-12-07 11:27:22 +0000 INFO:Version: v50.191
2025-12-07 11:27:22 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:27:22 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:security already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:directories already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:27:22 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:27:22 +0000 INFO:Session_state variables initialized
2025-12-07 11:27:22 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 11:27:22 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:27:22 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:27:22 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:27:22 +0000 DEBUG:selected_entity_name: All
2025-12-07 11:27:22 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:27:22 +0000 DEBUG:utils_dir: utils
2025-12-07 11:27:22 +0000 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations at 0x0000025F765E7370>}
2025-12-07 11:27:22 +0000 DEBUG:data_dir: data
2025-12-07 11:27:22 +0000 DEBUG:logs_dir: logs
2025-12-07 11:27:22 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:27:22 +0000 DEBUG:output_dir: output
2025-12-07 11:27:22 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:27:22 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:27:22 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:27:22 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:27:22 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:27:22 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:27:22 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:27:22 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:27:22 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:27:22 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:27:22 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:27:22 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:27:22 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:27:22 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:27:22 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:27:22 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:27:22 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:27:22 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:27:22 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:27:22 +0000 DEBUG:load_raw_data_last_modified: 1765106779.1883552
2025-12-07 11:27:22 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:27:22 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:27:22 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:27:22 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 11:27:22 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 11:27:22 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:27:22 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:27:22 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:27:22 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:27:22 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:27:22 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:27:22 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:27:22 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:27:22 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:27:22 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:27:22 +0000 DEBUG:load_donorlist_data_last_modified: 1765106784.7241917
2025-12-07 11:27:22 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:27:22 +0000 DEBUG:components_dir: components
2025-12-07 11:27:22 +0000 INFO:Session state Setup complete
2025-12-07 11:27:22 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:27:22 +0000 INFO:Package setup complete
2025-12-07 11:27:22 +0000 INFO:setup_package executed successfully
2025-12-07 11:27:22 +0000 INFO:Setup completed successfully.
2025-12-07 11:27:22 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:Running first load function.
2025-12-07 11:27:22 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:27:22 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:27:22 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:27:22 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:27:22 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:27:22 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:27:22 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:27:22 +0000 INFO:firstload executed successfully
2025-12-07 11:27:22 +0000 INFO:Data first load completed successfully.
2025-12-07 11:27:22 +0000 INFO:initialise_data executed successfully
2025-12-07 11:27:22 +0000 INFO:Running Menu setup...
2025-12-07 11:27:22 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:get_git_version executed successfully
2025-12-07 11:27:22 +0000 INFO:App Version: v50.229
2025-12-07 11:27:22 +0000 INFO:Switched to page: Public Fund Donations
2025-12-07 11:27:22 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 11:27:22 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:27:22 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:27:22 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 DEBUG:Page texts: {}
2025-12-07 11:27:22 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:27:22 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:27:22 +0000 INFO:display_data_page executed successfully
2025-12-07 11:27:22 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:27:22 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:27:22 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:27:22 +0000 DEBUG:Page texts: {}
2025-12-07 11:27:22 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:27:22 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:27:23 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:27:23 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:27:23 +0000 INFO:pagesetup executed successfully
2025-12-07 11:27:23 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:27:23 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:27:28 +0000 INFO:Streamlit App Starting...
2025-12-07 11:27:28 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:27:28 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:27:28 +0000 INFO:Running App setup...
2025-12-07 11:27:28 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:Setting up the package
2025-12-07 11:27:28 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:27:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:get_git_version executed successfully
2025-12-07 11:27:28 +0000 INFO:Version: v50.191
2025-12-07 11:27:28 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:27:28 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:security already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:directories already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:27:28 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:27:28 +0000 INFO:Session_state variables initialized
2025-12-07 11:27:28 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 11:27:28 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:27:28 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:27:28 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:27:28 +0000 DEBUG:selected_entity_name: All
2025-12-07 11:27:28 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:27:28 +0000 DEBUG:utils_dir: utils
2025-12-07 11:27:28 +0000 DEBUG:menu_selection: {'title': 'Bequests', 'function': <function mod_bequeths at 0x0000025F765E6EF0>}
2025-12-07 11:27:28 +0000 DEBUG:data_dir: data
2025-12-07 11:27:28 +0000 DEBUG:logs_dir: logs
2025-12-07 11:27:28 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:27:28 +0000 DEBUG:output_dir: output
2025-12-07 11:27:28 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:27:28 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:27:28 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:27:28 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:27:28 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:27:28 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:27:28 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:27:28 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:27:28 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:27:28 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:27:28 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:27:28 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:27:28 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:27:28 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:27:28 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:27:28 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:27:28 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:27:28 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:27:28 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:27:28 +0000 DEBUG:load_raw_data_last_modified: 1765106779.1883552
2025-12-07 11:27:28 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:27:28 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:27:28 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:27:28 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 11:27:28 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 11:27:28 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:27:28 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:27:28 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:27:28 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:27:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:27:28 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:27:28 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:27:28 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:27:28 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:27:28 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:27:28 +0000 DEBUG:load_donorlist_data_last_modified: 1765106784.7241917
2025-12-07 11:27:28 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:27:28 +0000 DEBUG:components_dir: components
2025-12-07 11:27:28 +0000 INFO:Session state Setup complete
2025-12-07 11:27:28 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:27:28 +0000 INFO:Package setup complete
2025-12-07 11:27:28 +0000 INFO:setup_package executed successfully
2025-12-07 11:27:28 +0000 INFO:Setup completed successfully.
2025-12-07 11:27:28 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:Running first load function.
2025-12-07 11:27:28 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:27:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:27:28 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:27:28 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:27:28 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:27:28 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:27:28 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:27:28 +0000 INFO:firstload executed successfully
2025-12-07 11:27:28 +0000 INFO:Data first load completed successfully.
2025-12-07 11:27:28 +0000 INFO:initialise_data executed successfully
2025-12-07 11:27:28 +0000 INFO:Running Menu setup...
2025-12-07 11:27:28 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:get_git_version executed successfully
2025-12-07 11:27:28 +0000 INFO:App Version: v50.229
2025-12-07 11:27:28 +0000 INFO:Switched to page: Bequests
2025-12-07 11:27:28 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 11:27:28 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:27:28 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:27:28 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 DEBUG:Page texts: {}
2025-12-07 11:27:28 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:27:28 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:27:28 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:27:28 +0000 INFO:display_data_page executed successfully
2025-12-07 11:27:28 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:27:29 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:27:29 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:27:29 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:27:29 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:27:29 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:27:29 +0000 DEBUG:Page texts: {}
2025-12-07 11:27:29 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:27:29 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:27:29 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:27:29 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:27:29 +0000 INFO:pagesetup executed successfully
2025-12-07 11:27:29 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:27:29 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:32:50 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:32:50 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:32:51 +0000 INFO:get_git_version executed successfully
2025-12-07 11:32:51 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:32:51 +0000 INFO:get_git_version executed successfully
2025-12-07 11:32:51 +0000 INFO:Streamlit App Starting...
2025-12-07 11:32:51 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:32:51 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:32:51 +0000 INFO:Running App setup...
2025-12-07 11:32:51 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:32:51 +0000 INFO:Setting up the package
2025-12-07 11:32:51 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:32:51 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 INFO:get_git_version executed successfully
2025-12-07 11:32:52 +0000 INFO:Version: v50.191
2025-12-07 11:32:52 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:32:52 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:32:52 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:32:52 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:32:52 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:32:52 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:32:52 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:32:52 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:32:52 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:32:52 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:32:52 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:32:52 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:32:52 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:32:52 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:32:52 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:32:52 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:32:52 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:32:52 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:32:52 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:32:52 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:32:52 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:32:52 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:32:52 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:32:52 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:32:52 +0000 INFO:Session_state variables initialized
2025-12-07 11:32:52 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:32:52 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:32:52 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:32:52 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:32:52 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:32:52 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:32:52 +0000 DEBUG:data_dir: data
2025-12-07 11:32:52 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:32:52 +0000 DEBUG:components_dir: components
2025-12-07 11:32:52 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:32:52 +0000 DEBUG:output_dir: output
2025-12-07 11:32:52 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:32:52 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:32:52 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:32:52 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:32:52 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:32:52 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:32:52 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:32:52 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:32:52 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:32:52 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:32:52 +0000 DEBUG:utils_dir: utils
2025-12-07 11:32:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:32:52 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:32:52 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:32:52 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:32:52 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:32:52 +0000 DEBUG:logs_dir: logs
2025-12-07 11:32:52 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:32:52 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:32:52 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:32:52 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:32:52 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:32:52 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:32:52 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:32:52 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:32:52 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:32:52 +0000 INFO:Session state Setup complete
2025-12-07 11:32:52 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:32:52 +0000 INFO:Package setup complete
2025-12-07 11:32:52 +0000 INFO:setup_package executed successfully
2025-12-07 11:32:52 +0000 INFO:Setup completed successfully.
2025-12-07 11:32:52 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 INFO:get_git_version executed successfully
2025-12-07 11:32:52 +0000 INFO:Running first load function.
2025-12-07 11:32:52 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:32:52 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:32:52 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:32:52 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:32:52 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:32:52 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:32:52 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:32:52 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:32:52 +0000 INFO:Last modification time: 1765106779.1883552
2025-12-07 11:32:52 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:32:52 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765106779.1883552 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:32:52 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:32:52 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:32:52 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:32:52 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 INFO:Cleaning up raw data
2025-12-07 11:32:52 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:32:52 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:32:52 +0000 INFO:Original file path: None
2025-12-07 11:32:52 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:32:52 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:32:52 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:32:52 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:32:54 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:32:54 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:32:54 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:32:54 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:32:54 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:32:54 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:32:54 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:32:54 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:32:55 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:32:55 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:32:55 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:32:55 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:32:55 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:32:55 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:32:56 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:32:56 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:32:56 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:32:56 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:32:57 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:32:57 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:32:57 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:32:57 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:32:57 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:32:57 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:32:57 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:32:57 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:32:57 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:32:57 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:32:57 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:32:57 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:32:57 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:32:57 +0000 INFO:Current modification time: 1765107176.8895898
2025-12-07 11:32:57 +0000 INFO:Last modification time: 1765106779.1883552
2025-12-07 11:32:57 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:32:57 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:32:57 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:32:57 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:32:57 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:32:57 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:32:59 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:32:59 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:32:59 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:32:59 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:32:59 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:32:59 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:32:59 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:32:59 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:32:59 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:32:59 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:32:59 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:32:59 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:32:59 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:32:59 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:32:59 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:32:59 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:32:59 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:32:59 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:33:00 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:33:00 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:33:02 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:33:02 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:33:02 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:33:02 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:02 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:33:02 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:33:02 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:33:02 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:33:02 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:33:02 +0000 INFO:Current modification time: 1765107182.2760413
2025-12-07 11:33:02 +0000 INFO:Last modification time: 1765106784.7241917
2025-12-07 11:33:02 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:33:02 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:33:02 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:33:02 +0000 INFO:Donor Data summary completed
2025-12-07 11:33:02 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:33:02 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:33:02 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:33:02 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:02 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:02 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:33:02 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:33:02 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:33:02 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:33:02 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:33:02 +0000 INFO:Current modification time: 1765107182.2760413
2025-12-07 11:33:02 +0000 INFO:Last modification time: 1765107182.2760413
2025-12-07 11:33:02 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:33:02 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765107182.2760413 instead of output\cleaned_data.csv
2025-12-07 11:33:02 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:33:02 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:33:02 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:33:02 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:33:02 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:33:02 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:33:02 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:33:02 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:33:02 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:33:02 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:02 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:02 +0000 INFO:firstload executed successfully
2025-12-07 11:33:02 +0000 INFO:Data first load completed successfully.
2025-12-07 11:33:02 +0000 INFO:initialise_data executed successfully
2025-12-07 11:33:02 +0000 INFO:Running Menu setup...
2025-12-07 11:33:02 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:02 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:03 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:03 +0000 INFO:App Version: v50.229
2025-12-07 11:33:03 +0000 INFO:Switched to page: Introduction
2025-12-07 11:33:03 +0000 INFO:pagesetup executed successfully
2025-12-07 11:33:03 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:33:03 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:33:09 +0000 INFO:Streamlit App Starting...
2025-12-07 11:33:09 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:09 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:33:09 +0000 INFO:Running App setup...
2025-12-07 11:33:09 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:33:09 +0000 INFO:Setting up the package
2025-12-07 11:33:09 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:09 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:09 +0000 INFO:Version: v50.191
2025-12-07 11:33:09 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:33:09 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:09 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:security already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:directories already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:33:09 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:33:09 +0000 INFO:Session_state variables initialized
2025-12-07 11:33:09 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001B9837E84C0>}
2025-12-07 11:33:09 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:33:09 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:33:09 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:33:09 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:09 +0000 DEBUG:load_donorlist_data_last_modified: 1765107182.2760413
2025-12-07 11:33:09 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:33:09 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:33:09 +0000 DEBUG:data_dir: data
2025-12-07 11:33:09 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:33:09 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:33:09 +0000 DEBUG:components_dir: components
2025-12-07 11:33:09 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:33:09 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:33:09 +0000 DEBUG:output_dir: output
2025-12-07 11:33:09 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:33:09 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship DonorStatus  ... WksSinceLastElection QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE     Company  ...               3748.0                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE     Company  ...               3755.0                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE     Company  ...               3744.0                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  Individual  ...               3745.0                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE     Company  ...               3750.0                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...         ...  ...                  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE       Other  ...               5029.0                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:33:09 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:33:09 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:33:09 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType      Value  ...                  CleanedDonorName CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party   50000.00  ...  Joseph Rowntree Refrom Trust Ltd            1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  112531.96  ...  Birkenhead North End Labour Club            2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee   15000.00  ...              Bord Institute Trust            3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee   25000.00  ...      Branksome Liberal Club Trust            4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee    4200.00  ...                  Bridgwater Trust            5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...        ...  ...                               ...            ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee    5807.00  ...                               NaN            NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee    3810.00  ...                               NaN            NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee    3560.00  ...                               NaN            NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee    3560.00  ...                               NaN            NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee    3810.00  ...                               NaN            NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:33:09 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:33:09 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:33:09 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:33:09 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:33:09 +0000 DEBUG:load_raw_data_last_modified: 1765107176.8895898
2025-12-07 11:33:09 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:33:09 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:33:09 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:33:09 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:33:09 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:33:09 +0000 DEBUG:utils_dir: utils
2025-12-07 11:33:09 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:33:09 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:33:09 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:33:09 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:33:09 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:33:09 +0000 DEBUG:logs_dir: logs
2025-12-07 11:33:09 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:33:09 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:33:09 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:33:09 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:33:09 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:33:09 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:33:09 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:33:09 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:33:09 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:33:09 +0000 INFO:Session state Setup complete
2025-12-07 11:33:09 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:33:09 +0000 INFO:Package setup complete
2025-12-07 11:33:09 +0000 INFO:setup_package executed successfully
2025-12-07 11:33:09 +0000 INFO:Setup completed successfully.
2025-12-07 11:33:09 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:09 +0000 INFO:Running first load function.
2025-12-07 11:33:09 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:33:09 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:09 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:09 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:09 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:09 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:33:09 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:09 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:09 +0000 INFO:firstload executed successfully
2025-12-07 11:33:09 +0000 INFO:Data first load completed successfully.
2025-12-07 11:33:09 +0000 INFO:initialise_data executed successfully
2025-12-07 11:33:09 +0000 INFO:Running Menu setup...
2025-12-07 11:33:09 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:33:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:09 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:09 +0000 INFO:App Version: v50.229
2025-12-07 11:33:09 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:33:09 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:10 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:33:10 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:33:10 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:33:10 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:33:10 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:33:10 +0000 DEBUG:Page texts: {}
2025-12-07 11:33:10 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:33:10 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:33:10 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:33:10 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:33:10 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:10 +0000 ERROR:Error in display_per_group_data_page: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 228, in load_and_filter_pergroup
    date_range2 = st.slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 626, in slider
    return self._slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 673, in _slider
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 150, in _register_element_id
    raise StreamlitDuplicateElementId(element_type)
streamlit.errors.StreamlitDuplicateElementId: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
2025-12-07 11:33:10 +0000 CRITICAL:Menu setup crashed: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 228, in load_and_filter_pergroup
    date_range2 = st.slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 626, in slider
    return self._slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 673, in _slider
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 150, in _register_element_id
    raise StreamlitDuplicateElementId(element_type)
streamlit.errors.StreamlitDuplicateElementId: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
2025-12-07 11:33:26 +0000 INFO:Streamlit App Starting...
2025-12-07 11:33:26 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:26 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:33:26 +0000 INFO:Running App setup...
2025-12-07 11:33:26 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:33:26 +0000 INFO:Setting up the package
2025-12-07 11:33:26 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:26 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:26 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:26 +0000 INFO:Version: v50.191
2025-12-07 11:33:26 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:33:26 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:26 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:security already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:directories already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:33:26 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:33:26 +0000 INFO:Session_state variables initialized
2025-12-07 11:33:26 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001B9837E84C0>}
2025-12-07 11:33:26 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:33:26 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:33:26 +0000 DEBUG:error_logged: True
2025-12-07 11:33:26 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:33:26 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:26 +0000 DEBUG:load_donorlist_data_last_modified: 1765107182.2760413
2025-12-07 11:33:26 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:33:26 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:33:26 +0000 DEBUG:data_dir: data
2025-12-07 11:33:26 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:33:26 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:33:26 +0000 DEBUG:components_dir: components
2025-12-07 11:33:26 +0000 DEBUG:selected_entity_name: All
2025-12-07 11:33:26 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:33:26 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:33:26 +0000 DEBUG:output_dir: output
2025-12-07 11:33:26 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:33:26 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship DonorStatus  ... WksSinceLastElection QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE     Company  ...               3748.0                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE     Company  ...               3755.0                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE     Company  ...               3744.0                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  Individual  ...               3745.0                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE     Company  ...               3750.0                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...         ...  ...                  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE       Other  ...               5029.0                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:33:26 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:33:26 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:33:26 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType      Value  ...                  CleanedDonorName CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party   50000.00  ...  Joseph Rowntree Refrom Trust Ltd            1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  112531.96  ...  Birkenhead North End Labour Club            2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee   15000.00  ...              Bord Institute Trust            3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee   25000.00  ...      Branksome Liberal Club Trust            4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee    4200.00  ...                  Bridgwater Trust            5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...        ...  ...                               ...            ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee    5807.00  ...                               NaN            NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee    3810.00  ...                               NaN            NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee    3560.00  ...                               NaN            NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee    3560.00  ...                               NaN            NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee    3810.00  ...                               NaN            NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:33:26 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:33:26 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:33:26 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:33:26 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:33:26 +0000 DEBUG:load_raw_data_last_modified: 1765107176.8895898
2025-12-07 11:33:26 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:33:26 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:33:26 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:33:26 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:33:26 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:33:26 +0000 DEBUG:utils_dir: utils
2025-12-07 11:33:26 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:33:26 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:33:26 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:33:26 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:33:26 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:33:26 +0000 DEBUG:logs_dir: logs
2025-12-07 11:33:26 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:33:26 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:33:26 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:33:26 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:33:26 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:33:26 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:33:26 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:33:26 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 11:33:26 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:33:26 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:33:26 +0000 INFO:Session state Setup complete
2025-12-07 11:33:26 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:33:26 +0000 INFO:Package setup complete
2025-12-07 11:33:26 +0000 INFO:setup_package executed successfully
2025-12-07 11:33:26 +0000 INFO:Setup completed successfully.
2025-12-07 11:33:26 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:26 +0000 INFO:Running first load function.
2025-12-07 11:33:26 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:33:26 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:26 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:26 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:26 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:26 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:33:26 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:26 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:26 +0000 INFO:firstload executed successfully
2025-12-07 11:33:26 +0000 INFO:Data first load completed successfully.
2025-12-07 11:33:26 +0000 INFO:initialise_data executed successfully
2025-12-07 11:33:26 +0000 INFO:Running Menu setup...
2025-12-07 11:33:26 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:33:26 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:26 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:26 +0000 INFO:App Version: v50.229
2025-12-07 11:33:26 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:33:26 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:27 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:33:27 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:33:27 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:33:27 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:33:27 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:33:27 +0000 DEBUG:Page texts: {}
2025-12-07 11:33:27 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:33:27 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:33:27 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:33:27 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:33:27 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:27 +0000 CRITICAL:Menu setup crashed: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 228, in load_and_filter_pergroup
    date_range2 = st.slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 626, in slider
    return self._slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 673, in _slider
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 150, in _register_element_id
    raise StreamlitDuplicateElementId(element_type)
streamlit.errors.StreamlitDuplicateElementId: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
2025-12-07 11:33:28 +0000 INFO:Streamlit App Starting...
2025-12-07 11:33:28 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:28 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:33:28 +0000 INFO:Running App setup...
2025-12-07 11:33:28 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 INFO:Setting up the package
2025-12-07 11:33:28 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:28 +0000 INFO:Version: v50.191
2025-12-07 11:33:28 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:28 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:security already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:directories already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:33:28 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:33:28 +0000 INFO:Session_state variables initialized
2025-12-07 11:33:28 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001B9837E84C0>}
2025-12-07 11:33:28 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:33:28 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:33:28 +0000 DEBUG:error_logged: True
2025-12-07 11:33:28 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:33:28 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:28 +0000 DEBUG:load_donorlist_data_last_modified: 1765107182.2760413
2025-12-07 11:33:28 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:33:28 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:33:28 +0000 DEBUG:data_dir: data
2025-12-07 11:33:28 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:33:28 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:33:28 +0000 DEBUG:components_dir: components
2025-12-07 11:33:28 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 11:33:28 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:33:28 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:33:28 +0000 DEBUG:output_dir: output
2025-12-07 11:33:28 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:33:28 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship DonorStatus  ... WksSinceLastElection QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE     Company  ...               3748.0                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE     Company  ...               3755.0                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE     Company  ...               3744.0                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  Individual  ...               3745.0                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE     Company  ...               3750.0                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...         ...  ...                  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE       Other  ...               5029.0                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:33:28 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:33:28 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:33:28 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType      Value  ...                  CleanedDonorName CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party   50000.00  ...  Joseph Rowntree Refrom Trust Ltd            1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  112531.96  ...  Birkenhead North End Labour Club            2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee   15000.00  ...              Bord Institute Trust            3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee   25000.00  ...      Branksome Liberal Club Trust            4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee    4200.00  ...                  Bridgwater Trust            5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...        ...  ...                               ...            ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee    5807.00  ...                               NaN            NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee    3810.00  ...                               NaN            NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee    3560.00  ...                               NaN            NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee    3560.00  ...                               NaN            NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee    3810.00  ...                               NaN            NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:33:28 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:33:28 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:33:28 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:33:28 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:33:28 +0000 DEBUG:load_raw_data_last_modified: 1765107176.8895898
2025-12-07 11:33:28 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:33:28 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:33:28 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:33:28 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:33:28 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:33:28 +0000 DEBUG:utils_dir: utils
2025-12-07 11:33:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:33:28 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:33:28 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:33:28 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:33:28 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:33:28 +0000 DEBUG:logs_dir: logs
2025-12-07 11:33:28 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:33:28 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:33:28 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:33:28 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:33:28 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:33:28 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:33:28 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:33:28 +0000 DEBUG:selected_group_entity: Regulated Entity Group
2025-12-07 11:33:28 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:33:28 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:33:28 +0000 INFO:Session state Setup complete
2025-12-07 11:33:28 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:33:28 +0000 INFO:Package setup complete
2025-12-07 11:33:28 +0000 INFO:setup_package executed successfully
2025-12-07 11:33:28 +0000 INFO:Setup completed successfully.
2025-12-07 11:33:28 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 INFO:Running first load function.
2025-12-07 11:33:28 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:28 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:28 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:28 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:33:28 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:28 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:28 +0000 INFO:firstload executed successfully
2025-12-07 11:33:28 +0000 INFO:Data first load completed successfully.
2025-12-07 11:33:28 +0000 INFO:initialise_data executed successfully
2025-12-07 11:33:28 +0000 INFO:Running Menu setup...
2025-12-07 11:33:28 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:28 +0000 INFO:App Version: v50.229
2025-12-07 11:33:28 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:33:28 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:33:28 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:33:28 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:33:28 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:33:29 +0000 DEBUG:Page texts: {}
2025-12-07 11:33:29 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:33:29 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:33:29 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:33:29 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:33:29 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:29 +0000 CRITICAL:Menu setup crashed: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 228, in load_and_filter_pergroup
    date_range2 = st.slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 626, in slider
    return self._slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 673, in _slider
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 150, in _register_element_id
    raise StreamlitDuplicateElementId(element_type)
streamlit.errors.StreamlitDuplicateElementId: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
2025-12-07 11:33:40 +0000 INFO:Streamlit App Starting...
2025-12-07 11:33:40 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:40 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:33:40 +0000 INFO:Running App setup...
2025-12-07 11:33:40 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 INFO:Setting up the package
2025-12-07 11:33:40 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:40 +0000 INFO:Version: v50.191
2025-12-07 11:33:40 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:40 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:security already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:directories already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:33:40 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:33:40 +0000 INFO:Session_state variables initialized
2025-12-07 11:33:40 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001B9837E84C0>}
2025-12-07 11:33:40 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:33:40 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:33:40 +0000 DEBUG:error_logged: True
2025-12-07 11:33:40 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:33:40 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:40 +0000 DEBUG:load_donorlist_data_last_modified: 1765107182.2760413
2025-12-07 11:33:40 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:33:40 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:33:40 +0000 DEBUG:data_dir: data
2025-12-07 11:33:40 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:33:40 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:33:40 +0000 DEBUG:components_dir: components
2025-12-07 11:33:40 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 11:33:40 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:33:40 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:33:40 +0000 DEBUG:output_dir: output
2025-12-07 11:33:40 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:33:40 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship DonorStatus  ... WksSinceLastElection QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE     Company  ...               3748.0                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE     Company  ...               3755.0                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE     Company  ...               3744.0                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  Individual  ...               3745.0                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE     Company  ...               3750.0                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...         ...  ...                  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE       Other  ...               5029.0                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:33:40 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:33:40 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:33:40 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType      Value  ...                  CleanedDonorName CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party   50000.00  ...  Joseph Rowntree Refrom Trust Ltd            1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  112531.96  ...  Birkenhead North End Labour Club            2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee   15000.00  ...              Bord Institute Trust            3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee   25000.00  ...      Branksome Liberal Club Trust            4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee    4200.00  ...                  Bridgwater Trust            5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...        ...  ...                               ...            ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee    5807.00  ...                               NaN            NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee    3810.00  ...                               NaN            NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee    3560.00  ...                               NaN            NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee    3560.00  ...                               NaN            NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee    3810.00  ...                               NaN            NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:33:40 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:33:40 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:33:40 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:33:40 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:33:40 +0000 DEBUG:load_raw_data_last_modified: 1765107176.8895898
2025-12-07 11:33:40 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:33:40 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:33:40 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:33:40 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:33:40 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:33:40 +0000 DEBUG:utils_dir: utils
2025-12-07 11:33:40 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:33:40 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:33:40 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:33:40 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:33:40 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:33:40 +0000 DEBUG:logs_dir: logs
2025-12-07 11:33:40 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:33:40 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:33:40 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:33:40 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:33:40 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:33:40 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:33:40 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:33:40 +0000 DEBUG:selected_group_entity: Party Affiliation
2025-12-07 11:33:40 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:33:40 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:33:40 +0000 INFO:Session state Setup complete
2025-12-07 11:33:40 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:33:40 +0000 INFO:Package setup complete
2025-12-07 11:33:40 +0000 INFO:setup_package executed successfully
2025-12-07 11:33:40 +0000 INFO:Setup completed successfully.
2025-12-07 11:33:40 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 INFO:Running first load function.
2025-12-07 11:33:40 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:40 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:40 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:40 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:40 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:33:40 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:40 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:40 +0000 INFO:firstload executed successfully
2025-12-07 11:33:40 +0000 INFO:Data first load completed successfully.
2025-12-07 11:33:40 +0000 INFO:initialise_data executed successfully
2025-12-07 11:33:40 +0000 INFO:Running Menu setup...
2025-12-07 11:33:40 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:40 +0000 INFO:App Version: v50.229
2025-12-07 11:33:40 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:33:40 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:33:40 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:33:40 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:33:40 +0000 DEBUG:Page texts: {}
2025-12-07 11:33:40 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:33:40 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:33:41 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:33:41 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:33:41 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:41 +0000 CRITICAL:Menu setup crashed: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 228, in load_and_filter_pergroup
    date_range2 = st.slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 626, in slider
    return self._slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 673, in _slider
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 150, in _register_element_id
    raise StreamlitDuplicateElementId(element_type)
streamlit.errors.StreamlitDuplicateElementId: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
2025-12-07 11:33:52 +0000 INFO:Streamlit App Starting...
2025-12-07 11:33:52 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:52 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:33:52 +0000 INFO:Running App setup...
2025-12-07 11:33:52 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:33:52 +0000 INFO:Setting up the package
2025-12-07 11:33:52 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:33:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:52 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:52 +0000 INFO:Version: v50.191
2025-12-07 11:33:52 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:33:52 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:52 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:security already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:directories already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:33:52 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:33:52 +0000 INFO:Session_state variables initialized
2025-12-07 11:33:52 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001B9837E84C0>}
2025-12-07 11:33:52 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:33:52 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:33:52 +0000 DEBUG:error_logged: True
2025-12-07 11:33:52 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:33:52 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:33:52 +0000 DEBUG:load_donorlist_data_last_modified: 1765107182.2760413
2025-12-07 11:33:52 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:33:52 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:33:52 +0000 DEBUG:data_dir: data
2025-12-07 11:33:52 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:33:52 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:33:52 +0000 DEBUG:components_dir: components
2025-12-07 11:33:52 +0000 DEBUG:selected_entity_name: Reform UK
2025-12-07 11:33:52 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:33:52 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:33:52 +0000 DEBUG:output_dir: output
2025-12-07 11:33:52 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:33:52 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship DonorStatus  ... WksSinceLastElection QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE     Company  ...               3748.0                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE     Company  ...               3755.0                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE     Company  ...               3744.0                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  Individual  ...               3745.0                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE     Company  ...               3750.0                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...         ...  ...                  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE       Other  ...               5029.0                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE       Other  ...               5033.0                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:33:52 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:33:52 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:33:52 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType      Value  ...                  CleanedDonorName CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party   50000.00  ...  Joseph Rowntree Refrom Trust Ltd            1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  112531.96  ...  Birkenhead North End Labour Club            2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee   15000.00  ...              Bord Institute Trust            3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee   25000.00  ...      Branksome Liberal Club Trust            4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee    4200.00  ...                  Bridgwater Trust            5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...        ...  ...                               ...            ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee    5807.00  ...                               NaN            NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee    3810.00  ...                               NaN            NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee    3560.00  ...                               NaN            NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee    3560.00  ...                               NaN            NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee    3810.00  ...                               NaN            NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:33:52 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:33:52 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:33:52 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:33:52 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:33:52 +0000 DEBUG:load_raw_data_last_modified: 1765107176.8895898
2025-12-07 11:33:52 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:33:52 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:33:52 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:33:52 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:33:52 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:33:52 +0000 DEBUG:utils_dir: utils
2025-12-07 11:33:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:33:52 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:33:52 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:33:52 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:33:52 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:33:52 +0000 DEBUG:logs_dir: logs
2025-12-07 11:33:52 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:33:52 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:33:52 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:33:52 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:33:52 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:33:52 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:33:52 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:33:52 +0000 DEBUG:selected_group_entity: Party Affiliation
2025-12-07 11:33:52 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:33:52 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:33:52 +0000 INFO:Session state Setup complete
2025-12-07 11:33:52 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:33:52 +0000 INFO:Package setup complete
2025-12-07 11:33:52 +0000 INFO:setup_package executed successfully
2025-12-07 11:33:52 +0000 INFO:Setup completed successfully.
2025-12-07 11:33:52 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:33:52 +0000 INFO:Running first load function.
2025-12-07 11:33:52 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:33:52 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:52 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:33:52 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:52 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:52 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:33:52 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:33:52 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:33:52 +0000 INFO:firstload executed successfully
2025-12-07 11:33:52 +0000 INFO:Data first load completed successfully.
2025-12-07 11:33:52 +0000 INFO:initialise_data executed successfully
2025-12-07 11:33:52 +0000 INFO:Running Menu setup...
2025-12-07 11:33:52 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:33:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:33:52 +0000 INFO:get_git_version executed successfully
2025-12-07 11:33:52 +0000 INFO:App Version: v50.229
2025-12-07 11:33:52 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:33:52 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:33:53 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:33:53 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:33:53 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:33:53 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:33:53 +0000 DEBUG:Page texts: {}
2025-12-07 11:33:53 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:33:53 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:33:53 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:33:53 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:33:53 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:33:53 +0000 CRITICAL:Menu setup crashed: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 228, in load_and_filter_pergroup
    date_range2 = st.slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 626, in slider
    return self._slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 673, in _slider
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 150, in _register_element_id
    raise StreamlitDuplicateElementId(element_type)
streamlit.errors.StreamlitDuplicateElementId: There are multiple `slider` elements with the same auto-generated ID. When this element is created, it is assigned an internal ID based on the element type and provided parameters. Multiple elements with the same type and parameters will cause this error.

To fix this error, please pass a unique `key` argument to the `slider` element.
2025-12-07 11:40:15 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:40:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:15 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:16 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:16 +0000 INFO:Streamlit App Starting...
2025-12-07 11:40:16 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:40:16 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:40:16 +0000 INFO:Running App setup...
2025-12-07 11:40:16 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:40:16 +0000 INFO:Setting up the package
2025-12-07 11:40:16 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:40:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:16 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:16 +0000 INFO:Version: v50.191
2025-12-07 11:40:16 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:40:16 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:40:16 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:40:16 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:40:16 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:40:16 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:40:16 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:40:16 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:40:16 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:40:16 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:40:16 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:40:16 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:40:16 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:40:16 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:40:16 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:40:16 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:40:16 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:40:16 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:40:16 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:40:16 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:40:16 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:40:16 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:40:16 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:40:16 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:40:16 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:40:16 +0000 INFO:Session_state variables initialized
2025-12-07 11:40:16 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:40:17 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:40:17 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:40:17 +0000 DEBUG:data_dir: data
2025-12-07 11:40:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:40:17 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:40:17 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:40:17 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:40:17 +0000 DEBUG:utils_dir: utils
2025-12-07 11:40:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:40:17 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:40:17 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:40:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:40:17 +0000 DEBUG:output_dir: output
2025-12-07 11:40:17 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:40:17 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:40:17 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:40:17 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:40:17 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:40:17 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:40:17 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:40:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:40:17 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:40:17 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:40:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:40:17 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:40:17 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:40:17 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:40:17 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:40:17 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:40:17 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:40:17 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:40:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:40:17 +0000 DEBUG:logs_dir: logs
2025-12-07 11:40:17 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:40:17 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:40:17 +0000 DEBUG:components_dir: components
2025-12-07 11:40:17 +0000 INFO:Session state Setup complete
2025-12-07 11:40:17 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:40:17 +0000 INFO:Package setup complete
2025-12-07 11:40:17 +0000 INFO:setup_package executed successfully
2025-12-07 11:40:17 +0000 INFO:Setup completed successfully.
2025-12-07 11:40:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:17 +0000 INFO:Running first load function.
2025-12-07 11:40:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:40:17 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:40:17 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:40:17 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:40:17 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:40:17 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:40:17 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:40:17 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:40:17 +0000 INFO:Last modification time: 1765107176.8895898
2025-12-07 11:40:17 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:40:17 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765107176.8895898 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:40:17 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:40:17 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:40:17 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:40:17 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 INFO:Cleaning up raw data
2025-12-07 11:40:17 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:40:17 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:17 +0000 INFO:Original file path: None
2025-12-07 11:40:17 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:40:17 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:40:17 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:40:17 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:40:19 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:40:19 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:40:19 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:40:19 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:40:19 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:40:19 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:40:19 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:40:19 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:40:20 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:40:20 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:40:20 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:40:20 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:40:20 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:40:20 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:40:21 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:40:21 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:40:21 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:40:22 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:40:22 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:40:22 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:40:22 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:22 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:22 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:40:22 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:22 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:40:22 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:40:22 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:40:22 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:40:22 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:40:22 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:40:22 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:40:22 +0000 INFO:Current modification time: 1765107621.9958258
2025-12-07 11:40:22 +0000 INFO:Last modification time: 1765107176.8895898
2025-12-07 11:40:22 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:40:22 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:40:22 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:40:22 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:40:22 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:40:22 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:40:24 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:40:24 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:40:24 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:40:24 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:40:24 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:40:24 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:40:24 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:40:24 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:40:24 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:40:24 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:40:24 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:40:24 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:40:24 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:40:24 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:40:24 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:40:24 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:40:24 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:40:24 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:40:24 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:40:24 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:40:27 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:40:27 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:40:27 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:40:27 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:40:27 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:40:27 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:40:27 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:40:27 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:40:27 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:40:27 +0000 INFO:Current modification time: 1765107627.26128
2025-12-07 11:40:27 +0000 INFO:Last modification time: 1765107182.2760413
2025-12-07 11:40:27 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:40:27 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:40:27 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:40:27 +0000 INFO:Donor Data summary completed
2025-12-07 11:40:27 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:40:27 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:40:27 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:40:27 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:40:27 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:40:27 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:40:27 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:40:27 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:40:27 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:40:27 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:40:27 +0000 INFO:Current modification time: 1765107627.26128
2025-12-07 11:40:27 +0000 INFO:Last modification time: 1765107627.26128
2025-12-07 11:40:27 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:40:27 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765107627.26128 instead of output\cleaned_data.csv
2025-12-07 11:40:27 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:40:27 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:40:27 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:40:27 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:40:27 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:40:27 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:40:27 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:40:27 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:40:27 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:40:27 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:40:27 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:40:27 +0000 INFO:firstload executed successfully
2025-12-07 11:40:27 +0000 INFO:Data first load completed successfully.
2025-12-07 11:40:27 +0000 INFO:initialise_data executed successfully
2025-12-07 11:40:27 +0000 INFO:Running Menu setup...
2025-12-07 11:40:27 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:27 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:28 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:28 +0000 INFO:App Version: v50.229
2025-12-07 11:40:28 +0000 INFO:Switched to page: Introduction
2025-12-07 11:40:28 +0000 INFO:pagesetup executed successfully
2025-12-07 11:40:28 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:40:28 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:40:52 +0000 INFO:Streamlit App Starting...
2025-12-07 11:40:52 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:40:52 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:40:52 +0000 INFO:Running App setup...
2025-12-07 11:40:52 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:40:52 +0000 INFO:Setting up the package
2025-12-07 11:40:52 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:40:52 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:52 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:52 +0000 INFO:Version: v50.191
2025-12-07 11:40:52 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:40:52 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:40:52 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:security already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:directories already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:40:52 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:40:52 +0000 INFO:Session_state variables initialized
2025-12-07 11:40:52 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:40:52 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:40:53 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:40:53 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:40:53 +0000 DEBUG:data_dir: data
2025-12-07 11:40:53 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:40:53 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:40:53 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:40:53 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:40:53 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:40:53 +0000 DEBUG:utils_dir: utils
2025-12-07 11:40:53 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:40:53 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:40:53 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:40:53 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:40:53 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:40:53 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:40:53 +0000 DEBUG:output_dir: output
2025-12-07 11:40:53 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:40:53 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:40:53 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:40:53 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:40:53 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:40:53 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:40:53 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:40:53 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:40:53 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:40:53 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:40:53 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:40:53 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:40:53 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:40:53 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:40:53 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:40:53 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:40:53 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:40:53 +0000 DEBUG:load_donorlist_data_last_modified: 1765107627.26128
2025-12-07 11:40:53 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:40:53 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:40:53 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:40:53 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:40:53 +0000 DEBUG:logs_dir: logs
2025-12-07 11:40:53 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x00000200F36500D0>}
2025-12-07 11:40:53 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:40:53 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:40:53 +0000 DEBUG:load_raw_data_last_modified: 1765107621.9958258
2025-12-07 11:40:53 +0000 DEBUG:components_dir: components
2025-12-07 11:40:53 +0000 INFO:Session state Setup complete
2025-12-07 11:40:53 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:40:53 +0000 INFO:Package setup complete
2025-12-07 11:40:53 +0000 INFO:setup_package executed successfully
2025-12-07 11:40:53 +0000 INFO:Setup completed successfully.
2025-12-07 11:40:53 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:40:53 +0000 INFO:Running first load function.
2025-12-07 11:40:53 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:40:53 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:40:53 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:40:53 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:40:53 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:40:53 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:40:53 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:40:53 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:40:53 +0000 INFO:firstload executed successfully
2025-12-07 11:40:53 +0000 INFO:Data first load completed successfully.
2025-12-07 11:40:53 +0000 INFO:initialise_data executed successfully
2025-12-07 11:40:53 +0000 INFO:Running Menu setup...
2025-12-07 11:40:53 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:40:53 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:40:53 +0000 INFO:get_git_version executed successfully
2025-12-07 11:40:53 +0000 INFO:App Version: v50.229
2025-12-07 11:40:53 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:40:53 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:40:53 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:40:53 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:40:53 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:40:53 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:40:53 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:40:53 +0000 DEBUG:Page texts: {}
2025-12-07 11:40:53 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:40:53 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:40:54 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:40:54 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:40:54 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:40:54 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='date_range_slider'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 228, in load_and_filter_pergroup
    date_range2 = st.slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 626, in slider
    return self._slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 673, in _slider
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='date_range_slider'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:40:54 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='date_range_slider'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 228, in load_and_filter_pergroup
    date_range2 = st.slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 626, in slider
    return self._slider(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\slider.py", line 673, in _slider
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='date_range_slider'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:44:03 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:44:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:04 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:04 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:04 +0000 INFO:Streamlit App Starting...
2025-12-07 11:44:04 +0000 INFO:Streamlit App Starting...
2025-12-07 11:44:04 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:44:04 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:44:04 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:44:04 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:44:04 +0000 INFO:Running App setup...
2025-12-07 11:44:04 +0000 INFO:Running App setup...
2025-12-07 11:44:04 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:44:04 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:44:04 +0000 INFO:Setting up the package
2025-12-07 11:44:04 +0000 INFO:Setting up the package
2025-12-07 11:44:04 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:44:04 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:44:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:04 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:05 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:05 +0000 INFO:Version: v50.191
2025-12-07 11:44:05 +0000 INFO:Version: v50.191
2025-12-07 11:44:05 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:44:05 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:44:05 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:44:05 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:44:05 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:44:05 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:44:05 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:44:05 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:44:05 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:44:05 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:44:05 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:44:05 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:44:05 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:44:05 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:44:05 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:44:05 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:44:05 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:44:05 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:44:05 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:44:05 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:44:05 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:44:05 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:44:05 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:44:05 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:44:05 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:44:05 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:44:05 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:44:05 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:44:05 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:44:05 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:44:05 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:44:05 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:44:05 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:44:05 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:44:05 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:44:05 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:44:05 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:44:05 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:44:05 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:44:05 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:44:05 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:44:05 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:44:05 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:44:05 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:44:05 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:44:05 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:44:05 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:44:05 +0000 INFO:Session_state variables initialized
2025-12-07 11:44:05 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:44:05 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:44:05 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:44:05 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:44:05 +0000 INFO:Session_state variables initialized
2025-12-07 11:44:05 +0000 DEBUG:output_dir: output
2025-12-07 11:44:05 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:44:05 +0000 DEBUG:utils_dir: utils
2025-12-07 11:44:05 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:44:05 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:44:05 +0000 DEBUG:output_dir: output
2025-12-07 11:44:05 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:44:05 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:44:05 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:44:05 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:44:05 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:44:05 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:44:05 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:44:05 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:44:05 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:44:05 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:44:05 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:44:05 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:44:05 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:44:05 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:44:05 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:44:05 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:44:05 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:44:05 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:44:05 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:44:05 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:44:05 +0000 DEBUG:components_dir: components
2025-12-07 11:44:05 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:44:05 +0000 DEBUG:data_dir: data
2025-12-07 11:44:05 +0000 DEBUG:components_dir: components
2025-12-07 11:44:05 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:44:05 +0000 DEBUG:data_dir: data
2025-12-07 11:44:05 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:44:05 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:44:05 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:44:05 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:44:05 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:44:05 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:44:05 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:44:05 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:44:05 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:44:05 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:44:05 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:44:05 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:44:05 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:44:05 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:44:05 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:44:05 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:44:05 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:44:05 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:44:05 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:44:05 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:44:05 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:44:05 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:44:05 +0000 DEBUG:logs_dir: logs
2025-12-07 11:44:05 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:44:05 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:44:05 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:44:05 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:44:05 +0000 DEBUG:logs_dir: logs
2025-12-07 11:44:05 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:44:05 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:44:05 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:44:05 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:44:05 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:44:05 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:44:05 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:44:05 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:44:05 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:44:05 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:44:05 +0000 INFO:Session state Setup complete
2025-12-07 11:44:05 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:44:05 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:44:05 +0000 DEBUG:utils_dir: utils
2025-12-07 11:44:05 +0000 INFO:Package setup complete
2025-12-07 11:44:05 +0000 INFO:Session state Setup complete
2025-12-07 11:44:05 +0000 INFO:setup_package executed successfully
2025-12-07 11:44:05 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:44:05 +0000 INFO:Setup completed successfully.
2025-12-07 11:44:05 +0000 INFO:Package setup complete
2025-12-07 11:44:05 +0000 INFO:setup_package executed successfully
2025-12-07 11:44:05 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 INFO:Setup completed successfully.
2025-12-07 11:44:05 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:05 +0000 INFO:Running first load function.
2025-12-07 11:44:05 +0000 INFO:Running first load function.
2025-12-07 11:44:05 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:44:05 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:44:05 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:44:05 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:44:05 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:44:05 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:44:05 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:44:05 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:44:05 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:44:05 +0000 INFO:Last modification time: 1765107621.9958258
2025-12-07 11:44:05 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:44:05 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765107621.9958258 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:44:05 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:44:05 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:44:06 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:44:06 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:44:06 +0000 INFO:Cleaning up raw data
2025-12-07 11:44:06 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:06 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:44:06 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:44:06 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:44:06 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:44:06 +0000 INFO:Cleaning up raw data
2025-12-07 11:44:06 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:44:06 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:06 +0000 INFO:Original file path: None
2025-12-07 11:44:06 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:44:06 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:44:06 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:44:06 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:44:07 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:44:07 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:44:08 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:44:08 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:44:08 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:44:08 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:44:08 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:44:08 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:44:08 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:44:08 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:44:08 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:44:08 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:44:08 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:44:08 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:44:10 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:44:10 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:44:10 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:44:10 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:44:10 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:44:10 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:44:10 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:10 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:10 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:44:10 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:10 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:44:10 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:44:10 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:44:10 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:44:10 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:44:10 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:44:10 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:44:10 +0000 INFO:Current modification time: 1765107850.052289
2025-12-07 11:44:10 +0000 INFO:Last modification time: 1765107621.9958258
2025-12-07 11:44:10 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:44:10 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:44:10 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:44:10 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:44:10 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:44:10 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:44:12 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:44:12 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:44:12 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:44:12 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:44:12 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:44:12 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:44:12 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:44:12 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:44:12 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:44:12 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:44:12 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:44:12 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:44:12 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:44:12 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:44:12 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:44:12 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:44:12 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:44:12 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:44:13 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:44:13 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:44:15 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:44:15 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:44:15 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:44:15 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:44:15 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:44:15 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:44:15 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:44:15 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:44:15 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:44:15 +0000 INFO:Current modification time: 1765107855.115641
2025-12-07 11:44:15 +0000 INFO:Last modification time: 1765107627.26128
2025-12-07 11:44:15 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:44:15 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:44:15 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:44:15 +0000 INFO:Donor Data summary completed
2025-12-07 11:44:15 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:44:15 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:44:15 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:44:15 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:44:15 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:44:15 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:44:15 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:44:15 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:44:15 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:44:15 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:44:15 +0000 INFO:Current modification time: 1765107855.115641
2025-12-07 11:44:15 +0000 INFO:Last modification time: 1765107855.115641
2025-12-07 11:44:15 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:44:15 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765107855.115641 instead of output\cleaned_data.csv
2025-12-07 11:44:15 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:44:15 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:44:15 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:44:15 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:44:15 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:44:15 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:44:15 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:44:15 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:44:15 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:44:15 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:44:15 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:44:15 +0000 INFO:firstload executed successfully
2025-12-07 11:44:15 +0000 INFO:Data first load completed successfully.
2025-12-07 11:44:15 +0000 INFO:initialise_data executed successfully
2025-12-07 11:44:15 +0000 INFO:Running Menu setup...
2025-12-07 11:44:15 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:15 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:15 +0000 INFO:App Version: v50.229
2025-12-07 11:44:15 +0000 INFO:Switched to page: Introduction
2025-12-07 11:44:15 +0000 INFO:pagesetup executed successfully
2025-12-07 11:44:15 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:44:15 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:44:23 +0000 INFO:Streamlit App Starting...
2025-12-07 11:44:23 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:44:23 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:44:23 +0000 INFO:Running App setup...
2025-12-07 11:44:23 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:44:23 +0000 INFO:Setting up the package
2025-12-07 11:44:23 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:44:23 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:23 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:23 +0000 INFO:Version: v50.191
2025-12-07 11:44:23 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:44:23 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:44:23 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:security already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:directories already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:44:23 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:44:23 +0000 INFO:Session_state variables initialized
2025-12-07 11:44:23 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:44:23 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:44:23 +0000 DEBUG:output_dir: output
2025-12-07 11:44:23 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:44:23 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:44:23 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:44:23 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:44:23 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:44:23 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:44:23 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:44:23 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:44:23 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:44:23 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:44:23 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:44:23 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:44:23 +0000 DEBUG:components_dir: components
2025-12-07 11:44:23 +0000 DEBUG:data_dir: data
2025-12-07 11:44:23 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:44:23 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:44:23 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:44:23 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:44:23 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:44:23 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:44:23 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:44:23 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:44:23 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:44:23 +0000 DEBUG:load_raw_data_last_modified: 1765107850.052289
2025-12-07 11:44:23 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:44:23 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:44:23 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:44:23 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:44:23 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:44:23 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:44:23 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:44:23 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:44:23 +0000 DEBUG:logs_dir: logs
2025-12-07 11:44:23 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x0000020B91BB44C0>}
2025-12-07 11:44:23 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:44:23 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:44:23 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:44:23 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:44:23 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:44:23 +0000 DEBUG:load_donorlist_data_last_modified: 1765107855.115641
2025-12-07 11:44:23 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:44:23 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:44:23 +0000 DEBUG:utils_dir: utils
2025-12-07 11:44:23 +0000 INFO:Session state Setup complete
2025-12-07 11:44:23 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:44:23 +0000 INFO:Package setup complete
2025-12-07 11:44:23 +0000 INFO:setup_package executed successfully
2025-12-07 11:44:23 +0000 INFO:Setup completed successfully.
2025-12-07 11:44:23 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:44:23 +0000 INFO:Running first load function.
2025-12-07 11:44:23 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:44:23 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:44:23 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:44:23 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:44:23 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:44:23 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:44:23 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:44:23 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:44:23 +0000 INFO:firstload executed successfully
2025-12-07 11:44:23 +0000 INFO:Data first load completed successfully.
2025-12-07 11:44:23 +0000 INFO:initialise_data executed successfully
2025-12-07 11:44:23 +0000 INFO:Running Menu setup...
2025-12-07 11:44:23 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:44:23 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:44:23 +0000 INFO:get_git_version executed successfully
2025-12-07 11:44:23 +0000 INFO:App Version: v50.229
2025-12-07 11:44:23 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:44:23 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:44:24 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:44:24 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:44:24 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:44:24 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:44:24 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:44:24 +0000 DEBUG:Page texts: {}
2025-12-07 11:44:24 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:44:24 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:44:24 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:44:24 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:44:24 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:44:24 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 266, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:44:24 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 266, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:46:28 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:46:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:29 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:29 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:30 +0000 INFO:Streamlit App Starting...
2025-12-07 11:46:30 +0000 INFO:Streamlit App Starting...
2025-12-07 11:46:30 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:46:30 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:46:30 +0000 INFO:Running App setup...
2025-12-07 11:46:30 +0000 INFO:Running App setup...
2025-12-07 11:46:30 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:Setting up the package
2025-12-07 11:46:30 +0000 INFO:Setting up the package
2025-12-07 11:46:30 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:30 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:30 +0000 INFO:Version: v50.191
2025-12-07 11:46:30 +0000 INFO:Version: v50.191
2025-12-07 11:46:30 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:46:30 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:46:30 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:46:30 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:46:30 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:46:30 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:46:30 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:46:30 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:46:30 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:46:30 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:46:30 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:46:30 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:46:30 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:46:30 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:46:30 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:46:30 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:46:30 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:46:30 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:46:30 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:46:30 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:46:30 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:46:30 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:46:30 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:46:30 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:46:30 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:46:30 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:46:30 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:46:30 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:46:30 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:46:30 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:46:30 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:46:30 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:46:30 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:46:30 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:46:30 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:46:30 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:46:30 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:46:30 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:46:30 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:46:30 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:46:30 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:46:30 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:46:30 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:46:30 +0000 INFO:Session_state variables initialized
2025-12-07 11:46:30 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:46:30 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:46:30 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:46:30 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:46:30 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:46:30 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:46:30 +0000 INFO:Session_state variables initialized
2025-12-07 11:46:30 +0000 DEBUG:utils_dir: utils
2025-12-07 11:46:30 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:46:30 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:46:30 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:46:30 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:46:30 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:46:30 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:46:30 +0000 DEBUG:utils_dir: utils
2025-12-07 11:46:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:46:30 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:46:30 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:46:30 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:46:30 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:46:30 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:46:30 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:46:30 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:46:30 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:46:30 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:46:30 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:46:30 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:46:30 +0000 DEBUG:data_dir: data
2025-12-07 11:46:30 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:46:30 +0000 DEBUG:components_dir: components
2025-12-07 11:46:30 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:46:30 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:46:30 +0000 DEBUG:data_dir: data
2025-12-07 11:46:30 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:46:30 +0000 DEBUG:components_dir: components
2025-12-07 11:46:30 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:46:30 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:46:30 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:46:30 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:46:30 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:46:30 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:46:30 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:46:30 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:46:30 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:46:30 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:46:30 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:46:30 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:46:30 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:46:30 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:46:30 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:46:30 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:46:30 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:46:30 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:46:30 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:46:30 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:46:30 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:46:30 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:46:30 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:46:30 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:46:30 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:46:30 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:46:30 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:46:30 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:46:30 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:46:30 +0000 DEBUG:output_dir: output
2025-12-07 11:46:30 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:46:30 +0000 DEBUG:logs_dir: logs
2025-12-07 11:46:30 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:46:30 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:46:30 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:46:30 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:46:30 +0000 DEBUG:output_dir: output
2025-12-07 11:46:30 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:46:30 +0000 DEBUG:logs_dir: logs
2025-12-07 11:46:30 +0000 INFO:Session state Setup complete
2025-12-07 11:46:30 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:46:30 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:46:30 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:46:30 +0000 INFO:Package setup complete
2025-12-07 11:46:30 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:46:30 +0000 INFO:setup_package executed successfully
2025-12-07 11:46:30 +0000 INFO:Session state Setup complete
2025-12-07 11:46:30 +0000 INFO:Setup completed successfully.
2025-12-07 11:46:30 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:46:30 +0000 INFO:Package setup complete
2025-12-07 11:46:30 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:setup_package executed successfully
2025-12-07 11:46:30 +0000 INFO:Setup completed successfully.
2025-12-07 11:46:30 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:30 +0000 INFO:Running first load function.
2025-12-07 11:46:30 +0000 INFO:Running first load function.
2025-12-07 11:46:30 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:46:30 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:46:30 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:46:30 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:46:30 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:46:30 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:46:30 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:46:30 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:46:30 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:46:30 +0000 INFO:Last modification time: 1765107850.052289
2025-12-07 11:46:30 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:46:30 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765107850.052289 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:46:30 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:46:30 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:46:31 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:46:31 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:46:31 +0000 INFO:Cleaning up raw data
2025-12-07 11:46:31 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:46:31 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:31 +0000 INFO:Original file path: None
2025-12-07 11:46:31 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:46:31 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:46:31 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:46:31 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:46:32 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:46:32 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:32 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:46:32 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:46:32 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:46:32 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:46:32 +0000 INFO:Cleaning up raw data
2025-12-07 11:46:32 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:46:32 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:46:34 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:46:34 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:46:34 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:46:34 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:46:34 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:46:34 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:46:34 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:46:34 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:46:35 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:46:35 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:46:35 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:46:35 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:46:35 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:46:35 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:46:37 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:46:37 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:46:37 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:46:37 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:46:37 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:46:37 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:46:37 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:37 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:37 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:46:37 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:37 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:46:37 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:46:37 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:46:37 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:46:37 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:46:37 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:46:37 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:46:37 +0000 INFO:Current modification time: 1765107997.0481977
2025-12-07 11:46:37 +0000 INFO:Last modification time: 1765107850.052289
2025-12-07 11:46:37 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:46:37 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:46:37 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:46:37 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:46:37 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:46:37 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:46:39 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:46:39 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:46:39 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:46:39 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:46:39 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:46:39 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:46:39 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:46:39 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:46:39 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:46:39 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:46:39 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:46:39 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:46:39 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:46:39 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:46:39 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:46:39 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:46:39 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:46:39 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:46:40 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:46:40 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:46:42 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:46:42 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:46:42 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:46:42 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:46:42 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:46:42 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:46:42 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:46:42 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:46:42 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:46:42 +0000 INFO:Current modification time: 1765108002.2410846
2025-12-07 11:46:42 +0000 INFO:Last modification time: 1765107855.115641
2025-12-07 11:46:42 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:46:42 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:46:42 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:46:42 +0000 INFO:Donor Data summary completed
2025-12-07 11:46:42 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:46:42 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:46:42 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:46:42 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:46:42 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:46:42 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:46:42 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:46:42 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:46:42 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:46:42 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:46:42 +0000 INFO:Current modification time: 1765108002.2410846
2025-12-07 11:46:42 +0000 INFO:Last modification time: 1765108002.2410846
2025-12-07 11:46:42 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:46:42 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765108002.2410846 instead of output\cleaned_data.csv
2025-12-07 11:46:42 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:46:42 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:46:42 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:46:42 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:46:42 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:46:42 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:46:42 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:46:42 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:46:42 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:46:42 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:46:42 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:46:42 +0000 INFO:firstload executed successfully
2025-12-07 11:46:42 +0000 INFO:Data first load completed successfully.
2025-12-07 11:46:42 +0000 INFO:initialise_data executed successfully
2025-12-07 11:46:42 +0000 INFO:Running Menu setup...
2025-12-07 11:46:42 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:42 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:43 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:43 +0000 INFO:App Version: v50.229
2025-12-07 11:46:43 +0000 INFO:Switched to page: Introduction
2025-12-07 11:46:43 +0000 INFO:pagesetup executed successfully
2025-12-07 11:46:43 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:46:43 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:46:47 +0000 INFO:Streamlit App Starting...
2025-12-07 11:46:47 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:46:47 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:46:47 +0000 INFO:Running App setup...
2025-12-07 11:46:47 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:46:47 +0000 INFO:Setting up the package
2025-12-07 11:46:47 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:46:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:47 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:47 +0000 INFO:Version: v50.191
2025-12-07 11:46:47 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:46:47 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:46:47 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:security already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:directories already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:46:47 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:46:47 +0000 INFO:Session_state variables initialized
2025-12-07 11:46:47 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:46:47 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x0000022E30D30280>}
2025-12-07 11:46:47 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:46:47 +0000 DEBUG:load_raw_data_last_modified: 1765107997.0481977
2025-12-07 11:46:47 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:46:47 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:46:47 +0000 DEBUG:utils_dir: utils
2025-12-07 11:46:47 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:46:47 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:46:47 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:46:47 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:46:47 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:46:47 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:46:47 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:46:47 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:46:47 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:46:47 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:46:47 +0000 DEBUG:data_dir: data
2025-12-07 11:46:47 +0000 DEBUG:components_dir: components
2025-12-07 11:46:47 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:46:47 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:46:47 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:46:47 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:46:47 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:46:47 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:46:47 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:46:47 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:46:47 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:46:47 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:46:47 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:46:47 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:46:47 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:46:47 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:46:47 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:46:47 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:46:47 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:46:47 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:46:47 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:46:47 +0000 DEBUG:load_donorlist_data_last_modified: 1765108002.2410846
2025-12-07 11:46:47 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:46:47 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:46:47 +0000 DEBUG:output_dir: output
2025-12-07 11:46:47 +0000 DEBUG:logs_dir: logs
2025-12-07 11:46:47 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:46:47 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:46:47 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:46:47 +0000 INFO:Session state Setup complete
2025-12-07 11:46:47 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:46:47 +0000 INFO:Package setup complete
2025-12-07 11:46:47 +0000 INFO:setup_package executed successfully
2025-12-07 11:46:47 +0000 INFO:Setup completed successfully.
2025-12-07 11:46:47 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:46:47 +0000 INFO:Running first load function.
2025-12-07 11:46:47 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:46:47 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:46:47 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:46:47 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:46:47 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:46:47 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:46:47 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:46:47 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:46:47 +0000 INFO:firstload executed successfully
2025-12-07 11:46:47 +0000 INFO:Data first load completed successfully.
2025-12-07 11:46:47 +0000 INFO:initialise_data executed successfully
2025-12-07 11:46:47 +0000 INFO:Running Menu setup...
2025-12-07 11:46:47 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:46:47 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:46:47 +0000 INFO:get_git_version executed successfully
2025-12-07 11:46:47 +0000 INFO:App Version: v50.229
2025-12-07 11:46:47 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:46:47 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:46:48 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:46:48 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:46:48 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:46:48 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:46:48 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:46:48 +0000 DEBUG:Page texts: {}
2025-12-07 11:46:48 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:46:48 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:46:49 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:46:49 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:46:49 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:46:49 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 33, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 271, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:46:49 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 33, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 271, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:47:08 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:47:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:09 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:10 +0000 INFO:Streamlit App Starting...
2025-12-07 11:47:10 +0000 INFO:Streamlit App Starting...
2025-12-07 11:47:10 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:47:10 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:47:10 +0000 INFO:Running App setup...
2025-12-07 11:47:10 +0000 INFO:Running App setup...
2025-12-07 11:47:10 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:Setting up the package
2025-12-07 11:47:10 +0000 INFO:Setting up the package
2025-12-07 11:47:10 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:10 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:10 +0000 INFO:Version: v50.191
2025-12-07 11:47:10 +0000 INFO:Version: v50.191
2025-12-07 11:47:10 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:47:10 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:47:10 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:47:10 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:47:10 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:47:10 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:47:10 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:47:10 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:47:10 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:47:10 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:47:10 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:47:10 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:47:10 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:47:10 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:47:10 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:47:10 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:47:10 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:47:10 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:47:10 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:47:10 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:47:10 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:47:10 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:47:10 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:47:10 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:47:10 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:47:10 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:47:10 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:47:10 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:47:10 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:47:10 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:47:10 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:47:10 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:47:10 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:47:10 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:47:10 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:47:10 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:47:10 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:47:10 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:47:10 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:47:10 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:47:10 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:47:10 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:47:10 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:47:10 +0000 INFO:Session_state variables initialized
2025-12-07 11:47:10 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:47:10 +0000 DEBUG:logs_dir: logs
2025-12-07 11:47:10 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:47:10 +0000 DEBUG:utils_dir: utils
2025-12-07 11:47:10 +0000 INFO:Session_state variables initialized
2025-12-07 11:47:10 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:47:10 +0000 DEBUG:logs_dir: logs
2025-12-07 11:47:10 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:47:10 +0000 DEBUG:utils_dir: utils
2025-12-07 11:47:10 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:47:10 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:47:10 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:47:10 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:47:10 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:47:10 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:47:10 +0000 DEBUG:data_dir: data
2025-12-07 11:47:10 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:47:10 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:47:10 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:47:10 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:47:10 +0000 DEBUG:data_dir: data
2025-12-07 11:47:10 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:47:10 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:47:10 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:47:10 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:47:10 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:47:10 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:47:10 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:47:10 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:47:10 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:47:10 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:47:10 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:47:10 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:47:10 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:47:10 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:47:10 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:47:10 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:47:10 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:47:10 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:47:10 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:47:10 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:47:10 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:47:10 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:47:10 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:47:10 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:47:10 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:47:10 +0000 DEBUG:output_dir: output
2025-12-07 11:47:10 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:47:10 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:47:10 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:47:10 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:47:10 +0000 DEBUG:output_dir: output
2025-12-07 11:47:10 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:47:10 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:47:10 +0000 DEBUG:components_dir: components
2025-12-07 11:47:10 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:47:10 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:47:10 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:47:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:47:10 +0000 DEBUG:components_dir: components
2025-12-07 11:47:10 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:47:10 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:47:10 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:47:10 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:47:10 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:47:10 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:47:10 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:47:10 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:47:10 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:47:10 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:47:10 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:47:10 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:47:10 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:47:10 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:47:10 +0000 INFO:Session state Setup complete
2025-12-07 11:47:10 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:47:10 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:47:10 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:47:10 +0000 INFO:Package setup complete
2025-12-07 11:47:10 +0000 INFO:Session state Setup complete
2025-12-07 11:47:10 +0000 INFO:setup_package executed successfully
2025-12-07 11:47:10 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:47:10 +0000 INFO:Setup completed successfully.
2025-12-07 11:47:10 +0000 INFO:Package setup complete
2025-12-07 11:47:10 +0000 INFO:setup_package executed successfully
2025-12-07 11:47:10 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:Setup completed successfully.
2025-12-07 11:47:10 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:10 +0000 INFO:Running first load function.
2025-12-07 11:47:10 +0000 INFO:Running first load function.
2025-12-07 11:47:10 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:47:10 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:47:10 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:47:10 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:47:10 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:47:10 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:47:10 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:47:10 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:47:10 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:47:10 +0000 INFO:Last modification time: 1765107997.0481977
2025-12-07 11:47:10 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:47:10 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765107997.0481977 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:47:10 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:47:11 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:47:11 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:47:11 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:47:11 +0000 INFO:Cleaning up raw data
2025-12-07 11:47:11 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:47:11 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:11 +0000 INFO:Original file path: None
2025-12-07 11:47:11 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:47:11 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:47:11 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:47:11 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:47:13 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:47:13 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:13 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:47:13 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:47:13 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:47:13 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:47:13 +0000 INFO:Cleaning up raw data
2025-12-07 11:47:13 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:47:13 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:47:15 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:47:15 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:47:15 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:47:15 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:47:15 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:47:15 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:47:15 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:47:15 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:47:15 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:47:15 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:47:15 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:47:15 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:47:15 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:47:15 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:47:17 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:47:17 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:47:17 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:47:17 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:47:17 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:47:17 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:47:17 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:17 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:17 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:47:17 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:17 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:47:17 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:47:17 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:47:17 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:47:17 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:47:17 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:47:17 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:47:17 +0000 INFO:Current modification time: 1765108037.7635841
2025-12-07 11:47:17 +0000 INFO:Last modification time: 1765107997.0481977
2025-12-07 11:47:17 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:47:17 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:47:17 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:47:17 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:47:17 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:47:18 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:47:20 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:47:20 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:47:20 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:47:20 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:47:20 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:47:20 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:47:20 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:47:20 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:47:20 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:47:20 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:47:20 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:47:20 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:47:20 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:47:20 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:47:20 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:47:20 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:47:20 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:47:20 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:47:20 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:47:20 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:47:23 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:47:23 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:47:23 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:47:23 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:47:23 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:47:23 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:47:23 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:47:23 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:47:23 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:47:23 +0000 INFO:Current modification time: 1765108043.1507807
2025-12-07 11:47:23 +0000 INFO:Last modification time: 1765108002.2410846
2025-12-07 11:47:23 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:47:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:47:23 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:47:23 +0000 INFO:Donor Data summary completed
2025-12-07 11:47:23 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:47:23 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:47:23 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:47:23 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:47:23 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:47:23 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:47:23 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:47:23 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:47:23 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:47:23 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:47:23 +0000 INFO:Current modification time: 1765108043.1507807
2025-12-07 11:47:23 +0000 INFO:Last modification time: 1765108043.1507807
2025-12-07 11:47:23 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:47:23 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765108043.1507807 instead of output\cleaned_data.csv
2025-12-07 11:47:23 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:47:23 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:47:23 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:47:23 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:47:23 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:47:23 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:47:23 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:47:23 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:47:23 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:47:23 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:47:23 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:47:23 +0000 INFO:firstload executed successfully
2025-12-07 11:47:23 +0000 INFO:Data first load completed successfully.
2025-12-07 11:47:23 +0000 INFO:initialise_data executed successfully
2025-12-07 11:47:23 +0000 INFO:Running Menu setup...
2025-12-07 11:47:23 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:23 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:23 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:23 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:23 +0000 INFO:App Version: v50.229
2025-12-07 11:47:23 +0000 INFO:Switched to page: Introduction
2025-12-07 11:47:23 +0000 INFO:pagesetup executed successfully
2025-12-07 11:47:23 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:47:23 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:47:34 +0000 INFO:Streamlit App Starting...
2025-12-07 11:47:34 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:47:34 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:47:34 +0000 INFO:Running App setup...
2025-12-07 11:47:34 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:47:34 +0000 INFO:Setting up the package
2025-12-07 11:47:34 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:47:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:34 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:34 +0000 INFO:Version: v50.191
2025-12-07 11:47:34 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:47:34 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:47:34 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:security already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:directories already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:47:34 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:47:34 +0000 INFO:Session_state variables initialized
2025-12-07 11:47:34 +0000 DEBUG:logs_dir: logs
2025-12-07 11:47:34 +0000 DEBUG:utils_dir: utils
2025-12-07 11:47:34 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:47:34 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:47:34 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:47:34 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:47:34 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:47:34 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:47:34 +0000 DEBUG:data_dir: data
2025-12-07 11:47:34 +0000 DEBUG:load_donorlist_data_last_modified: 1765108043.1507807
2025-12-07 11:47:34 +0000 DEBUG:load_raw_data_last_modified: 1765108037.7635841
2025-12-07 11:47:34 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:47:34 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:47:34 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:47:34 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:47:34 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:47:34 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:47:34 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:47:34 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:47:34 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:47:34 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:47:34 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:47:34 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:47:34 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:47:34 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:47:34 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:47:34 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:47:34 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000002492AEA0670>}
2025-12-07 11:47:34 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:47:34 +0000 DEBUG:output_dir: output
2025-12-07 11:47:34 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:47:34 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:47:34 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:47:34 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:47:34 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:47:34 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:47:34 +0000 DEBUG:components_dir: components
2025-12-07 11:47:34 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:47:34 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:47:34 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:47:34 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:47:34 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:47:34 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:47:34 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:47:34 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:47:34 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:47:34 +0000 INFO:Session state Setup complete
2025-12-07 11:47:34 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:47:34 +0000 INFO:Package setup complete
2025-12-07 11:47:34 +0000 INFO:setup_package executed successfully
2025-12-07 11:47:34 +0000 INFO:Setup completed successfully.
2025-12-07 11:47:34 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:47:34 +0000 INFO:Running first load function.
2025-12-07 11:47:34 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:47:34 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:47:34 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:47:34 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:47:34 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:47:34 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:47:34 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:47:34 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:47:34 +0000 INFO:firstload executed successfully
2025-12-07 11:47:34 +0000 INFO:Data first load completed successfully.
2025-12-07 11:47:34 +0000 INFO:initialise_data executed successfully
2025-12-07 11:47:34 +0000 INFO:Running Menu setup...
2025-12-07 11:47:34 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:47:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:47:34 +0000 INFO:get_git_version executed successfully
2025-12-07 11:47:34 +0000 INFO:App Version: v50.229
2025-12-07 11:47:34 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:47:34 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:47:35 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:47:35 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:47:35 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:47:35 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:47:35 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:47:35 +0000 DEBUG:Page texts: {}
2025-12-07 11:47:35 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:47:35 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:47:35 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:47:35 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:47:35 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:47:35 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 33, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 271, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:47:35 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 33, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 271, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:49:37 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:49:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:37 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:37 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:37 +0000 INFO:Streamlit App Starting...
2025-12-07 11:49:37 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:49:37 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:49:37 +0000 INFO:Running App setup...
2025-12-07 11:49:37 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:49:37 +0000 INFO:Setting up the package
2025-12-07 11:49:37 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:49:37 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:37 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:37 +0000 INFO:Version: v50.191
2025-12-07 11:49:37 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:49:37 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:49:37 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:security already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:directories already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:49:37 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:49:37 +0000 INFO:Session_state variables initialized
2025-12-07 11:49:37 +0000 DEBUG:logs_dir: logs
2025-12-07 11:49:37 +0000 DEBUG:utils_dir: utils
2025-12-07 11:49:37 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_RegulatedEntity_ftrDonors per Regulated Entity: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 11:49:37 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:49:37 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:49:37 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:49:37 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:49:37 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_RegulatedEntity_ftrRegulated Entity by Entity: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 11:49:37 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:49:37 +0000 DEBUG:error_logged: True
2025-12-07 11:49:37 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:49:37 +0000 DEBUG:data_dir: data
2025-12-07 11:49:37 +0000 DEBUG:load_donorlist_data_last_modified: 1765108043.1507807
2025-12-07 11:49:37 +0000 DEBUG:load_raw_data_last_modified: 1765108037.7635841
2025-12-07 11:49:37 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:49:37 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:49:37 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:49:37 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:49:37 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:49:37 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:49:37 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:49:37 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:49:37 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:49:37 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:49:37 +0000 DEBUG:selected_entity_name: All
2025-12-07 11:49:37 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:49:37 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:49:37 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:49:37 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:49:37 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:49:37 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:49:37 +0000 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors at 0x000002492AEA0700>}
2025-12-07 11:49:37 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:49:37 +0000 DEBUG:output_dir: output
2025-12-07 11:49:37 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:49:37 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:49:37 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:49:38 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:49:38 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 11:49:38 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:49:38 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:49:38 +0000 DEBUG:components_dir: components
2025-12-07 11:49:38 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:49:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:49:38 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:49:38 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:49:38 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:49:38 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:49:38 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:49:38 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:49:38 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:49:38 +0000 INFO:Session state Setup complete
2025-12-07 11:49:38 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:49:38 +0000 INFO:Package setup complete
2025-12-07 11:49:38 +0000 INFO:setup_package executed successfully
2025-12-07 11:49:38 +0000 INFO:Setup completed successfully.
2025-12-07 11:49:38 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:38 +0000 INFO:Running first load function.
2025-12-07 11:49:38 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:49:38 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:49:38 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:49:38 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:49:38 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:49:38 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:49:38 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:49:38 +0000 INFO:firstload executed successfully
2025-12-07 11:49:38 +0000 INFO:Data first load completed successfully.
2025-12-07 11:49:38 +0000 INFO:initialise_data executed successfully
2025-12-07 11:49:38 +0000 INFO:Running Menu setup...
2025-12-07 11:49:38 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:38 +0000 INFO:App Version: v50.229
2025-12-07 11:49:38 +0000 INFO:Switched to page: Dubious Donors
2025-12-07 11:49:38 +0000 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:load_and_filter_data executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 DEBUG:Page texts: {}
2025-12-07 11:49:38 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:49:38 +0000 INFO:display_data_page executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:49:38 +0000 DEBUG:Page texts: {}
2025-12-07 11:49:38 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:49:38 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:49:39 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:49:39 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:49:39 +0000 INFO:pagesetup executed successfully
2025-12-07 11:49:39 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:49:39 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:49:41 +0000 INFO:Streamlit App Starting...
2025-12-07 11:49:41 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:49:41 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:49:41 +0000 INFO:Running App setup...
2025-12-07 11:49:41 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:49:41 +0000 INFO:Setting up the package
2025-12-07 11:49:41 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:49:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:41 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:41 +0000 INFO:Version: v50.191
2025-12-07 11:49:41 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:49:41 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:49:41 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:security already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:directories already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:49:41 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:49:41 +0000 INFO:Session_state variables initialized
2025-12-07 11:49:41 +0000 DEBUG:logs_dir: logs
2025-12-07 11:49:41 +0000 DEBUG:utils_dir: utils
2025-12-07 11:49:41 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:49:41 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:49:41 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:49:41 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:49:41 +0000 DEBUG:error_logged: True
2025-12-07 11:49:41 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:49:41 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:49:41 +0000 DEBUG:data_dir: data
2025-12-07 11:49:41 +0000 DEBUG:load_donorlist_data_last_modified: 1765108043.1507807
2025-12-07 11:49:41 +0000 DEBUG:load_raw_data_last_modified: 1765108037.7635841
2025-12-07 11:49:41 +0000 DEBUG:date_range_mod_dubious_donors_per_entity_DubiousDonors_ftrDubious Donors per Entity: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 11:49:41 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:49:41 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:49:41 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:49:41 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:49:41 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:49:41 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:49:41 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:49:41 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 11:49:41 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:49:41 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:49:41 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:49:41 +0000 DEBUG:selected_entity_name: All
2025-12-07 11:49:41 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:49:41 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:49:41 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:49:41 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:49:41 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:49:41 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:49:41 +0000 DEBUG:menu_selection: {'title': 'Notes on Data and Manipulations', 'function': <function notesondataprep_body at 0x000002492A098280>}
2025-12-07 11:49:41 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:49:41 +0000 DEBUG:output_dir: output
2025-12-07 11:49:41 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:49:41 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:49:41 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:49:41 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:49:41 +0000 DEBUG:selected_group_entity: Donor
2025-12-07 11:49:41 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:49:41 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:49:41 +0000 DEBUG:components_dir: components
2025-12-07 11:49:41 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 11:49:41 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:49:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:49:41 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:49:41 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:49:41 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:49:41 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:49:41 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:49:41 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:49:41 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:49:41 +0000 INFO:Session state Setup complete
2025-12-07 11:49:41 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:49:41 +0000 INFO:Package setup complete
2025-12-07 11:49:41 +0000 INFO:setup_package executed successfully
2025-12-07 11:49:41 +0000 INFO:Setup completed successfully.
2025-12-07 11:49:41 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:49:41 +0000 INFO:Running first load function.
2025-12-07 11:49:41 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:49:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:49:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:49:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:49:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:49:41 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:49:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:49:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:49:41 +0000 INFO:firstload executed successfully
2025-12-07 11:49:41 +0000 INFO:Data first load completed successfully.
2025-12-07 11:49:41 +0000 INFO:initialise_data executed successfully
2025-12-07 11:49:41 +0000 INFO:Running Menu setup...
2025-12-07 11:49:41 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:49:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:41 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:41 +0000 INFO:App Version: v50.229
2025-12-07 11:49:41 +0000 INFO:Switched to page: Notes on Data and Manipulations
2025-12-07 11:49:41 +0000 INFO:pagesetup executed successfully
2025-12-07 11:49:41 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:49:41 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:49:43 +0000 INFO:Streamlit App Starting...
2025-12-07 11:49:43 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:49:43 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:49:43 +0000 INFO:Running App setup...
2025-12-07 11:49:43 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:49:43 +0000 INFO:Setting up the package
2025-12-07 11:49:43 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:49:43 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:43 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:43 +0000 INFO:Version: v50.191
2025-12-07 11:49:43 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:49:43 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:49:43 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:security already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:directories already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:49:43 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:49:43 +0000 INFO:Session_state variables initialized
2025-12-07 11:49:43 +0000 DEBUG:logs_dir: logs
2025-12-07 11:49:43 +0000 DEBUG:utils_dir: utils
2025-12-07 11:49:43 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:49:43 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:49:43 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:49:43 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:49:43 +0000 DEBUG:error_logged: True
2025-12-07 11:49:43 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:49:43 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:49:43 +0000 DEBUG:data_dir: data
2025-12-07 11:49:43 +0000 DEBUG:load_donorlist_data_last_modified: 1765108043.1507807
2025-12-07 11:49:43 +0000 DEBUG:load_raw_data_last_modified: 1765108037.7635841
2025-12-07 11:49:43 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:49:43 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:49:43 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:49:43 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:49:43 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:49:43 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:49:43 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:49:43 +0000 DEBUG:max_date: 2025-11-13
2025-12-07 11:49:43 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:49:43 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:49:43 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:49:43 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:49:43 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:49:43 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:49:43 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:49:43 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:49:43 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:49:43 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000002492A099090>}
2025-12-07 11:49:43 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:49:43 +0000 DEBUG:output_dir: output
2025-12-07 11:49:43 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:49:43 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:49:43 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:49:43 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:49:43 +0000 DEBUG:min_date: 2001-01-01
2025-12-07 11:49:43 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:49:43 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:49:43 +0000 DEBUG:components_dir: components
2025-12-07 11:49:43 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:49:43 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:49:43 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:49:43 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:49:43 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:49:43 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:49:43 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:49:43 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:49:43 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:49:43 +0000 INFO:Session state Setup complete
2025-12-07 11:49:43 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:49:43 +0000 INFO:Package setup complete
2025-12-07 11:49:43 +0000 INFO:setup_package executed successfully
2025-12-07 11:49:43 +0000 INFO:Setup completed successfully.
2025-12-07 11:49:43 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:49:43 +0000 INFO:Running first load function.
2025-12-07 11:49:43 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:49:43 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:49:43 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:49:43 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:49:43 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:49:43 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:49:43 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:49:43 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:49:43 +0000 INFO:firstload executed successfully
2025-12-07 11:49:43 +0000 INFO:Data first load completed successfully.
2025-12-07 11:49:43 +0000 INFO:initialise_data executed successfully
2025-12-07 11:49:43 +0000 INFO:Running Menu setup...
2025-12-07 11:49:43 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:49:43 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:49:43 +0000 INFO:get_git_version executed successfully
2025-12-07 11:49:43 +0000 INFO:App Version: v50.229
2025-12-07 11:49:43 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:49:43 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:49:43 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:49:44 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:49:44 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:49:44 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:49:44 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:49:44 +0000 DEBUG:Page texts: {}
2025-12-07 11:49:44 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:49:44 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:49:44 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:49:44 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:49:44 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:49:44 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 113, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:50:00 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:50:00 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:01 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:01 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:01 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:02 +0000 INFO:Streamlit App Starting...
2025-12-07 11:50:02 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:50:02 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:50:02 +0000 INFO:Running App setup...
2025-12-07 11:50:02 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 INFO:Setting up the package
2025-12-07 11:50:02 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:50:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:02 +0000 INFO:Version: v50.191
2025-12-07 11:50:02 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:50:02 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:50:02 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:50:02 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:50:02 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:50:02 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:50:02 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:50:02 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:50:02 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:50:02 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:50:02 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:50:02 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:50:02 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:50:02 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:50:02 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:50:02 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:50:02 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:50:02 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:50:02 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:50:02 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:50:02 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:50:02 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:50:02 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:50:02 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:50:02 +0000 INFO:Session_state variables initialized
2025-12-07 11:50:02 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:50:02 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:50:02 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:50:02 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:50:02 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:50:02 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:50:02 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:50:02 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:50:02 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:50:02 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:50:02 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:50:02 +0000 DEBUG:logs_dir: logs
2025-12-07 11:50:02 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:50:02 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:50:02 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:50:02 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:50:02 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:50:02 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:50:02 +0000 DEBUG:utils_dir: utils
2025-12-07 11:50:02 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:50:02 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:50:02 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:50:02 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:50:02 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:50:02 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:50:02 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:50:02 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:50:02 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:50:02 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:50:02 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:50:02 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:50:02 +0000 DEBUG:components_dir: components
2025-12-07 11:50:02 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:50:02 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:50:02 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:50:02 +0000 DEBUG:output_dir: output
2025-12-07 11:50:02 +0000 DEBUG:data_dir: data
2025-12-07 11:50:02 +0000 INFO:Session state Setup complete
2025-12-07 11:50:02 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:50:02 +0000 INFO:Package setup complete
2025-12-07 11:50:02 +0000 INFO:setup_package executed successfully
2025-12-07 11:50:02 +0000 INFO:Setup completed successfully.
2025-12-07 11:50:02 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:02 +0000 INFO:Running first load function.
2025-12-07 11:50:02 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:50:02 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:50:02 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:50:02 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:50:02 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:50:02 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:50:02 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:50:02 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:50:02 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:50:02 +0000 INFO:Last modification time: 1765108037.7635841
2025-12-07 11:50:02 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:50:02 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765108037.7635841 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:50:02 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:50:03 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:50:03 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:50:03 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:50:03 +0000 INFO:Cleaning up raw data
2025-12-07 11:50:03 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:50:03 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:03 +0000 INFO:Original file path: None
2025-12-07 11:50:03 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:50:03 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:50:03 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:50:03 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:50:04 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:50:04 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:50:04 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:50:04 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:50:04 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:50:04 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:50:04 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:50:04 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:50:05 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:50:05 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:50:05 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:50:05 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:50:05 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:50:05 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:50:07 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:50:07 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:50:07 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:50:07 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:50:07 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:50:07 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:50:07 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:07 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:07 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:50:07 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:07 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:50:07 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:50:07 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:50:07 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:50:07 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:50:07 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:50:07 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:50:07 +0000 INFO:Current modification time: 1765108207.5436006
2025-12-07 11:50:07 +0000 INFO:Last modification time: 1765108037.7635841
2025-12-07 11:50:07 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:50:07 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:50:07 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:50:07 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:50:07 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:50:08 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:50:10 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:50:10 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:50:10 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:50:10 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:50:10 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:50:10 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:50:10 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:50:10 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:50:10 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:50:10 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:50:11 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:50:11 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:50:11 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:50:11 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:50:11 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:50:11 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:50:11 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:50:11 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:50:11 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:50:11 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:50:13 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:50:13 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:50:13 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:50:13 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:50:13 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:50:13 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:50:13 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:50:13 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:50:13 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:50:13 +0000 INFO:Current modification time: 1765108213.3026237
2025-12-07 11:50:13 +0000 INFO:Last modification time: 1765108043.1507807
2025-12-07 11:50:13 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:50:13 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:50:13 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:50:13 +0000 INFO:Donor Data summary completed
2025-12-07 11:50:13 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:50:13 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:50:13 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:50:13 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:50:13 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:50:13 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:50:13 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:50:13 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:50:13 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:50:13 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:50:13 +0000 INFO:Current modification time: 1765108213.3026237
2025-12-07 11:50:13 +0000 INFO:Last modification time: 1765108213.3026237
2025-12-07 11:50:13 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:50:13 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765108213.3026237 instead of output\cleaned_data.csv
2025-12-07 11:50:13 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:50:13 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:50:13 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:50:13 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:50:13 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:50:13 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:50:13 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:50:13 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:50:13 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:50:13 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:50:13 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:50:13 +0000 INFO:firstload executed successfully
2025-12-07 11:50:13 +0000 INFO:Data first load completed successfully.
2025-12-07 11:50:13 +0000 INFO:initialise_data executed successfully
2025-12-07 11:50:13 +0000 INFO:Running Menu setup...
2025-12-07 11:50:13 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:13 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:14 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:14 +0000 INFO:App Version: v50.229
2025-12-07 11:50:14 +0000 INFO:Switched to page: Introduction
2025-12-07 11:50:14 +0000 INFO:pagesetup executed successfully
2025-12-07 11:50:14 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:50:14 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:50:18 +0000 INFO:Streamlit App Starting...
2025-12-07 11:50:18 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:50:18 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:50:18 +0000 INFO:Running App setup...
2025-12-07 11:50:18 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 INFO:Setting up the package
2025-12-07 11:50:18 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:50:18 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:18 +0000 INFO:Version: v50.191
2025-12-07 11:50:18 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:50:18 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:security already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:directories already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:50:18 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:50:18 +0000 INFO:Session_state variables initialized
2025-12-07 11:50:18 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:50:18 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:50:18 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:50:18 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName  ...   DonorId                              DonorName
0      C0000001                     Charter 88  ...       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88  ...       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp  ...       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp  ...       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp  ...       5.0                       Bridgwater Trust
...         ...                            ...  ...       ...                                    ...
91646  V0833992                    John Cooper  ...  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan  ...  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar  ...  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George  ...  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks  ...  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:50:18 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:50:18 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:50:18 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:50:18 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:50:18 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:50:18 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:50:18 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:50:18 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:50:18 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001E9139C43A0>}
2025-12-07 11:50:18 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:50:18 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:50:18 +0000 DEBUG:load_raw_data_last_modified: 1765108207.5436006
2025-12-07 11:50:18 +0000 DEBUG:logs_dir: logs
2025-12-07 11:50:18 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:50:18 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:50:18 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:50:18 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  ... Donation Events  Donation Mean
0                  17.0                            English Democrats  ...              12    9877.666667
1                  19.0                   Legalise Cannabis Alliance  ...              13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  ...               1   10000.000000
3                  39.0                                    Sinn Fein  ...              13   17136.383077
4                  39.0                                   Sinn FIn  ...             358   16583.006955
...                 ...                                          ...  ...             ...            ...
1714            18270.0                                 Richard Tice  ...               1    6250.000000
1715            18271.0                                 John Slinger  ...               1    9456.850000
1716            18273.0                            Sir Jeremy Wright  ...               1    3246.720000
1717            18274.0                                   Paul Givan  ...               1    3810.000000
1718            18276.0                                 David Brooks  ...               1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:50:18 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:50:18 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:50:18 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:50:18 +0000 DEBUG:utils_dir: utils
2025-12-07 11:50:18 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:50:18 +0000 DEBUG:load_donorlist_data_last_modified: 1765108213.3026237
2025-12-07 11:50:18 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:50:18 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:50:18 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:50:18 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:50:18 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:50:18 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:50:18 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:50:18 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:50:18 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:50:18 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:50:18 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:50:18 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:50:18 +0000 DEBUG:components_dir: components
2025-12-07 11:50:18 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:50:18 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:50:18 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value  ... QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00  ...                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96  ...                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00  ...                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00  ...                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00  ...                 289.0                 1.0                 72.0
...         ...                 ...        ...  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00  ...                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00  ...                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00  ...                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:50:18 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:50:18 +0000 DEBUG:output_dir: output
2025-12-07 11:50:18 +0000 DEBUG:data_dir: data
2025-12-07 11:50:18 +0000 INFO:Session state Setup complete
2025-12-07 11:50:18 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:50:18 +0000 INFO:Package setup complete
2025-12-07 11:50:18 +0000 INFO:setup_package executed successfully
2025-12-07 11:50:18 +0000 INFO:Setup completed successfully.
2025-12-07 11:50:18 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 INFO:Running first load function.
2025-12-07 11:50:18 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:50:18 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:50:18 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:50:18 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:50:18 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:50:18 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:50:18 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:50:18 +0000 INFO:firstload executed successfully
2025-12-07 11:50:18 +0000 INFO:Data first load completed successfully.
2025-12-07 11:50:18 +0000 INFO:initialise_data executed successfully
2025-12-07 11:50:18 +0000 INFO:Running Menu setup...
2025-12-07 11:50:18 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 INFO:get_git_version executed successfully
2025-12-07 11:50:18 +0000 INFO:App Version: v50.229
2025-12-07 11:50:18 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:50:18 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:50:18 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:50:18 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:50:18 +0000 DEBUG:Page texts: {}
2025-12-07 11:50:18 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:50:18 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:50:19 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:50:19 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:50:19 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:50:19 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:50:19 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 113, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:53:02 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:53:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:02 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:03 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:03 +0000 INFO:Streamlit App Starting...
2025-12-07 11:53:03 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:53:03 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:53:03 +0000 INFO:Running App setup...
2025-12-07 11:53:03 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:53:03 +0000 INFO:Setting up the package
2025-12-07 11:53:03 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:53:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:03 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:03 +0000 INFO:Version: v50.191
2025-12-07 11:53:03 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:53:03 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:53:03 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:53:03 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:53:03 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:53:03 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:53:03 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:53:03 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:53:03 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:53:03 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:53:03 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:53:03 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:53:03 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:53:03 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:53:03 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:53:03 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:53:03 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:53:03 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:53:03 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:53:03 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:53:03 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:53:03 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:53:03 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:53:03 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:53:03 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:53:03 +0000 INFO:Session_state variables initialized
2025-12-07 11:53:03 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:53:03 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:53:03 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:53:03 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:53:03 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:53:03 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:53:03 +0000 DEBUG:logs_dir: logs
2025-12-07 11:53:03 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:53:03 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:53:03 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:53:03 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:53:03 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:53:03 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:53:03 +0000 DEBUG:utils_dir: utils
2025-12-07 11:53:03 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:53:03 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:53:03 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:53:03 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:53:03 +0000 DEBUG:data_dir: data
2025-12-07 11:53:03 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:53:03 +0000 DEBUG:components_dir: components
2025-12-07 11:53:03 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:53:03 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:53:03 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:53:03 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:53:03 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:53:03 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:53:03 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:53:03 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:53:03 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:53:03 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:53:03 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:53:03 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:53:03 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:53:03 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:53:03 +0000 DEBUG:output_dir: output
2025-12-07 11:53:03 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:53:03 +0000 INFO:Session state Setup complete
2025-12-07 11:53:03 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:53:03 +0000 INFO:Package setup complete
2025-12-07 11:53:03 +0000 INFO:setup_package executed successfully
2025-12-07 11:53:03 +0000 INFO:Setup completed successfully.
2025-12-07 11:53:03 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:03 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:04 +0000 INFO:Running first load function.
2025-12-07 11:53:04 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:53:04 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:04 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:04 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:53:04 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:53:04 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:04 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:53:04 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:53:04 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:53:04 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:53:04 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:53:04 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:53:04 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:53:04 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:53:04 +0000 INFO:Last modification time: 1765108207.5436006
2025-12-07 11:53:04 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:53:04 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765108207.5436006 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:53:04 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:53:04 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:53:04 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:53:04 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:53:04 +0000 INFO:Cleaning up raw data
2025-12-07 11:53:04 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:53:04 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:04 +0000 INFO:Original file path: None
2025-12-07 11:53:04 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:53:04 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:53:04 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:53:04 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:53:06 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:53:06 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:53:06 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:53:06 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:53:06 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:53:06 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:53:06 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:53:06 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:53:06 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:53:06 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:53:06 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:53:06 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:53:06 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:53:06 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:53:08 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:53:08 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:53:08 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:53:08 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:53:08 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:53:08 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:53:08 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:08 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:08 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:53:08 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:08 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:53:08 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:53:08 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:53:08 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:53:08 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:53:08 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:53:08 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:53:08 +0000 INFO:Current modification time: 1765108388.4487789
2025-12-07 11:53:08 +0000 INFO:Last modification time: 1765108207.5436006
2025-12-07 11:53:08 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:53:08 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:53:08 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:53:08 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:53:08 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:53:08 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:53:10 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:53:10 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:53:10 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:53:11 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:53:11 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:53:11 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:53:11 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:53:11 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:53:11 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:53:11 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:53:11 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:53:11 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:53:11 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:53:11 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:53:11 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:53:11 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:53:11 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:53:11 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:53:11 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:53:11 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:53:13 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:53:13 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:53:13 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:53:13 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:53:13 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:53:13 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:53:13 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:53:13 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:53:13 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:53:13 +0000 INFO:Current modification time: 1765108393.4571097
2025-12-07 11:53:13 +0000 INFO:Last modification time: 1765108213.3026237
2025-12-07 11:53:13 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:53:13 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:53:13 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:53:13 +0000 INFO:Donor Data summary completed
2025-12-07 11:53:13 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:53:13 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:53:13 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:53:13 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:53:13 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:53:13 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:53:13 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:53:13 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:53:13 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:53:13 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:53:13 +0000 INFO:Current modification time: 1765108393.4571097
2025-12-07 11:53:13 +0000 INFO:Last modification time: 1765108393.4571097
2025-12-07 11:53:13 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:53:13 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765108393.4571097 instead of output\cleaned_data.csv
2025-12-07 11:53:13 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:53:13 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:53:13 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:53:13 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:53:13 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:53:13 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:53:13 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:53:13 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:53:13 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:53:13 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:53:13 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:53:13 +0000 INFO:firstload executed successfully
2025-12-07 11:53:13 +0000 INFO:Data first load completed successfully.
2025-12-07 11:53:13 +0000 INFO:initialise_data executed successfully
2025-12-07 11:53:13 +0000 INFO:Running Menu setup...
2025-12-07 11:53:13 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:13 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:13 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:14 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:14 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:14 +0000 INFO:App Version: v50.229
2025-12-07 11:53:14 +0000 INFO:Switched to page: Introduction
2025-12-07 11:53:14 +0000 INFO:pagesetup executed successfully
2025-12-07 11:53:14 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:53:14 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:53:19 +0000 INFO:Streamlit App Starting...
2025-12-07 11:53:19 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:53:19 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:53:19 +0000 INFO:Running App setup...
2025-12-07 11:53:19 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:53:19 +0000 INFO:Setting up the package
2025-12-07 11:53:19 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:53:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:19 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:19 +0000 INFO:Version: v50.191
2025-12-07 11:53:19 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:53:19 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:53:19 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:security already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:directories already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:53:19 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:53:19 +0000 INFO:Session_state variables initialized
2025-12-07 11:53:19 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:53:19 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:53:19 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:53:19 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:53:19 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:53:19 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:53:19 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:53:19 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:53:19 +0000 DEBUG:load_donorlist_data_last_modified: 1765108393.4571097
2025-12-07 11:53:19 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:53:19 +0000 DEBUG:logs_dir: logs
2025-12-07 11:53:19 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:53:19 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:53:19 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:53:19 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:53:19 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:53:19 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:53:19 +0000 DEBUG:utils_dir: utils
2025-12-07 11:53:19 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:53:19 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:53:19 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:53:19 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:53:19 +0000 DEBUG:data_dir: data
2025-12-07 11:53:19 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000002820231C5E0>}
2025-12-07 11:53:19 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:53:19 +0000 DEBUG:components_dir: components
2025-12-07 11:53:19 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:53:19 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:53:19 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:53:19 +0000 DEBUG:load_raw_data_last_modified: 1765108388.4487789
2025-12-07 11:53:19 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:53:19 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:53:19 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:53:19 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:53:19 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:53:19 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:53:19 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:53:19 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:53:19 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:53:19 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:53:19 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:53:19 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:53:19 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:53:19 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:53:19 +0000 DEBUG:output_dir: output
2025-12-07 11:53:19 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:53:19 +0000 INFO:Session state Setup complete
2025-12-07 11:53:19 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:53:19 +0000 INFO:Package setup complete
2025-12-07 11:53:19 +0000 INFO:setup_package executed successfully
2025-12-07 11:53:19 +0000 INFO:Setup completed successfully.
2025-12-07 11:53:19 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:53:19 +0000 INFO:Running first load function.
2025-12-07 11:53:19 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:53:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:53:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:53:19 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:53:19 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:53:19 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:53:19 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:53:19 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:53:19 +0000 INFO:firstload executed successfully
2025-12-07 11:53:19 +0000 INFO:Data first load completed successfully.
2025-12-07 11:53:19 +0000 INFO:initialise_data executed successfully
2025-12-07 11:53:19 +0000 INFO:Running Menu setup...
2025-12-07 11:53:19 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:53:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:53:19 +0000 INFO:get_git_version executed successfully
2025-12-07 11:53:19 +0000 INFO:App Version: v50.229
2025-12-07 11:53:19 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:53:19 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:53:19 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:53:20 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:53:20 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:53:20 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:53:20 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:53:20 +0000 DEBUG:Page texts: {}
2025-12-07 11:53:20 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:53:20 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:53:20 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:53:20 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:53:20 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:53:20 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:53:20 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 113, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:55:19 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:55:19 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:20 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:21 +0000 INFO:Streamlit App Starting...
2025-12-07 11:55:21 +0000 INFO:Streamlit App Starting...
2025-12-07 11:55:21 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:55:21 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:55:21 +0000 INFO:Running App setup...
2025-12-07 11:55:21 +0000 INFO:Running App setup...
2025-12-07 11:55:21 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 INFO:Setting up the package
2025-12-07 11:55:21 +0000 INFO:Setting up the package
2025-12-07 11:55:21 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:21 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:21 +0000 INFO:Version: v50.191
2025-12-07 11:55:21 +0000 INFO:Version: v50.191
2025-12-07 11:55:21 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:55:21 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:55:21 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:55:21 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:55:21 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:55:21 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:55:21 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:55:21 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:55:21 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:55:21 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:55:21 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:55:21 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:55:21 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:55:21 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:55:21 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:55:21 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:55:21 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:55:21 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:55:21 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:55:21 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:55:21 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:55:21 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:55:21 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:55:21 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:55:21 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:55:21 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:55:21 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:55:21 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:55:21 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:55:21 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:55:21 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:55:21 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:55:21 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:55:21 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:55:21 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:55:21 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:55:21 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:55:21 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:55:21 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:55:21 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:55:21 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:55:21 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:55:21 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:55:21 +0000 INFO:Session_state variables initialized
2025-12-07 11:55:21 +0000 INFO:Session_state variables initialized
2025-12-07 11:55:21 +0000 DEBUG:logs_dir: logs
2025-12-07 11:55:21 +0000 DEBUG:logs_dir: logs
2025-12-07 11:55:21 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:55:21 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:55:21 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:55:21 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:55:21 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:55:21 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:55:21 +0000 DEBUG:utils_dir: utils
2025-12-07 11:55:21 +0000 DEBUG:utils_dir: utils
2025-12-07 11:55:21 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:55:21 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:55:21 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:55:21 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:55:21 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:55:21 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:55:21 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:55:21 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:55:21 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:55:21 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:55:21 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:55:21 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:55:21 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:55:21 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:55:21 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:55:21 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:55:21 +0000 DEBUG:data_dir: data
2025-12-07 11:55:21 +0000 DEBUG:data_dir: data
2025-12-07 11:55:21 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:55:21 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:55:21 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:55:21 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:55:21 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:55:21 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:55:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:55:21 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:55:21 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:55:21 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:55:21 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:55:21 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:55:21 +0000 DEBUG:components_dir: components
2025-12-07 11:55:21 +0000 DEBUG:components_dir: components
2025-12-07 11:55:21 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:55:21 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:55:21 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:55:21 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:55:21 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:55:21 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:55:21 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:55:21 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:55:21 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:55:21 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:55:21 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:55:21 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:55:21 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:55:21 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:55:21 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:55:21 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:55:21 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:55:21 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:55:21 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:55:21 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:55:21 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:55:21 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:55:21 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:55:21 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:55:21 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:55:21 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:55:21 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:55:21 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:55:21 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:55:21 +0000 DEBUG:output_dir: output
2025-12-07 11:55:21 +0000 DEBUG:output_dir: output
2025-12-07 11:55:21 +0000 INFO:Session state Setup complete
2025-12-07 11:55:21 +0000 INFO:Session state Setup complete
2025-12-07 11:55:21 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:55:21 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:55:21 +0000 INFO:Package setup complete
2025-12-07 11:55:21 +0000 INFO:Package setup complete
2025-12-07 11:55:21 +0000 INFO:setup_package executed successfully
2025-12-07 11:55:21 +0000 INFO:setup_package executed successfully
2025-12-07 11:55:21 +0000 INFO:Setup completed successfully.
2025-12-07 11:55:21 +0000 INFO:Setup completed successfully.
2025-12-07 11:55:21 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:21 +0000 INFO:Running first load function.
2025-12-07 11:55:21 +0000 INFO:Running first load function.
2025-12-07 11:55:21 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:55:21 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:55:21 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:55:21 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:55:21 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:55:21 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:55:21 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:55:21 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:55:21 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:55:21 +0000 INFO:Last modification time: 1765108388.4487789
2025-12-07 11:55:21 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:55:21 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765108388.4487789 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:55:21 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:55:22 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:55:22 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:55:22 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:55:22 +0000 INFO:Cleaning up raw data
2025-12-07 11:55:22 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:55:22 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:22 +0000 INFO:Original file path: None
2025-12-07 11:55:22 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:55:22 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:55:22 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:55:22 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:55:24 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:55:24 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:24 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:55:24 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:55:24 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:55:24 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:55:24 +0000 INFO:Cleaning up raw data
2025-12-07 11:55:24 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:55:24 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:55:25 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:55:25 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:55:26 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:55:26 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:55:26 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:55:26 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:55:26 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:55:26 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:55:26 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:55:26 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:55:26 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:55:26 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:55:26 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:55:26 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:55:28 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:55:28 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:55:28 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:55:28 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:55:28 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:55:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:55:28 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:28 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:28 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:55:28 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:28 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:55:28 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:55:28 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:55:28 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:55:28 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:55:28 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:55:28 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:55:28 +0000 INFO:Current modification time: 1765108528.195061
2025-12-07 11:55:28 +0000 INFO:Last modification time: 1765108388.4487789
2025-12-07 11:55:28 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:55:28 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:55:28 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:55:28 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:55:28 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:55:28 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:55:30 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:55:30 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:55:30 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:55:31 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:55:31 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:55:31 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:55:31 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:55:31 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:55:31 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:55:31 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:55:31 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:55:31 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:55:31 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:55:31 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:55:31 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:55:31 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:55:31 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:55:31 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:55:31 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:55:31 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:55:33 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:55:33 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:55:33 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:55:33 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:55:33 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:55:33 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:55:33 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:55:33 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:55:33 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:55:33 +0000 INFO:Current modification time: 1765108533.6635141
2025-12-07 11:55:33 +0000 INFO:Last modification time: 1765108393.4571097
2025-12-07 11:55:33 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:55:33 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:55:33 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:55:33 +0000 INFO:Donor Data summary completed
2025-12-07 11:55:33 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:55:33 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:55:33 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:55:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:55:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:55:33 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:55:33 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:55:33 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:55:33 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:55:33 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:55:33 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:55:33 +0000 INFO:Current modification time: 1765108533.6635141
2025-12-07 11:55:33 +0000 INFO:Last modification time: 1765108533.6635141
2025-12-07 11:55:33 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:55:33 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765108533.6635141 instead of output\cleaned_data.csv
2025-12-07 11:55:33 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:55:33 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:55:33 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:55:34 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:55:34 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:55:34 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:55:34 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:55:34 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:55:34 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:55:34 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:55:34 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:55:34 +0000 INFO:firstload executed successfully
2025-12-07 11:55:34 +0000 INFO:Data first load completed successfully.
2025-12-07 11:55:34 +0000 INFO:initialise_data executed successfully
2025-12-07 11:55:34 +0000 INFO:Running Menu setup...
2025-12-07 11:55:34 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:55:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:34 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:34 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:34 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:34 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:34 +0000 INFO:App Version: v50.229
2025-12-07 11:55:34 +0000 INFO:Switched to page: Introduction
2025-12-07 11:55:34 +0000 INFO:pagesetup executed successfully
2025-12-07 11:55:34 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:55:34 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:55:38 +0000 INFO:Streamlit App Starting...
2025-12-07 11:55:38 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:55:38 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:55:38 +0000 INFO:Running App setup...
2025-12-07 11:55:38 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:55:38 +0000 INFO:Setting up the package
2025-12-07 11:55:38 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:55:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:38 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:38 +0000 INFO:Version: v50.191
2025-12-07 11:55:38 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:55:38 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:55:38 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:security already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:directories already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:55:38 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:55:38 +0000 INFO:Session_state variables initialized
2025-12-07 11:55:38 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:55:38 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:55:38 +0000 DEBUG:logs_dir: logs
2025-12-07 11:55:38 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x0000020F0B9C4430>}
2025-12-07 11:55:38 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:55:38 +0000 DEBUG:utils_dir: utils
2025-12-07 11:55:38 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:55:38 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:55:38 +0000 DEBUG:load_donorlist_data_last_modified: 1765108533.6635141
2025-12-07 11:55:38 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:55:38 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:55:38 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:55:38 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:55:38 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:55:38 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:55:38 +0000 DEBUG:data_dir: data
2025-12-07 11:55:38 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:55:38 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:55:38 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:55:38 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:55:38 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:55:38 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:55:38 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:55:38 +0000 DEBUG:load_raw_data_last_modified: 1765108528.195061
2025-12-07 11:55:38 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:55:38 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:55:38 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:55:38 +0000 DEBUG:components_dir: components
2025-12-07 11:55:38 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:55:38 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:55:38 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:55:38 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:55:38 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:55:38 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:55:38 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:55:38 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:55:38 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:55:38 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:55:38 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:55:38 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:55:38 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:55:38 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:55:38 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:55:38 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:55:38 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:55:38 +0000 DEBUG:output_dir: output
2025-12-07 11:55:38 +0000 INFO:Session state Setup complete
2025-12-07 11:55:38 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:55:38 +0000 INFO:Package setup complete
2025-12-07 11:55:38 +0000 INFO:setup_package executed successfully
2025-12-07 11:55:38 +0000 INFO:Setup completed successfully.
2025-12-07 11:55:38 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:55:38 +0000 INFO:Running first load function.
2025-12-07 11:55:38 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:55:38 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:55:38 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:55:38 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:55:38 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:55:38 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:55:38 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:55:38 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:55:38 +0000 INFO:firstload executed successfully
2025-12-07 11:55:38 +0000 INFO:Data first load completed successfully.
2025-12-07 11:55:38 +0000 INFO:initialise_data executed successfully
2025-12-07 11:55:38 +0000 INFO:Running Menu setup...
2025-12-07 11:55:38 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:55:38 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:55:38 +0000 INFO:get_git_version executed successfully
2025-12-07 11:55:38 +0000 INFO:App Version: v50.229
2025-12-07 11:55:38 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:55:38 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:55:39 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:55:39 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:55:39 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:55:39 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:55:39 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:55:39 +0000 DEBUG:Page texts: {}
2025-12-07 11:55:39 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:55:39 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:55:39 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:55:40 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:55:40 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:55:40 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:55:40 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 113, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:57:15 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 11:57:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:16 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:17 +0000 INFO:Streamlit App Starting...
2025-12-07 11:57:17 +0000 INFO:Streamlit App Starting...
2025-12-07 11:57:17 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:57:17 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:57:17 +0000 INFO:Running App setup...
2025-12-07 11:57:17 +0000 INFO:Running App setup...
2025-12-07 11:57:17 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:Setting up the package
2025-12-07 11:57:17 +0000 INFO:Setting up the package
2025-12-07 11:57:17 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:17 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:17 +0000 INFO:Version: v50.191
2025-12-07 11:57:17 +0000 INFO:Version: v50.191
2025-12-07 11:57:17 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:57:17 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:57:17 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:57:17 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 11:57:17 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:57:17 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 11:57:17 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:57:17 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:57:17 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:57:17 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:57:17 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:57:17 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:57:17 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:57:17 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:57:17 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:57:17 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 11:57:17 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:57:17 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 11:57:17 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:57:17 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:57:17 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:57:17 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 11:57:17 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:57:17 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 11:57:17 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:57:17 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 11:57:17 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:57:17 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 11:57:17 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:57:17 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 11:57:17 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:57:17 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 11:57:17 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:57:17 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 11:57:17 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:57:17 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 11:57:17 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:57:17 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 11:57:17 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:57:17 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 11:57:17 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:57:17 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:57:17 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 11:57:17 +0000 INFO:Session_state variables initialized
2025-12-07 11:57:17 +0000 INFO:Session_state variables initialized
2025-12-07 11:57:17 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:57:17 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:57:17 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:57:17 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:57:17 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:57:17 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:57:17 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:57:17 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:57:17 +0000 DEBUG:components_dir: components
2025-12-07 11:57:17 +0000 DEBUG:components_dir: components
2025-12-07 11:57:17 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:57:17 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:57:17 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:57:17 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:57:17 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:57:17 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:57:17 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:57:17 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:57:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:57:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:57:17 +0000 DEBUG:data_dir: data
2025-12-07 11:57:17 +0000 DEBUG:data_dir: data
2025-12-07 11:57:17 +0000 DEBUG:output_dir: output
2025-12-07 11:57:17 +0000 DEBUG:output_dir: output
2025-12-07 11:57:17 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:57:17 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:57:17 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:57:17 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:57:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:57:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:57:17 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:57:17 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:57:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:57:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:57:17 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:57:17 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:57:17 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:57:17 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:57:17 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:57:17 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:57:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:57:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:57:17 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:57:17 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:57:17 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:57:17 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:57:17 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:57:17 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:57:17 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:57:17 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:57:17 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:57:17 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:57:17 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:57:17 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:57:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:57:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:57:17 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:57:17 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:57:17 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:57:17 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:57:17 +0000 DEBUG:logs_dir: logs
2025-12-07 11:57:17 +0000 DEBUG:logs_dir: logs
2025-12-07 11:57:17 +0000 DEBUG:utils_dir: utils
2025-12-07 11:57:17 +0000 DEBUG:utils_dir: utils
2025-12-07 11:57:17 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:57:17 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:57:17 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:57:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:57:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:57:17 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:57:17 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:57:17 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:57:17 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:57:17 +0000 INFO:Session state Setup complete
2025-12-07 11:57:17 +0000 INFO:Session state Setup complete
2025-12-07 11:57:17 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:57:17 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:57:17 +0000 INFO:Package setup complete
2025-12-07 11:57:17 +0000 INFO:Package setup complete
2025-12-07 11:57:17 +0000 INFO:setup_package executed successfully
2025-12-07 11:57:17 +0000 INFO:setup_package executed successfully
2025-12-07 11:57:17 +0000 INFO:Setup completed successfully.
2025-12-07 11:57:17 +0000 INFO:Setup completed successfully.
2025-12-07 11:57:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:17 +0000 INFO:Running first load function.
2025-12-07 11:57:17 +0000 INFO:Running first load function.
2025-12-07 11:57:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 11:57:17 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 11:57:17 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:57:17 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 11:57:17 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 11:57:17 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:57:17 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 11:57:17 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:57:17 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 11:57:17 +0000 INFO:Last modification time: 1765108528.195061
2025-12-07 11:57:17 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:57:17 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765108528.195061 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 11:57:17 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 11:57:18 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:57:18 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 11:57:18 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 11:57:18 +0000 INFO:Cleaning up raw data
2025-12-07 11:57:18 +0000 ERROR:Session state variables not initialized!
2025-12-07 11:57:18 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:18 +0000 INFO:Original file path: None
2025-12-07 11:57:18 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 11:57:18 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 11:57:18 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:57:18 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 11:57:19 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:57:19 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:57:20 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:57:20 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 11:57:20 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 11:57:20 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:57:20 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 11:57:20 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 11:57:20 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 11:57:20 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 11:57:20 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 11:57:20 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 11:57:20 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:57:20 +0000 INFO:Data shape: (91651, 37)
2025-12-07 11:57:21 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 11:57:21 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 11:57:21 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 11:57:21 +0000 INFO:load_raw_data executed successfully
2025-12-07 11:57:22 +0000 INFO:get_raw_data executed successfully
2025-12-07 11:57:22 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:57:22 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:22 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:22 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 11:57:22 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:22 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 11:57:22 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 11:57:22 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:57:22 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 11:57:22 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:57:22 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 11:57:22 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:57:22 +0000 INFO:Current modification time: 1765108641.947387
2025-12-07 11:57:22 +0000 INFO:Last modification time: 1765108528.195061
2025-12-07 11:57:22 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:57:22 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:57:22 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 11:57:22 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 11:57:22 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 11:57:22 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 11:57:24 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 11:57:24 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 11:57:24 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:57:24 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 11:57:24 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:57:24 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 11:57:24 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 11:57:24 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 11:57:24 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 11:57:24 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 11:57:24 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 11:57:24 +0000 INFO:Loading election dates from pdpy.
2025-12-07 11:57:24 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 11:57:24 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 11:57:24 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 11:57:24 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:57:24 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:57:24 +0000 INFO:load_election_dates executed successfully
2025-12-07 11:57:24 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 11:57:24 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 11:57:27 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 11:57:27 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 11:57:27 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 11:57:27 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:57:27 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:57:27 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 11:57:27 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:57:27 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:57:27 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:57:27 +0000 INFO:Current modification time: 1765108647.5072327
2025-12-07 11:57:27 +0000 INFO:Last modification time: 1765108533.6635141
2025-12-07 11:57:27 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:57:27 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:57:27 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 11:57:27 +0000 INFO:Donor Data summary completed
2025-12-07 11:57:27 +0000 INFO:Data shape: (31905, 5)
2025-12-07 11:57:27 +0000 INFO:load_donorList_data executed successfully
2025-12-07 11:57:27 +0000 INFO:get_donor_data executed successfully
2025-12-07 11:57:27 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:57:27 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:57:27 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 11:57:27 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 11:57:27 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 11:57:27 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 11:57:27 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 11:57:27 +0000 INFO:Current modification time: 1765108647.5072327
2025-12-07 11:57:27 +0000 INFO:Last modification time: 1765108647.5072327
2025-12-07 11:57:27 +0000 INFO:is_file_updated executed successfully
2025-12-07 11:57:27 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765108647.5072327 instead of output\cleaned_data.csv
2025-12-07 11:57:27 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 11:57:27 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 11:57:27 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 11:57:27 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 11:57:27 +0000 INFO:Raw Data cleanup completed
2025-12-07 11:57:27 +0000 INFO:Data shape: (1719, 6)
2025-12-07 11:57:27 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 11:57:27 +0000 INFO:get_regentity_data executed successfully
2025-12-07 11:57:27 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:57:27 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:57:27 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:57:27 +0000 INFO:firstload executed successfully
2025-12-07 11:57:27 +0000 INFO:Data first load completed successfully.
2025-12-07 11:57:27 +0000 INFO:initialise_data executed successfully
2025-12-07 11:57:27 +0000 INFO:Running Menu setup...
2025-12-07 11:57:27 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:27 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:27 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:28 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:28 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:28 +0000 INFO:App Version: v50.229
2025-12-07 11:57:28 +0000 INFO:Switched to page: Introduction
2025-12-07 11:57:28 +0000 INFO:pagesetup executed successfully
2025-12-07 11:57:28 +0000 INFO:Menu setup completed successfully.
2025-12-07 11:57:28 +0000 INFO:App is fully loaded and ready!
2025-12-07 11:57:32 +0000 INFO:Streamlit App Starting...
2025-12-07 11:57:32 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 11:57:32 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 11:57:32 +0000 INFO:Running App setup...
2025-12-07 11:57:32 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 11:57:32 +0000 INFO:Setting up the package
2025-12-07 11:57:32 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 11:57:32 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:32 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:32 +0000 INFO:Version: v50.191
2025-12-07 11:57:32 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 11:57:32 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:57:32 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:filenames already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:thresholds already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:filter_def already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:security already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:perc_target already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:directories already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:data_dir already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:output_dir already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:components_dir already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 11:57:32 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 11:57:32 +0000 INFO:Session_state variables initialized
2025-12-07 11:57:32 +0000 DEBUG:reference_dir: reference_files
2025-12-07 11:57:32 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 11:57:32 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 11:57:32 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 11:57:32 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 11:57:32 +0000 DEBUG:components_dir: components
2025-12-07 11:57:32 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 11:57:32 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001CB49EC0310>}
2025-12-07 11:57:32 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 11:57:32 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 11:57:32 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 11:57:32 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 11:57:32 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 11:57:32 +0000 DEBUG:data_dir: data
2025-12-07 11:57:32 +0000 DEBUG:output_dir: output
2025-12-07 11:57:32 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 11:57:32 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 11:57:32 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 11:57:32 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 11:57:32 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 11:57:32 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 11:57:32 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 11:57:32 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 11:57:32 +0000 DEBUG:load_raw_data_last_modified: 1765108641.947387
2025-12-07 11:57:32 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 11:57:32 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 11:57:32 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 11:57:32 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 11:57:32 +0000 DEBUG:Cash_ftr: None
2025-12-07 11:57:32 +0000 DEBUG:perc_target: 0.5
2025-12-07 11:57:32 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 11:57:32 +0000 DEBUG:load_donorlist_data_last_modified: 1765108647.5072327
2025-12-07 11:57:32 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 11:57:32 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 11:57:32 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 11:57:32 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 11:57:32 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 11:57:32 +0000 DEBUG:logs_dir: logs
2025-12-07 11:57:32 +0000 DEBUG:utils_dir: utils
2025-12-07 11:57:32 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 11:57:32 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 11:57:32 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 11:57:32 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 11:57:32 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 11:57:32 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 11:57:32 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 11:57:32 +0000 INFO:Session state Setup complete
2025-12-07 11:57:32 +0000 INFO:initialize_session_state executed successfully
2025-12-07 11:57:32 +0000 INFO:Package setup complete
2025-12-07 11:57:32 +0000 INFO:setup_package executed successfully
2025-12-07 11:57:32 +0000 INFO:Setup completed successfully.
2025-12-07 11:57:32 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 11:57:32 +0000 INFO:Running first load function.
2025-12-07 11:57:32 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 11:57:32 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:57:32 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 11:57:32 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:57:32 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:57:32 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 11:57:32 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 11:57:32 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 11:57:32 +0000 INFO:firstload executed successfully
2025-12-07 11:57:32 +0000 INFO:Data first load completed successfully.
2025-12-07 11:57:32 +0000 INFO:initialise_data executed successfully
2025-12-07 11:57:32 +0000 INFO:Running Menu setup...
2025-12-07 11:57:32 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 11:57:32 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 11:57:32 +0000 INFO:get_git_version executed successfully
2025-12-07 11:57:32 +0000 INFO:App Version: v50.229
2025-12-07 11:57:32 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 11:57:32 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:57:33 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 11:57:33 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 11:57:33 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 11:57:33 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 11:57:33 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 11:57:33 +0000 DEBUG:Page texts: {}
2025-12-07 11:57:33 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 11:57:33 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 11:57:33 +0000 INFO:display_visualizations executed successfully
2025-12-07 11:57:33 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 11:57:33 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 11:57:33 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 11:57:33 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 113, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 34, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 276, in load_and_filter_pergroup
    selected_group_entity = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_group_entity'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 12:01:15 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 12:01:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:01:15 +0000 INFO:get_git_version executed successfully
2025-12-07 12:01:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:01:16 +0000 INFO:get_git_version executed successfully
2025-12-07 12:01:16 +0000 INFO:Streamlit App Starting...
2025-12-07 12:01:16 +0000 INFO:Streamlit App Starting...
2025-12-07 12:01:16 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:01:16 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:01:16 +0000 INFO:Running App setup...
2025-12-07 12:01:16 +0000 INFO:Running App setup...
2025-12-07 12:01:16 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:01:16 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:01:16 +0000 INFO:Setting up the package
2025-12-07 12:01:16 +0000 INFO:Setting up the package
2025-12-07 12:01:16 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:01:16 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:01:16 +0000 INFO:get_git_version executed successfully
2025-12-07 12:01:16 +0000 INFO:get_git_version executed successfully
2025-12-07 12:01:16 +0000 INFO:Version: v50.191
2025-12-07 12:01:16 +0000 INFO:Version: v50.191
2025-12-07 12:01:16 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:01:16 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:01:16 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:01:16 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:01:16 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:01:16 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:01:16 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:01:16 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:01:16 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:01:16 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:01:16 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:01:16 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:01:16 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:01:16 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:01:16 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:01:16 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:01:16 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:01:16 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:01:16 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:01:16 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:01:16 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:01:16 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:01:16 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:01:16 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:01:16 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:01:16 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:01:16 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:01:16 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:01:16 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:01:16 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:01:16 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:01:16 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:01:16 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:01:16 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:01:16 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:01:16 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:01:16 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:01:16 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:01:16 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:01:16 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:01:16 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:01:16 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:01:16 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:01:16 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:01:16 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:01:16 +0000 INFO:Session_state variables initialized
2025-12-07 12:01:16 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:01:16 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:01:16 +0000 INFO:Session_state variables initialized
2025-12-07 12:01:16 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:01:16 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:01:16 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:01:16 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:01:16 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:01:16 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:01:16 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:01:16 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:01:16 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:01:16 +0000 DEBUG:output_dir: output
2025-12-07 12:01:16 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:01:16 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:01:16 +0000 DEBUG:output_dir: output
2025-12-07 12:01:16 +0000 DEBUG:components_dir: components
2025-12-07 12:01:16 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:01:16 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:01:16 +0000 DEBUG:components_dir: components
2025-12-07 12:01:16 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:01:16 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:01:16 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:01:16 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:01:16 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:01:16 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:01:16 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:01:16 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:01:16 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:01:16 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:01:16 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:01:16 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:01:16 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:01:16 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:01:16 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:01:16 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:01:16 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:01:16 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:01:16 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:01:16 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:01:16 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:01:16 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:01:16 +0000 DEBUG:data_dir: data
2025-12-07 12:01:16 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:01:16 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:01:16 +0000 DEBUG:data_dir: data
2025-12-07 12:01:16 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:01:16 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:01:16 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:01:16 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:01:16 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:01:16 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:01:16 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:01:16 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:01:16 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:01:16 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:01:16 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:01:16 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:01:16 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:01:16 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:01:16 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:01:16 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:01:16 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:01:16 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:01:16 +0000 DEBUG:utils_dir: utils
2025-12-07 12:01:16 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:01:16 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:01:16 +0000 DEBUG:utils_dir: utils
2025-12-07 12:01:16 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:01:16 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:01:16 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:01:16 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:01:16 +0000 DEBUG:logs_dir: logs
2025-12-07 12:01:16 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:01:16 +0000 INFO:Session state Setup complete
2025-12-07 12:01:16 +0000 DEBUG:logs_dir: logs
2025-12-07 12:01:16 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:01:16 +0000 INFO:Session state Setup complete
2025-12-07 12:01:16 +0000 INFO:Package setup complete
2025-12-07 12:01:16 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:01:16 +0000 INFO:setup_package executed successfully
2025-12-07 12:01:16 +0000 INFO:Package setup complete
2025-12-07 12:01:16 +0000 INFO:Setup completed successfully.
2025-12-07 12:01:16 +0000 INFO:setup_package executed successfully
2025-12-07 12:01:16 +0000 INFO:Setup completed successfully.
2025-12-07 12:01:16 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:01:16 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:01:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:01:17 +0000 ERROR:Error in initialise_data: cannot import name 'firstload' from 'data.data_loader' (H:\GitHub\dashboard_demo\data\data_loader.py)
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\data_utils.py", line 47, in initialise_data
    from data.data_loader import firstload
ImportError: cannot import name 'firstload' from 'data.data_loader' (H:\GitHub\dashboard_demo\data\data_loader.py)
2025-12-07 12:01:17 +0000 CRITICAL:First load crashed: cannot import name 'firstload' from 'data.data_loader' (H:\GitHub\dashboard_demo\data\data_loader.py)
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    initialise_data()  # Load the data
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\data\data_utils.py", line 47, in initialise_data
    from data.data_loader import firstload
ImportError: cannot import name 'firstload' from 'data.data_loader' (H:\GitHub\dashboard_demo\data\data_loader.py)
2025-12-07 12:16:57 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 12:16:57 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 INFO:get_git_version executed successfully
2025-12-07 12:16:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 INFO:get_git_version executed successfully
2025-12-07 12:16:58 +0000 INFO:Streamlit App Starting...
2025-12-07 12:16:58 +0000 INFO:Streamlit App Starting...
2025-12-07 12:16:58 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:16:58 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:16:58 +0000 INFO:Running App setup...
2025-12-07 12:16:58 +0000 INFO:Running App setup...
2025-12-07 12:16:58 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 INFO:Setting up the package
2025-12-07 12:16:58 +0000 INFO:Setting up the package
2025-12-07 12:16:58 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 INFO:get_git_version executed successfully
2025-12-07 12:16:58 +0000 INFO:get_git_version executed successfully
2025-12-07 12:16:58 +0000 INFO:Version: v50.191
2025-12-07 12:16:58 +0000 INFO:Version: v50.191
2025-12-07 12:16:58 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:16:58 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:16:58 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:16:58 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:16:58 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:16:58 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:16:58 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:16:58 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:16:58 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:16:58 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:16:58 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:16:58 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:16:58 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:16:58 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:16:58 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:16:58 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:16:58 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:16:58 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:16:58 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:16:58 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:16:58 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:16:58 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:16:58 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:16:58 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:16:58 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:16:58 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:16:58 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:16:58 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:16:58 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:16:58 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:16:58 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:16:58 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:16:58 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:16:58 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:16:58 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:16:58 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:16:58 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:16:58 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:16:58 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:16:58 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:16:58 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:16:58 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:16:58 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:16:58 +0000 INFO:Session_state variables initialized
2025-12-07 12:16:58 +0000 INFO:Session_state variables initialized
2025-12-07 12:16:58 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:16:58 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:16:58 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:16:58 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:16:58 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:16:58 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:16:58 +0000 DEBUG:logs_dir: logs
2025-12-07 12:16:58 +0000 DEBUG:logs_dir: logs
2025-12-07 12:16:58 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:16:58 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:16:58 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:16:58 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:16:58 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:16:58 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:16:58 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:16:58 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:16:58 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:16:58 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:16:58 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:16:58 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:16:58 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:16:58 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:16:58 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:16:58 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:16:58 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:16:58 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:16:58 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:16:58 +0000 DEBUG:components_dir: components
2025-12-07 12:16:58 +0000 DEBUG:components_dir: components
2025-12-07 12:16:58 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:16:58 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:16:58 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:16:58 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:16:58 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:16:58 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:16:58 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:16:58 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:16:58 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:16:58 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:16:58 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:16:58 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:16:58 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:16:58 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:16:58 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:16:58 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:16:58 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:16:58 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:16:58 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:16:58 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:16:58 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:16:58 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:16:58 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:16:58 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:16:58 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:16:58 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:16:58 +0000 DEBUG:output_dir: output
2025-12-07 12:16:58 +0000 DEBUG:output_dir: output
2025-12-07 12:16:58 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:16:58 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:16:58 +0000 DEBUG:data_dir: data
2025-12-07 12:16:58 +0000 DEBUG:data_dir: data
2025-12-07 12:16:58 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:16:58 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:16:58 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:16:58 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:16:58 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:16:58 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:16:58 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:16:58 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:16:58 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:16:58 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:16:58 +0000 DEBUG:utils_dir: utils
2025-12-07 12:16:58 +0000 DEBUG:utils_dir: utils
2025-12-07 12:16:58 +0000 INFO:Session state Setup complete
2025-12-07 12:16:58 +0000 INFO:Session state Setup complete
2025-12-07 12:16:58 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:16:58 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:16:58 +0000 INFO:Package setup complete
2025-12-07 12:16:58 +0000 INFO:Package setup complete
2025-12-07 12:16:58 +0000 INFO:setup_package executed successfully
2025-12-07 12:16:58 +0000 INFO:setup_package executed successfully
2025-12-07 12:16:58 +0000 INFO:Setup completed successfully.
2025-12-07 12:16:58 +0000 INFO:Setup completed successfully.
2025-12-07 12:16:58 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:16:58 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 INFO:get_git_version executed successfully
2025-12-07 12:16:59 +0000 INFO:Running first load function.
2025-12-07 12:16:59 +0000 INFO:Running first load function.
2025-12-07 12:16:59 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 12:16:59 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 12:16:59 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:16:59 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 12:16:59 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 12:16:59 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 12:16:59 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:16:59 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 12:16:59 +0000 INFO:Last modification time: 1765108641.947387
2025-12-07 12:16:59 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:16:59 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765108641.947387 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 12:16:59 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 12:16:59 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:16:59 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 12:16:59 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 INFO:Cleaning up raw data
2025-12-07 12:16:59 +0000 ERROR:Session state variables not initialized!
2025-12-07 12:16:59 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:16:59 +0000 INFO:Original file path: None
2025-12-07 12:16:59 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 12:16:59 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 12:16:59 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:16:59 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 12:17:01 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 12:17:01 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 12:17:01 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 12:17:01 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 12:17:01 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 12:17:01 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 12:17:01 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 12:17:01 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 12:17:01 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 12:17:01 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 12:17:02 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 12:17:02 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 12:17:02 +0000 INFO:Raw Data cleanup completed
2025-12-07 12:17:02 +0000 INFO:Data shape: (91651, 37)
2025-12-07 12:17:03 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 12:17:03 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 12:17:03 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 12:17:03 +0000 INFO:load_raw_data executed successfully
2025-12-07 12:17:03 +0000 INFO:get_raw_data executed successfully
2025-12-07 12:17:03 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:17:03 +0000 INFO:get_raw_data executed successfully
2025-12-07 12:17:03 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:03 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:17:03 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:03 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:03 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 12:17:03 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:03 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 12:17:03 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 12:17:03 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:17:03 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 12:17:03 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:17:03 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 12:17:03 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:17:03 +0000 INFO:Current modification time: 1765109823.6101656
2025-12-07 12:17:03 +0000 INFO:Last modification time: 1765108641.947387
2025-12-07 12:17:03 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:17:03 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:17:03 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 12:17:03 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 12:17:03 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 12:17:04 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 12:17:06 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 12:17:06 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 12:17:06 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 12:17:06 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 12:17:06 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 12:17:06 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 12:17:06 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 12:17:06 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 12:17:06 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 12:17:06 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 12:17:06 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 12:17:06 +0000 INFO:Loading election dates from pdpy.
2025-12-07 12:17:06 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 12:17:06 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 12:17:06 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 12:17:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:17:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:17:06 +0000 INFO:load_election_dates executed successfully
2025-12-07 12:17:06 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 12:17:06 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 12:17:09 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 12:17:09 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 12:17:09 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 12:17:09 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:17:09 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 12:17:09 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 12:17:09 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 12:17:09 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 12:17:09 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:17:09 +0000 INFO:Current modification time: 1765109829.3337467
2025-12-07 12:17:09 +0000 INFO:Last modification time: 1765108647.5072327
2025-12-07 12:17:09 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:17:09 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:17:09 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 12:17:09 +0000 INFO:Donor Data summary completed
2025-12-07 12:17:09 +0000 INFO:Data shape: (31905, 5)
2025-12-07 12:17:09 +0000 INFO:load_donorList_data executed successfully
2025-12-07 12:17:09 +0000 INFO:get_donor_data executed successfully
2025-12-07 12:17:09 +0000 INFO:get_donor_data executed successfully
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:17:09 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 12:17:09 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 12:17:09 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 12:17:09 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 12:17:09 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:17:09 +0000 INFO:Current modification time: 1765109829.3337467
2025-12-07 12:17:09 +0000 INFO:Last modification time: 1765109829.3337467
2025-12-07 12:17:09 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:17:09 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765109829.3337467 instead of output\cleaned_data.csv
2025-12-07 12:17:09 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 12:17:09 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 12:17:09 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:17:09 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 12:17:09 +0000 INFO:Raw Data cleanup completed
2025-12-07 12:17:09 +0000 INFO:Data shape: (1719, 6)
2025-12-07 12:17:09 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 12:17:09 +0000 INFO:get_regentity_data executed successfully
2025-12-07 12:17:09 +0000 INFO:get_regentity_data executed successfully
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:17:09 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:17:09 +0000 INFO:firstload executed successfully
2025-12-07 12:17:09 +0000 INFO:firstload executed successfully
2025-12-07 12:17:09 +0000 INFO:Data first load completed successfully.
2025-12-07 12:17:09 +0000 INFO:Data first load completed successfully.
2025-12-07 12:17:09 +0000 INFO:initialise_data executed successfully
2025-12-07 12:17:09 +0000 INFO:initialise_data executed successfully
2025-12-07 12:17:09 +0000 INFO:Running Menu setup...
2025-12-07 12:17:09 +0000 INFO:Running Menu setup...
2025-12-07 12:17:09 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:17:09 +0000 INFO:get_git_version executed successfully
2025-12-07 12:17:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:17:10 +0000 INFO:get_git_version executed successfully
2025-12-07 12:17:10 +0000 ERROR:Error in pagesetup: unexpected indent (plot_pie_chart.py, line 115)
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 10, in pagesetup
    from app_pages.headlinefigures import hlf_body
  File "H:\GitHub\dashboard_demo\app_pages\headlinefigures.py", line 2, in <module>
    from Visualisations import (
  File "H:\GitHub\dashboard_demo\Visualisations\plot_pie_chart.py", line 115
    st.plotly_chart(fig, use_container_width=True)
IndentationError: unexpected indent
2025-12-07 12:17:10 +0000 ERROR:Error in pagesetup: cannot import name 'hlf_body' from 'app_pages.headlinefigures' (H:\GitHub\dashboard_demo\app_pages\headlinefigures.py)
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 10, in pagesetup
    from app_pages.headlinefigures import hlf_body
ImportError: cannot import name 'hlf_body' from 'app_pages.headlinefigures' (H:\GitHub\dashboard_demo\app_pages\headlinefigures.py)
2025-12-07 12:17:10 +0000 CRITICAL:Menu setup crashed: unexpected indent (plot_pie_chart.py, line 115)
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 10, in pagesetup
    from app_pages.headlinefigures import hlf_body
  File "H:\GitHub\dashboard_demo\app_pages\headlinefigures.py", line 2, in <module>
    from Visualisations import (
  File "H:\GitHub\dashboard_demo\Visualisations\plot_pie_chart.py", line 115
    st.plotly_chart(fig, use_container_width=True)
IndentationError: unexpected indent
2025-12-07 12:17:10 +0000 CRITICAL:Menu setup crashed: cannot import name 'hlf_body' from 'app_pages.headlinefigures' (H:\GitHub\dashboard_demo\app_pages\headlinefigures.py)
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 10, in pagesetup
    from app_pages.headlinefigures import hlf_body
ImportError: cannot import name 'hlf_body' from 'app_pages.headlinefigures' (H:\GitHub\dashboard_demo\app_pages\headlinefigures.py)
2025-12-07 12:18:12 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 12:18:12 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:13 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:14 +0000 INFO:Streamlit App Starting...
2025-12-07 12:18:14 +0000 INFO:Streamlit App Starting...
2025-12-07 12:18:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:18:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:18:14 +0000 INFO:Running App setup...
2025-12-07 12:18:14 +0000 INFO:Running App setup...
2025-12-07 12:18:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:Setting up the package
2025-12-07 12:18:14 +0000 INFO:Setting up the package
2025-12-07 12:18:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:Streamlit App Starting...
2025-12-07 12:18:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:18:14 +0000 INFO:Running App setup...
2025-12-07 12:18:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:Setting up the package
2025-12-07 12:18:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:14 +0000 INFO:Version: v50.191
2025-12-07 12:18:14 +0000 INFO:Version: v50.191
2025-12-07 12:18:14 +0000 INFO:Version: v50.191
2025-12-07 12:18:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:18:14 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:18:14 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:18:14 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:18:14 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:18:14 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:18:14 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:18:14 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:18:14 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:18:14 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:18:14 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:18:14 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:18:14 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:18:14 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:18:14 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:18:14 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:18:14 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:18:14 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:18:14 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:18:14 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:18:14 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:18:14 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:18:14 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:18:14 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:18:14 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:18:14 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:18:14 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:18:14 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:18:14 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:18:14 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:18:14 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:18:14 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:18:14 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:18:14 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:18:14 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:18:14 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:18:14 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:18:14 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:18:14 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:18:14 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:18:14 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:18:14 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:18:14 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:18:14 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:18:14 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:18:14 +0000 INFO:Session_state variables initialized
2025-12-07 12:18:14 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:18:14 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:18:14 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:18:14 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:18:14 +0000 INFO:Session_state variables initialized
2025-12-07 12:18:14 +0000 INFO:Session_state variables initialized
2025-12-07 12:18:14 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:18:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:18:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:18:14 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:18:14 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:18:14 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:18:14 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:18:14 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:18:14 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:18:14 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:18:14 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:18:14 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:18:14 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:18:14 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:18:14 +0000 DEBUG:components_dir: components
2025-12-07 12:18:14 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:18:14 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:18:14 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:18:14 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:18:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:18:14 +0000 DEBUG:components_dir: components
2025-12-07 12:18:14 +0000 DEBUG:components_dir: components
2025-12-07 12:18:14 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:18:14 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:18:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:18:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:18:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:18:14 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:18:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:18:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:18:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:18:14 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:18:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:18:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:18:14 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:18:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:18:14 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:18:14 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:18:14 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:18:14 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:18:14 +0000 DEBUG:data_dir: data
2025-12-07 12:18:14 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:18:14 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:18:14 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:18:14 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:18:14 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:18:14 +0000 DEBUG:data_dir: data
2025-12-07 12:18:14 +0000 DEBUG:data_dir: data
2025-12-07 12:18:14 +0000 DEBUG:logs_dir: logs
2025-12-07 12:18:14 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:18:14 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:18:14 +0000 DEBUG:utils_dir: utils
2025-12-07 12:18:14 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:18:14 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:18:14 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:18:14 +0000 DEBUG:logs_dir: logs
2025-12-07 12:18:14 +0000 DEBUG:logs_dir: logs
2025-12-07 12:18:14 +0000 DEBUG:output_dir: output
2025-12-07 12:18:14 +0000 DEBUG:utils_dir: utils
2025-12-07 12:18:14 +0000 DEBUG:utils_dir: utils
2025-12-07 12:18:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:18:14 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:18:14 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:18:14 +0000 DEBUG:output_dir: output
2025-12-07 12:18:14 +0000 DEBUG:output_dir: output
2025-12-07 12:18:14 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:18:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:18:14 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:18:14 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:18:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:18:14 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:18:14 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:18:14 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:18:14 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:18:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:18:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:18:14 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:18:14 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:18:14 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:18:14 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:18:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:18:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:18:14 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:18:14 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:18:14 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:18:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:18:14 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:18:14 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:18:14 +0000 INFO:Session state Setup complete
2025-12-07 12:18:14 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:18:14 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:18:14 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:18:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:18:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:18:14 +0000 INFO:Package setup complete
2025-12-07 12:18:14 +0000 INFO:Session state Setup complete
2025-12-07 12:18:14 +0000 INFO:Session state Setup complete
2025-12-07 12:18:14 +0000 INFO:setup_package executed successfully
2025-12-07 12:18:14 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:18:14 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:18:14 +0000 INFO:Setup completed successfully.
2025-12-07 12:18:14 +0000 INFO:Package setup complete
2025-12-07 12:18:14 +0000 INFO:Package setup complete
2025-12-07 12:18:14 +0000 INFO:setup_package executed successfully
2025-12-07 12:18:14 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:setup_package executed successfully
2025-12-07 12:18:14 +0000 INFO:Setup completed successfully.
2025-12-07 12:18:14 +0000 INFO:Setup completed successfully.
2025-12-07 12:18:14 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:14 +0000 INFO:Running first load function.
2025-12-07 12:18:14 +0000 INFO:Running first load function.
2025-12-07 12:18:14 +0000 INFO:Running first load function.
2025-12-07 12:18:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 12:18:14 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 12:18:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 12:18:14 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 12:18:14 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:18:14 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:18:14 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 12:18:14 +0000 INFO:Last modification time: 1765109823.6101656
2025-12-07 12:18:14 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:18:14 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765109823.6101656 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:14 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 12:18:15 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:18:15 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 12:18:15 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 12:18:15 +0000 INFO:Cleaning up raw data
2025-12-07 12:18:15 +0000 ERROR:Session state variables not initialized!
2025-12-07 12:18:15 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:15 +0000 INFO:Original file path: None
2025-12-07 12:18:15 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 12:18:15 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 12:18:15 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:18:15 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 12:18:16 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 12:18:16 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 12:18:17 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 12:18:17 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 12:18:17 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 12:18:17 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 12:18:17 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 12:18:17 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 12:18:17 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 12:18:17 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 12:18:17 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 12:18:17 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 12:18:17 +0000 INFO:Raw Data cleanup completed
2025-12-07 12:18:17 +0000 INFO:Data shape: (91651, 37)
2025-12-07 12:18:18 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 12:18:18 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 12:18:18 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 12:18:19 +0000 INFO:load_raw_data executed successfully
2025-12-07 12:18:19 +0000 INFO:get_raw_data executed successfully
2025-12-07 12:18:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:18:19 +0000 INFO:get_raw_data executed successfully
2025-12-07 12:18:19 +0000 INFO:get_raw_data executed successfully
2025-12-07 12:18:19 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:18:19 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:18:19 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:19 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:19 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:19 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 12:18:19 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:19 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 12:18:19 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 12:18:19 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:18:19 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 12:18:19 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:18:19 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 12:18:19 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:18:19 +0000 INFO:Current modification time: 1765109898.9958625
2025-12-07 12:18:19 +0000 INFO:Last modification time: 1765109823.6101656
2025-12-07 12:18:19 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:18:19 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:18:19 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 12:18:19 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 12:18:19 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 12:18:19 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 12:18:21 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 12:18:21 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 12:18:21 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 12:18:21 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 12:18:21 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 12:18:21 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 12:18:21 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 12:18:21 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 12:18:21 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 12:18:22 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 12:18:22 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 12:18:22 +0000 INFO:Loading election dates from pdpy.
2025-12-07 12:18:22 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 12:18:22 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 12:18:22 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 12:18:22 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:18:22 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:18:22 +0000 INFO:load_election_dates executed successfully
2025-12-07 12:18:22 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 12:18:22 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 12:18:24 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 12:18:24 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 12:18:24 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:18:24 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 12:18:24 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:18:24 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:18:24 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 12:18:24 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 12:18:24 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 12:18:24 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 12:18:24 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:18:24 +0000 INFO:Current modification time: 1765109904.2986655
2025-12-07 12:18:24 +0000 INFO:Last modification time: 1765109829.3337467
2025-12-07 12:18:24 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:18:24 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:18:24 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 12:18:24 +0000 INFO:Donor Data summary completed
2025-12-07 12:18:24 +0000 INFO:Data shape: (31905, 5)
2025-12-07 12:18:24 +0000 INFO:load_donorList_data executed successfully
2025-12-07 12:18:24 +0000 INFO:get_donor_data executed successfully
2025-12-07 12:18:24 +0000 INFO:get_donor_data executed successfully
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:18:24 +0000 INFO:get_donor_data executed successfully
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:18:24 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:18:24 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 12:18:24 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 12:18:24 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 12:18:24 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 12:18:24 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:18:24 +0000 INFO:Current modification time: 1765109904.2986655
2025-12-07 12:18:24 +0000 INFO:Last modification time: 1765109904.2986655
2025-12-07 12:18:24 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:18:24 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765109904.2986655 instead of output\cleaned_data.csv
2025-12-07 12:18:24 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 12:18:24 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 12:18:24 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:18:24 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 12:18:24 +0000 INFO:Raw Data cleanup completed
2025-12-07 12:18:24 +0000 INFO:Data shape: (1719, 6)
2025-12-07 12:18:24 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 12:18:24 +0000 INFO:get_regentity_data executed successfully
2025-12-07 12:18:24 +0000 INFO:get_regentity_data executed successfully
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:18:24 +0000 INFO:get_regentity_data executed successfully
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:18:24 +0000 INFO:firstload executed successfully
2025-12-07 12:18:24 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:18:24 +0000 INFO:firstload executed successfully
2025-12-07 12:18:24 +0000 INFO:Data first load completed successfully.
2025-12-07 12:18:24 +0000 INFO:firstload executed successfully
2025-12-07 12:18:24 +0000 INFO:Data first load completed successfully.
2025-12-07 12:18:24 +0000 INFO:initialise_data executed successfully
2025-12-07 12:18:24 +0000 INFO:Data first load completed successfully.
2025-12-07 12:18:24 +0000 INFO:initialise_data executed successfully
2025-12-07 12:18:24 +0000 INFO:Running Menu setup...
2025-12-07 12:18:24 +0000 INFO:initialise_data executed successfully
2025-12-07 12:18:24 +0000 INFO:Running Menu setup...
2025-12-07 12:18:24 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:Running Menu setup...
2025-12-07 12:18:24 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:24 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:25 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:25 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:25 +0000 INFO:App Version: v50.229
2025-12-07 12:18:25 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:25 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:25 +0000 INFO:Switched to page: Introduction
2025-12-07 12:18:25 +0000 INFO:App Version: v50.229
2025-12-07 12:18:25 +0000 INFO:App Version: v50.229
2025-12-07 12:18:25 +0000 INFO:Switched to page: Introduction
2025-12-07 12:18:25 +0000 INFO:Switched to page: Introduction
2025-12-07 12:18:25 +0000 INFO:pagesetup executed successfully
2025-12-07 12:18:25 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:18:25 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:18:25 +0000 INFO:pagesetup executed successfully
2025-12-07 12:18:25 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:18:25 +0000 INFO:pagesetup executed successfully
2025-12-07 12:18:25 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:18:25 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:18:25 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:18:33 +0000 INFO:Streamlit App Starting...
2025-12-07 12:18:33 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:18:33 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:18:33 +0000 INFO:Running App setup...
2025-12-07 12:18:33 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:18:33 +0000 INFO:Setting up the package
2025-12-07 12:18:33 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:18:33 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:33 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:33 +0000 INFO:Version: v50.191
2025-12-07 12:18:33 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:18:33 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:18:33 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:security already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:directories already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:18:33 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:18:33 +0000 INFO:Session_state variables initialized
2025-12-07 12:18:33 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:18:33 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:18:33 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:18:33 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:18:33 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:18:33 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:18:33 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:18:33 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:18:33 +0000 DEBUG:components_dir: components
2025-12-07 12:18:33 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001C886246320>}
2025-12-07 12:18:33 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:18:33 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:18:33 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:18:33 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:18:33 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:18:33 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:18:33 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:18:33 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:18:33 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:18:33 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:18:33 +0000 DEBUG:data_dir: data
2025-12-07 12:18:33 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:18:33 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:18:33 +0000 DEBUG:logs_dir: logs
2025-12-07 12:18:33 +0000 DEBUG:utils_dir: utils
2025-12-07 12:18:33 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:18:33 +0000 DEBUG:output_dir: output
2025-12-07 12:18:33 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:18:33 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:18:33 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:18:33 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:18:33 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:18:33 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:18:33 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:18:33 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:18:33 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:18:33 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:18:33 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:18:33 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:18:33 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:18:33 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:18:33 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:18:33 +0000 INFO:Session state Setup complete
2025-12-07 12:18:33 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:18:33 +0000 INFO:Package setup complete
2025-12-07 12:18:33 +0000 INFO:setup_package executed successfully
2025-12-07 12:18:33 +0000 INFO:Setup completed successfully.
2025-12-07 12:18:33 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:18:33 +0000 INFO:Running first load function.
2025-12-07 12:18:33 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:18:33 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:18:33 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:18:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:18:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:18:33 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:18:33 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:18:33 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:18:33 +0000 INFO:firstload executed successfully
2025-12-07 12:18:33 +0000 INFO:Data first load completed successfully.
2025-12-07 12:18:33 +0000 INFO:initialise_data executed successfully
2025-12-07 12:18:33 +0000 INFO:Running Menu setup...
2025-12-07 12:18:33 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:18:33 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:18:33 +0000 INFO:get_git_version executed successfully
2025-12-07 12:18:33 +0000 INFO:App Version: v50.229
2025-12-07 12:18:33 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 12:18:33 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:18:34 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:18:34 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:18:34 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:18:34 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:18:34 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:18:34 +0000 DEBUG:Page texts: {}
2025-12-07 12:18:34 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:18:34 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:18:34 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:18:34 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:18:34 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:18:34 +0000 ERROR:Error in display_per_group_data_page: There are multiple elements with the same `key='selected_entity_name'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 30, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 312, in load_and_filter_pergroup
    selected_entity_name = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_entity_name'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 12:18:34 +0000 CRITICAL:Menu setup crashed: There are multiple elements with the same `key='selected_entity_name'`. To fix this, please make sure that the `key` argument is unique for each element you create.
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 54, in pagesetup
    app.run()  # Run the  app
  File "H:\GitHub\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 112, in mod_regulated_donor_per_entity
    display_per_group_data_page(
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\app_pages\modular_page_per_donor.py", line 30, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\GitHub\dashboard_demo\components\modular_page_blocks.py", line 312, in load_and_filter_pergroup
    selected_entity_name = st.selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\runtime\metrics_util.py", line 531, in wrapped_func
    result = non_optional_func(*args, **kwargs)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 470, in selectbox
    return self._selectbox(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\widgets\selectbox.py", line 542, in _selectbox
    element_id = compute_and_register_element_id(
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 265, in compute_and_register_element_id
    _register_element_id(ctx, element_type, element_id)
  File "h:\GitHub\dashboard_demo\.venv\lib\site-packages\streamlit\elements\lib\utils.py", line 145, in _register_element_id
    raise StreamlitDuplicateElementKey(user_key)
streamlit.errors.StreamlitDuplicateElementKey: There are multiple elements with the same `key='selected_entity_name'`. To fix this, please make sure that the `key` argument is unique for each element you create.
2025-12-07 12:21:01 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 12:21:01 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:21:02 +0000 INFO:get_git_version executed successfully
2025-12-07 12:21:02 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 INFO:get_git_version executed successfully
2025-12-07 12:21:03 +0000 INFO:Streamlit App Starting...
2025-12-07 12:21:03 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:21:03 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:21:03 +0000 INFO:Running App setup...
2025-12-07 12:21:03 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 INFO:Setting up the package
2025-12-07 12:21:03 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:21:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 INFO:get_git_version executed successfully
2025-12-07 12:21:03 +0000 INFO:Version: v50.191
2025-12-07 12:21:03 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:21:03 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:21:03 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:21:03 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:21:03 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:21:03 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:21:03 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:21:03 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:21:03 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:21:03 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:21:03 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:21:03 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:21:03 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:21:03 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:21:03 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:21:03 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:21:03 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:21:03 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:21:03 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:21:03 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:21:03 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:21:03 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:21:03 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:21:03 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:21:03 +0000 INFO:Session_state variables initialized
2025-12-07 12:21:03 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:21:03 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:21:03 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:21:03 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:21:03 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:21:03 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:21:03 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:21:03 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:21:03 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:21:03 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:21:03 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:21:03 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:21:03 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:21:03 +0000 DEBUG:data_dir: data
2025-12-07 12:21:03 +0000 DEBUG:utils_dir: utils
2025-12-07 12:21:03 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:21:03 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:21:03 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:21:03 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:21:03 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:21:03 +0000 DEBUG:components_dir: components
2025-12-07 12:21:03 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:21:03 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:21:03 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:21:03 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:21:03 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:21:03 +0000 DEBUG:logs_dir: logs
2025-12-07 12:21:03 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:21:03 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:21:03 +0000 DEBUG:output_dir: output
2025-12-07 12:21:03 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:21:03 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:21:03 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:21:03 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:21:03 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:21:03 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:21:03 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:21:03 +0000 INFO:Session state Setup complete
2025-12-07 12:21:03 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:21:03 +0000 INFO:Package setup complete
2025-12-07 12:21:03 +0000 INFO:setup_package executed successfully
2025-12-07 12:21:03 +0000 INFO:Setup completed successfully.
2025-12-07 12:21:03 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 INFO:get_git_version executed successfully
2025-12-07 12:21:03 +0000 INFO:Running first load function.
2025-12-07 12:21:03 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 12:21:03 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 12:21:03 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:21:03 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 12:21:03 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 12:21:03 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:21:03 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 12:21:03 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:21:03 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 12:21:03 +0000 INFO:Last modification time: 1765109898.9958625
2025-12-07 12:21:03 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:21:03 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765109898.9958625 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 12:21:03 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 12:21:04 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:21:04 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 12:21:04 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 12:21:04 +0000 INFO:Cleaning up raw data
2025-12-07 12:21:04 +0000 ERROR:Session state variables not initialized!
2025-12-07 12:21:04 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:04 +0000 INFO:Original file path: None
2025-12-07 12:21:04 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 12:21:04 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 12:21:04 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:21:04 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 12:21:05 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 12:21:05 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 12:21:06 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 12:21:06 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 12:21:06 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 12:21:06 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 12:21:06 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 12:21:06 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 12:21:06 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 12:21:06 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 12:21:06 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 12:21:06 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 12:21:06 +0000 INFO:Raw Data cleanup completed
2025-12-07 12:21:06 +0000 INFO:Data shape: (91651, 37)
2025-12-07 12:21:08 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 12:21:08 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 12:21:08 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 12:21:08 +0000 INFO:load_raw_data executed successfully
2025-12-07 12:21:08 +0000 INFO:get_raw_data executed successfully
2025-12-07 12:21:08 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:21:08 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:08 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:08 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 12:21:08 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:08 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 12:21:08 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 12:21:08 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:21:08 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 12:21:08 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:21:08 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 12:21:08 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:21:08 +0000 INFO:Current modification time: 1765110068.6947827
2025-12-07 12:21:08 +0000 INFO:Last modification time: 1765109898.9958625
2025-12-07 12:21:08 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:21:08 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:21:08 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 12:21:08 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 12:21:08 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 12:21:09 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 12:21:11 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 12:21:11 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 12:21:11 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 12:21:11 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 12:21:11 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 12:21:11 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 12:21:11 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 12:21:11 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 12:21:11 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 12:21:11 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 12:21:11 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 12:21:11 +0000 INFO:Loading election dates from pdpy.
2025-12-07 12:21:12 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 12:21:12 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 12:21:12 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 12:21:12 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:21:12 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:21:12 +0000 INFO:load_election_dates executed successfully
2025-12-07 12:21:12 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 12:21:12 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 12:21:14 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 12:21:14 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 12:21:14 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 12:21:14 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:21:14 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 12:21:14 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 12:21:14 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 12:21:14 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 12:21:14 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:21:14 +0000 INFO:Current modification time: 1765110074.2738063
2025-12-07 12:21:14 +0000 INFO:Last modification time: 1765109904.2986655
2025-12-07 12:21:14 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:21:14 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:21:14 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 12:21:14 +0000 INFO:Donor Data summary completed
2025-12-07 12:21:14 +0000 INFO:Data shape: (31905, 5)
2025-12-07 12:21:14 +0000 INFO:load_donorList_data executed successfully
2025-12-07 12:21:14 +0000 INFO:get_donor_data executed successfully
2025-12-07 12:21:14 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:21:14 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:21:14 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 12:21:14 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 12:21:14 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 12:21:14 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 12:21:14 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:21:14 +0000 INFO:Current modification time: 1765110074.2738063
2025-12-07 12:21:14 +0000 INFO:Last modification time: 1765110074.2738063
2025-12-07 12:21:14 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:21:14 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765110074.2738063 instead of output\cleaned_data.csv
2025-12-07 12:21:14 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 12:21:14 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 12:21:14 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:21:14 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 12:21:14 +0000 INFO:Raw Data cleanup completed
2025-12-07 12:21:14 +0000 INFO:Data shape: (1719, 6)
2025-12-07 12:21:14 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 12:21:14 +0000 INFO:get_regentity_data executed successfully
2025-12-07 12:21:14 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:21:14 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:21:14 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:21:14 +0000 INFO:firstload executed successfully
2025-12-07 12:21:14 +0000 INFO:Data first load completed successfully.
2025-12-07 12:21:14 +0000 INFO:initialise_data executed successfully
2025-12-07 12:21:14 +0000 INFO:Running Menu setup...
2025-12-07 12:21:14 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:21:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:21:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:21:14 +0000 ERROR:Error in pagesetup: unterminated string literal (detected at line 103) (mod_page_calls.py, line 103)
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 12, in pagesetup
    from app_pages.mod_page_calls import (
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 103
    "TBC])
    ^
SyntaxError: unterminated string literal (detected at line 103)
2025-12-07 12:21:14 +0000 CRITICAL:Menu setup crashed: unterminated string literal (detected at line 103) (mod_page_calls.py, line 103)
Traceback (most recent call last):
  File "H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 56, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\GitHub\dashboard_demo\utils\logger.py", line 45, in wrapper
    result = func(*args, **kwargs)
  File "H:\GitHub\dashboard_demo\politicalpartyanalysis.py", line 12, in pagesetup
    from app_pages.mod_page_calls import (
  File "H:\GitHub\dashboard_demo\app_pages\mod_page_calls.py", line 103
    "TBC])
    ^
SyntaxError: unterminated string literal (detected at line 103)
2025-12-07 12:22:07 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 12:22:07 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:08 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:08 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:08 +0000 INFO:Streamlit App Starting...
2025-12-07 12:22:08 +0000 INFO:Streamlit App Starting...
2025-12-07 12:22:08 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:22:08 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:22:08 +0000 INFO:Running App setup...
2025-12-07 12:22:08 +0000 INFO:Running App setup...
2025-12-07 12:22:08 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:22:08 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:22:08 +0000 INFO:Setting up the package
2025-12-07 12:22:08 +0000 INFO:Setting up the package
2025-12-07 12:22:08 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:08 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:08 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:08 +0000 INFO:Version: v50.191
2025-12-07 12:22:08 +0000 INFO:Version: v50.191
2025-12-07 12:22:08 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:22:08 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:22:08 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 DEBUG:Initialised BASE_DIR with value: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:22:08 +0000 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:22:08 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:22:08 +0000 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025-12-07 12:22:08 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:22:08 +0000 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025-12-07 12:22:08 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:22:08 +0000 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:22:08 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:22:08 +0000 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:22:08 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:22:08 +0000 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:22:08 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:22:08 +0000 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:22:08 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:22:08 +0000 DEBUG:Initialised perc_target with value: 0.5
2025-12-07 12:22:08 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:22:08 +0000 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: True
2025-12-07 12:22:08 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:22:08 +0000 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:22:08 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:22:08 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:22:08 +0000 DEBUG:Initialised reference_dir with value: reference_files
2025-12-07 12:22:08 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:22:08 +0000 DEBUG:Initialised data_dir with value: data
2025-12-07 12:22:08 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:22:08 +0000 DEBUG:Initialised output_dir with value: output
2025-12-07 12:22:08 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:22:08 +0000 DEBUG:Initialised logs_dir with value: logs
2025-12-07 12:22:08 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:22:08 +0000 DEBUG:Initialised components_dir with value: components
2025-12-07 12:22:08 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:22:08 +0000 DEBUG:Initialised app_pages_dir with value: app_pages
2025-12-07 12:22:08 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised utils_dir with value: utils
2025-12-07 12:22:08 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:22:08 +0000 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:22:08 +0000 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025-12-07 12:22:08 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025-12-07 12:22:08 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:22:08 +0000 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025-12-07 12:22:08 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025-12-07 12:22:08 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:22:08 +0000 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:22:08 +0000 INFO:Session_state variables initialized
2025-12-07 12:22:08 +0000 DEBUG:Initialised Cash_ftr with value: None
2025-12-07 12:22:08 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:22:08 +0000 INFO:Session_state variables initialized
2025-12-07 12:22:08 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:22:08 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:22:08 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:22:08 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:22:08 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:22:08 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:22:08 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:22:08 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:22:08 +0000 DEBUG:components_dir: components
2025-12-07 12:22:08 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:22:08 +0000 DEBUG:logs_dir: logs
2025-12-07 12:22:08 +0000 DEBUG:components_dir: components
2025-12-07 12:22:08 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:22:08 +0000 DEBUG:logs_dir: logs
2025-12-07 12:22:08 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:22:08 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:22:08 +0000 DEBUG:utils_dir: utils
2025-12-07 12:22:08 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:22:08 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:22:08 +0000 DEBUG:utils_dir: utils
2025-12-07 12:22:08 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:22:08 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:22:08 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:22:08 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:22:08 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:22:08 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:22:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:22:08 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:22:08 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:22:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:22:08 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:22:08 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:22:08 +0000 DEBUG:data_dir: data
2025-12-07 12:22:08 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:22:08 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:22:08 +0000 DEBUG:data_dir: data
2025-12-07 12:22:08 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:22:08 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:22:08 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:22:08 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:22:08 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:22:08 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:22:08 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:22:08 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:22:08 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:22:08 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:22:08 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:22:08 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:22:08 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:22:08 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:22:08 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:22:08 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:22:08 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:22:08 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:22:08 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:22:08 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:22:08 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:22:08 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:22:08 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:22:08 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:22:08 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:22:09 +0000 DEBUG:output_dir: output
2025-12-07 12:22:09 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:22:09 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:22:09 +0000 DEBUG:output_dir: output
2025-12-07 12:22:09 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:22:09 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:22:09 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:22:09 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:22:09 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:22:09 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:22:09 +0000 INFO:Session state Setup complete
2025-12-07 12:22:09 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:22:09 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:22:09 +0000 INFO:Session state Setup complete
2025-12-07 12:22:09 +0000 INFO:Package setup complete
2025-12-07 12:22:09 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:22:09 +0000 INFO:setup_package executed successfully
2025-12-07 12:22:09 +0000 INFO:Package setup complete
2025-12-07 12:22:09 +0000 INFO:Setup completed successfully.
2025-12-07 12:22:09 +0000 INFO:setup_package executed successfully
2025-12-07 12:22:09 +0000 INFO:Setup completed successfully.
2025-12-07 12:22:09 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:09 +0000 INFO:Running first load function.
2025-12-07 12:22:09 +0000 INFO:Running first load function.
2025-12-07 12:22:09 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 DEBUG:Original data file path pre raw data load: source_data_fname
2025-12-07 12:22:09 +0000 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025-12-07 12:22:09 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:22:09 +0000 INFO:Saved file path: output\imported_raw.csv
2025-12-07 12:22:09 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025-12-07 12:22:09 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:22:09 +0000 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025-12-07 12:22:09 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:22:09 +0000 INFO:Current modification time: 1765052688.9370306
2025-12-07 12:22:09 +0000 INFO:Last modification time: 1765110068.6947827
2025-12-07 12:22:09 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:22:09 +0000 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1765110068.6947827 instead of source\Donations_accepted_by_political_parties.csv
2025-12-07 12:22:09 +0000 INFO:Importing file from output\imported_raw.csv
2025-12-07 12:22:09 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:22:10 +0000 INFO:Preprocessed data loaded successfully.
2025-12-07 12:22:10 +0000 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025-12-07 12:22:10 +0000 INFO:Cleaning up raw data
2025-12-07 12:22:10 +0000 ERROR:Session state variables not initialized!
2025-12-07 12:22:10 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:10 +0000 INFO:Original file path: None
2025-12-07 12:22:10 +0000 INFO:Saved file path: output\cleaned_donations.csv
2025-12-07 12:22:10 +0000 ERROR:Error: originalfilepath is None!
2025-12-07 12:22:10 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:22:10 +0000 INFO:Data loaded, shape: (91651, 29)
2025-12-07 12:22:11 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 12:22:11 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 12:22:11 +0000 INFO:File deduplication complete, shape: ECRef                            594
OriginalRegulatedEntityName      594
RegulatedEntityType              594
Value                            594
AcceptedDate                     575
AccountingUnitName               594
DonorName                        594
AccountingUnitsAsCentralParty    594
IsSponsorship                    594
DonorStatus                      594
RegulatedDoneeType               594
CompanyRegistrationNumber        594
Postcode                         594
DonationType                     594
NatureOfDonation                 594
PurposeOfVisit                   594
DonationAction                   594
ReceivedDate                     487
ReportedDate                     594
IsReportedPrePoll                423
ReportingPeriodName              594
IsBequest                        594
IsAggregation                    594
OriginalRegulatedEntityId        594
AccountingUnitId                 594
DonorId                          594
CampaigningName                  594
RegisterName                     594
IsIrishSource                    594
CleanedRegulatedEntityName       594
CleanedRegulatedEntityId         594
RegulatedEntityId                594
RegulatedEntityName              594
dtype: int64 records updated with new RegulatedEntityId and ECRef                            10131
OriginalRegulatedEntityName      10131
RegulatedEntityType              10131
Value                            10129
AcceptedDate                      9805
AccountingUnitName               10131
DonorName                        10131
AccountingUnitsAsCentralParty    10131
IsSponsorship                    10131
DonorStatus                      10131
RegulatedDoneeType               10131
CompanyRegistrationNumber        10131
Postcode                         10131
DonationType                     10131
NatureOfDonation                 10131
PurposeOfVisit                   10131
DonationAction                   10131
ReceivedDate                      7114
ReportedDate                     10121
IsReportedPrePoll                 4878
ReportingPeriodName              10131
IsBequest                        10131
IsAggregation                    10131
OriginalRegulatedEntityId        10131
AccountingUnitId                 10131
DonorId                          10131
CampaigningName                  10131
RegisterName                     10131
IsIrishSource                    10131
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                10131
RegulatedEntityName              10131
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 12:22:11 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            3850
OriginalRegulatedEntityName      3850
RegulatedEntityType              3850
Value                            3850
AcceptedDate                     3745
AccountingUnitName               3850
DonorName                        3850
AccountingUnitsAsCentralParty    3850
IsSponsorship                    3850
DonorStatus                      3850
RegulatedDoneeType               3850
CompanyRegistrationNumber        3850
Postcode                         3850
DonationType                     3850
NatureOfDonation                 3850
PurposeOfVisit                   3850
DonationAction                   3850
ReceivedDate                     3398
ReportedDate                     3850
IsReportedPrePoll                 449
ReportingPeriodName              3850
IsBequest                        3850
IsAggregation                    3850
OriginalRegulatedEntityId        3850
AccountingUnitId                 3850
DonorId                          3850
CampaigningName                  3850
RegisterName                     3850
IsIrishSource                    3850
CleanedRegulatedEntityName        594
CleanedRegulatedEntityId          594
RegulatedEntityId                3850
RegulatedEntityName              3850
dtype: int64 records updated with new RegulatedEntityId and ECRef                            13387
OriginalRegulatedEntityName      13387
RegulatedEntityType              13387
Value                            13385
AcceptedDate                     12975
AccountingUnitName               13387
DonorName                        13387
AccountingUnitsAsCentralParty    13387
IsSponsorship                    13387
DonorStatus                      13387
RegulatedDoneeType               13387
CompanyRegistrationNumber        13387
Postcode                         13387
DonationType                     13387
NatureOfDonation                 13387
PurposeOfVisit                   13387
DonationAction                   13387
ReceivedDate                     10025
ReportedDate                     13377
IsReportedPrePoll                 4904
ReportingPeriodName              13387
IsBequest                        13387
IsAggregation                    13387
OriginalRegulatedEntityId        13387
AccountingUnitId                 13387
DonorId                          13387
CampaigningName                  13387
RegisterName                     13387
IsIrishSource                    13387
CleanedRegulatedEntityName       10131
CleanedRegulatedEntityId         10131
RegulatedEntityId                13387
RegulatedEntityName              13387
dtype: int64 records updated with new RegulatedEntityName
2025-12-07 12:22:11 +0000 INFO:File deduplication complete, shape: (91651, 33)
2025-12-07 12:22:11 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 12:22:11 +0000 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025-12-07 12:22:11 +0000 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025-12-07 12:22:12 +0000 INFO:File deduplication complete, shape: ECRef                            34217
OriginalRegulatedEntityName      34217
RegulatedEntityType              34217
Value                            34214
AcceptedDate                     33822
AccountingUnitName               34217
OriginalDonorName                34217
AccountingUnitsAsCentralParty    34217
IsSponsorship                    34217
DonorStatus                      34217
RegulatedDoneeType               34217
CompanyRegistrationNumber        34217
Postcode                         34217
DonationType                     34217
NatureOfDonation                 34217
PurposeOfVisit                   34217
DonationAction                   34217
ReceivedDate                     32617
ReportedDate                     34206
IsReportedPrePoll                22707
ReportingPeriodName              34217
IsBequest                        34217
IsAggregation                    34217
OriginalRegulatedEntityId        34217
AccountingUnitId                 34217
OriginalDonorId                  34217
CampaigningName                  34217
RegisterName                     34217
IsIrishSource                    34217
CleanedRegulatedEntityName       34217
CleanedRegulatedEntityId         34217
RegulatedEntityId                34217
RegulatedEntityName              34217
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          34217
DonorName                        34217
dtype: int64 records updated with new DonorId and ECRef                            20369
OriginalRegulatedEntityName      20369
RegulatedEntityType              20369
Value                            20367
AcceptedDate                     20042
AccountingUnitName               20369
OriginalDonorName                20369
AccountingUnitsAsCentralParty    20369
IsSponsorship                    20369
DonorStatus                      20369
RegulatedDoneeType               20369
CompanyRegistrationNumber        20369
Postcode                         20369
DonationType                     20369
NatureOfDonation                 20369
PurposeOfVisit                   20369
DonationAction                   20369
ReceivedDate                     19832
ReportedDate                     20360
IsReportedPrePoll                13414
ReportingPeriodName              20369
IsBequest                        20369
IsAggregation                    20369
OriginalRegulatedEntityId        20369
AccountingUnitId                 20369
OriginalDonorId                  20369
CampaigningName                  20369
RegisterName                     20369
IsIrishSource                    20369
CleanedRegulatedEntityName       20368
CleanedRegulatedEntityId         20368
RegulatedEntityId                20369
RegulatedEntityName              20369
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          20369
DonorName                        20369
dtype: int64 records updated with new DonorName
2025-12-07 12:22:12 +0000 DEBUG:File deduplication cleaned complete, shape: ECRef                            53024
OriginalRegulatedEntityName      53024
RegulatedEntityType              53024
Value                            53021
AcceptedDate                     52222
AccountingUnitName               53024
OriginalDonorName                53024
AccountingUnitsAsCentralParty    53024
IsSponsorship                    53024
DonorStatus                      53024
RegulatedDoneeType               53024
CompanyRegistrationNumber        53024
Postcode                         53024
DonationType                     53024
NatureOfDonation                 53024
PurposeOfVisit                   53024
DonationAction                   53024
ReceivedDate                     50666
ReportedDate                     53013
IsReportedPrePoll                23658
ReportingPeriodName              53024
IsBequest                        53024
IsAggregation                    53024
OriginalRegulatedEntityId        53024
AccountingUnitId                 53024
OriginalDonorId                  53024
CampaigningName                  53024
RegisterName                     53024
IsIrishSource                    53024
CleanedRegulatedEntityName       49817
CleanedRegulatedEntityId         49817
RegulatedEntityId                53024
RegulatedEntityName              53024
CleanedDonorName                 34217
CleanedDonorId                   34217
DonorId                          53024
DonorName                        53024
dtype: int64 records updated with new DonorId and ECRef                            39176
OriginalRegulatedEntityName      39176
RegulatedEntityType              39176
Value                            39174
AcceptedDate                     38442
AccountingUnitName               39176
OriginalDonorName                39176
AccountingUnitsAsCentralParty    39176
IsSponsorship                    39176
DonorStatus                      39176
RegulatedDoneeType               39176
CompanyRegistrationNumber        39176
Postcode                         39176
DonationType                     39176
NatureOfDonation                 39176
PurposeOfVisit                   39176
DonationAction                   39176
ReceivedDate                     37881
ReportedDate                     39167
IsReportedPrePoll                14365
ReportingPeriodName              39176
IsBequest                        39176
IsAggregation                    39176
OriginalRegulatedEntityId        39176
AccountingUnitId                 39176
OriginalDonorId                  39176
CampaigningName                  39176
RegisterName                     39176
IsIrishSource                    39176
CleanedRegulatedEntityName       35968
CleanedRegulatedEntityId         35968
RegulatedEntityId                39176
RegulatedEntityName              39176
CleanedDonorName                 20369
CleanedDonorId                   20369
DonorId                          39176
DonorName                        39176
dtype: int64 records updated with new DonorName
2025-12-07 12:22:12 +0000 INFO:File deduplication complete, shape: (91651, 37)
2025-12-07 12:22:12 +0000 INFO:dedupe_entity_file executed successfully
2025-12-07 12:22:12 +0000 INFO:Raw Data cleanup completed
2025-12-07 12:22:12 +0000 INFO:Data shape: (91651, 37)
2025-12-07 12:22:14 +0000 INFO:Data saved to output\cleaned_donations.csv
2025-12-07 12:22:14 +0000 INFO:Data cleanup completed, shape: (91651, 37)
2025-12-07 12:22:14 +0000 INFO:raw_data_cleanup executed successfully
2025-12-07 12:22:14 +0000 INFO:load_raw_data executed successfully
2025-12-07 12:22:14 +0000 INFO:get_raw_data executed successfully
2025-12-07 12:22:14 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:22:14 +0000 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:14 +0000 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:14 +0000 DEBUG:Rows in Raw Data: 91651
2025-12-07 12:22:14 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:14 +0000 INFO:Original file path: output\cleaned_donations.csv
2025-12-07 12:22:14 +0000 INFO:Saved file path: output\cleaned_data.csv
2025-12-07 12:22:14 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:22:14 +0000 INFO:Checking if output\cleaned_donations.csv has been updated.
2025-12-07 12:22:14 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:22:14 +0000 INFO:Getting modification time for output\cleaned_donations.csv
2025-12-07 12:22:14 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:22:14 +0000 INFO:Current modification time: 1765110134.100864
2025-12-07 12:22:14 +0000 INFO:Last modification time: 1765110068.6947827
2025-12-07 12:22:14 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:22:14 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:22:14 +0000 ERROR:Failed to load data from output\cleaned_donations.csv
2025-12-07 12:22:14 +0000 INFO:Loading and cleaning data... data.clean_and_enhance
2025-12-07 12:22:14 +0000 DEBUG:Clean Data Prep 79: streamlitdata load: 91651
2025-12-07 12:22:14 +0000 DEBUG:Clean Data Prep 126: streamlitdata load: 91651
2025-12-07 12:22:16 +0000 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025-12-07 12:22:17 +0000 DEBUG:Clean Data Prep 204: Map Party: 91651
2025-12-07 12:22:17 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 12:22:17 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    28648
Labour Party                       22748
Liberal Democrats                  19184
Small Medium Entity                 6138
Small Entity                        2881
Medium Large Entity                 2190
Large Entity                        1964
Very Small Entity                   1857
Uk Independence Party (Ukip)        1830
Green Party                         1669
Medium Entity                       1591
Single Donation Entity               584
Reform UK                            367
Name: count, dtype: int64
2025-12-07 12:22:17 +0000 DEBUG:Group assignment: group
Very Small Entity                  617
Single Donation Entity             584
Small Entity                       306
Small Medium Entity                179
Medium Entity                       11
Medium Large Entity                  8
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 12:22:17 +0000 DEBUG:Clean Data Prep 325: RegEntity_Map: 91651
2025-12-07 12:22:17 +0000 DEBUG:Group assignment with exceptions: {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}
2025-12-07 12:22:17 +0000 DEBUG:Group assignment: group
Conservative And Unionist Party    32061
Labour Party                       27167
Liberal Democrat                   19522
Small Medium Entity                 2047
Large Entity                        2038
Medium Large Entity                 1902
Uk Independence Party (Ukip)        1851
Green Party                         1690
Medium Entity                       1295
Small Entity                         853
Very Small Entity                    633
Reform UK                            367
Single Donation Entity               225
Name: count, dtype: int64
2025-12-07 12:22:17 +0000 DEBUG:Group assignment: group
Single Donation Entity             225
Very Small Entity                  218
Small Entity                        91
Small Medium Entity                 57
Medium Entity                        9
Medium Large Entity                  7
Large Entity                         3
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrat                     1
Reform UK                            1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025-12-07 12:22:17 +0000 DEBUG:Clean Data Prep 335: Party_Group: 91651
2025-12-07 12:22:17 +0000 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025-12-07 12:22:17 +0000 INFO:Loading election dates from pdpy.
2025-12-07 12:22:17 +0000 INFO:Election Dates loaded from pdpy.
2025-12-07 12:22:17 +0000 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025-12-07 12:22:17 +0000 INFO:Election Dates Loaded Successfully.
2025-12-07 12:22:17 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:22:17 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:22:17 +0000 INFO:load_election_dates executed successfully
2025-12-07 12:22:17 +0000 DEBUG:Clean Data Prep 353: Election dates: 91651
2025-12-07 12:22:17 +0000 DEBUG:Clean Data Prep 386: End of clean: 91651
2025-12-07 12:22:19 +0000 INFO:Cleaned Data completed, shape: (91651, 55)
2025-12-07 12:22:19 +0000 INFO:load_cleaned_data executed successfully
2025-12-07 12:22:20 +0000 INFO:get_cleaned_data executed successfully
2025-12-07 12:22:20 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:22:20 +0000 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 12:22:20 +0000 INFO:Saved file path: output\cleaned_donorlist.csv
2025-12-07 12:22:20 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 12:22:20 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 12:22:20 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:22:20 +0000 INFO:Current modification time: 1765110139.9349468
2025-12-07 12:22:20 +0000 INFO:Last modification time: 1765110074.2738063
2025-12-07 12:22:20 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:22:20 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:22:20 +0000 INFO:Donor data saved to output\cleaned_donorlist.csv
2025-12-07 12:22:20 +0000 INFO:Donor Data summary completed
2025-12-07 12:22:20 +0000 INFO:Data shape: (31905, 5)
2025-12-07 12:22:20 +0000 INFO:load_donorList_data executed successfully
2025-12-07 12:22:20 +0000 INFO:get_donor_data executed successfully
2025-12-07 12:22:20 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:22:20 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:22:20 +0000 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:Original file path: output\cleaned_data.csv
2025-12-07 12:22:20 +0000 INFO:Saved file path: output\cleaned_regentity.csv
2025-12-07 12:22:20 +0000 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:Checking if output\cleaned_data.csv has been updated.
2025-12-07 12:22:20 +0000 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:Getting modification time for output\cleaned_data.csv
2025-12-07 12:22:20 +0000 INFO:get_file_modification_time executed successfully
2025-12-07 12:22:20 +0000 INFO:Current modification time: 1765110139.9349468
2025-12-07 12:22:20 +0000 INFO:Last modification time: 1765110139.9349468
2025-12-07 12:22:20 +0000 INFO:is_file_updated executed successfully
2025-12-07 12:22:20 +0000 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1765110139.9349468 instead of output\cleaned_data.csv
2025-12-07 12:22:20 +0000 INFO:Importing file from output\cleaned_regentity.csv
2025-12-07 12:22:20 +0000 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025-12-07 12:22:20 +0000 INFO:try_to_use_preprocessed_data executed successfully
2025-12-07 12:22:20 +0000 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025-12-07 12:22:20 +0000 INFO:Raw Data cleanup completed
2025-12-07 12:22:20 +0000 INFO:Data shape: (1719, 6)
2025-12-07 12:22:20 +0000 INFO:load_regulated_entity_data executed successfully
2025-12-07 12:22:20 +0000 INFO:get_regentity_data executed successfully
2025-12-07 12:22:20 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:22:20 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:22:20 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:22:20 +0000 INFO:firstload executed successfully
2025-12-07 12:22:20 +0000 INFO:Data first load completed successfully.
2025-12-07 12:22:20 +0000 INFO:initialise_data executed successfully
2025-12-07 12:22:20 +0000 INFO:Running Menu setup...
2025-12-07 12:22:20 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:20 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:20 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:20 +0000 INFO:App Version: v50.229
2025-12-07 12:22:20 +0000 INFO:Switched to page: Introduction
2025-12-07 12:22:20 +0000 INFO:pagesetup executed successfully
2025-12-07 12:22:20 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:22:20 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:22:26 +0000 INFO:Streamlit App Starting...
2025-12-07 12:22:26 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:22:26 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:22:26 +0000 INFO:Running App setup...
2025-12-07 12:22:26 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:22:26 +0000 INFO:Setting up the package
2025-12-07 12:22:26 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:22:26 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:26 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:26 +0000 INFO:Version: v50.191
2025-12-07 12:22:26 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:22:26 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:22:26 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:security already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:directories already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:22:26 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:22:26 +0000 INFO:Session_state variables initialized
2025-12-07 12:22:26 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:22:26 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:22:26 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:22:26 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:22:26 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:22:26 +0000 DEBUG:components_dir: components
2025-12-07 12:22:26 +0000 DEBUG:logs_dir: logs
2025-12-07 12:22:26 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:22:26 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:22:26 +0000 DEBUG:utils_dir: utils
2025-12-07 12:22:26 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:22:26 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:22:26 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:22:26 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:22:26 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:22:26 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:22:26 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:22:26 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:22:26 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:22:26 +0000 DEBUG:data_dir: data
2025-12-07 12:22:26 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:22:26 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:22:26 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:22:26 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:22:26 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:22:26 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:22:26 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:22:26 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:22:26 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:22:26 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:22:26 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:22:26 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:22:26 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:22:26 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:22:26 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:22:26 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:22:26 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:22:26 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:22:26 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:22:26 +0000 DEBUG:output_dir: output
2025-12-07 12:22:26 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:22:26 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:22:26 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:22:26 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001BAB89639A0>}
2025-12-07 12:22:26 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:22:26 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:22:26 +0000 INFO:Session state Setup complete
2025-12-07 12:22:26 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:22:26 +0000 INFO:Package setup complete
2025-12-07 12:22:26 +0000 INFO:setup_package executed successfully
2025-12-07 12:22:26 +0000 INFO:Setup completed successfully.
2025-12-07 12:22:26 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:22:26 +0000 INFO:Running first load function.
2025-12-07 12:22:26 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:22:26 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:22:26 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:22:26 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:22:26 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:22:26 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:22:26 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:22:26 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:22:26 +0000 INFO:firstload executed successfully
2025-12-07 12:22:26 +0000 INFO:Data first load completed successfully.
2025-12-07 12:22:26 +0000 INFO:initialise_data executed successfully
2025-12-07 12:22:26 +0000 INFO:Running Menu setup...
2025-12-07 12:22:26 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:22:26 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:22:26 +0000 INFO:get_git_version executed successfully
2025-12-07 12:22:26 +0000 INFO:App Version: v50.229
2025-12-07 12:22:26 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 12:22:26 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:22:26 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:22:27 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:22:27 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:22:27 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:22:27 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:22:27 +0000 DEBUG:Page texts: {}
2025-12-07 12:22:27 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:22:27 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:22:27 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:22:27 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:22:27 +0000 INFO:pagesetup executed successfully
2025-12-07 12:22:27 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:22:27 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:23:14 +0000 INFO:Logging is set up correctly! Current log level: DEBUG
2025-12-07 12:23:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:14 +0000 INFO:Streamlit App Starting...
2025-12-07 12:23:14 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:14 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:23:14 +0000 INFO:Running App setup...
2025-12-07 12:23:14 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 INFO:Setting up the package
2025-12-07 12:23:14 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:14 +0000 INFO:Version: v50.191
2025-12-07 12:23:14 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:14 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:security already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:directories already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:23:14 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:23:14 +0000 INFO:Session_state variables initialized
2025-12-07 12:23:14 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:23:14 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:23:14 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:23:14 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:23:14 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:23:14 +0000 DEBUG:components_dir: components
2025-12-07 12:23:14 +0000 DEBUG:logs_dir: logs
2025-12-07 12:23:14 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:23:14 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:23:14 +0000 DEBUG:utils_dir: utils
2025-12-07 12:23:14 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityDonors per Regulated EntityNone_group_entity_select: Donor
2025-12-07 12:23:14 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:23:14 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:23:14 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:23:14 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:23:14 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:23:14 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:23:14 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:23:14 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:23:14 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:23:14 +0000 DEBUG:data_dir: data
2025-12-07 12:23:14 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityDonors per Regulated EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:23:14 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:23:14 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:14 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:23:14 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:23:14 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:23:14 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:23:14 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:23:14 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:23:14 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:23:14 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:23:14 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:23:14 +0000 DEBUG:selected_entity_name: All
2025-12-07 12:23:14 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:23:14 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:23:14 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:23:14 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:23:14 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:23:14 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:23:14 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:23:14 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:23:14 +0000 DEBUG:output_dir: output
2025-12-07 12:23:14 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:23:14 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:23:14 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:23:14 +0000 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001BAB8962E60>}
2025-12-07 12:23:14 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:23:14 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:23:14 +0000 INFO:Session state Setup complete
2025-12-07 12:23:14 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:23:14 +0000 INFO:Package setup complete
2025-12-07 12:23:14 +0000 INFO:setup_package executed successfully
2025-12-07 12:23:14 +0000 INFO:Setup completed successfully.
2025-12-07 12:23:14 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:14 +0000 INFO:Running first load function.
2025-12-07 12:23:14 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:14 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:14 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:14 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:14 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:23:14 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:14 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:14 +0000 INFO:firstload executed successfully
2025-12-07 12:23:14 +0000 INFO:Data first load completed successfully.
2025-12-07 12:23:14 +0000 INFO:initialise_data executed successfully
2025-12-07 12:23:14 +0000 INFO:Running Menu setup...
2025-12-07 12:23:14 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:14 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:15 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:15 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:15 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:15 +0000 INFO:App Version: v50.229
2025-12-07 12:23:15 +0000 INFO:Switched to page: Introduction
2025-12-07 12:23:15 +0000 INFO:pagesetup executed successfully
2025-12-07 12:23:15 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:23:15 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:23:17 +0000 INFO:Streamlit App Starting...
2025-12-07 12:23:17 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:17 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:23:17 +0000 INFO:Running App setup...
2025-12-07 12:23:17 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:23:17 +0000 INFO:Setting up the package
2025-12-07 12:23:17 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:17 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:17 +0000 INFO:Version: v50.191
2025-12-07 12:23:17 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:23:17 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:17 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:security already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:directories already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:23:17 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:23:17 +0000 INFO:Session_state variables initialized
2025-12-07 12:23:17 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:23:17 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:23:17 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:23:17 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:23:17 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:23:17 +0000 DEBUG:components_dir: components
2025-12-07 12:23:17 +0000 DEBUG:logs_dir: logs
2025-12-07 12:23:17 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:23:17 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:23:17 +0000 DEBUG:utils_dir: utils
2025-12-07 12:23:17 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:23:17 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:23:17 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:23:17 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:23:17 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:23:17 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:23:17 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:23:17 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:23:17 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:23:17 +0000 DEBUG:data_dir: data
2025-12-07 12:23:17 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:23:17 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:17 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:23:17 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:23:17 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:23:17 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:23:17 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:23:17 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:23:17 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:23:17 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:23:17 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:23:17 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:23:17 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:23:17 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:23:17 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:23:17 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:23:17 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:23:17 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:23:17 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:23:17 +0000 DEBUG:output_dir: output
2025-12-07 12:23:17 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:23:17 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:23:17 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:23:17 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001BAB8A58040>}
2025-12-07 12:23:17 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:23:17 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:23:17 +0000 INFO:Session state Setup complete
2025-12-07 12:23:17 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:23:17 +0000 INFO:Package setup complete
2025-12-07 12:23:17 +0000 INFO:setup_package executed successfully
2025-12-07 12:23:17 +0000 INFO:Setup completed successfully.
2025-12-07 12:23:17 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:23:17 +0000 INFO:Running first load function.
2025-12-07 12:23:17 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:23:17 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:17 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:17 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:17 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:17 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:23:17 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:17 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:17 +0000 INFO:firstload executed successfully
2025-12-07 12:23:17 +0000 INFO:Data first load completed successfully.
2025-12-07 12:23:17 +0000 INFO:initialise_data executed successfully
2025-12-07 12:23:17 +0000 INFO:Running Menu setup...
2025-12-07 12:23:17 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:23:17 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:17 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:17 +0000 INFO:App Version: v50.229
2025-12-07 12:23:17 +0000 INFO:Switched to page: Regulated Entity per Donor
2025-12-07 12:23:17 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:23:18 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:23:18 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:23:18 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:23:18 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:23:18 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:23:18 +0000 DEBUG:Page texts: {}
2025-12-07 12:23:18 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:23:18 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:23:18 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:23:18 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:23:18 +0000 INFO:pagesetup executed successfully
2025-12-07 12:23:18 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:23:18 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:23:24 +0000 INFO:Streamlit App Starting...
2025-12-07 12:23:24 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:24 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:23:24 +0000 INFO:Running App setup...
2025-12-07 12:23:24 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:23:24 +0000 INFO:Setting up the package
2025-12-07 12:23:24 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:24 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:24 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:24 +0000 INFO:Version: v50.191
2025-12-07 12:23:24 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:23:24 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:24 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:security already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:directories already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:23:24 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:23:24 +0000 INFO:Session_state variables initialized
2025-12-07 12:23:24 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:23:24 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:23:24 +0000 DEBUG:mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor_group_entity_select: Donor Classification
2025-12-07 12:23:24 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:23:24 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:23:24 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:23:24 +0000 DEBUG:components_dir: components
2025-12-07 12:23:24 +0000 DEBUG:logs_dir: logs
2025-12-07 12:23:24 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:23:24 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:23:24 +0000 DEBUG:utils_dir: utils
2025-12-07 12:23:24 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:23:24 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:23:24 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:23:24 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:23:24 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:23:24 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:23:24 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:23:24 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:23:25 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:23:25 +0000 DEBUG:data_dir: data
2025-12-07 12:23:25 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:23:25 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:25 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:23:25 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:23:25 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:23:25 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:23:25 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:23:25 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:23:25 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:23:25 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:23:25 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:23:25 +0000 DEBUG:selected_entity_name: All
2025-12-07 12:23:25 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:23:25 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:23:25 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:23:25 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:23:25 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:23:25 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:23:25 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:23:25 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:23:25 +0000 DEBUG:output_dir: output
2025-12-07 12:23:25 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:23:25 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:23:25 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:23:25 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001BAB8A58040>}
2025-12-07 12:23:25 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:23:25 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:23:25 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:23:25 +0000 INFO:Session state Setup complete
2025-12-07 12:23:25 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:23:25 +0000 INFO:Package setup complete
2025-12-07 12:23:25 +0000 INFO:setup_package executed successfully
2025-12-07 12:23:25 +0000 INFO:Setup completed successfully.
2025-12-07 12:23:25 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 INFO:Running first load function.
2025-12-07 12:23:25 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:25 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:25 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:25 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:25 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:23:25 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:25 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:25 +0000 INFO:firstload executed successfully
2025-12-07 12:23:25 +0000 INFO:Data first load completed successfully.
2025-12-07 12:23:25 +0000 INFO:initialise_data executed successfully
2025-12-07 12:23:25 +0000 INFO:Running Menu setup...
2025-12-07 12:23:25 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:25 +0000 INFO:App Version: v50.229
2025-12-07 12:23:25 +0000 INFO:Switched to page: Regulated Entity per Donor
2025-12-07 12:23:25 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:23:25 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:23:25 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 DEBUG:Page texts: {}
2025-12-07 12:23:25 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:23:25 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:23:25 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:23:25 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:23:25 +0000 INFO:pagesetup executed successfully
2025-12-07 12:23:25 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:23:25 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:23:28 +0000 INFO:Streamlit App Starting...
2025-12-07 12:23:28 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:28 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:23:28 +0000 INFO:Running App setup...
2025-12-07 12:23:28 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:23:28 +0000 INFO:Setting up the package
2025-12-07 12:23:28 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:28 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:28 +0000 INFO:Version: v50.191
2025-12-07 12:23:28 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:23:28 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:28 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:security already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:directories already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:23:28 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:23:28 +0000 INFO:Session_state variables initialized
2025-12-07 12:23:28 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:23:28 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:23:28 +0000 DEBUG:mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor_group_entity_select: Donor Classification
2025-12-07 12:23:28 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:23:28 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:23:28 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:23:28 +0000 DEBUG:components_dir: components
2025-12-07 12:23:28 +0000 DEBUG:logs_dir: logs
2025-12-07 12:23:28 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:23:28 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:23:28 +0000 DEBUG:utils_dir: utils
2025-12-07 12:23:28 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:23:28 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:23:28 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:23:28 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:23:28 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:23:28 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:23:28 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:23:28 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:23:28 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:23:28 +0000 DEBUG:data_dir: data
2025-12-07 12:23:28 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:23:28 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:28 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:23:28 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:23:28 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:23:28 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:23:28 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:23:28 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:23:28 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:23:28 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:23:28 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:23:28 +0000 DEBUG:selected_entity_name: Trade Union
2025-12-07 12:23:28 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:23:28 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:23:28 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:23:28 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:23:28 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:23:28 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:23:28 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:23:28 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:23:28 +0000 DEBUG:output_dir: output
2025-12-07 12:23:28 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:23:28 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:23:28 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:23:28 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001BAB8A58040>}
2025-12-07 12:23:28 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:23:28 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:23:28 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:23:28 +0000 INFO:Session state Setup complete
2025-12-07 12:23:28 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:23:28 +0000 INFO:Package setup complete
2025-12-07 12:23:28 +0000 INFO:setup_package executed successfully
2025-12-07 12:23:28 +0000 INFO:Setup completed successfully.
2025-12-07 12:23:28 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:23:28 +0000 INFO:Running first load function.
2025-12-07 12:23:28 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:23:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:28 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:28 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:28 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:28 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:23:28 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:28 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:28 +0000 INFO:firstload executed successfully
2025-12-07 12:23:28 +0000 INFO:Data first load completed successfully.
2025-12-07 12:23:28 +0000 INFO:initialise_data executed successfully
2025-12-07 12:23:28 +0000 INFO:Running Menu setup...
2025-12-07 12:23:28 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:23:28 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:28 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:28 +0000 INFO:App Version: v50.229
2025-12-07 12:23:28 +0000 INFO:Switched to page: Regulated Entity per Donor
2025-12-07 12:23:29 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:23:29 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:23:29 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:23:29 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:23:29 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:23:29 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:23:29 +0000 DEBUG:Page texts: {}
2025-12-07 12:23:29 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:23:29 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:23:29 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:23:29 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:23:29 +0000 INFO:pagesetup executed successfully
2025-12-07 12:23:29 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:23:29 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:23:36 +0000 INFO:Streamlit App Starting...
2025-12-07 12:23:36 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:36 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:23:36 +0000 INFO:Running App setup...
2025-12-07 12:23:36 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:23:36 +0000 INFO:Setting up the package
2025-12-07 12:23:36 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:36 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:36 +0000 INFO:Version: v50.191
2025-12-07 12:23:36 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:23:36 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:36 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:security already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:directories already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:23:36 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:23:36 +0000 INFO:Session_state variables initialized
2025-12-07 12:23:36 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:23:36 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:23:36 +0000 DEBUG:mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor_group_entity_select: Donor Classification
2025-12-07 12:23:36 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:23:36 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:23:36 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:23:36 +0000 DEBUG:components_dir: components
2025-12-07 12:23:36 +0000 DEBUG:logs_dir: logs
2025-12-07 12:23:36 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:23:36 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:23:36 +0000 DEBUG:utils_dir: utils
2025-12-07 12:23:36 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:23:36 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:23:36 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:23:36 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:23:36 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:23:36 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:23:36 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:23:36 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:23:36 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:23:36 +0000 DEBUG:data_dir: data
2025-12-07 12:23:36 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:23:36 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:36 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:23:36 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:23:36 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:23:36 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:23:36 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:23:36 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:23:36 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:23:36 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:23:36 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:23:36 +0000 DEBUG:selected_entity_name: Trade Union
2025-12-07 12:23:36 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:23:36 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:23:36 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:23:36 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:23:36 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:23:36 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:23:36 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:23:36 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:23:36 +0000 DEBUG:output_dir: output
2025-12-07 12:23:36 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:23:36 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:23:36 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:23:36 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001BAB87DBF40>}
2025-12-07 12:23:36 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:23:36 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:23:36 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:23:36 +0000 INFO:Session state Setup complete
2025-12-07 12:23:36 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:23:36 +0000 INFO:Package setup complete
2025-12-07 12:23:36 +0000 INFO:setup_package executed successfully
2025-12-07 12:23:36 +0000 INFO:Setup completed successfully.
2025-12-07 12:23:36 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:23:36 +0000 INFO:Running first load function.
2025-12-07 12:23:36 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:23:36 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:36 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:36 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:36 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:36 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:23:36 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:36 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:36 +0000 INFO:firstload executed successfully
2025-12-07 12:23:36 +0000 INFO:Data first load completed successfully.
2025-12-07 12:23:36 +0000 INFO:initialise_data executed successfully
2025-12-07 12:23:36 +0000 INFO:Running Menu setup...
2025-12-07 12:23:36 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:23:36 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:36 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:36 +0000 INFO:App Version: v50.229
2025-12-07 12:23:36 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 12:23:36 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:23:36 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:23:37 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:23:37 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:23:37 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:23:37 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:23:37 +0000 DEBUG:Page texts: {}
2025-12-07 12:23:37 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:23:37 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:23:37 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:23:37 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:23:37 +0000 INFO:pagesetup executed successfully
2025-12-07 12:23:37 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:23:37 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:23:41 +0000 INFO:Streamlit App Starting...
2025-12-07 12:23:41 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:41 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:23:41 +0000 INFO:Running App setup...
2025-12-07 12:23:41 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 INFO:Setting up the package
2025-12-07 12:23:41 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:41 +0000 INFO:Version: v50.191
2025-12-07 12:23:41 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:41 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:security already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:directories already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:23:41 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:23:41 +0000 INFO:Session_state variables initialized
2025-12-07 12:23:41 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:23:41 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:23:41 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:23:41 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:23:41 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:23:41 +0000 DEBUG:components_dir: components
2025-12-07 12:23:41 +0000 DEBUG:logs_dir: logs
2025-12-07 12:23:41 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:23:41 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:23:41 +0000 DEBUG:utils_dir: utils
2025-12-07 12:23:41 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityDonors per Regulated EntityNone_group_entity_select: Regulated Entity Group
2025-12-07 12:23:41 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:23:41 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:23:41 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:23:41 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:23:41 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:23:41 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:23:41 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:23:41 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:23:41 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:23:41 +0000 DEBUG:data_dir: data
2025-12-07 12:23:41 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityDonors per Regulated EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:23:41 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:23:41 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:41 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:23:41 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:23:41 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:23:41 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:23:41 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:23:41 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:23:41 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:23:41 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:23:41 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:23:41 +0000 DEBUG:selected_entity_name: All
2025-12-07 12:23:41 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:23:41 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:23:41 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:23:41 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:23:41 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:23:41 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:23:41 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:23:41 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:23:41 +0000 DEBUG:output_dir: output
2025-12-07 12:23:41 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:23:41 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:23:41 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:23:41 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001BAB87DBF40>}
2025-12-07 12:23:41 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:23:41 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:23:41 +0000 INFO:Session state Setup complete
2025-12-07 12:23:41 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:23:41 +0000 INFO:Package setup complete
2025-12-07 12:23:41 +0000 INFO:setup_package executed successfully
2025-12-07 12:23:41 +0000 INFO:Setup completed successfully.
2025-12-07 12:23:41 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 INFO:Running first load function.
2025-12-07 12:23:41 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:41 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:41 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:23:41 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:41 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:41 +0000 INFO:firstload executed successfully
2025-12-07 12:23:41 +0000 INFO:Data first load completed successfully.
2025-12-07 12:23:41 +0000 INFO:initialise_data executed successfully
2025-12-07 12:23:41 +0000 INFO:Running Menu setup...
2025-12-07 12:23:41 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:41 +0000 INFO:App Version: v50.229
2025-12-07 12:23:41 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 12:23:41 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:23:41 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:23:41 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:23:41 +0000 DEBUG:Page texts: {}
2025-12-07 12:23:41 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:23:41 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:23:42 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:23:42 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:23:42 +0000 INFO:pagesetup executed successfully
2025-12-07 12:23:42 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:23:42 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:23:42 +0000 INFO:Streamlit App Starting...
2025-12-07 12:23:42 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:42 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:23:42 +0000 INFO:Running App setup...
2025-12-07 12:23:42 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:23:42 +0000 INFO:Setting up the package
2025-12-07 12:23:42 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:23:42 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:42 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:42 +0000 INFO:Version: v50.191
2025-12-07 12:23:42 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:23:42 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:42 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:23:42 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:security already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:directories already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:23:43 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:23:43 +0000 INFO:Session_state variables initialized
2025-12-07 12:23:43 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:23:43 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:23:43 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:23:43 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:23:43 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 12:23:43 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:23:43 +0000 DEBUG:components_dir: components
2025-12-07 12:23:43 +0000 DEBUG:logs_dir: logs
2025-12-07 12:23:43 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:23:43 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:23:43 +0000 DEBUG:utils_dir: utils
2025-12-07 12:23:43 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityDonors per Regulated EntityNone_group_entity_select: Regulated Entity Group
2025-12-07 12:23:43 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:23:43 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:23:43 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:23:43 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:23:43 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:23:43 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:23:43 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:23:43 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:23:43 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:23:43 +0000 DEBUG:data_dir: data
2025-12-07 12:23:43 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityDonors per Regulated EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:23:43 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:23:43 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:23:43 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:23:43 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:23:43 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:23:43 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:23:43 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:23:43 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:23:43 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:23:43 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:23:43 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:23:43 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:23:43 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:23:43 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:23:43 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:23:43 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:23:43 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:23:43 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:23:43 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:23:43 +0000 DEBUG:output_dir: output
2025-12-07 12:23:43 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:23:43 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:23:43 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:23:43 +0000 DEBUG:menu_selection: {'title': 'Regulated Donor per Entity', 'function': <function mod_regulated_donor_per_entity at 0x000001BAB87DBF40>}
2025-12-07 12:23:43 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:23:43 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:23:43 +0000 INFO:Session state Setup complete
2025-12-07 12:23:43 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:23:43 +0000 INFO:Package setup complete
2025-12-07 12:23:43 +0000 INFO:setup_package executed successfully
2025-12-07 12:23:43 +0000 INFO:Setup completed successfully.
2025-12-07 12:23:43 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 INFO:Running first load function.
2025-12-07 12:23:43 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:43 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:23:43 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:43 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:43 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:23:43 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:23:43 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:23:43 +0000 INFO:firstload executed successfully
2025-12-07 12:23:43 +0000 INFO:Data first load completed successfully.
2025-12-07 12:23:43 +0000 INFO:initialise_data executed successfully
2025-12-07 12:23:43 +0000 INFO:Running Menu setup...
2025-12-07 12:23:43 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 INFO:get_git_version executed successfully
2025-12-07 12:23:43 +0000 INFO:App Version: v50.229
2025-12-07 12:23:43 +0000 INFO:Switched to page: Regulated Donor per Entity
2025-12-07 12:23:43 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:23:43 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:23:43 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 DEBUG:Page texts: {}
2025-12-07 12:23:43 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:23:43 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:23:43 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:23:43 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:23:43 +0000 INFO:pagesetup executed successfully
2025-12-07 12:23:43 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:23:43 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:24:01 +0000 INFO:Streamlit App Starting...
2025-12-07 12:24:01 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:24:01 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:24:01 +0000 INFO:Running App setup...
2025-12-07 12:24:01 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 INFO:Setting up the package
2025-12-07 12:24:01 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:24:01 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 INFO:get_git_version executed successfully
2025-12-07 12:24:01 +0000 INFO:Version: v50.191
2025-12-07 12:24:01 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:24:01 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:security already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:directories already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:24:01 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:24:01 +0000 INFO:Session_state variables initialized
2025-12-07 12:24:01 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:24:01 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:24:01 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:24:01 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:24:01 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 12:24:01 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:24:01 +0000 DEBUG:components_dir: components
2025-12-07 12:24:01 +0000 DEBUG:logs_dir: logs
2025-12-07 12:24:01 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:24:01 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:24:01 +0000 DEBUG:utils_dir: utils
2025-12-07 12:24:01 +0000 DEBUG:mod_regulated_donor_per_entity_None_mod_regulated_donor_per_entityDonors per Regulated EntityNone_group_entity_select: Regulated Entity Group
2025-12-07 12:24:01 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:24:01 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:24:01 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:24:01 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:24:01 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:24:01 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:24:01 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:24:01 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:24:01 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:24:01 +0000 DEBUG:data_dir: data
2025-12-07 12:24:01 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_mod_regulated_donor_per_entityDonors per Regulated EntityNone: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:24:01 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:24:01 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:24:01 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:24:01 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:24:01 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:24:01 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:24:01 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:24:01 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:24:01 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:24:01 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:24:01 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:24:01 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:24:01 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:24:01 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:24:01 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:24:01 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:24:01 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:24:01 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:24:01 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:24:01 +0000 DEBUG:output_dir: output
2025-12-07 12:24:01 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:24:01 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:24:01 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:24:01 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001BAB8A58040>}
2025-12-07 12:24:01 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:24:01 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:24:01 +0000 INFO:Session state Setup complete
2025-12-07 12:24:01 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:24:01 +0000 INFO:Package setup complete
2025-12-07 12:24:01 +0000 INFO:setup_package executed successfully
2025-12-07 12:24:01 +0000 INFO:Setup completed successfully.
2025-12-07 12:24:01 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 INFO:Running first load function.
2025-12-07 12:24:01 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:24:01 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:24:01 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:24:01 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:24:01 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:24:01 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:24:01 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:24:01 +0000 INFO:firstload executed successfully
2025-12-07 12:24:01 +0000 INFO:Data first load completed successfully.
2025-12-07 12:24:01 +0000 INFO:initialise_data executed successfully
2025-12-07 12:24:01 +0000 INFO:Running Menu setup...
2025-12-07 12:24:01 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 INFO:get_git_version executed successfully
2025-12-07 12:24:01 +0000 INFO:App Version: v50.229
2025-12-07 12:24:01 +0000 INFO:Switched to page: Regulated Entity per Donor
2025-12-07 12:24:01 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:24:01 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:24:01 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:24:01 +0000 DEBUG:Page texts: {}
2025-12-07 12:24:01 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:24:01 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:24:02 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:24:02 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:24:02 +0000 INFO:pagesetup executed successfully
2025-12-07 12:24:02 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:24:02 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:24:06 +0000 INFO:Streamlit App Starting...
2025-12-07 12:24:06 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:24:06 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:24:06 +0000 INFO:Running App setup...
2025-12-07 12:24:06 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 INFO:Setting up the package
2025-12-07 12:24:06 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:24:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 INFO:get_git_version executed successfully
2025-12-07 12:24:06 +0000 INFO:Version: v50.191
2025-12-07 12:24:06 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:24:06 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:security already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:directories already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:24:06 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:24:06 +0000 INFO:Session_state variables initialized
2025-12-07 12:24:06 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:24:06 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:24:06 +0000 DEBUG:mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor_group_entity_select: Regulated Entity Group
2025-12-07 12:24:06 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:24:06 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:24:06 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:24:06 +0000 DEBUG:components_dir: components
2025-12-07 12:24:06 +0000 DEBUG:logs_dir: logs
2025-12-07 12:24:06 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:24:06 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:24:06 +0000 DEBUG:utils_dir: utils
2025-12-07 12:24:06 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:24:06 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:24:06 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:24:06 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:24:06 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:24:06 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:24:06 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:24:06 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:24:06 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:24:06 +0000 DEBUG:data_dir: data
2025-12-07 12:24:06 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:24:06 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:24:06 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:24:06 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:24:06 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:24:06 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:24:06 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:24:06 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:24:06 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:24:06 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:24:06 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:24:06 +0000 DEBUG:selected_entity_name: All
2025-12-07 12:24:06 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:24:06 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:24:06 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:24:06 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:24:06 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:24:06 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:24:06 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:24:06 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:24:06 +0000 DEBUG:output_dir: output
2025-12-07 12:24:06 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:24:06 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:24:06 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:24:06 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001BAB8A58040>}
2025-12-07 12:24:06 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:24:06 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:24:06 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:24:06 +0000 INFO:Session state Setup complete
2025-12-07 12:24:06 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:24:06 +0000 INFO:Package setup complete
2025-12-07 12:24:06 +0000 INFO:setup_package executed successfully
2025-12-07 12:24:06 +0000 INFO:Setup completed successfully.
2025-12-07 12:24:06 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 INFO:Running first load function.
2025-12-07 12:24:06 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:24:06 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:24:06 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:24:06 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:24:06 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:24:06 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:24:06 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:24:06 +0000 INFO:firstload executed successfully
2025-12-07 12:24:06 +0000 INFO:Data first load completed successfully.
2025-12-07 12:24:06 +0000 INFO:initialise_data executed successfully
2025-12-07 12:24:06 +0000 INFO:Running Menu setup...
2025-12-07 12:24:06 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 INFO:get_git_version executed successfully
2025-12-07 12:24:06 +0000 INFO:App Version: v50.229
2025-12-07 12:24:06 +0000 INFO:Switched to page: Regulated Entity per Donor
2025-12-07 12:24:06 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:24:06 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:24:06 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:24:06 +0000 DEBUG:Page texts: {}
2025-12-07 12:24:06 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:24:06 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:24:07 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:24:07 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:24:07 +0000 INFO:pagesetup executed successfully
2025-12-07 12:24:07 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:24:07 +0000 INFO:App is fully loaded and ready!
2025-12-07 12:24:08 +0000 INFO:Streamlit App Starting...
2025-12-07 12:24:08 +0000 INFO:Current Working Directory: H:\GitHub\dashboard_demo
2025-12-07 12:24:08 +0000 INFO:running H:\GitHub\dashboard_demo, H:\GitHub\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025-12-07 12:24:08 +0000 INFO:Running App setup...
2025-12-07 12:24:08 +0000 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025-12-07 12:24:08 +0000 INFO:Setting up the package
2025-12-07 12:24:08 +0000 INFO:Module directory: H:\GitHub\dashboard_demo
2025-12-07 12:24:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:24:08 +0000 INFO:get_git_version executed successfully
2025-12-07 12:24:08 +0000 INFO:Version: v50.191
2025-12-07 12:24:08 +0000 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025-12-07 12:24:08 +0000 INFO:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:24:08 +0000 DEBUG:BASE_DIR already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:filenames already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:PLACEHOLDER_DATE already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:PLACEHOLDER_ID already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:thresholds already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:data_remappings already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:filter_def already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:security already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:perc_target already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:directories already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:reference_dir already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:data_dir already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:output_dir already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:logs_dir already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:components_dir already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:app_pages_dir already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:utils_dir already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:mppartymemb_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:donor_map_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:politician_party_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:regentity_map_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:original_data_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:CREDENTIALS_FILE already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:TEXT_FILE already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:ELECTION_DATES already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:cleaned_data_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:cleaned_donations_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:cleaned_donorlist_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:cleaned_regentity_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:party_summary_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:imported_raw_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:source_data_fname already exists in session state
2025-12-07 12:24:08 +0000 DEBUG:Cash_ftr already exists in session state
2025-12-07 12:24:08 +0000 INFO:Session_state variables initialized
2025-12-07 12:24:08 +0000 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025-12-07 12:24:08 +0000 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025-12-07 12:24:08 +0000 DEBUG:mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor_group_entity_select: Regulated Entity Group
2025-12-07 12:24:08 +0000 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorStatus': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonorTypes_ftr': {'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorName': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor'], 'DonorId': [1000001], 'DonationType': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor', 'Anonymous Donor']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonationType': ['Aggregated Donation'], 'IsAggregation': [True], 'ReceivedDate': ['PLACEHOLDER_DATE', None], 'RegulatedEntityId': [1000001], 'RegulatedEntityName': ['Unidentified Entity', 'Unidentifiable Entity', 'Unknown Entity'], 'DonationAction': ['Returned', 'Forfeited']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025-12-07 12:24:08 +0000 DEBUG:imported_raw_fname: output\imported_raw.csv
2025-12-07 12:24:08 +0000 DEBUG:selected_entity_name: Conservative And Unionist Party
2025-12-07 12:24:08 +0000 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025-12-07 12:24:08 +0000 DEBUG:components_dir: components
2025-12-07 12:24:08 +0000 DEBUG:logs_dir: logs
2025-12-07 12:24:08 +0000 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025-12-07 12:24:08 +0000 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025-12-07 12:24:08 +0000 DEBUG:utils_dir: utils
2025-12-07 12:24:08 +0000 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025-12-07 12:24:08 +0000 DEBUG:app_pages_dir: app_pages
2025-12-07 12:24:08 +0000 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025-12-07 12:24:08 +0000 DEBUG:load_donorlist_data_last_modified: 1765110139.9349468
2025-12-07 12:24:08 +0000 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025-12-07 12:24:08 +0000 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: True
2025-12-07 12:24:08 +0000 DEBUG:PLACEHOLDER_ID: 1000001
2025-12-07 12:24:08 +0000 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025-12-07 12:24:08 +0000 DEBUG:data_clean:           ECRef RegulatedEntityType      Value IsSponsorship  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      C0000001         Third Party   50000.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
1      C0000002         Third Party  112531.96         FALSE  ...                  1.0                 289.0                 1.0                 73.0
2      C0000003     Regulated Donee   15000.00         FALSE  ...                  2.0                 288.0                 1.0                 72.0
3      C0000004     Regulated Donee   25000.00         FALSE  ...                  2.0                 289.0                 1.0                 72.0
4      C0000005     Regulated Donee    4200.00         FALSE  ...                  1.0                 289.0                 1.0                 72.0
...         ...                 ...        ...           ...  ...                  ...                   ...                 ...                  ...
91646  V0833992     Regulated Donee    5807.00         FALSE  ...                -23.0                 387.0                -5.0                 97.0
91647  V0834001     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91648  V0834029     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91649  V0834030     Regulated Donee    3560.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0
91650  V0834031     Regulated Donee    3810.00         FALSE  ...                -23.0                 388.0                -5.0                 97.0

[91651 rows x 55 columns]
2025-12-07 12:24:08 +0000 DEBUG:data_dir: data
2025-12-07 12:24:08 +0000 DEBUG:Cash_ftr: None
2025-12-07 12:24:08 +0000 DEBUG:BASE_DIR: H:\GitHub\dashboard_demo
2025-12-07 12:24:08 +0000 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025-12-07 12:24:08 +0000 DEBUG:raw_data:           ECRef    OriginalRegulatedEntityName RegulatedEntityType  ...  CleanedDonorId   DonorId                              DonorName
0      C0000001                     Charter 88         Third Party  ...             1.0       1.0       Joseph Rowntree Refrom Trust Ltd
1      C0000002                     Charter 88         Third Party  ...             2.0       2.0       Birkenhead North End Labour Club
2      C0000003  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             3.0       3.0                   Bord Institute Trust
3      C0000004  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             4.0       4.0           Branksome Liberal Club Trust
4      C0000005  The Rt Hon Charles Kennedy Mp     Regulated Donee  ...             5.0       5.0                       Bridgwater Trust
...         ...                            ...                 ...  ...             ...       ...                                    ...
91646  V0833992                    John Cooper     Regulated Donee  ...             NaN  103968.0  Taiwanese Ministry Of Foreign Affairs
91647  V0834001                     Paul Givan     Regulated Donee  ...             NaN  103972.0               Embassy Of Israel London
91648  V0834029               Mr Darren Millar     Regulated Donee  ...             NaN  103977.0               Embassy Of Israel London
91649  V0834030                 Russell George     Regulated Donee  ...             NaN  103978.0               Embassy Of Israel London
91650  V0834031                   David Brooks     Regulated Donee  ...             NaN  103979.0               Embassy Of Israel London

[91651 rows x 37 columns]
2025-12-07 12:24:08 +0000 DEBUG:load_raw_data_last_modified: 1765110134.100864
2025-12-07 12:24:08 +0000 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025-12-07 12:24:08 +0000 DEBUG:reference_dir: reference_files
2025-12-07 12:24:08 +0000 DEBUG:original_data_fname: reference_files\original_data.csv
2025-12-07 12:24:08 +0000 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025-12-07 12:24:08 +0000 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025-12-07 12:24:08 +0000 DEBUG:data_donor:          DonorId                        Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0  Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0  Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0              Bord Institute Trust         36893.54                4    9223.385000
3            4.0      Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                  Bridgwater Trust          7700.00                3    2566.666667
...          ...                               ...              ...              ...            ...
31900   103972.0          Embassy Of Israel London          3810.00                1    3810.000000
31901   103977.0          Embassy Of Israel London          3560.00                1    3560.000000
31902   103978.0          Embassy Of Israel London          3560.00                1    3560.000000
31903   103979.0          Embassy Of Israel London          3810.00                1    3810.000000
31904  1000001.0                Unidentified Donor       2377856.90              140   16984.692143

[31905 rows x 5 columns]
2025-12-07 12:24:08 +0000 DEBUG:party_summary_fname: output\party_summary.csv
2025-12-07 12:24:08 +0000 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025-12-07 12:24:08 +0000 DEBUG:data_regentity:       RegulatedEntityId                        Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                            English Democrats            Small Entity        118532.00               12    9877.666667
1                  19.0                   Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0  Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                    Sinn Fein            Small Entity        222772.98               13   17136.383077
4                  39.0                                   Sinn FIn     Medium Large Entity       5936716.49              358   16583.006955
...                 ...                                          ...                     ...              ...              ...            ...
1714            18270.0                                 Richard Tice  Single Donation Entity          6250.00                1    6250.000000
1715            18271.0                                 John Slinger  Single Donation Entity          9456.85                1    9456.850000
1716            18273.0                            Sir Jeremy Wright  Single Donation Entity          3246.72                1    3246.720000
1717            18274.0                                   Paul Givan  Single Donation Entity          3810.00                1    3810.000000
1718            18276.0                                 David Brooks  Single Donation Entity          3810.00                1    3810.000000

[1719 rows x 6 columns]
2025-12-07 12:24:08 +0000 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/GitHub/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025-12-07 12:24:08 +0000 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'Reform UK': 7931, 'UKIP': 84, 'Unknown': 0}}
2025-12-07 12:24:08 +0000 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025-12-07 12:24:08 +0000 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025-12-07 12:24:08 +0000 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025-12-07 12:24:08 +0000 DEBUG:output_dir: output
2025-12-07 12:24:08 +0000 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025-12-07 12:24:08 +0000 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025-12-07 12:24:08 +0000 DEBUG:perc_target: 0.5
2025-12-07 12:24:08 +0000 DEBUG:menu_selection: {'title': 'Regulated Entity per Donor', 'function': <function mod_regulated_entity_per_donor at 0x000001BAB8A58040>}
2025-12-07 12:24:08 +0000 DEBUG:date_range_mod_regulated_donor_per_entity_RegEntity_by_Donor_mod_regulated_donor_per_entityRegulated Entity by EntityRegEntity_by_Donor: (datetime.datetime(2001, 1, 1, 0, 0), datetime.datetime(2025, 11, 13, 0, 0))
2025-12-07 12:24:08 +0000 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025-12-07 12:24:08 +0000 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025-12-07 12:24:08 +0000 INFO:Session state Setup complete
2025-12-07 12:24:08 +0000 INFO:initialize_session_state executed successfully
2025-12-07 12:24:08 +0000 INFO:Package setup complete
2025-12-07 12:24:08 +0000 INFO:setup_package executed successfully
2025-12-07 12:24:08 +0000 INFO:Setup completed successfully.
2025-12-07 12:24:08 +0000 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025-12-07 12:24:08 +0000 INFO:Running first load function.
2025-12-07 12:24:08 +0000 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025-12-07 12:24:08 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:24:08 +0000 DEBUG:st.session_state.raw_data: 91651
2025-12-07 12:24:08 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:24:08 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:24:08 +0000 DEBUG:st.session_state.data_regentity: 1719
2025-12-07 12:24:08 +0000 DEBUG:st.session_state.data_donor: 31905
2025-12-07 12:24:08 +0000 DEBUG:st.session_state.data_clean: 91651
2025-12-07 12:24:08 +0000 INFO:firstload executed successfully
2025-12-07 12:24:08 +0000 INFO:Data first load completed successfully.
2025-12-07 12:24:08 +0000 INFO:initialise_data executed successfully
2025-12-07 12:24:08 +0000 INFO:Running Menu setup...
2025-12-07 12:24:08 +0000 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025-12-07 12:24:08 +0000 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025-12-07 12:24:08 +0000 INFO:get_git_version executed successfully
2025-12-07 12:24:08 +0000 INFO:App Version: v50.229
2025-12-07 12:24:08 +0000 INFO:Switched to page: Regulated Entity per Donor
2025-12-07 12:24:08 +0000 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025-12-07 12:24:08 +0000 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025-12-07 12:24:09 +0000 INFO:display_summary_statistics executed successfully
2025-12-07 12:24:09 +0000 DEBUG:Calling display_textual_insights_predefined with args={args}, kwargs={kwargs}
2025-12-07 12:24:09 +0000 INFO:display_textual_insights_predefined executed successfully
2025-12-07 12:24:09 +0000 DEBUG:Calling display_textual_insights_custom with args={args}, kwargs={kwargs}
2025-12-07 12:24:09 +0000 DEBUG:Page texts: {}
2025-12-07 12:24:09 +0000 INFO:display_textual_insights_custom executed successfully
2025-12-07 12:24:09 +0000 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025-12-07 12:24:09 +0000 INFO:display_visualizations executed successfully
2025-12-07 12:24:09 +0000 INFO:display_per_group_data_page executed successfully
2025-12-07 12:24:09 +0000 INFO:pagesetup executed successfully
2025-12-07 12:24:09 +0000 INFO:Menu setup completed successfully.
2025-12-07 12:24:09 +0000 INFO:App is fully loaded and ready!
