2025/03/01 11:00:46 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:00:46 AM INFO:Setting up the package
2025/03/01 11:00:46 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:00:46 AM INFO:get_git_version executed successfully
2025/03/01 11:00:46 AM INFO:Version: v20.115
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:init_state_var executed successfully
2025/03/01 11:00:46 AM INFO:Session_state variables initialized
2025/03/01 11:00:46 AM INFO:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000018CE1BC6A70>}
2025/03/01 11:00:46 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:00:46 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:00:46 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:00:46 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:00:46 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:00:46 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:00:46 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:00:46 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:00:46 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:00:46 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:00:46 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:00:46 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:00:46 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:00:46 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:00:46 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:00:46 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:00:46 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:00:46 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:00:46 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:00:46 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:00:46 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:00:46 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:00:46 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:00:46 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:00:46 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:00:46 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:00:46 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:00:46 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:00:46 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:00:46 AM INFO:perc_target: 0.5
2025/03/01 11:00:46 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:00:46 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:00:46 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:00:46 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:00:46 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:00:46 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:00:46 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:00:46 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:00:46 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:00:46 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:00:46 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:00:46 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:00:46 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:00:46 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:00:46 AM INFO:Session state Setup complete
2025/03/01 11:00:46 AM INFO:initialize_session_state executed successfully
2025/03/01 11:00:46 AM INFO:Package setup complete
2025/03/01 11:00:46 AM INFO:get_git_version executed successfully
2025/03/01 11:00:46 AM INFO:App Version: v20.130
2025/03/01 11:00:46 AM INFO:Switched to page: Head Line Figures
2025/03/01 11:00:47 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:00:47 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:00:47 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:00:48 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:00:48 AM INFO:plot_pie_chart executed successfully
2025/03/01 11:00:48 AM INFO:plot_pie_chart executed successfully
2025/03/01 11:00:48 AM INFO:pagesetup executed successfully
2025/03/01 11:00:48 AM INFO:Data already loaded in session state.
2025/03/01 11:00:51 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:00:51 AM INFO:Setting up the package
2025/03/01 11:00:51 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:00:51 AM INFO:get_git_version executed successfully
2025/03/01 11:00:51 AM INFO:Version: v20.115
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:init_state_var executed successfully
2025/03/01 11:00:51 AM INFO:Session_state variables initialized
2025/03/01 11:00:51 AM INFO:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x0000018CE1FF9750>}
2025/03/01 11:00:51 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:00:51 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:00:51 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:00:51 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:00:51 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:00:51 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:00:51 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:00:51 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:00:51 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:00:51 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:00:51 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:00:51 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:00:51 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:00:51 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:00:51 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:00:51 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:00:51 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:00:51 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:00:51 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:00:51 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:00:51 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:00:51 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:00:51 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:00:51 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:00:51 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:00:51 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:00:51 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:00:51 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:00:51 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:00:51 AM INFO:perc_target: 0.5
2025/03/01 11:00:51 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:00:51 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:00:51 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:00:51 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:00:51 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:00:51 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:00:51 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:00:51 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:00:51 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:00:51 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:00:51 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:00:51 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:00:51 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:00:51 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:00:51 AM INFO:Session state Setup complete
2025/03/01 11:00:51 AM INFO:initialize_session_state executed successfully
2025/03/01 11:00:51 AM INFO:Package setup complete
2025/03/01 11:00:51 AM INFO:get_git_version executed successfully
2025/03/01 11:00:51 AM INFO:App Version: v20.130
2025/03/01 11:00:51 AM INFO:Switched to page: Bequeths
2025/03/01 11:00:55 AM ERROR:Missing column: 'PartyName' in loaddata_df. Available columns: Index(['ECRef', 'OriginalRegulatedEntityName', 'RegulatedEntityType', 'Value',
       'AcceptedDate', 'AccountingUnitName', 'OriginalDonorName',
       'AccountingUnitsAsCentralParty', 'IsSponsorship', 'DonorStatus',
       'RegulatedDoneeType', 'CompanyRegistrationNumber', 'Postcode',
       'DonationType', 'NatureOfDonation', 'PurposeOfVisit', 'DonationAction',
       'ReceivedDate', 'ReportedDate', 'IsReportedPrePoll',
       'ReportingPeriodName', 'IsBequest', 'IsAggregation',
       'OriginalRegulatedEntityId', 'AccountingUnitId', 'OriginalDonorId',
       'CampaigningName', 'RegisterName', 'IsIrishSource',
       'CleanedRegulatedEntityId', 'CleanedRegulatedEntityName',
       'OriginalRegulatedEntityName', 'RegulatedEntityId',
       'RegulatedEntityName', 'CleanedDonorId', 'ParentDonorName',
       'CleanedDonorName', 'DonorStatus2', 'DonorId', 'DonorName',
       'EventCount', 'YearReceived', 'MonthReceived', 'YearMonthReceived'],
      dtype='object')
2025/03/01 11:00:55 AM INFO:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/01 11:00:55 AM INFO:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/01 11:00:55 AM INFO:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/01 11:00:55 AM INFO:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/01 11:00:55 AM INFO:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/01 11:00:55 AM INFO:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/01 11:00:55 AM INFO:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/01 11:00:55 AM INFO:Data Updated with PartyName and PartyId successfully
2025/03/01 11:00:55 AM INFO:map_mp_to_party executed successfully
2025/03/01 11:01:20 AM INFO:Cleaned Data completed, shape: (79737, 58)
2025/03/01 11:01:20 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:01:20 AM INFO:load_and_filter_data executed successfully
2025/03/01 11:01:20 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:01:20 AM INFO:display_textual_insights executed successfully
2025/03/01 11:01:21 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:21 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:21 AM INFO:display_visualizations executed successfully
2025/03/01 11:01:21 AM INFO:display_data_page executed successfully
2025/03/01 11:01:21 AM INFO:pagesetup executed successfully
2025/03/01 11:01:21 AM INFO:Data already loaded in session state.
2025/03/01 11:01:33 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:01:33 AM INFO:Setting up the package
2025/03/01 11:01:33 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:01:33 AM INFO:get_git_version executed successfully
2025/03/01 11:01:33 AM INFO:Version: v20.115
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:init_state_var executed successfully
2025/03/01 11:01:33 AM INFO:Session_state variables initialized
2025/03/01 11:01:33 AM INFO:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations_page at 0x0000018CE1FF97E0>}
2025/03/01 11:01:33 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:01:33 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:01:33 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:01:33 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:01:33 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:01:33 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:01:33 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:01:33 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:01:33 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:01:33 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:01:33 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:01:33 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:01:33 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:01:33 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:01:33 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:01:33 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:01:33 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:01:33 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:01:33 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:01:33 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:01:33 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:01:33 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:01:33 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:01:33 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:01:33 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:01:33 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:01:33 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:01:34 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:01:34 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:01:34 AM INFO:perc_target: 0.5
2025/03/01 11:01:34 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:01:34 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:01:34 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:01:34 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:01:34 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:01:34 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:01:34 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:01:34 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:01:34 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:01:34 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:01:34 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:01:34 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:01:34 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:01:34 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:01:34 AM INFO:Session state Setup complete
2025/03/01 11:01:34 AM INFO:initialize_session_state executed successfully
2025/03/01 11:01:34 AM INFO:Package setup complete
2025/03/01 11:01:34 AM INFO:get_git_version executed successfully
2025/03/01 11:01:34 AM INFO:App Version: v20.130
2025/03/01 11:01:34 AM INFO:Switched to page: Corporate Donations
2025/03/01 11:01:34 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:01:34 AM INFO:load_and_filter_data executed successfully
2025/03/01 11:01:34 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:01:34 AM INFO:display_textual_insights executed successfully
2025/03/01 11:01:34 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:34 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:34 AM INFO:display_visualizations executed successfully
2025/03/01 11:01:34 AM INFO:display_data_page executed successfully
2025/03/01 11:01:34 AM INFO:pagesetup executed successfully
2025/03/01 11:01:34 AM INFO:Data already loaded in session state.
2025/03/01 11:01:39 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:01:39 AM INFO:Setting up the package
2025/03/01 11:01:39 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:01:39 AM INFO:get_git_version executed successfully
2025/03/01 11:01:39 AM INFO:Version: v20.115
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:init_state_var executed successfully
2025/03/01 11:01:39 AM INFO:Session_state variables initialized
2025/03/01 11:01:39 AM INFO:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorship_page at 0x0000018CE1FF95A0>}
2025/03/01 11:01:39 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:01:39 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:01:39 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:01:39 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:01:39 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:01:39 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:01:39 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:01:39 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:01:39 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:01:39 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:01:39 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:01:39 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:01:39 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:01:39 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:01:39 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:01:39 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:01:39 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:01:39 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:01:39 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:01:39 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:01:39 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:01:39 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:01:39 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:01:39 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:01:39 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:01:39 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:01:39 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:01:39 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:01:39 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:01:39 AM INFO:perc_target: 0.5
2025/03/01 11:01:39 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:01:39 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:01:39 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:01:39 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:01:39 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:01:39 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:01:39 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:01:39 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:01:39 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:01:39 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:01:39 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:01:39 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:01:39 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:01:39 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:01:39 AM INFO:Session state Setup complete
2025/03/01 11:01:39 AM INFO:initialize_session_state executed successfully
2025/03/01 11:01:39 AM INFO:Package setup complete
2025/03/01 11:01:39 AM INFO:get_git_version executed successfully
2025/03/01 11:01:39 AM INFO:App Version: v20.130
2025/03/01 11:01:39 AM INFO:Switched to page: Sponsorships
2025/03/01 11:01:39 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:01:39 AM INFO:load_and_filter_data executed successfully
2025/03/01 11:01:39 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:01:39 AM INFO:display_textual_insights executed successfully
2025/03/01 11:01:39 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:39 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:39 AM INFO:display_visualizations executed successfully
2025/03/01 11:01:39 AM INFO:display_data_page executed successfully
2025/03/01 11:01:39 AM INFO:pagesetup executed successfully
2025/03/01 11:01:39 AM INFO:Data already loaded in session state.
2025/03/01 11:01:42 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:01:42 AM INFO:Setting up the package
2025/03/01 11:01:42 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:01:42 AM INFO:get_git_version executed successfully
2025/03/01 11:01:42 AM INFO:Version: v20.115
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:init_state_var executed successfully
2025/03/01 11:01:42 AM INFO:Session_state variables initialized
2025/03/01 11:01:42 AM INFO:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits_page at 0x0000018CE1FC39A0>}
2025/03/01 11:01:42 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:01:42 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:01:42 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:01:42 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:01:42 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:01:42 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:01:42 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:01:42 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:01:42 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:01:42 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:01:42 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:01:42 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:01:42 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:01:42 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:01:42 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:01:42 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:01:42 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:01:42 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:01:42 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:01:42 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:01:42 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:01:42 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:01:42 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:01:42 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:01:42 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:01:42 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:01:42 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:01:42 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:01:42 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:01:42 AM INFO:perc_target: 0.5
2025/03/01 11:01:42 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:01:42 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:01:42 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:01:42 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:01:42 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:01:42 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:01:42 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:01:42 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:01:42 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:01:42 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:01:42 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:01:42 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:01:42 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:01:42 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:01:42 AM INFO:Session state Setup complete
2025/03/01 11:01:42 AM INFO:initialize_session_state executed successfully
2025/03/01 11:01:42 AM INFO:Package setup complete
2025/03/01 11:01:42 AM INFO:get_git_version executed successfully
2025/03/01 11:01:42 AM INFO:App Version: v20.130
2025/03/01 11:01:42 AM INFO:Switched to page: Paid Visits
2025/03/01 11:01:42 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:01:43 AM INFO:load_and_filter_data executed successfully
2025/03/01 11:01:43 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:01:43 AM INFO:display_textual_insights executed successfully
2025/03/01 11:01:43 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:43 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:43 AM INFO:display_visualizations executed successfully
2025/03/01 11:01:43 AM INFO:display_data_page executed successfully
2025/03/01 11:01:43 AM INFO:pagesetup executed successfully
2025/03/01 11:01:43 AM INFO:Data already loaded in session state.
2025/03/01 11:01:57 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:01:57 AM INFO:Setting up the package
2025/03/01 11:01:57 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:01:57 AM INFO:get_git_version executed successfully
2025/03/01 11:01:57 AM INFO:Version: v20.115
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:init_state_var executed successfully
2025/03/01 11:01:57 AM INFO:Session_state variables initialized
2025/03/01 11:01:57 AM INFO:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors_page at 0x0000018CE1FF9E10>}
2025/03/01 11:01:57 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:01:57 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:01:57 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:01:57 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:01:57 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:01:57 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:01:57 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:01:57 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:01:57 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:01:57 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:01:57 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:01:57 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:01:57 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:01:57 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:01:57 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:01:57 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:01:57 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:01:57 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:01:57 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:01:57 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:01:57 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:01:57 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:01:57 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:01:57 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:01:57 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:01:57 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:01:57 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:01:57 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:01:57 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:01:57 AM INFO:perc_target: 0.5
2025/03/01 11:01:57 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:01:57 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:01:57 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:01:57 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:01:57 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:01:57 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:01:57 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:01:57 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:01:57 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:01:57 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:01:57 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:01:57 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:01:57 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:01:57 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:01:57 AM INFO:Session state Setup complete
2025/03/01 11:01:57 AM INFO:initialize_session_state executed successfully
2025/03/01 11:01:57 AM INFO:Package setup complete
2025/03/01 11:01:57 AM INFO:get_git_version executed successfully
2025/03/01 11:01:57 AM INFO:App Version: v20.130
2025/03/01 11:01:57 AM INFO:Switched to page: Dubious Donors
2025/03/01 11:01:57 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:01:57 AM INFO:load_and_filter_data executed successfully
2025/03/01 11:01:57 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:01:57 AM INFO:display_textual_insights executed successfully
2025/03/01 11:01:57 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:58 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:01:58 AM INFO:display_visualizations executed successfully
2025/03/01 11:01:58 AM INFO:display_data_page executed successfully
2025/03/01 11:01:58 AM INFO:pagesetup executed successfully
2025/03/01 11:01:58 AM INFO:Data already loaded in session state.
2025/03/01 11:02:01 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:02:01 AM INFO:Setting up the package
2025/03/01 11:02:01 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:02:01 AM INFO:get_git_version executed successfully
2025/03/01 11:02:01 AM INFO:Version: v20.115
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:init_state_var executed successfully
2025/03/01 11:02:01 AM INFO:Session_state variables initialized
2025/03/01 11:02:01 AM INFO:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations_page at 0x0000018CE1FF9990>}
2025/03/01 11:02:01 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:02:01 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:02:01 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:02:01 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:02:01 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:02:01 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:02:01 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:02:01 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:02:01 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:02:01 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:02:01 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:02:01 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:02:01 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:02:01 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:02:01 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:02:01 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:02:01 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:02:01 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:02:01 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:02:01 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:02:01 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:02:01 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:02:01 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:02:01 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:02:01 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:02:01 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:02:01 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:02:01 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:02:01 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:02:01 AM INFO:perc_target: 0.5
2025/03/01 11:02:01 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:02:01 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:02:01 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:02:01 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:02:01 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:02:01 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:02:01 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:02:01 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:02:01 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:02:01 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:02:01 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:02:01 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:02:01 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:02:01 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:02:01 AM INFO:Session state Setup complete
2025/03/01 11:02:01 AM INFO:initialize_session_state executed successfully
2025/03/01 11:02:01 AM INFO:Package setup complete
2025/03/01 11:02:01 AM INFO:get_git_version executed successfully
2025/03/01 11:02:01 AM INFO:App Version: v20.130
2025/03/01 11:02:01 AM INFO:Switched to page: Dubious Donations
2025/03/01 11:02:01 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:02:01 AM INFO:load_and_filter_data executed successfully
2025/03/01 11:02:01 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:02:01 AM INFO:display_textual_insights executed successfully
2025/03/01 11:02:02 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:02:02 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:02:02 AM INFO:display_visualizations executed successfully
2025/03/01 11:02:02 AM INFO:display_data_page executed successfully
2025/03/01 11:02:02 AM INFO:pagesetup executed successfully
2025/03/01 11:02:02 AM INFO:Data already loaded in session state.
2025/03/01 11:07:18 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:18 AM INFO:Setting up the package
2025/03/01 11:07:18 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:18 AM INFO:get_git_version executed successfully
2025/03/01 11:07:18 AM INFO:Version: v20.115
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:init_state_var executed successfully
2025/03/01 11:07:18 AM INFO:Session_state variables initialized
2025/03/01 11:07:18 AM INFO:menu_selection: {'title': 'Corporate Donations per Entity', 'function': <function mod_corporate_donations_per_entity_page at 0x0000018CE1FF9B40>}
2025/03/01 11:07:18 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:18 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:18 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:18 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:18 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:18 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:18 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:18 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:18 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:18 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:18 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:18 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:18 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:18 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:18 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:18 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:18 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:18 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:18 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:18 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:18 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:18 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:18 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:18 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:18 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:18 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:18 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:18 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:18 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:18 AM INFO:perc_target: 0.5
2025/03/01 11:07:18 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:18 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:18 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:18 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:18 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:18 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:18 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:18 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:18 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:18 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:18 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:18 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:18 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:18 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:18 AM INFO:Session state Setup complete
2025/03/01 11:07:18 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:18 AM INFO:Package setup complete
2025/03/01 11:07:18 AM INFO:get_git_version executed successfully
2025/03/01 11:07:18 AM INFO:App Version: v20.130
2025/03/01 11:07:18 AM INFO:Switched to page: Corporate Donations per Entity
2025/03/01 11:07:18 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:18 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:07:18 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:07:18 AM INFO:display_textual_insights executed successfully
2025/03/01 11:07:18 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:19 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:19 AM INFO:display_visualizations executed successfully
2025/03/01 11:07:19 AM INFO:pagesetup executed successfully
2025/03/01 11:07:19 AM INFO:Data already loaded in session state.
2025/03/01 11:07:20 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:20 AM INFO:Setting up the package
2025/03/01 11:07:20 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:20 AM INFO:get_git_version executed successfully
2025/03/01 11:07:20 AM INFO:Version: v20.115
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:init_state_var executed successfully
2025/03/01 11:07:20 AM INFO:Session_state variables initialized
2025/03/01 11:07:20 AM INFO:menu_selection: {'title': 'Sponsorship per Entity ', 'function': <function mod_sponsorships_per_entity_page at 0x0000018CE1FF9510>}
2025/03/01 11:07:20 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:20 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:20 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:20 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:20 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:20 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:20 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:20 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:20 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:20 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:20 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:20 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:20 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:20 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:20 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:20 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:20 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:20 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:20 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:20 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:20 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:20 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:20 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:20 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:20 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:20 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:20 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:20 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:20 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:20 AM INFO:perc_target: 0.5
2025/03/01 11:07:20 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:20 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:20 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:20 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:20 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:20 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:20 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:20 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:20 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:20 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:20 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:20 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:20 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:20 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:20 AM INFO:Session state Setup complete
2025/03/01 11:07:20 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:20 AM INFO:Package setup complete
2025/03/01 11:07:20 AM INFO:get_git_version executed successfully
2025/03/01 11:07:20 AM INFO:App Version: v20.130
2025/03/01 11:07:20 AM INFO:Switched to page: Sponsorship per Entity 
2025/03/01 11:07:20 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:20 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:07:20 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:07:20 AM INFO:display_textual_insights executed successfully
2025/03/01 11:07:21 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:21 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:21 AM INFO:display_visualizations executed successfully
2025/03/01 11:07:21 AM INFO:pagesetup executed successfully
2025/03/01 11:07:21 AM INFO:Data already loaded in session state.
2025/03/01 11:07:23 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:23 AM INFO:Setting up the package
2025/03/01 11:07:23 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:23 AM INFO:get_git_version executed successfully
2025/03/01 11:07:23 AM INFO:Version: v20.115
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:init_state_var executed successfully
2025/03/01 11:07:23 AM INFO:Session_state variables initialized
2025/03/01 11:07:23 AM INFO:menu_selection: {'title': 'Paid Visits per Entity', 'function': <function mod_visits_per_regulated_entity at 0x0000018CE1FF92D0>}
2025/03/01 11:07:23 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:23 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:23 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:23 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:23 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:23 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:23 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:23 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:23 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:23 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:23 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:23 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:23 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:23 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:23 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:23 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:23 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:23 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:23 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:23 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:23 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:23 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:23 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:23 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:23 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:23 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:23 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:23 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:23 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:23 AM INFO:perc_target: 0.5
2025/03/01 11:07:23 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:23 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:23 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:23 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:23 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:23 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:23 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:23 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:23 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:23 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:23 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:23 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:23 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:23 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:23 AM INFO:Session state Setup complete
2025/03/01 11:07:23 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:23 AM INFO:Package setup complete
2025/03/01 11:07:23 AM INFO:get_git_version executed successfully
2025/03/01 11:07:23 AM INFO:App Version: v20.130
2025/03/01 11:07:23 AM INFO:Switched to page: Paid Visits per Entity
2025/03/01 11:07:23 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:23 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:07:23 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:07:24 AM INFO:display_textual_insights executed successfully
2025/03/01 11:07:24 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:24 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:24 AM INFO:display_visualizations executed successfully
2025/03/01 11:07:24 AM INFO:pagesetup executed successfully
2025/03/01 11:07:24 AM INFO:Data already loaded in session state.
2025/03/01 11:07:31 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:31 AM INFO:Setting up the package
2025/03/01 11:07:31 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:31 AM INFO:get_git_version executed successfully
2025/03/01 11:07:31 AM INFO:Version: v20.115
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:init_state_var executed successfully
2025/03/01 11:07:31 AM INFO:Session_state variables initialized
2025/03/01 11:07:31 AM INFO:menu_selection: {'title': 'Donors per Regulated Entity', 'function': <function mod_regulated_entity_per_donors_page at 0x0000018CE1FF9CF0>}
2025/03/01 11:07:31 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:31 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:31 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:31 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:31 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:31 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:31 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:31 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:31 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:31 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:31 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:31 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:31 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:31 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:31 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:31 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:31 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:31 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:31 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:31 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:31 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:31 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:31 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:31 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:31 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:31 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:31 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:31 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:31 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:31 AM INFO:perc_target: 0.5
2025/03/01 11:07:31 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:31 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:31 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:31 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:31 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:31 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:31 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:31 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:31 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:31 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:31 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:31 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:31 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:31 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:31 AM INFO:Session state Setup complete
2025/03/01 11:07:31 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:31 AM INFO:Package setup complete
2025/03/01 11:07:31 AM INFO:get_git_version executed successfully
2025/03/01 11:07:31 AM INFO:App Version: v20.130
2025/03/01 11:07:31 AM INFO:Switched to page: Donors per Regulated Entity
2025/03/01 11:07:31 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:31 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:07:31 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:07:31 AM INFO:display_textual_insights executed successfully
2025/03/01 11:07:32 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:32 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:32 AM INFO:display_visualizations executed successfully
2025/03/01 11:07:32 AM INFO:pagesetup executed successfully
2025/03/01 11:07:32 AM INFO:Data already loaded in session state.
2025/03/01 11:07:33 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:33 AM INFO:Setting up the package
2025/03/01 11:07:33 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:33 AM INFO:get_git_version executed successfully
2025/03/01 11:07:33 AM INFO:Version: v20.115
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:init_state_var executed successfully
2025/03/01 11:07:33 AM INFO:Session_state variables initialized
2025/03/01 11:07:33 AM INFO:menu_selection: {'title': 'Dubious Donors per Regulated Entity', 'function': <function mod_dubious_donors_per_entity_page at 0x0000018CE1FF9D80>}
2025/03/01 11:07:33 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:33 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:33 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:33 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:33 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:33 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:33 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:33 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:33 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:33 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:33 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:33 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:33 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:33 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:33 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:33 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:33 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:33 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:33 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:33 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:33 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:33 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:33 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:33 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:33 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:33 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:33 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:33 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:33 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:33 AM INFO:perc_target: 0.5
2025/03/01 11:07:33 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:33 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:33 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:33 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:33 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:33 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:33 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:33 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:33 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:33 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:33 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:33 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:33 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:33 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:33 AM INFO:Session state Setup complete
2025/03/01 11:07:33 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:33 AM INFO:Package setup complete
2025/03/01 11:07:33 AM INFO:get_git_version executed successfully
2025/03/01 11:07:33 AM INFO:App Version: v20.130
2025/03/01 11:07:33 AM INFO:Switched to page: Dubious Donors per Regulated Entity
2025/03/01 11:07:33 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:34 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:07:34 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:07:34 AM INFO:display_textual_insights executed successfully
2025/03/01 11:07:34 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:34 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:34 AM INFO:display_visualizations executed successfully
2025/03/01 11:07:34 AM INFO:pagesetup executed successfully
2025/03/01 11:07:34 AM INFO:Data already loaded in session state.
2025/03/01 11:07:37 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:37 AM INFO:Setting up the package
2025/03/01 11:07:37 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:37 AM INFO:get_git_version executed successfully
2025/03/01 11:07:37 AM INFO:Version: v20.115
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:init_state_var executed successfully
2025/03/01 11:07:37 AM INFO:Session_state variables initialized
2025/03/01 11:07:37 AM INFO:menu_selection: {'title': 'Dubious Donations per Regulated Entity', 'function': <function mod_dubious_donations_per_entity_page at 0x0000018CE1FF9A20>}
2025/03/01 11:07:37 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:37 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:37 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:37 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:37 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:37 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:37 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:37 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:37 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:37 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:37 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:37 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:37 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:37 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:37 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:37 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:37 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:37 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:37 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:37 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:37 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:37 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:37 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:37 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:37 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:37 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:37 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:37 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:37 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:37 AM INFO:perc_target: 0.5
2025/03/01 11:07:37 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:37 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:37 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:37 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:37 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:37 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:37 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:37 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:37 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:37 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:37 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:37 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:37 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:37 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:37 AM INFO:Session state Setup complete
2025/03/01 11:07:37 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:37 AM INFO:Package setup complete
2025/03/01 11:07:37 AM INFO:get_git_version executed successfully
2025/03/01 11:07:37 AM INFO:App Version: v20.130
2025/03/01 11:07:37 AM INFO:Switched to page: Dubious Donations per Regulated Entity
2025/03/01 11:07:37 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:37 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:07:37 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:07:37 AM INFO:display_textual_insights executed successfully
2025/03/01 11:07:37 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:38 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:38 AM INFO:display_visualizations executed successfully
2025/03/01 11:07:38 AM INFO:pagesetup executed successfully
2025/03/01 11:07:38 AM INFO:Data already loaded in session state.
2025/03/01 11:07:39 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:39 AM INFO:Setting up the package
2025/03/01 11:07:39 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:39 AM INFO:get_git_version executed successfully
2025/03/01 11:07:39 AM INFO:Version: v20.115
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:init_state_var executed successfully
2025/03/01 11:07:39 AM INFO:Session_state variables initialized
2025/03/01 11:07:39 AM INFO:menu_selection: {'title': 'Corporate Donations by Donor', 'function': <function mod_corporate_donations_per_donor_page at 0x0000018CE1FF9900>}
2025/03/01 11:07:39 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:39 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:39 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:39 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:39 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:39 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:39 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:39 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:39 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:39 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:39 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:39 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:39 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:39 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:39 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:39 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:39 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:39 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:39 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:39 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:39 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:39 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:39 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:39 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:39 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:39 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:39 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:39 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:39 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:39 AM INFO:perc_target: 0.5
2025/03/01 11:07:39 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:39 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:39 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:39 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:39 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:39 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:39 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:39 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:39 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:39 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:39 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:39 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:39 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:39 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:39 AM INFO:Session state Setup complete
2025/03/01 11:07:39 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:39 AM INFO:Package setup complete
2025/03/01 11:07:39 AM INFO:get_git_version executed successfully
2025/03/01 11:07:39 AM INFO:App Version: v20.130
2025/03/01 11:07:39 AM INFO:Switched to page: Corporate Donations by Donor
2025/03/01 11:07:39 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:39 AM INFO:load_and_filter_perentity executed successfully
2025/03/01 11:07:39 AM ERROR:Error in pagesetup: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 76, in mod_corporate_donations_per_donor_page
    display_per_entity_data_page("CorporateDonations_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_entity.py", line 20, in display_data_page
    cleaned_df, filtered_df = load_and_filter_perentity(
ValueError: too many values to unpack (expected 2)
2025/03/01 11:07:39 AM CRITICAL:Menu setup crashed: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 76, in mod_corporate_donations_per_donor_page
    display_per_entity_data_page("CorporateDonations_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_entity.py", line 20, in display_data_page
    cleaned_df, filtered_df = load_and_filter_perentity(
ValueError: too many values to unpack (expected 2)
2025/03/01 11:07:51 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:51 AM INFO:Setting up the package
2025/03/01 11:07:51 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:51 AM INFO:get_git_version executed successfully
2025/03/01 11:07:51 AM INFO:Version: v20.115
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:init_state_var executed successfully
2025/03/01 11:07:51 AM INFO:Session_state variables initialized
2025/03/01 11:07:51 AM INFO:menu_selection: {'title': 'Sponsorships per Donor', 'function': <function mod_sponsorships_per_donor_page at 0x0000018CE1FF96C0>}
2025/03/01 11:07:51 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:51 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:51 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:51 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:51 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:51 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:51 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:51 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:51 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:51 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:51 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:51 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:51 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:51 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:51 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:51 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:51 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:51 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:51 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:51 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:51 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:51 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:51 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:51 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:51 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:51 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:51 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:51 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:51 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:51 AM INFO:perc_target: 0.5
2025/03/01 11:07:51 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:51 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:51 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:51 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:51 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:51 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:51 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:51 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:51 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:51 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:51 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:51 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:51 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:51 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:51 AM INFO:Session state Setup complete
2025/03/01 11:07:51 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:51 AM INFO:Package setup complete
2025/03/01 11:07:51 AM INFO:get_git_version executed successfully
2025/03/01 11:07:51 AM INFO:App Version: v20.130
2025/03/01 11:07:51 AM INFO:Switched to page: Sponsorships per Donor
2025/03/01 11:07:51 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:51 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:07:51 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:07:51 AM INFO:display_textual_insights executed successfully
2025/03/01 11:07:51 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:52 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:52 AM INFO:display_visualizations executed successfully
2025/03/01 11:07:52 AM INFO:pagesetup executed successfully
2025/03/01 11:07:52 AM INFO:Data already loaded in session state.
2025/03/01 11:07:53 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:53 AM INFO:Setting up the package
2025/03/01 11:07:53 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:53 AM INFO:get_git_version executed successfully
2025/03/01 11:07:53 AM INFO:Version: v20.115
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:init_state_var executed successfully
2025/03/01 11:07:53 AM INFO:Session_state variables initialized
2025/03/01 11:07:53 AM INFO:menu_selection: {'title': 'Corporate Donations by Donor', 'function': <function mod_corporate_donations_per_donor_page at 0x0000018CE1FF9900>}
2025/03/01 11:07:53 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:53 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:53 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:53 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:53 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:53 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:53 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:53 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:53 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:53 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:53 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:53 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:53 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:53 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:53 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:53 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:53 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:53 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:53 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:53 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:53 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:53 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:53 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:53 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:53 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:53 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:53 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:53 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:53 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:53 AM INFO:perc_target: 0.5
2025/03/01 11:07:53 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:53 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:53 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:53 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:53 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:53 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:53 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:53 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:53 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:53 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:53 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:53 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:53 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:53 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:53 AM INFO:Session state Setup complete
2025/03/01 11:07:53 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:53 AM INFO:Package setup complete
2025/03/01 11:07:53 AM INFO:get_git_version executed successfully
2025/03/01 11:07:53 AM INFO:App Version: v20.130
2025/03/01 11:07:53 AM INFO:Switched to page: Corporate Donations by Donor
2025/03/01 11:07:53 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:54 AM INFO:load_and_filter_perentity executed successfully
2025/03/01 11:07:54 AM ERROR:Error in pagesetup: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 76, in mod_corporate_donations_per_donor_page
    display_per_entity_data_page("CorporateDonations_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_entity.py", line 20, in display_data_page
    cleaned_df, filtered_df = load_and_filter_perentity(
ValueError: too many values to unpack (expected 2)
2025/03/01 11:07:54 AM CRITICAL:Menu setup crashed: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 76, in mod_corporate_donations_per_donor_page
    display_per_entity_data_page("CorporateDonations_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_entity.py", line 20, in display_data_page
    cleaned_df, filtered_df = load_and_filter_perentity(
ValueError: too many values to unpack (expected 2)
2025/03/01 11:07:58 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:58 AM INFO:Setting up the package
2025/03/01 11:07:58 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:07:58 AM INFO:get_git_version executed successfully
2025/03/01 11:07:58 AM INFO:Version: v20.115
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:init_state_var executed successfully
2025/03/01 11:07:58 AM INFO:Session_state variables initialized
2025/03/01 11:07:58 AM INFO:menu_selection: {'title': 'Paid Visits per Donor', 'function': <function mod_visits_per_donor at 0x0000018CE1FF9630>}
2025/03/01 11:07:58 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:07:58 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:07:58 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:07:58 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:07:58 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:07:58 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:07:58 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:07:59 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:07:59 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:07:59 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:07:59 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:07:59 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:07:59 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:07:59 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:07:59 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:07:59 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:07:59 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:07:59 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:07:59 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:07:59 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:07:59 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:07:59 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:07:59 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:07:59 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:07:59 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:07:59 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:07:59 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:07:59 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:07:59 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:07:59 AM INFO:perc_target: 0.5
2025/03/01 11:07:59 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:07:59 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:07:59 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:07:59 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:07:59 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:07:59 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:07:59 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:07:59 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:07:59 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:07:59 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:07:59 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:07:59 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:07:59 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:07:59 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:07:59 AM INFO:Session state Setup complete
2025/03/01 11:07:59 AM INFO:initialize_session_state executed successfully
2025/03/01 11:07:59 AM INFO:Package setup complete
2025/03/01 11:07:59 AM INFO:get_git_version executed successfully
2025/03/01 11:07:59 AM INFO:App Version: v20.130
2025/03/01 11:07:59 AM INFO:Switched to page: Paid Visits per Donor
2025/03/01 11:07:59 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:07:59 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:07:59 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:07:59 AM INFO:display_textual_insights executed successfully
2025/03/01 11:07:59 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:59 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:07:59 AM INFO:display_visualizations executed successfully
2025/03/01 11:07:59 AM INFO:pagesetup executed successfully
2025/03/01 11:07:59 AM INFO:Data already loaded in session state.
2025/03/01 11:08:00 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:00 AM INFO:Setting up the package
2025/03/01 11:08:00 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:00 AM INFO:get_git_version executed successfully
2025/03/01 11:08:00 AM INFO:Version: v20.115
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:init_state_var executed successfully
2025/03/01 11:08:00 AM INFO:Session_state variables initialized
2025/03/01 11:08:00 AM INFO:menu_selection: {'title': 'Regulated Entities per Donor', 'function': <function mod_regulated_donor_per_entity_page at 0x0000018CE1FF9C60>}
2025/03/01 11:08:00 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:08:00 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:08:00 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:08:00 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:08:00 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:08:00 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:08:00 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:08:00 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:08:00 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:08:00 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:08:00 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:08:00 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:08:00 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:08:00 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:08:00 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:08:00 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:08:00 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:08:00 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:08:00 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:08:00 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:08:00 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:08:00 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:08:00 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:08:00 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:08:00 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:08:00 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:08:00 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:08:00 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:08:00 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:08:00 AM INFO:perc_target: 0.5
2025/03/01 11:08:00 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:08:00 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:08:00 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:08:00 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:08:00 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:08:00 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:08:00 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:08:00 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:08:00 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:08:00 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:08:00 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:08:00 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:08:00 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:08:00 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:08:00 AM INFO:Session state Setup complete
2025/03/01 11:08:00 AM INFO:initialize_session_state executed successfully
2025/03/01 11:08:00 AM INFO:Package setup complete
2025/03/01 11:08:01 AM INFO:get_git_version executed successfully
2025/03/01 11:08:01 AM INFO:App Version: v20.130
2025/03/01 11:08:01 AM INFO:Switched to page: Regulated Entities per Donor
2025/03/01 11:08:01 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:08:01 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:08:01 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:08:01 AM INFO:display_textual_insights executed successfully
2025/03/01 11:08:01 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:08:01 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:08:01 AM INFO:display_visualizations executed successfully
2025/03/01 11:08:01 AM INFO:pagesetup executed successfully
2025/03/01 11:08:01 AM INFO:Data already loaded in session state.
2025/03/01 11:08:02 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:02 AM INFO:Setting up the package
2025/03/01 11:08:02 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:02 AM INFO:get_git_version executed successfully
2025/03/01 11:08:02 AM INFO:Version: v20.115
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:init_state_var executed successfully
2025/03/01 11:08:02 AM INFO:Session_state variables initialized
2025/03/01 11:08:02 AM INFO:menu_selection: {'title': 'Dubious donations per Donor', 'function': <function mod_dubious_donations_per_donor_page at 0x0000018CE1FF9AB0>}
2025/03/01 11:08:02 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:08:02 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:08:02 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:08:02 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:08:02 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:08:02 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:08:02 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:08:03 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:08:03 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:08:03 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:08:03 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:08:03 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:08:03 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:08:03 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:08:03 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:08:03 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:08:03 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:08:03 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:08:03 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:08:03 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:08:03 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:08:03 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:08:03 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:08:03 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:08:03 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:08:03 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:08:03 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:08:03 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:08:03 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:08:03 AM INFO:perc_target: 0.5
2025/03/01 11:08:03 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:08:03 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:08:03 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:08:03 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:08:03 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:08:03 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:08:03 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:08:03 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:08:03 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:08:03 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:08:03 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:08:03 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:08:03 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:08:03 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:08:03 AM INFO:Session state Setup complete
2025/03/01 11:08:03 AM INFO:initialize_session_state executed successfully
2025/03/01 11:08:03 AM INFO:Package setup complete
2025/03/01 11:08:03 AM INFO:get_git_version executed successfully
2025/03/01 11:08:03 AM INFO:App Version: v20.130
2025/03/01 11:08:03 AM INFO:Switched to page: Dubious donations per Donor
2025/03/01 11:08:03 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:08:03 AM INFO:load_and_filter_pergroup executed successfully
2025/03/01 11:08:03 AM INFO:display_summary_statistics executed successfully
2025/03/01 11:08:03 AM INFO:display_textual_insights executed successfully
2025/03/01 11:08:03 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:08:03 AM INFO:plot_bar_line_by_year executed successfully
2025/03/01 11:08:03 AM INFO:display_visualizations executed successfully
2025/03/01 11:08:03 AM INFO:pagesetup executed successfully
2025/03/01 11:08:03 AM INFO:Data already loaded in session state.
2025/03/01 11:08:05 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:05 AM INFO:Setting up the package
2025/03/01 11:08:05 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:05 AM INFO:get_git_version executed successfully
2025/03/01 11:08:05 AM INFO:Version: v20.115
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:init_state_var executed successfully
2025/03/01 11:08:05 AM INFO:Session_state variables initialized
2025/03/01 11:08:05 AM INFO:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party_page at 0x0000018CE1FF9BD0>}
2025/03/01 11:08:05 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:08:05 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:08:05 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:08:05 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:08:05 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:08:05 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:08:05 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:08:05 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:08:05 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:08:05 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:08:05 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:08:05 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:08:05 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:08:05 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:08:05 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:08:05 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:08:05 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:08:05 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:08:05 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:08:05 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:08:05 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:08:05 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:08:05 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:08:05 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:08:05 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:08:05 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:08:05 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:08:05 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:08:05 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:08:05 AM INFO:perc_target: 0.5
2025/03/01 11:08:05 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:08:05 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:08:05 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:08:05 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:08:05 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:08:05 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:08:05 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:08:05 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:08:05 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:08:05 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:08:05 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:08:05 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:08:05 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:08:05 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:08:05 AM INFO:Session state Setup complete
2025/03/01 11:08:05 AM INFO:initialize_session_state executed successfully
2025/03/01 11:08:05 AM INFO:Package setup complete
2025/03/01 11:08:05 AM INFO:get_git_version executed successfully
2025/03/01 11:08:05 AM INFO:App Version: v20.130
2025/03/01 11:08:05 AM INFO:Switched to page: Donations by Political Party
2025/03/01 11:08:05 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:08:05 AM ERROR:Error in load_and_filter_pergroup: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:05 AM ERROR:Error in pagesetup: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 110, in mod_donations_per_political_party_page
    display_per_group_data_page("PoliticalParty_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_donor.py", line 28, in display_data_page
    ) = load_and_filter_pergroup(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:05 AM CRITICAL:Menu setup crashed: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 110, in mod_donations_per_political_party_page
    display_per_group_data_page("PoliticalParty_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_donor.py", line 28, in display_data_page
    ) = load_and_filter_pergroup(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:19 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:19 AM INFO:Setting up the package
2025/03/01 11:08:19 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:19 AM INFO:get_git_version executed successfully
2025/03/01 11:08:19 AM INFO:Version: v20.115
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:init_state_var executed successfully
2025/03/01 11:08:19 AM INFO:Session_state variables initialized
2025/03/01 11:08:19 AM INFO:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party_page at 0x0000018CE1FF9BD0>}
2025/03/01 11:08:19 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:08:19 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:08:19 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:08:19 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:08:19 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:08:19 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:08:19 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:08:19 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:08:19 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:08:19 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:08:19 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:08:19 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:08:19 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:08:19 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:08:19 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:08:19 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:08:19 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:08:19 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:08:19 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:08:19 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:08:19 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:08:19 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:08:19 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:08:19 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:08:19 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:08:19 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:08:19 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:08:19 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:08:19 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:08:19 AM INFO:perc_target: 0.5
2025/03/01 11:08:19 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:08:19 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:08:19 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:08:19 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:08:19 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:08:19 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:08:19 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:08:19 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:08:19 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:08:19 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:08:19 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:08:19 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:08:19 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:08:19 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:08:19 AM INFO:Session state Setup complete
2025/03/01 11:08:19 AM INFO:initialize_session_state executed successfully
2025/03/01 11:08:19 AM INFO:Package setup complete
2025/03/01 11:08:19 AM INFO:get_git_version executed successfully
2025/03/01 11:08:19 AM INFO:App Version: v20.130
2025/03/01 11:08:19 AM INFO:Switched to page: Donations by Political Party
2025/03/01 11:08:19 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:08:19 AM ERROR:Error in load_and_filter_pergroup: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:19 AM ERROR:Error in pagesetup: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 110, in mod_donations_per_political_party_page
    display_per_group_data_page("PoliticalParty_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_donor.py", line 28, in display_data_page
    ) = load_and_filter_pergroup(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:19 AM CRITICAL:Menu setup crashed: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 110, in mod_donations_per_political_party_page
    display_per_group_data_page("PoliticalParty_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_donor.py", line 28, in display_data_page
    ) = load_and_filter_pergroup(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:23 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:23 AM INFO:Setting up the package
2025/03/01 11:08:23 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:23 AM INFO:get_git_version executed successfully
2025/03/01 11:08:23 AM INFO:Version: v20.115
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:init_state_var executed successfully
2025/03/01 11:08:23 AM INFO:Session_state variables initialized
2025/03/01 11:08:23 AM INFO:menu_selection: {'title': 'Notes on Data and Manipulations', 'function': <function notesondataprep_body at 0x0000018CE1FC3AC0>}
2025/03/01 11:08:23 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:08:23 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:08:23 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:08:23 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:08:23 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:08:23 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:08:23 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:08:23 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:08:23 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:08:23 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:08:23 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:08:23 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:08:23 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:08:23 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:08:23 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:08:23 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:08:23 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:08:23 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:08:23 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:08:23 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:08:23 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:08:23 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:08:23 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:08:23 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:08:23 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:08:23 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:08:23 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:08:23 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:08:23 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:08:23 AM INFO:perc_target: 0.5
2025/03/01 11:08:23 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:08:23 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:08:23 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:08:23 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:08:23 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:08:23 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:08:23 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:08:23 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:08:23 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:08:23 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:08:23 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:08:23 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:08:23 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:08:23 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:08:23 AM INFO:Session state Setup complete
2025/03/01 11:08:23 AM INFO:initialize_session_state executed successfully
2025/03/01 11:08:23 AM INFO:Package setup complete
2025/03/01 11:08:23 AM INFO:get_git_version executed successfully
2025/03/01 11:08:23 AM INFO:App Version: v20.130
2025/03/01 11:08:23 AM INFO:Switched to page: Notes on Data and Manipulations
2025/03/01 11:08:23 AM INFO:pagesetup executed successfully
2025/03/01 11:08:23 AM INFO:Data already loaded in session state.
2025/03/01 11:08:26 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:26 AM INFO:Setting up the package
2025/03/01 11:08:26 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:26 AM INFO:get_git_version executed successfully
2025/03/01 11:08:26 AM INFO:Version: v20.115
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:init_state_var executed successfully
2025/03/01 11:08:26 AM INFO:Session_state variables initialized
2025/03/01 11:08:26 AM INFO:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party_page at 0x0000018CE1FF9BD0>}
2025/03/01 11:08:26 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:08:26 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:08:26 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:08:26 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:08:26 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:08:26 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:08:26 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:08:26 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:08:26 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:08:26 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:08:26 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:08:26 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:08:26 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:08:26 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:08:26 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:08:26 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:08:26 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:08:26 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:08:26 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:08:26 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:08:26 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:08:26 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:08:26 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:08:26 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:08:26 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:08:26 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:08:26 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:08:26 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:08:26 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:08:26 AM INFO:perc_target: 0.5
2025/03/01 11:08:26 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:08:26 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:08:26 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:08:26 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:08:26 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:08:26 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:08:26 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:08:26 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:08:26 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:08:26 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:08:26 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:08:26 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:08:26 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:08:26 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:08:26 AM INFO:Session state Setup complete
2025/03/01 11:08:26 AM INFO:initialize_session_state executed successfully
2025/03/01 11:08:26 AM INFO:Package setup complete
2025/03/01 11:08:26 AM INFO:get_git_version executed successfully
2025/03/01 11:08:26 AM INFO:App Version: v20.130
2025/03/01 11:08:26 AM INFO:Switched to page: Donations by Political Party
2025/03/01 11:08:26 AM INFO:load_cleaned_data executed successfully
2025/03/01 11:08:26 AM ERROR:Error in load_and_filter_pergroup: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:26 AM ERROR:Error in pagesetup: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 110, in mod_donations_per_political_party_page
    display_per_group_data_page("PoliticalParty_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_donor.py", line 28, in display_data_page
    ) = load_and_filter_pergroup(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:26 AM CRITICAL:Menu setup crashed: 'DonorType'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 191, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 234, in pandas._libs.index.IndexEngine._get_loc_duplicates
  File "index.pyx", line 242, in pandas._libs.index.IndexEngine._maybe_get_bool_indexer
  File "index.pyx", line 134, in pandas._libs.index._unpack_bool_indexer
KeyError: 'DonorType'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 110, in mod_donations_per_political_party_page
    display_per_group_data_page("PoliticalParty_ftr",
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_donor.py", line 28, in display_data_page
    ) = load_and_filter_pergroup(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 415, in load_and_filter_pergroup
    cleaned_c_df = apply_filters(cleaned_df, current_target)
  File "H:\VScode\dashboard_demo-1\components\filters.py", line 37, in apply_filters
    conditions.append(df[column] == value)
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'DonorType'
2025/03/01 11:08:30 AM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:30 AM INFO:Setting up the package
2025/03/01 11:08:30 AM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 11:08:30 AM INFO:get_git_version executed successfully
2025/03/01 11:08:30 AM INFO:Version: v20.115
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:init_state_var executed successfully
2025/03/01 11:08:30 AM INFO:Session_state variables initialized
2025/03/01 11:08:30 AM INFO:menu_selection: {'title': 'Introduction', 'function': <function introduction_body at 0x0000018CE1BC68C0>}
2025/03/01 11:08:30 AM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 11:08:30 AM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 11:08:30 AM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 11:08:30 AM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 11:08:30 AM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 11:08:30 AM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 11:08:30 AM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 11:08:30 AM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 11:08:30 AM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 11:08:30 AM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 11:08:30 AM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 11:08:30 AM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 11:08:30 AM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 11:08:30 AM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 11:08:30 AM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 11:08:30 AM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 11:08:30 AM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 11:08:30 AM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 11:08:30 AM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 11:08:30 AM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 11:08:30 AM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 11:08:30 AM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 11:08:30 AM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 11:08:30 AM INFO:LOG_LEVEL: DEBUG
2025/03/01 11:08:30 AM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 11:08:30 AM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 11:08:30 AM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 11:08:30 AM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 11:08:30 AM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 11:08:30 AM INFO:perc_target: 0.5
2025/03/01 11:08:30 AM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 11:08:30 AM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 11:08:30 AM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 11:08:30 AM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 11:08:30 AM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 11:08:30 AM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 11:08:30 AM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 11:08:30 AM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 11:08:30 AM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 11:08:30 AM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 11:08:30 AM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 11:08:30 AM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 11:08:30 AM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 11:08:30 AM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 11:08:30 AM INFO:Session state Setup complete
2025/03/01 11:08:30 AM INFO:initialize_session_state executed successfully
2025/03/01 11:08:30 AM INFO:Package setup complete
2025/03/01 11:08:30 AM INFO:get_git_version executed successfully
2025/03/01 11:08:30 AM INFO:App Version: v20.130
2025/03/01 11:08:30 AM INFO:Switched to page: Introduction
2025/03/01 11:08:30 AM INFO:pagesetup executed successfully
2025/03/01 11:08:30 AM INFO:Data already loaded in session state.
2025/03/01 12:02:53 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/01 12:02:53 PM INFO:get_git_version executed successfully
2025/03/01 12:03:20 PM INFO:get_git_version executed successfully
2025/03/01 12:03:20 PM INFO:get_git_version executed successfully
2025/03/01 12:03:40 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:03:48 PM INFO:Setting up the package
2025/03/01 12:03:48 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:03:48 PM INFO:get_git_version executed successfully
2025/03/01 12:03:48 PM INFO:Version: v20.116
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:init_state_var executed successfully
2025/03/01 12:03:48 PM INFO:Session_state variables initialized
2025/03/01 12:03:48 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:03:48 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:03:48 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:03:48 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:03:48 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:03:48 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:03:48 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:03:48 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:03:48 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:03:48 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:03:48 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:03:48 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:03:48 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:03:48 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:03:48 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:03:48 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:03:48 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:03:48 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:03:48 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:03:48 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:03:48 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:03:48 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:03:48 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:03:48 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:03:48 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:03:48 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:03:48 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:03:48 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:03:48 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:03:48 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:03:48 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:03:48 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:03:48 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:03:48 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:03:48 PM INFO:perc_target: 0.5
2025/03/01 12:03:48 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:03:48 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:03:48 PM INFO:Session state Setup complete
2025/03/01 12:03:48 PM INFO:initialize_session_state executed successfully
2025/03/01 12:03:48 PM INFO:Package setup complete
2025/03/01 12:04:00 PM INFO:get_git_version executed successfully
2025/03/01 12:04:01 PM ERROR:Error in pagesetup: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
2025/03/01 12:04:40 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/01 12:04:41 PM INFO:get_git_version executed successfully
2025/03/01 12:04:45 PM INFO:get_git_version executed successfully
2025/03/01 12:04:51 PM INFO:get_git_version executed successfully
2025/03/01 12:05:01 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:05:01 PM INFO:Setting up the package
2025/03/01 12:05:01 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:05:01 PM INFO:get_git_version executed successfully
2025/03/01 12:05:01 PM INFO:Version: v20.116
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:01 PM INFO:init_state_var executed successfully
2025/03/01 12:05:02 PM INFO:init_state_var executed successfully
2025/03/01 12:05:02 PM INFO:init_state_var executed successfully
2025/03/01 12:05:02 PM INFO:init_state_var executed successfully
2025/03/01 12:05:02 PM INFO:init_state_var executed successfully
2025/03/01 12:05:02 PM INFO:init_state_var executed successfully
2025/03/01 12:05:02 PM INFO:Session_state variables initialized
2025/03/01 12:05:02 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:05:02 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:05:02 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:05:02 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:05:02 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:05:02 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:05:02 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:05:02 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:05:02 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:05:02 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:05:02 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:05:02 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:05:02 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:05:02 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:05:02 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:05:02 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:05:02 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:05:02 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:05:02 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:05:02 PM INFO:perc_target: 0.5
2025/03/01 12:05:02 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:05:02 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:05:02 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:05:02 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:05:02 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:05:02 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:05:02 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:05:02 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:05:02 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:05:02 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:05:02 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:05:02 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:05:02 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:05:02 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:05:02 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:05:02 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:05:02 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:05:02 PM INFO:Session state Setup complete
2025/03/01 12:05:02 PM INFO:initialize_session_state executed successfully
2025/03/01 12:05:02 PM INFO:Package setup complete
2025/03/01 12:05:53 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:05:53 PM INFO:Setting up the package
2025/03/01 12:05:53 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:05:53 PM INFO:get_git_version executed successfully
2025/03/01 12:05:53 PM INFO:Version: v20.116
2025/03/01 12:05:53 PM INFO:init_state_var executed successfully
2025/03/01 12:05:53 PM INFO:init_state_var executed successfully
2025/03/01 12:05:53 PM INFO:init_state_var executed successfully
2025/03/01 12:05:53 PM INFO:init_state_var executed successfully
2025/03/01 12:05:53 PM INFO:init_state_var executed successfully
2025/03/01 12:05:53 PM INFO:init_state_var executed successfully
2025/03/01 12:05:53 PM INFO:init_state_var executed successfully
2025/03/01 12:05:53 PM INFO:init_state_var executed successfully
2025/03/01 12:05:57 PM INFO:init_state_var executed successfully
2025/03/01 12:05:57 PM INFO:init_state_var executed successfully
2025/03/01 12:05:57 PM INFO:init_state_var executed successfully
2025/03/01 12:05:57 PM INFO:init_state_var executed successfully
2025/03/01 12:06:02 PM INFO:get_git_version executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:init_state_var executed successfully
2025/03/01 12:07:05 PM INFO:Session_state variables initialized
2025/03/01 12:07:05 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:07:05 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:07:05 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:07:05 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:07:05 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:07:05 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:07:05 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:07:05 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:07:05 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:07:05 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:07:05 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:07:05 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:07:05 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:07:05 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:07:05 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:07:05 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:07:05 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:07:05 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:07:05 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:07:05 PM INFO:perc_target: 0.5
2025/03/01 12:07:05 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:07:05 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:07:05 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:07:05 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:07:05 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:07:05 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:07:05 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:07:05 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:07:05 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:07:06 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:07:06 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:07:06 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:07:06 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:07:06 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:07:06 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:07:06 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:07:06 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:07:06 PM INFO:Session state Setup complete
2025/03/01 12:07:06 PM INFO:initialize_session_state executed successfully
2025/03/01 12:07:06 PM INFO:Package setup complete
2025/03/01 12:07:41 PM ERROR:Error in pagesetup: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
2025/03/01 12:07:41 PM CRITICAL:Menu setup crashed: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
2025/03/01 12:08:32 PM INFO:get_git_version executed successfully
2025/03/01 12:08:32 PM INFO:App Version: v20.131
2025/03/01 12:08:32 PM INFO:Switched to page: Introduction
2025/03/01 12:08:32 PM INFO:pagesetup executed successfully
2025/03/01 12:08:41 PM INFO:No data found in session state, running firstload()
2025/03/01 12:08:44 PM INFO:map_filename: regentity_map_fname
2025/03/01 12:08:44 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:08:44 PM INFO:Dedupe by file
2025/03/01 12:08:44 PM INFO:Dedupe by file, shape: (65279, 34)
2025/03/01 12:08:44 PM INFO:dedupe_entity_file executed successfully
2025/03/01 12:08:44 PM INFO:map_filename: donor_map_fname
2025/03/01 12:08:44 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:08:44 PM INFO:Dedupe by file
2025/03/01 12:08:45 PM INFO:Dedupe by file, shape: (66011, 40)
2025/03/01 12:08:45 PM INFO:dedupe_entity_file executed successfully
2025/03/01 12:08:45 PM INFO:Data cleanup completed, shape: (66011, 40)
2025/03/01 12:08:45 PM INFO:raw_data_cleanup executed successfully
2025/03/01 12:08:46 PM INFO:load_raw_data executed successfully
2025/03/01 12:08:46 PM INFO:get_raw_data executed successfully
2025/03/01 12:08:46 PM INFO:load_data_to_session executed successfully
2025/03/01 12:08:49 PM ERROR:Missing column: 'PartyName' in loaddata_df. Available columns: Index(['ECRef', 'OriginalRegulatedEntityName', 'RegulatedEntityType', 'Value',
       'AcceptedDate', 'AccountingUnitName', 'OriginalDonorName',
       'AccountingUnitsAsCentralParty', 'IsSponsorship', 'DonorStatus',
       'RegulatedDoneeType', 'CompanyRegistrationNumber', 'Postcode',
       'DonationType', 'NatureOfDonation', 'PurposeOfVisit', 'DonationAction',
       'ReceivedDate', 'ReportedDate', 'IsReportedPrePoll',
       'ReportingPeriodName', 'IsBequest', 'IsAggregation',
       'OriginalRegulatedEntityId', 'AccountingUnitId', 'OriginalDonorId',
       'CampaigningName', 'RegisterName', 'IsIrishSource',
       'CleanedRegulatedEntityId', 'CleanedRegulatedEntityName',
       'OriginalRegulatedEntityName', 'RegulatedEntityId',
       'RegulatedEntityName', 'CleanedDonorId', 'ParentDonorName',
       'CleanedDonorName', 'DonorStatus2', 'DonorId', 'DonorName',
       'EventCount', 'YearReceived', 'MonthReceived', 'YearMonthReceived'],
      dtype='object')
2025/03/01 12:08:49 PM INFO:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/01 12:08:49 PM INFO:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/01 12:08:50 PM INFO:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/01 12:08:50 PM INFO:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/01 12:08:50 PM INFO:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/01 12:08:50 PM INFO:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/01 12:08:50 PM INFO:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/01 12:08:50 PM INFO:Data Updated with PartyName and PartyId successfully
2025/03/01 12:08:50 PM INFO:map_mp_to_party executed successfully
2025/03/01 12:08:51 PM INFO:Election Dates not found in session, loading now.
2025/03/01 12:08:51 PM INFO:ElectionDatesDict: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30)}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27)}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14)}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5)}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23)}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25)}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26)}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8)}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15)}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31)}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18)}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28)}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10)}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3)}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9)}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11)}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9)}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1)}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7)}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5)}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6)}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7)}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8)}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12)}}
2025/03/01 12:08:51 PM INFO:Election Dates Loaded Successfully.
2025/03/01 12:08:51 PM INFO:load_election_dates executed successfully
2025/03/01 12:09:19 PM INFO:Cleaned Data completed, shape: (79737, 58)
2025/03/01 12:09:20 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:09:20 PM INFO:get_cleaned_data executed successfully
2025/03/01 12:09:20 PM INFO:load_data_to_session executed successfully
2025/03/01 12:09:20 PM INFO:load_entity_summary_data executed successfully
2025/03/01 12:09:20 PM INFO:get_party_summary_data executed successfully
2025/03/01 12:09:20 PM INFO:load_data_to_session executed successfully
2025/03/01 12:09:20 PM INFO:load_donorList_data executed successfully
2025/03/01 12:09:20 PM INFO:get_donor_data executed successfully
2025/03/01 12:09:20 PM INFO:load_data_to_session executed successfully
2025/03/01 12:09:20 PM INFO:load_regulated_entity_data executed successfully
2025/03/01 12:09:20 PM INFO:get_regentity_data executed successfully
2025/03/01 12:09:20 PM INFO:load_data_to_session executed successfully
2025/03/01 12:09:20 PM INFO:firstload executed successfully
2025/03/01 12:09:29 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:09:29 PM INFO:Setting up the package
2025/03/01 12:09:29 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:09:29 PM INFO:get_git_version executed successfully
2025/03/01 12:09:29 PM INFO:Version: v20.116
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:init_state_var executed successfully
2025/03/01 12:09:29 PM INFO:Session_state variables initialized
2025/03/01 12:09:29 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:09:29 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:09:29 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:09:29 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:09:29 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:09:29 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:09:29 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:09:29 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:09:29 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:09:29 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:09:29 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:09:29 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:09:29 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:09:29 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:09:29 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:09:29 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:09:29 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:09:29 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:09:29 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:09:29 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:09:29 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:09:29 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:09:29 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:09:29 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:09:29 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:09:29 PM INFO:perc_target: 0.5
2025/03/01 12:09:29 PM INFO:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000002118C666020>}
2025/03/01 12:09:29 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:09:29 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:09:29 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:09:29 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:09:29 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:09:29 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:09:29 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:09:29 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:09:29 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:09:29 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:09:29 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:09:29 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:09:29 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:09:29 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:09:29 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:09:29 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:09:29 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:09:29 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:09:29 PM INFO:Session state Setup complete
2025/03/01 12:09:29 PM INFO:initialize_session_state executed successfully
2025/03/01 12:09:29 PM INFO:Package setup complete
2025/03/01 12:09:41 PM INFO:get_git_version executed successfully
2025/03/01 12:09:41 PM INFO:App Version: v20.131
2025/03/01 12:09:41 PM INFO:Switched to page: Head Line Figures
2025/03/01 12:09:43 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:09:44 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:09:44 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:09:44 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:09:44 PM INFO:plot_pie_chart executed successfully
2025/03/01 12:09:44 PM INFO:plot_pie_chart executed successfully
2025/03/01 12:09:44 PM INFO:pagesetup executed successfully
2025/03/01 12:09:48 PM INFO:Data already loaded in session state.
2025/03/01 12:19:24 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/01 12:19:25 PM INFO:get_git_version executed successfully
2025/03/01 12:19:26 PM INFO:get_git_version executed successfully
2025/03/01 12:19:26 PM INFO:get_git_version executed successfully
2025/03/01 12:19:26 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:19:26 PM INFO:Setting up the package
2025/03/01 12:19:26 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:19:26 PM INFO:get_git_version executed successfully
2025/03/01 12:19:26 PM INFO:Version: v20.116
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:init_state_var executed successfully
2025/03/01 12:19:26 PM INFO:Session_state variables initialized
2025/03/01 12:19:26 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:19:26 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:19:26 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:19:26 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:19:26 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:19:26 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:19:26 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:19:26 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:19:26 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:19:26 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:19:26 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:19:26 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:19:26 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:19:26 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:19:26 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:19:26 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:19:26 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:19:26 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:19:26 PM INFO:perc_target: 0.5
2025/03/01 12:19:26 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:19:26 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:19:26 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:19:26 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:19:26 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:19:26 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:19:26 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:19:26 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:19:26 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:19:26 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:19:26 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:19:26 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:19:26 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:19:26 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:19:26 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:19:26 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:19:26 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:19:26 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:19:26 PM INFO:Session state Setup complete
2025/03/01 12:19:26 PM INFO:initialize_session_state executed successfully
2025/03/01 12:19:26 PM INFO:Package setup complete
2025/03/01 12:19:26 PM INFO:get_git_version executed successfully
2025/03/01 12:19:27 PM ERROR:Error in pagesetup: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
2025/03/01 12:19:27 PM CRITICAL:Menu setup crashed: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
2025/03/01 12:19:42 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:19:42 PM INFO:Setting up the package
2025/03/01 12:19:42 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:19:42 PM INFO:get_git_version executed successfully
2025/03/01 12:19:42 PM INFO:Version: v20.116
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:init_state_var executed successfully
2025/03/01 12:19:42 PM INFO:Session_state variables initialized
2025/03/01 12:19:42 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:19:42 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:19:42 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:19:42 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:19:42 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:19:42 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:19:42 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:19:42 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:19:42 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:19:42 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:19:42 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:19:42 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:19:42 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:19:42 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:19:42 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:19:42 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:19:42 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:19:42 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:19:42 PM INFO:perc_target: 0.5
2025/03/01 12:19:42 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:19:42 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:19:42 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:19:42 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:19:42 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:19:42 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:19:42 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:19:42 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:19:42 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:19:42 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:19:42 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:19:42 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:19:42 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:19:42 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:19:42 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:19:42 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:19:42 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:19:42 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:19:42 PM INFO:Session state Setup complete
2025/03/01 12:19:42 PM INFO:initialize_session_state executed successfully
2025/03/01 12:19:42 PM INFO:Package setup complete
2025/03/01 12:19:42 PM INFO:get_git_version executed successfully
2025/03/01 12:19:42 PM INFO:App Version: v20.131
2025/03/01 12:19:42 PM INFO:Switched to page: Introduction
2025/03/01 12:19:42 PM INFO:pagesetup executed successfully
2025/03/01 12:19:42 PM INFO:No data found in session state, running firstload()
2025/03/01 12:19:43 PM INFO:map_filename: regentity_map_fname
2025/03/01 12:19:43 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:19:43 PM INFO:Dedupe by file
2025/03/01 12:19:44 PM INFO:Dedupe by file, shape: (65279, 34)
2025/03/01 12:19:44 PM INFO:dedupe_entity_file executed successfully
2025/03/01 12:19:44 PM INFO:map_filename: donor_map_fname
2025/03/01 12:19:44 PM INFO:map_filename found: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:19:44 PM INFO:Dedupe by file
2025/03/01 12:19:44 PM INFO:Dedupe by file, shape: (66011, 40)
2025/03/01 12:19:44 PM INFO:dedupe_entity_file executed successfully
2025/03/01 12:19:44 PM INFO:Data cleanup completed, shape: (66011, 40)
2025/03/01 12:19:44 PM INFO:raw_data_cleanup executed successfully
2025/03/01 12:19:45 PM INFO:load_raw_data executed successfully
2025/03/01 12:19:45 PM INFO:get_raw_data executed successfully
2025/03/01 12:19:45 PM INFO:load_data_to_session executed successfully
2025/03/01 12:19:48 PM ERROR:Missing column: 'PartyName' in loaddata_df. Available columns: Index(['ECRef', 'OriginalRegulatedEntityName', 'RegulatedEntityType', 'Value',
       'AcceptedDate', 'AccountingUnitName', 'OriginalDonorName',
       'AccountingUnitsAsCentralParty', 'IsSponsorship', 'DonorStatus',
       'RegulatedDoneeType', 'CompanyRegistrationNumber', 'Postcode',
       'DonationType', 'NatureOfDonation', 'PurposeOfVisit', 'DonationAction',
       'ReceivedDate', 'ReportedDate', 'IsReportedPrePoll',
       'ReportingPeriodName', 'IsBequest', 'IsAggregation',
       'OriginalRegulatedEntityId', 'AccountingUnitId', 'OriginalDonorId',
       'CampaigningName', 'RegisterName', 'IsIrishSource',
       'CleanedRegulatedEntityId', 'CleanedRegulatedEntityName',
       'OriginalRegulatedEntityName', 'RegulatedEntityId',
       'RegulatedEntityName', 'CleanedDonorId', 'ParentDonorName',
       'CleanedDonorName', 'DonorStatus2', 'DonorId', 'DonorName',
       'EventCount', 'YearReceived', 'MonthReceived', 'YearMonthReceived'],
      dtype='object')
2025/03/01 12:19:48 PM INFO:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/01 12:19:48 PM INFO:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/01 12:19:48 PM INFO:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/01 12:19:48 PM INFO:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/01 12:19:48 PM INFO:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/01 12:19:48 PM INFO:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/01 12:19:48 PM INFO:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/01 12:19:48 PM INFO:Data Updated with PartyName and PartyId successfully
2025/03/01 12:19:48 PM INFO:map_mp_to_party executed successfully
2025/03/01 12:19:48 PM INFO:Election Dates not found in session, loading now.
2025/03/01 12:19:48 PM INFO:ElectionDatesDict: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30)}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27)}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14)}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5)}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23)}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25)}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26)}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8)}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15)}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31)}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18)}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28)}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10)}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3)}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9)}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11)}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9)}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1)}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7)}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5)}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6)}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7)}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8)}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12)}}
2025/03/01 12:19:48 PM INFO:Election Dates Loaded Successfully.
2025/03/01 12:19:48 PM INFO:load_election_dates executed successfully
2025/03/01 12:19:58 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:19:58 PM INFO:Setting up the package
2025/03/01 12:19:58 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:19:58 PM INFO:get_git_version executed successfully
2025/03/01 12:19:58 PM INFO:Version: v20.116
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:58 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:19:59 PM INFO:init_state_var executed successfully
2025/03/01 12:20:00 PM INFO:init_state_var executed successfully
2025/03/01 12:20:00 PM INFO:init_state_var executed successfully
2025/03/01 12:20:00 PM INFO:init_state_var executed successfully
2025/03/01 12:20:00 PM INFO:init_state_var executed successfully
2025/03/01 12:20:00 PM INFO:init_state_var executed successfully
2025/03/01 12:20:00 PM INFO:init_state_var executed successfully
2025/03/01 12:20:00 PM INFO:Session_state variables initialized
2025/03/01 12:20:00 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:20:00 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:20:00 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:20:00 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:20:00 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:20:00 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:20:00 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:20:00 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:20:00 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:20:00 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:20:00 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:20:00 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:20:00 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:20:00 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:20:00 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:20:00 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:20:00 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:20:00 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:20:00 PM INFO:perc_target: 0.5
2025/03/01 12:20:00 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:20:00 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:20:00 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:20:00 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:20:00 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:20:00 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:20:00 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:20:00 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:20:01 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:20:01 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:20:01 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:20:01 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:20:01 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:20:01 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:20:01 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:20:01 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:20:01 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:20:01 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:20:01 PM INFO:Session state Setup complete
2025/03/01 12:20:01 PM INFO:initialize_session_state executed successfully
2025/03/01 12:20:01 PM INFO:Package setup complete
2025/03/01 12:20:01 PM INFO:get_git_version executed successfully
2025/03/01 12:20:01 PM INFO:App Version: v20.131
2025/03/01 12:20:01 PM INFO:Switched to page: Introduction
2025/03/01 12:20:01 PM INFO:pagesetup executed successfully
2025/03/01 12:20:02 PM INFO:No data found in session state, running firstload()
2025/03/01 12:20:05 PM INFO:Cleaned Data completed, shape: (79737, 58)
2025/03/01 12:20:05 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:20:05 PM INFO:get_cleaned_data executed successfully
2025/03/01 12:20:05 PM INFO:load_data_to_session executed successfully
2025/03/01 12:20:05 PM INFO:load_entity_summary_data executed successfully
2025/03/01 12:20:05 PM INFO:get_party_summary_data executed successfully
2025/03/01 12:20:05 PM INFO:load_data_to_session executed successfully
2025/03/01 12:20:06 PM INFO:load_donorList_data executed successfully
2025/03/01 12:20:06 PM INFO:get_donor_data executed successfully
2025/03/01 12:20:06 PM INFO:load_data_to_session executed successfully
2025/03/01 12:20:06 PM INFO:load_regulated_entity_data executed successfully
2025/03/01 12:20:06 PM INFO:get_regentity_data executed successfully
2025/03/01 12:20:06 PM INFO:load_data_to_session executed successfully
2025/03/01 12:20:06 PM INFO:firstload executed successfully
2025/03/01 12:20:06 PM INFO:firstload executed successfully
2025/03/01 12:20:19 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:20:19 PM INFO:Setting up the package
2025/03/01 12:20:19 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:20:19 PM INFO:get_git_version executed successfully
2025/03/01 12:20:19 PM INFO:Version: v20.116
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:init_state_var executed successfully
2025/03/01 12:20:19 PM INFO:Session_state variables initialized
2025/03/01 12:20:19 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:20:19 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:20:19 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:20:19 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:20:19 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:20:19 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:20:19 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:20:19 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:20:19 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:20:19 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:20:19 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:20:19 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:20:19 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:20:19 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:20:19 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:20:19 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:20:19 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:20:19 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:20:19 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:20:19 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:20:19 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:20:19 PM INFO:perc_target: 0.5
2025/03/01 12:20:19 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:20:19 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:20:19 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:20:19 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:20:19 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:20:19 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:20:19 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:20:19 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:20:19 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:20:19 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:20:19 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:20:19 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:20:19 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:20:19 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:20:19 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:20:19 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:20:19 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:20:19 PM INFO:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001AE4B51D8A0>}
2025/03/01 12:20:19 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:20:19 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:20:19 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:20:19 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:20:19 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:20:19 PM INFO:Session state Setup complete
2025/03/01 12:20:19 PM INFO:initialize_session_state executed successfully
2025/03/01 12:20:19 PM INFO:Package setup complete
2025/03/01 12:20:19 PM INFO:get_git_version executed successfully
2025/03/01 12:20:19 PM INFO:App Version: v20.131
2025/03/01 12:20:19 PM INFO:Switched to page: Head Line Figures
2025/03/01 12:20:20 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:20:20 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:20:20 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:20:20 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:20:20 PM INFO:plot_pie_chart executed successfully
2025/03/01 12:20:20 PM INFO:plot_pie_chart executed successfully
2025/03/01 12:20:20 PM INFO:pagesetup executed successfully
2025/03/01 12:20:20 PM INFO:Data already loaded in session state.
2025/03/01 12:20:23 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:20:23 PM INFO:Setting up the package
2025/03/01 12:20:23 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:20:23 PM INFO:get_git_version executed successfully
2025/03/01 12:20:23 PM INFO:Version: v20.116
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:init_state_var executed successfully
2025/03/01 12:20:23 PM INFO:Session_state variables initialized
2025/03/01 12:20:23 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:20:23 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:20:23 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:20:23 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:20:23 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:20:23 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:20:23 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:20:23 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:20:23 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:20:23 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:20:23 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:20:23 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:20:23 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:20:23 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:20:23 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:20:23 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:20:23 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:20:23 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:20:23 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:20:23 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:20:23 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:20:23 PM INFO:perc_target: 0.5
2025/03/01 12:20:23 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:20:23 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:20:23 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:20:23 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:20:23 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:20:23 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:20:23 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:20:23 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:20:23 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:20:23 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:20:23 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:20:23 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:20:23 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:20:23 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:20:23 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:20:23 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:20:23 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:20:23 PM INFO:menu_selection: {'title': 'Introduction', 'function': <function introduction_body at 0x000001AE4B51D120>}
2025/03/01 12:20:23 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:20:23 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:20:23 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:20:23 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:20:23 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:20:23 PM INFO:Session state Setup complete
2025/03/01 12:20:23 PM INFO:initialize_session_state executed successfully
2025/03/01 12:20:23 PM INFO:Package setup complete
2025/03/01 12:20:23 PM INFO:get_git_version executed successfully
2025/03/01 12:20:23 PM INFO:App Version: v20.131
2025/03/01 12:20:23 PM INFO:Switched to page: Introduction
2025/03/01 12:20:23 PM INFO:pagesetup executed successfully
2025/03/01 12:20:23 PM INFO:Data already loaded in session state.
2025/03/01 12:20:28 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:20:28 PM INFO:Setting up the package
2025/03/01 12:20:28 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:20:28 PM INFO:get_git_version executed successfully
2025/03/01 12:20:28 PM INFO:Version: v20.116
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:init_state_var executed successfully
2025/03/01 12:20:28 PM INFO:Session_state variables initialized
2025/03/01 12:20:28 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:20:28 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:20:28 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:20:28 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:20:28 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:20:28 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:20:28 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:20:28 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:20:28 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:20:28 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:20:28 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:20:28 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:20:28 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:20:28 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:20:28 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:20:28 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:20:28 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:20:28 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:20:28 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:20:28 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:20:28 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:20:28 PM INFO:perc_target: 0.5
2025/03/01 12:20:28 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:20:28 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:20:28 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:20:28 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:20:28 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:20:28 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:20:28 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:20:28 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:20:28 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:20:28 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:20:28 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:20:28 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:20:28 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:20:28 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:20:28 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:20:28 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:20:28 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:20:28 PM INFO:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits_page at 0x000001AE4C934220>}
2025/03/01 12:20:28 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:20:28 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:20:28 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:20:28 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:20:28 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:20:28 PM INFO:Session state Setup complete
2025/03/01 12:20:28 PM INFO:initialize_session_state executed successfully
2025/03/01 12:20:28 PM INFO:Package setup complete
2025/03/01 12:20:28 PM INFO:get_git_version executed successfully
2025/03/01 12:20:28 PM INFO:App Version: v20.131
2025/03/01 12:20:28 PM INFO:Switched to page: Paid Visits
2025/03/01 12:20:31 PM ERROR:Missing column: 'PartyName' in loaddata_df. Available columns: Index(['ECRef', 'OriginalRegulatedEntityName', 'RegulatedEntityType', 'Value',
       'AcceptedDate', 'AccountingUnitName', 'OriginalDonorName',
       'AccountingUnitsAsCentralParty', 'IsSponsorship', 'DonorStatus',
       'RegulatedDoneeType', 'CompanyRegistrationNumber', 'Postcode',
       'DonationType', 'NatureOfDonation', 'PurposeOfVisit', 'DonationAction',
       'ReceivedDate', 'ReportedDate', 'IsReportedPrePoll',
       'ReportingPeriodName', 'IsBequest', 'IsAggregation',
       'OriginalRegulatedEntityId', 'AccountingUnitId', 'OriginalDonorId',
       'CampaigningName', 'RegisterName', 'IsIrishSource',
       'CleanedRegulatedEntityId', 'CleanedRegulatedEntityName',
       'OriginalRegulatedEntityName', 'RegulatedEntityId',
       'RegulatedEntityName', 'CleanedDonorId', 'ParentDonorName',
       'CleanedDonorName', 'DonorStatus2', 'DonorId', 'DonorName',
       'EventCount', 'YearReceived', 'MonthReceived', 'YearMonthReceived'],
      dtype='object')
2025/03/01 12:20:31 PM INFO:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/01 12:20:31 PM INFO:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/01 12:20:31 PM INFO:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/01 12:20:31 PM INFO:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/01 12:20:31 PM INFO:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 46 columns]
2025/03/01 12:20:32 PM INFO:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 46 columns]
2025/03/01 12:20:32 PM INFO:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/01 12:20:32 PM INFO:Data Updated with PartyName and PartyId successfully
2025/03/01 12:20:32 PM INFO:map_mp_to_party executed successfully
2025/03/01 12:20:49 PM INFO:Cleaned Data completed, shape: (79737, 58)
2025/03/01 12:20:50 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:20:50 PM INFO:load_and_filter_data executed successfully
2025/03/01 12:20:50 PM INFO:display_summary_statistics executed successfully
2025/03/01 12:20:50 PM INFO:display_textual_insights executed successfully
2025/03/01 12:20:50 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:20:50 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:20:50 PM INFO:display_visualizations executed successfully
2025/03/01 12:20:50 PM INFO:display_data_page executed successfully
2025/03/01 12:20:50 PM INFO:pagesetup executed successfully
2025/03/01 12:20:50 PM INFO:Data already loaded in session state.
2025/03/01 12:20:54 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:20:54 PM INFO:Setting up the package
2025/03/01 12:20:54 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:20:54 PM INFO:get_git_version executed successfully
2025/03/01 12:20:54 PM INFO:Version: v20.116
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:init_state_var executed successfully
2025/03/01 12:20:54 PM INFO:Session_state variables initialized
2025/03/01 12:20:54 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:20:54 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:20:54 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:20:54 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:20:54 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:20:54 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:20:54 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:20:54 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:20:54 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:20:54 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:20:54 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:20:54 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:20:54 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:20:54 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:20:54 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:20:54 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:20:54 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:20:54 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:20:54 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:20:54 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:20:54 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:20:54 PM INFO:perc_target: 0.5
2025/03/01 12:20:54 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:20:54 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:20:54 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:20:54 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:20:54 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:20:54 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:20:54 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:20:54 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:20:54 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:20:54 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:20:54 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:20:54 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:20:54 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:20:54 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:20:54 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:20:54 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:20:54 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:20:54 PM INFO:menu_selection: {'title': 'Paid Visits per Entity', 'function': <function mod_visits_per_regulated_entity at 0x000001AE4C935620>}
2025/03/01 12:20:54 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:20:54 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:20:54 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:20:54 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:20:54 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:20:54 PM INFO:Session state Setup complete
2025/03/01 12:20:54 PM INFO:initialize_session_state executed successfully
2025/03/01 12:20:54 PM INFO:Package setup complete
2025/03/01 12:20:54 PM INFO:get_git_version executed successfully
2025/03/01 12:20:54 PM INFO:App Version: v20.131
2025/03/01 12:20:54 PM INFO:Switched to page: Paid Visits per Entity
2025/03/01 12:20:54 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:20:54 PM INFO:load_and_filter_pergroup executed successfully
2025/03/01 12:20:54 PM INFO:display_summary_statistics executed successfully
2025/03/01 12:20:54 PM INFO:display_textual_insights executed successfully
2025/03/01 12:20:54 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:20:55 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:20:55 PM INFO:display_visualizations executed successfully
2025/03/01 12:20:55 PM INFO:display_data_page executed successfully
2025/03/01 12:20:55 PM INFO:pagesetup executed successfully
2025/03/01 12:20:55 PM INFO:Data already loaded in session state.
2025/03/01 12:22:57 PM INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/01 12:22:57 PM INFO:get_git_version executed successfully
2025/03/01 12:22:57 PM INFO:get_git_version executed successfully
2025/03/01 12:22:57 PM INFO:get_git_version executed successfully
2025/03/01 12:22:57 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:22:57 PM INFO:Setting up the package
2025/03/01 12:22:57 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:22:57 PM INFO:get_git_version executed successfully
2025/03/01 12:22:57 PM INFO:Version: v20.116
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:init_state_var executed successfully
2025/03/01 12:22:57 PM INFO:Session_state variables initialized
2025/03/01 12:22:57 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:22:57 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:22:57 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:22:57 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:22:57 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:22:57 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:22:57 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:22:57 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:22:57 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:22:57 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:22:57 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:22:57 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:22:57 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:22:57 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:22:57 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:22:57 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:22:57 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:22:57 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:22:57 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:22:57 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:22:57 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:22:57 PM INFO:perc_target: 0.5
2025/03/01 12:22:57 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:22:57 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:22:57 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:22:57 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:22:57 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:22:57 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:22:57 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:22:57 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:22:57 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:22:57 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:22:57 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:22:57 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:22:57 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:22:57 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:22:57 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:22:57 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:22:57 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:22:57 PM INFO:menu_selection: {'title': 'Donors per Regulated Entity', 'function': <function mod_regulated_entity_per_donors_page at 0x000001AE4C935EE0>}
2025/03/01 12:22:57 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:22:57 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:22:57 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:22:57 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:22:57 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:22:57 PM INFO:Session state Setup complete
2025/03/01 12:22:58 PM INFO:initialize_session_state executed successfully
2025/03/01 12:22:58 PM INFO:Package setup complete
2025/03/01 12:22:58 PM INFO:get_git_version executed successfully
2025/03/01 12:22:58 PM INFO:get_git_version executed successfully
2025/03/01 12:22:58 PM INFO:App Version: v20.131
2025/03/01 12:22:58 PM INFO:Switched to page: Donors per Regulated Entity
2025/03/01 12:22:58 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:22:58 PM INFO:load_and_filter_pergroup executed successfully
2025/03/01 12:22:58 PM INFO:display_summary_statistics executed successfully
2025/03/01 12:22:58 PM INFO:display_textual_insights executed successfully
2025/03/01 12:22:59 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:22:59 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:22:59 PM INFO:display_visualizations executed successfully
2025/03/01 12:22:59 PM INFO:display_data_page executed successfully
2025/03/01 12:22:59 PM INFO:pagesetup executed successfully
2025/03/01 12:22:59 PM INFO:Data already loaded in session state.
2025/03/01 12:23:42 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:23:42 PM INFO:Setting up the package
2025/03/01 12:23:42 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:23:42 PM INFO:get_git_version executed successfully
2025/03/01 12:23:42 PM INFO:Version: v20.116
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:init_state_var executed successfully
2025/03/01 12:23:42 PM INFO:Session_state variables initialized
2025/03/01 12:23:42 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:23:42 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:23:42 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:23:42 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:23:42 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:23:42 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:23:42 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:23:42 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:23:42 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:23:42 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:23:42 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:23:42 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:23:42 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:23:42 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:23:42 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:23:42 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:23:42 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:23:42 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:23:42 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:23:42 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:23:42 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:23:42 PM INFO:perc_target: 0.5
2025/03/01 12:23:42 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:23:42 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:23:42 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:23:42 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:23:42 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:23:42 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:23:42 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:23:42 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:23:42 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:23:42 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:23:42 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:23:42 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:23:42 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:23:42 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:23:42 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:23:42 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:23:42 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:23:42 PM INFO:menu_selection: {'title': 'Dubious Donors per Regulated Entity', 'function': <function mod_dubious_donors_per_entity_page at 0x000001AE54EB8D60>}
2025/03/01 12:23:42 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:23:42 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:23:42 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:23:42 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:23:42 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:23:42 PM INFO:Session state Setup complete
2025/03/01 12:23:42 PM INFO:initialize_session_state executed successfully
2025/03/01 12:23:42 PM INFO:Package setup complete
2025/03/01 12:23:42 PM INFO:get_git_version executed successfully
2025/03/01 12:23:42 PM INFO:App Version: v20.131
2025/03/01 12:23:42 PM INFO:Switched to page: Dubious Donors per Regulated Entity
2025/03/01 12:23:42 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:23:43 PM INFO:load_and_filter_pergroup executed successfully
2025/03/01 12:23:43 PM INFO:display_summary_statistics executed successfully
2025/03/01 12:23:43 PM INFO:display_textual_insights executed successfully
2025/03/01 12:23:43 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:23:43 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:23:43 PM INFO:display_visualizations executed successfully
2025/03/01 12:23:43 PM INFO:display_data_page executed successfully
2025/03/01 12:23:43 PM INFO:pagesetup executed successfully
2025/03/01 12:23:43 PM INFO:Data already loaded in session state.
2025/03/01 12:23:49 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:23:49 PM INFO:Setting up the package
2025/03/01 12:23:49 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:23:49 PM INFO:get_git_version executed successfully
2025/03/01 12:23:49 PM INFO:Version: v20.116
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:init_state_var executed successfully
2025/03/01 12:23:49 PM INFO:Session_state variables initialized
2025/03/01 12:23:49 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:23:49 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:23:49 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:23:49 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:23:49 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:23:49 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:23:49 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:23:49 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:23:49 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:23:49 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:23:49 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:23:49 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:23:49 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:23:49 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:23:49 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:23:49 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:23:49 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:23:49 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:23:49 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:23:49 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:23:49 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:23:49 PM INFO:perc_target: 0.5
2025/03/01 12:23:49 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:23:49 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:23:49 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:23:49 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:23:49 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:23:49 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:23:49 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:23:49 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:23:49 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:23:49 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:23:49 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:23:49 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:23:49 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:23:49 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:23:49 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:23:49 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:23:49 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:23:49 PM INFO:menu_selection: {'title': 'Dubious Donations per Regulated Entity', 'function': <function mod_dubious_donations_per_entity_page at 0x000001AE54EB9120>}
2025/03/01 12:23:49 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:23:49 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:23:49 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:23:49 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:23:49 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:23:49 PM INFO:Session state Setup complete
2025/03/01 12:23:49 PM INFO:initialize_session_state executed successfully
2025/03/01 12:23:49 PM INFO:Package setup complete
2025/03/01 12:23:49 PM INFO:get_git_version executed successfully
2025/03/01 12:23:49 PM INFO:App Version: v20.131
2025/03/01 12:23:49 PM INFO:Switched to page: Dubious Donations per Regulated Entity
2025/03/01 12:23:49 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:23:50 PM INFO:load_and_filter_pergroup executed successfully
2025/03/01 12:23:50 PM INFO:display_summary_statistics executed successfully
2025/03/01 12:23:50 PM INFO:display_textual_insights executed successfully
2025/03/01 12:23:50 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:23:50 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:23:50 PM INFO:display_visualizations executed successfully
2025/03/01 12:23:50 PM INFO:display_data_page executed successfully
2025/03/01 12:23:50 PM INFO:pagesetup executed successfully
2025/03/01 12:23:50 PM INFO:Data already loaded in session state.
2025/03/01 12:23:54 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:23:54 PM INFO:Setting up the package
2025/03/01 12:23:54 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:23:54 PM INFO:get_git_version executed successfully
2025/03/01 12:23:54 PM INFO:Version: v20.116
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:init_state_var executed successfully
2025/03/01 12:23:54 PM INFO:Session_state variables initialized
2025/03/01 12:23:54 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:23:54 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:23:54 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:23:54 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:23:54 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:23:54 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:23:54 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:23:54 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:23:54 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:23:54 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:23:54 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:23:54 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:23:54 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:23:54 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:23:54 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:23:54 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:23:54 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:23:54 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:23:54 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:23:54 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:23:54 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:23:54 PM INFO:perc_target: 0.5
2025/03/01 12:23:54 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:23:54 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:23:54 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:23:54 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:23:54 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:23:54 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:23:54 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:23:54 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:23:54 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:23:54 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:23:54 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:23:54 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:23:54 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:23:54 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:23:54 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:23:54 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:23:54 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:23:54 PM INFO:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors_page at 0x000001AE54EB8CC0>}
2025/03/01 12:23:54 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:23:54 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:23:54 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:23:54 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:23:54 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:23:54 PM INFO:Session state Setup complete
2025/03/01 12:23:54 PM INFO:initialize_session_state executed successfully
2025/03/01 12:23:54 PM INFO:Package setup complete
2025/03/01 12:23:54 PM INFO:get_git_version executed successfully
2025/03/01 12:23:54 PM INFO:App Version: v20.131
2025/03/01 12:23:54 PM INFO:Switched to page: Dubious Donors
2025/03/01 12:23:55 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:23:55 PM INFO:load_and_filter_data executed successfully
2025/03/01 12:23:55 PM INFO:display_summary_statistics executed successfully
2025/03/01 12:23:55 PM INFO:display_textual_insights executed successfully
2025/03/01 12:23:55 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:23:55 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:23:55 PM INFO:display_visualizations executed successfully
2025/03/01 12:23:55 PM INFO:display_data_page executed successfully
2025/03/01 12:23:55 PM INFO:pagesetup executed successfully
2025/03/01 12:23:55 PM INFO:Data already loaded in session state.
2025/03/01 12:23:58 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:23:58 PM INFO:Setting up the package
2025/03/01 12:23:58 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:23:58 PM INFO:get_git_version executed successfully
2025/03/01 12:23:58 PM INFO:Version: v20.116
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:init_state_var executed successfully
2025/03/01 12:23:58 PM INFO:Session_state variables initialized
2025/03/01 12:23:58 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:23:58 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:23:58 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:23:58 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:23:58 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:23:58 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:23:58 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:23:58 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:23:58 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:23:58 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:23:58 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:23:58 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:23:58 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:23:58 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:23:58 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:23:58 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:23:58 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:23:58 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:23:58 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:23:58 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:23:58 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:23:58 PM INFO:perc_target: 0.5
2025/03/01 12:23:58 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:23:58 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:23:58 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:23:58 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:23:58 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:23:58 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:23:58 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:23:58 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:23:58 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:23:58 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:23:58 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:23:58 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:23:58 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:23:58 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:23:58 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:23:58 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:23:58 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:23:58 PM INFO:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations_page at 0x000001AE54EB91C0>}
2025/03/01 12:23:58 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:23:58 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:23:58 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:23:58 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:23:58 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:23:58 PM INFO:Session state Setup complete
2025/03/01 12:23:58 PM INFO:initialize_session_state executed successfully
2025/03/01 12:23:58 PM INFO:Package setup complete
2025/03/01 12:23:58 PM INFO:get_git_version executed successfully
2025/03/01 12:23:58 PM INFO:App Version: v20.131
2025/03/01 12:23:58 PM INFO:Switched to page: Dubious Donations
2025/03/01 12:23:58 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:23:58 PM INFO:load_and_filter_data executed successfully
2025/03/01 12:23:59 PM INFO:display_summary_statistics executed successfully
2025/03/01 12:23:59 PM INFO:display_textual_insights executed successfully
2025/03/01 12:23:59 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:23:59 PM INFO:plot_bar_line_by_year executed successfully
2025/03/01 12:23:59 PM INFO:display_visualizations executed successfully
2025/03/01 12:23:59 PM INFO:display_data_page executed successfully
2025/03/01 12:23:59 PM INFO:pagesetup executed successfully
2025/03/01 12:23:59 PM INFO:Data already loaded in session state.
2025/03/01 12:24:06 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:24:06 PM INFO:Setting up the package
2025/03/01 12:24:06 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:24:06 PM INFO:get_git_version executed successfully
2025/03/01 12:24:06 PM INFO:Version: v20.116
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:init_state_var executed successfully
2025/03/01 12:24:06 PM INFO:Session_state variables initialized
2025/03/01 12:24:06 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:24:06 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:24:06 PM INFO:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Féin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/01 12:24:06 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:24:06 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:24:06 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:24:06 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:24:06 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:24:06 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:24:06 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:24:06 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:24:06 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:24:06 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:24:06 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:24:06 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:24:06 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:24:06 PM INFO:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/01 12:24:06 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:24:06 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:24:06 PM INFO:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName                DonorStatus2  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party  Registered Political Party  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...                         ...      ...                              ...
66006   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...          Shaftesbury Investments                     Company  74198.0          Shaftesbury Investments
66007   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking                  Individual  74184.0                Mr Jeremy Hosking
66008   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                   Anthony Clarke                  Individual  23556.0                   Anthony Clarke
66009   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens                  Individual   2146.0                Mr Peter A Dubens
66010   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas                  Individual  74743.0                 Mr Ravi S Kailas

[66011 rows x 40 columns]
2025/03/01 12:24:06 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:24:06 PM INFO:perc_target: 0.5
2025/03/01 12:24:06 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:24:06 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:24:06 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:24:06 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:24:06 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:24:06 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:24:06 PM INFO:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0               Agents Training Trust         56000.00                3   18666.666667
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         38250.00                5    7650.000000
3            4.0        Branksome Liberal Club Trust        132991.78               28    4749.706429
4            5.0                    Bridgwater Trust         11200.00                5    2240.000000
...          ...                                 ...              ...              ...            ...
30284    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
30285  1000001.0             Not Recorded 1900-01-01         20000.00                3    6666.666667
30286  1000001.0             Not Recorded 1961-01-01         12908.00                3    4302.666667
30287  1000001.0             Not Recorded 1995-05-10         40876.38                3   13625.460000
30288  1000001.0                  Unidentified Donor       1127120.21              133    8474.588045

[30289 rows x 5 columns]
2025/03/01 12:24:06 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:24:06 PM INFO:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WeeksTillNextElection WeeksSinceLastElection QuartersTillNextElection QuartersSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                    15                   4710                        2                       363
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                    15                   4710                        2                       363
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                    15                   4710                        2                       363
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                    15                   4710                        2                       363
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                    15                   4709                        2                       363
...          ...                              ...                    ...        ...  ...                   ...                    ...                      ...                       ...
79732   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                    62                   4532                        5                       349
79733   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                    70                   4524                        6                       348
79734   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    51                   4543                        4                       350
79735   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                     2                   4591                        1                       354
79736   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                     2                   4592                        1                       354

[79737 rows x 58 columns]
2025/03/01 12:24:06 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:24:06 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:24:06 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:24:06 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:24:06 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:24:06 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:24:06 PM INFO:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/01 12:24:06 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:24:06 PM INFO:menu_selection: {'title': 'Corporate Donations by Donor', 'function': <function mod_corporate_donations_per_donor_page at 0x000001AE54EB9260>}
2025/03/01 12:24:06 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:24:06 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:24:06 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:24:06 PM INFO:data_party_sum:              RegulatedEntityName  DonationsValue  DonationEvents  DonationMean         RegEntity_Group
0     A Minority Pastime Limited         6612.00               1   6612.000000  Single Donation Entity
1                    A. A. Craig        12100.00              11   1100.000000            Small Entity
2                Abisola Ifasawo         1650.00               1   1650.000000  Single Donation Entity
3                  Adam Holloway        31341.00              11   2849.181818            Small Entity
4                    Adam Ingram         5245.20               1   5245.200000  Single Donation Entity
...                          ...             ...             ...           ...                     ...
1356   Young Britons' Foundation        54999.00               2  27499.500000       Very Small Entity
1357               Yvette Cooper       545172.31              49  11125.965510     Small Medium Entity
1358             Yvonne Fovargue         6758.06               2   3379.030000       Very Small Entity
1359               Zac Goldsmith        50000.00               1  50000.000000  Single Donation Entity
1360              Órlaithí Flynn        10000.00               1  10000.000000  Single Donation Entity

[1361 rows x 5 columns]
2025/03/01 12:24:06 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:24:06 PM INFO:Session state Setup complete
2025/03/01 12:24:06 PM INFO:initialize_session_state executed successfully
2025/03/01 12:24:06 PM INFO:Package setup complete
2025/03/01 12:24:06 PM INFO:get_git_version executed successfully
2025/03/01 12:24:06 PM INFO:App Version: v20.131
2025/03/01 12:24:06 PM INFO:Switched to page: Corporate Donations by Donor
2025/03/01 12:24:06 PM INFO:load_cleaned_data executed successfully
2025/03/01 12:24:07 PM INFO:load_and_filter_perentity executed successfully
2025/03/01 12:24:07 PM ERROR:Error in display_data_page: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_entity.py", line 21, in display_data_page
    cleaned_df, filtered_df = load_and_filter_perentity(
    ^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)
2025/03/01 12:24:07 PM ERROR:Error in pagesetup: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
    ^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
    ^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 76, in mod_corporate_donations_per_donor_page
    display_per_entity_data_page("CorporateDonations_ftr",
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_entity.py", line 21, in display_data_page
    cleaned_df, filtered_df = load_and_filter_perentity(
    ^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)
2025/03/01 12:24:07 PM CRITICAL:Menu setup crashed: too many values to unpack (expected 2)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 65, in pagesetup
    app.run()  # Run the  app
    ^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 45, in run
    page["function"]()  # Run the selected page's function
    ^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 76, in mod_corporate_donations_per_donor_page
    display_per_entity_data_page("CorporateDonations_ftr",
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_entity.py", line 21, in display_data_page
    cleaned_df, filtered_df = load_and_filter_perentity(
    ^^^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)
2025/03/01 12:28:40 PM INFO:Logging is set up correctly! Current log level: INFO
2025/03/01 12:28:41 PM INFO:get_git_version executed successfully
2025/03/01 12:28:41 PM INFO:get_git_version executed successfully
2025/03/01 12:28:42 PM INFO:get_git_version executed successfully
2025/03/01 12:28:42 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:28:42 PM INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/01 12:28:42 PM INFO:Setting up the package
2025/03/01 12:28:42 PM INFO:Setting up the package
2025/03/01 12:28:42 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:28:42 PM INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/01 12:28:42 PM INFO:get_git_version executed successfully
2025/03/01 12:28:42 PM INFO:get_git_version executed successfully
2025/03/01 12:28:42 PM INFO:Version: v20.116
2025/03/01 12:28:42 PM INFO:Version: v20.116
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:init_state_var executed successfully
2025/03/01 12:28:42 PM INFO:Session_state variables initialized
2025/03/01 12:28:42 PM INFO:Session_state variables initialized
2025/03/01 12:28:42 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:28:42 PM INFO:CREDENTIALS_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_credentials.json
2025/03/01 12:28:42 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:28:42 PM INFO:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/01 12:28:42 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:28:42 PM INFO:party_summary_fname: H:\VScode\dashboard_demo-1\output\party_summary.csv
2025/03/01 12:28:42 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:28:42 PM INFO:cleaned_regentity_fname: H:\VScode\dashboard_demo-1\output\cleaned_regentity.csv
2025/03/01 12:28:42 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:28:42 PM INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/01 12:28:42 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:28:42 PM INFO:output_dir: H:\VScode\dashboard_demo-1\output
2025/03/01 12:28:42 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:28:42 PM INFO:ec_donations_fname: Donations_accepted_by_political_parties.csv
2025/03/01 12:28:42 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:28:42 PM INFO:directories: {'base_dir': 'H:\\VScode\\dashboard_demo-1', 'data_dir': 'H:\\VScode\\dashboard_demo-1\\data', 'output_dir': 'H:\\VScode\\dashboard_demo-1\\output', 'logs_dir': 'H:\\VScode\\dashboard_demo-1\\logs', 'reference_dir': 'H:\\VScode\\dashboard_demo-1\\reference_files', 'components_dir': 'H:\\VScode\\dashboard_demo-1\\components', 'app_pages_dir': 'H:\\VScode\\dashboard_demo-1\\app_pages', 'utils_dir': 'H:\\VScode\\dashboard_demo-1\\utils'}
2025/03/01 12:28:42 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:28:42 PM INFO:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/01 12:28:42 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:28:42 PM INFO:potential_donor_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_donor_duplicates.csv
2025/03/01 12:28:42 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:28:42 PM INFO:logs_dir: H:\VScode\dashboard_demo-1\logs
2025/03/01 12:28:42 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:28:42 PM INFO:mppartymemb_fname: H:\VScode\dashboard_demo-1\reference_files\mppartymemb_pypd.csv
2025/03/01 12:28:42 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:28:42 PM INFO:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeDuped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'potential_donor_duplicates_fname': 'potential_donor_duplicates.csv', 'potential_regulatedentity_duplicates_fname': 'potential_regentiity_duplicates.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv'}, 'BASE_DIR': {'ec_donations_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/01 12:28:42 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:28:42 PM INFO:PLACEHOLDER_ID: 1000001
2025/03/01 12:28:42 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:28:42 PM INFO:politician_party_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople_Final.csv
2025/03/01 12:28:42 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:28:42 PM INFO:potential_regulatedentity_duplicates_fname: H:\VScode\dashboard_demo-1\reference_files\potential_regentiity_duplicates.csv
2025/03/01 12:28:42 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:28:42 PM INFO:TEXT_FILE: H:\VScode\dashboard_demo-1\reference_files\admin_text.json
2025/03/01 12:28:42 PM INFO:perc_target: 0.5
2025/03/01 12:28:42 PM INFO:perc_target: 0.5
2025/03/01 12:28:42 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:28:42 PM INFO:reference_dir: H:\VScode\dashboard_demo-1\reference_files
2025/03/01 12:28:42 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:28:42 PM INFO:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': ['1000001', None, 1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': ['1000001', None, 1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorType': 'Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/01 12:28:42 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:28:42 PM INFO:LOG_LEVEL: DEBUG
2025/03/01 12:28:42 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:28:42 PM INFO:cleaned_donorlist_fname: H:\VScode\dashboard_demo-1\output\cleaned_donorlist.csv
2025/03/01 12:28:42 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:28:42 PM INFO:app_pages_dir: H:\VScode\dashboard_demo-1\app_pages
2025/03/01 12:28:42 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:28:42 PM INFO:utils_dir: H:\VScode\dashboard_demo-1\utils
2025/03/01 12:28:42 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:28:42 PM INFO:original_data_fname: H:\VScode\dashboard_demo-1\reference_files\original_data.csv
2025/03/01 12:28:42 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:28:42 PM INFO:cleaned_data_fname: H:\VScode\dashboard_demo-1\output\cleaned_data.csv
2025/03/01 12:28:42 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:28:42 PM INFO:components_dir: H:\VScode\dashboard_demo-1\components
2025/03/01 12:28:42 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:28:42 PM INFO:data_dir: H:\VScode\dashboard_demo-1\data
2025/03/01 12:28:42 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:28:42 PM INFO:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/01 12:28:42 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:28:42 PM INFO:regentity_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalEntityDeDuped.csv
2025/03/01 12:28:42 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:28:42 PM INFO:Cash_ftr: {'DonationType': 'Cash'}
2025/03/01 12:28:42 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:28:42 PM INFO:ListofPoliticalPeople_fname: H:\VScode\dashboard_demo-1\reference_files\ListOfPoliticalPeople.csv
2025/03/01 12:28:42 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:28:42 PM INFO:donor_map_fname: H:\VScode\dashboard_demo-1\reference_files\PoliticalDonorsDeDuped.csv
2025/03/01 12:28:42 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:28:42 PM INFO:Donor_dedupe_cleaned_fname: H:\VScode\dashboard_demo-1\reference_files\Donor_dedupe_cleaned_data.csv
2025/03/01 12:28:42 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:28:42 PM INFO:cleaned_donations_fname: H:\VScode\dashboard_demo-1\output\cleaned_donations.csv
2025/03/01 12:28:42 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:28:42 PM INFO:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/01 12:28:42 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:28:42 PM INFO:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/01 12:28:42 PM INFO:Session state Setup complete
2025/03/01 12:28:42 PM INFO:Session state Setup complete
2025/03/01 12:28:42 PM INFO:initialize_session_state executed successfully
2025/03/01 12:28:42 PM INFO:initialize_session_state executed successfully
2025/03/01 12:28:42 PM INFO:Package setup complete
2025/03/01 12:28:42 PM INFO:Package setup complete
2025/03/01 12:28:42 PM INFO:get_git_version executed successfully
2025/03/01 12:28:43 PM ERROR:Error in pagesetup: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
2025/03/01 12:28:43 PM ERROR:Error in pagesetup: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
2025/03/01 12:28:43 PM CRITICAL:Menu setup crashed: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
2025/03/01 12:28:43 PM CRITICAL:Menu setup crashed: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 37, in wrapper
    raise e
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 32, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 36, in pagesetup
    app = MultiPage(app_name="UK Political Donations")  # Create an instance
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 14, in __init__
    st.set_page_config(
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\metrics_util.py", line 410, in wrapped_func
    result = non_optional_func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\commands\page_config.py", line 274, in set_page_config
    ctx.enqueue(msg)
  File "h:\VScode\dashboard_demo-1\.venv\Lib\site-packages\streamlit\runtime\scriptrunner_utils\script_run_context.py", line 179, in enqueue
    raise StreamlitSetPageConfigMustBeFirstCommandError()
streamlit.errors.StreamlitSetPageConfigMustBeFirstCommandError: `set_page_config()` can only be called once per app page, and must be called as the first Streamlit command in your script.

For more information refer to the [docs](https://docs.streamlit.io/develop/api-reference/configuration/st.set_page_config).
