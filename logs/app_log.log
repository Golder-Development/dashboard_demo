2025/03/04 04:26 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/04 04:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:get_git_version executed successfully
2025/03/04 04:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:get_git_version executed successfully
2025/03/04 04:26 INFO:Streamlit App Starting...
2025/03/04 04:26 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/04 04:26 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/04 04:26 INFO:Running App setup...
2025/03/04 04:26 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Setting up the package
2025/03/04 04:26 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/04 04:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:get_git_version executed successfully
2025/03/04 04:26 INFO:Version: v20.145
2025/03/04 04:26 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 04:26 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/04 04:26 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/04 04:26 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 04:26 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/04 04:26 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/04 04:26 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 04:26 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 04:26 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 04:26 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 04:26 DEBUG:Initialised perc_target with value: 0.5
2025/03/04 04:26 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/04 04:26 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 04:26 DEBUG:Initialised reference_dir with value: reference_files
2025/03/04 04:26 DEBUG:Initialised data_dir with value: data
2025/03/04 04:26 DEBUG:Initialised output_dir with value: output
2025/03/04 04:26 DEBUG:Initialised logs_dir with value: logs
2025/03/04 04:26 DEBUG:Initialised components_dir with value: components
2025/03/04 04:26 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/04 04:26 DEBUG:Initialised utils_dir with value: utils
2025/03/04 04:26 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 04:26 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/04 04:26 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/04 04:26 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 04:26 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 04:26 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 04:26 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/04 04:26 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/04 04:26 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/04 04:26 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/04 04:26 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/04 04:26 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/04 04:26 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/04 04:26 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/04 04:26 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/04 04:26 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/04 04:26 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/04 04:26 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/04 04:26 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/04 04:26 INFO:Session_state variables initialized
2025/03/04 04:26 DEBUG:app_pages_dir: app_pages
2025/03/04 04:26 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/04 04:26 DEBUG:perc_target: 0.5
2025/03/04 04:26 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/04 04:26 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/04 04:26 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/04 04:26 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/04 04:26 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/04 04:26 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/04 04:26 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/04 04:26 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/04 04:26 DEBUG:output_dir: output
2025/03/04 04:26 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/04 04:26 DEBUG:utils_dir: utils
2025/03/04 04:26 DEBUG:logs_dir: logs
2025/03/04 04:26 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/04 04:26 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/04 04:26 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/04 04:26 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/04 04:26 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/04 04:26 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/04 04:26 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/04 04:26 DEBUG:data_dir: data
2025/03/04 04:26 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/04 04:26 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/04 04:26 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/04 04:26 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/04 04:26 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/04 04:26 DEBUG:components_dir: components
2025/03/04 04:26 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/04 04:26 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/04 04:26 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/04 04:26 DEBUG:reference_dir: reference_files
2025/03/04 04:26 DEBUG:LOG_LEVEL: ERROR
2025/03/04 04:26 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/04 04:26 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/04 04:26 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/04 04:26 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/04 04:26 INFO:Session state Setup complete
2025/03/04 04:26 INFO:initialize_session_state executed successfully
2025/03/04 04:26 INFO:Package setup complete
2025/03/04 04:26 INFO:setup_package executed successfully
2025/03/04 04:26 INFO:Setup completed successfully.
2025/03/04 04:26 INFO:Running Menu setup...
2025/03/04 04:26 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:get_git_version executed successfully
2025/03/04 04:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:get_git_version executed successfully
2025/03/04 04:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:get_git_version executed successfully
2025/03/04 04:26 INFO:App Version: v20.166
2025/03/04 04:26 INFO:Switched to page: Introduction
2025/03/04 04:26 INFO:pagesetup executed successfully
2025/03/04 04:26 INFO:Menu setup completed successfully.
2025/03/04 04:26 INFO:No data found in session state, running firstload()
2025/03/04 04:26 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Running first load function.
2025/03/04 04:26 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/04 04:26 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/04 04:26 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 04:26 INFO:Saved file path: output\imported_raw.csv
2025/03/04 04:26 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 04:26 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 04:26 INFO:get_file_modification_time executed successfully
2025/03/04 04:26 INFO:Current modification time: 1740757862.6744745
2025/03/04 04:26 INFO:Last modification time: None
2025/03/04 04:26 INFO:is_file_updated executed successfully
2025/03/04 04:26 INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 04:26 INFO:Loading raw data...
2025/03/04 04:26 DEBUG:Original data file path post raw data load: {originaldatafilepath}
2025/03/04 04:26 DEBUG:Processed data file path post raw data load: {processeddatafilepath}
2025/03/04 04:26 INFO:Data loaded successfully. Data has 65278 rows and 29 columns
2025/03/04 04:26 INFO:Data saved to output\imported_raw.csv
2025/03/04 04:26 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Cleaning up raw data
2025/03/04 04:26 ERROR:Session state variables not initialized!
2025/03/04 04:26 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Original file path: None
2025/03/04 04:26 INFO:Saved file path: output\cleaned_donations.csv
2025/03/04 04:26 ERROR:Error: originalfilepath is None!
2025/03/04 04:26 INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 04:26 INFO:Data loaded, shape: (65278, 29)
2025/03/04 04:26 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/04 04:26 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/04 04:26 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/04 04:26 INFO:File deduplication complete, shape: (65278, 33)
2025/03/04 04:26 INFO:dedupe_entity_file executed successfully
2025/03/04 04:26 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/04 04:26 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/04 04:26 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/04 04:26 INFO:File deduplication complete, shape: (65278, 37)
2025/03/04 04:26 INFO:dedupe_entity_file executed successfully
2025/03/04 04:26 INFO:Raw Data cleanup completed
2025/03/04 04:26 INFO:Data shape: (65278, 37)
2025/03/04 04:26 INFO:Data saved to output\cleaned_donations.csv
2025/03/04 04:26 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/04 04:26 INFO:raw_data_cleanup executed successfully
2025/03/04 04:26 INFO:load_raw_data executed successfully
2025/03/04 04:26 INFO:get_raw_data executed successfully
2025/03/04 04:26 INFO:load_data_to_session executed successfully
2025/03/04 04:26 DEBUG:st.session_state.raw_data: 65278
2025/03/04 04:26 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Rows in Raw Data: 65278
2025/03/04 04:26 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Original file path: output\cleaned_donations.csv
2025/03/04 04:26 INFO:Saved file path: output\cleaned_data.csv
2025/03/04 04:26 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/04 04:26 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/04 04:26 INFO:get_file_modification_time executed successfully
2025/03/04 04:26 INFO:Current modification time: 1741105593.3717692
2025/03/04 04:26 INFO:Last modification time: 1740757862.6744745
2025/03/04 04:26 INFO:is_file_updated executed successfully
2025/03/04 04:26 INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 04:26 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/04 04:26 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/04 04:26 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/04 04:26 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/04 04:26 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/04 04:26 DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/04 04:26 DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/04 04:26 DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/04 04:26 DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/04 04:26 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/04 04:26 ERROR:Attempting to remove duplicates
2025/03/04 04:26 DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 43 columns]
2025/03/04 04:26 DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/04 04:26 INFO:Data Updated with PartyName and PartyId successfully
2025/03/04 04:26 INFO:map_mp_to_party executed successfully
2025/03/04 04:26 DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/04 04:26 DEBUG:Group assignment: group
RegulatedEntityName       53528
Small Medium Entity        4430
Small Entity               2251
Very Small Entity          1492
Medium Large Entity        1203
Large Entity               1194
Medium Entity               694
Single Donation Entity      486
Name: count, dtype: int64
2025/03/04 04:26 DEBUG:Group assignment: group
Very Small Entity         491
Single Donation Entity    486
Small Entity              241
Small Medium Entity       127
Medium Entity               5
RegulatedEntityName         5
Medium Large Entity         4
Large Entity                2
Name: count, dtype: int64
2025/03/04 04:26 DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/04 04:26 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/04 04:26 DEBUG:try to load previous election dates from file.
2025/03/04 04:26 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/04 04:26 INFO:Saved file path: reference_files\elections.csv
2025/03/04 04:26 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/04 04:26 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/04 04:26 INFO:get_file_modification_time executed successfully
2025/03/04 04:26 INFO:Current modification time: 1740757862.6744745
2025/03/04 04:26 INFO:Last modification time: None
2025/03/04 04:26 INFO:is_file_updated executed successfully
2025/03/04 04:26 INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 04:26 ERROR:Failed to load election dates from file.
2025/03/04 04:26 INFO:Election_dates_df empty - loading from pdpy.
2025/03/04 04:26 INFO:Election Dates loaded vis pdpy.
2025/03/04 04:26 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/04 04:26 INFO:Election Dates Loaded Successfully.
2025/03/04 04:26 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/04 04:26 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/04 04:26 INFO:load_election_dates executed successfully
2025/03/04 04:26 DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/04 04:26 DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/04 04:26 INFO:Cleaned Data completed, shape: (65278, 57)
2025/03/04 04:26 INFO:load_cleaned_data executed successfully
2025/03/04 04:26 INFO:get_cleaned_data executed successfully
2025/03/04 04:26 INFO:load_data_to_session executed successfully
2025/03/04 04:26 DEBUG:st.session_state.raw_data: 65278
2025/03/04 04:26 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Original file path: output\cleaned_data.csv
2025/03/04 04:26 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/04 04:26 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 04:26 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 04:26 INFO:get_file_modification_time executed successfully
2025/03/04 04:26 INFO:Current modification time: 1741105598.5723538
2025/03/04 04:26 INFO:Last modification time: None
2025/03/04 04:26 INFO:is_file_updated executed successfully
2025/03/04 04:26 INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 04:26 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/04 04:26 INFO:Donor Data summary completed
2025/03/04 04:26 INFO:Data shape: (25576, 5)
2025/03/04 04:26 INFO:load_donorList_data executed successfully
2025/03/04 04:26 INFO:get_donor_data executed successfully
2025/03/04 04:26 INFO:load_data_to_session executed successfully
2025/03/04 04:26 DEBUG:st.session_state.data_donor: 25576
2025/03/04 04:26 DEBUG:st.session_state.data_clean: 65278
2025/03/04 04:26 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Original file path: output\cleaned_data.csv
2025/03/04 04:26 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/04 04:26 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/04 04:26 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/04 04:26 INFO:Getting modification time for output\cleaned_data.csv
2025/03/04 04:26 INFO:get_file_modification_time executed successfully
2025/03/04 04:26 INFO:Current modification time: 1741105598.5723538
2025/03/04 04:26 INFO:Last modification time: 1741105598.5723538
2025/03/04 04:26 INFO:is_file_updated executed successfully
2025/03/04 04:26 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/04 04:26 INFO:try_to_use_preprocessed_data executed successfully
2025/03/04 04:26 INFO:load_regulated_entity_data executed successfully
2025/03/04 04:26 INFO:get_regentity_data executed successfully
2025/03/04 04:26 INFO:load_data_to_session executed successfully
2025/03/04 04:26 DEBUG:st.session_state.data_regentity: 1364
2025/03/04 04:26 DEBUG:st.session_state.data_donor: 25576
2025/03/04 04:26 DEBUG:st.session_state.data_clean: 65278
2025/03/04 04:26 INFO:firstload executed successfully
2025/03/04 04:26 INFO:Data first load completed successfully.
2025/03/04 04:26 INFO:initialise_data executed successfully
2025/03/04 04:26 INFO:App is fully loaded and ready!
2025/03/05 08:06 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 08:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:get_git_version executed successfully
2025/03/05 08:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:get_git_version executed successfully
2025/03/05 08:06 INFO:Streamlit App Starting...
2025/03/05 08:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 08:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 08:06 INFO:Running App setup...
2025/03/05 08:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Setting up the package
2025/03/05 08:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 08:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:get_git_version executed successfully
2025/03/05 08:06 INFO:Version: v20.145
2025/03/05 08:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:06 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 08:06 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 08:06 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 08:06 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 08:06 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 08:06 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 08:06 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 08:06 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 08:06 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 08:06 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 08:06 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 08:06 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 08:06 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 08:06 DEBUG:Initialised data_dir with value: data
2025/03/05 08:06 DEBUG:Initialised output_dir with value: output
2025/03/05 08:06 DEBUG:Initialised logs_dir with value: logs
2025/03/05 08:06 DEBUG:Initialised components_dir with value: components
2025/03/05 08:06 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 08:06 DEBUG:Initialised utils_dir with value: utils
2025/03/05 08:06 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 08:06 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 08:06 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 08:06 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 08:06 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 08:06 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 08:06 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 08:06 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 08:06 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 08:06 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 08:06 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 08:06 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 08:06 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 08:06 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 08:06 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 08:06 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 08:06 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 08:06 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:06 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 08:06 INFO:Session_state variables initialized
2025/03/05 08:06 DEBUG:utils_dir: utils
2025/03/05 08:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 08:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 08:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 08:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 08:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 08:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 08:06 DEBUG:logs_dir: logs
2025/03/05 08:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 08:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 08:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 08:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 08:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 08:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 08:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 08:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 08:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 08:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 08:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 08:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 08:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 08:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 08:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 08:06 DEBUG:data_dir: data
2025/03/05 08:06 DEBUG:app_pages_dir: app_pages
2025/03/05 08:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 08:06 DEBUG:output_dir: output
2025/03/05 08:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 08:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 08:06 DEBUG:reference_dir: reference_files
2025/03/05 08:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 08:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 08:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 08:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:06 DEBUG:components_dir: components
2025/03/05 08:06 DEBUG:perc_target: 0.5
2025/03/05 08:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 08:06 INFO:Session state Setup complete
2025/03/05 08:06 INFO:initialize_session_state executed successfully
2025/03/05 08:06 INFO:Package setup complete
2025/03/05 08:06 INFO:setup_package executed successfully
2025/03/05 08:06 INFO:Setup completed successfully.
2025/03/05 08:06 INFO:Running Menu setup...
2025/03/05 08:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:get_git_version executed successfully
2025/03/05 08:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:get_git_version executed successfully
2025/03/05 08:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:get_git_version executed successfully
2025/03/05 08:06 INFO:App Version: v20.166
2025/03/05 08:06 INFO:Switched to page: Introduction
2025/03/05 08:06 INFO:pagesetup executed successfully
2025/03/05 08:06 INFO:Menu setup completed successfully.
2025/03/05 08:06 INFO:No data found in session state, running firstload()
2025/03/05 08:06 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Running first load function.
2025/03/05 08:06 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 08:06 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 08:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:06 INFO:Saved file path: output\imported_raw.csv
2025/03/05 08:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 08:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 08:06 INFO:get_file_modification_time executed successfully
2025/03/05 08:06 INFO:Current modification time: 1740757862.6744745
2025/03/05 08:06 INFO:Last modification time: 1741105593.3717692
2025/03/05 08:06 INFO:is_file_updated executed successfully
2025/03/05 08:06 INFO:Loading preprocessed data. Using output\imported_raw.csv dated load_raw_data_last_modified instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 08:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 08:06 INFO:load_raw_data executed successfully
2025/03/05 08:06 INFO:get_raw_data executed successfully
2025/03/05 08:06 INFO:load_data_to_session executed successfully
2025/03/05 08:06 DEBUG:st.session_state.raw_data: 65278
2025/03/05 08:06 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Rows in Raw Data: 65278
2025/03/05 08:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 08:06 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 08:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 08:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 08:06 INFO:get_file_modification_time executed successfully
2025/03/05 08:06 INFO:Current modification time: 1741105593.3717692
2025/03/05 08:06 INFO:Last modification time: 1741105593.3717692
2025/03/05 08:06 INFO:is_file_updated executed successfully
2025/03/05 08:06 INFO:Loading preprocessed data. Using output\cleaned_data.csv dated load_raw_data_last_modified instead of output\cleaned_donations.csv
2025/03/05 08:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 08:06 INFO:load_cleaned_data executed successfully
2025/03/05 08:06 INFO:get_cleaned_data executed successfully
2025/03/05 08:06 INFO:load_data_to_session executed successfully
2025/03/05 08:06 DEBUG:st.session_state.raw_data: 65278
2025/03/05 08:06 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Original file path: output\cleaned_data.csv
2025/03/05 08:06 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 08:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 08:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 08:06 INFO:get_file_modification_time executed successfully
2025/03/05 08:06 INFO:Current modification time: 1741105598.5723538
2025/03/05 08:06 INFO:Last modification time: 1741105598.5723538
2025/03/05 08:06 INFO:is_file_updated executed successfully
2025/03/05 08:06 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/05 08:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 08:06 INFO:load_donorList_data executed successfully
2025/03/05 08:06 INFO:get_donor_data executed successfully
2025/03/05 08:06 INFO:load_data_to_session executed successfully
2025/03/05 08:06 DEBUG:st.session_state.data_donor: 25576
2025/03/05 08:06 DEBUG:st.session_state.data_clean: 65278
2025/03/05 08:06 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Original file path: output\cleaned_data.csv
2025/03/05 08:06 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 08:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 08:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 08:06 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 08:06 INFO:get_file_modification_time executed successfully
2025/03/05 08:06 INFO:Current modification time: 1741105598.5723538
2025/03/05 08:06 INFO:Last modification time: 1741105598.5723538
2025/03/05 08:06 INFO:is_file_updated executed successfully
2025/03/05 08:06 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/05 08:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 08:06 INFO:load_regulated_entity_data executed successfully
2025/03/05 08:06 INFO:get_regentity_data executed successfully
2025/03/05 08:06 INFO:load_data_to_session executed successfully
2025/03/05 08:06 DEBUG:st.session_state.data_regentity: 1364
2025/03/05 08:06 DEBUG:st.session_state.data_donor: 25576
2025/03/05 08:06 DEBUG:st.session_state.data_clean: 65278
2025/03/05 08:06 INFO:firstload executed successfully
2025/03/05 08:06 INFO:Data first load completed successfully.
2025/03/05 08:06 INFO:initialise_data executed successfully
2025/03/05 08:06 INFO:App is fully loaded and ready!
2025/03/05 08:07 INFO:Streamlit App Starting...
2025/03/05 08:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 08:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 08:07 INFO:Running App setup...
2025/03/05 08:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Setting up the package
2025/03/05 08:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 INFO:Version: v20.145
2025/03/05 08:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 08:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 08:07 DEBUG:filenames already exists in session state
2025/03/05 08:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 08:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 08:07 DEBUG:thresholds already exists in session state
2025/03/05 08:07 DEBUG:data_remappings already exists in session state
2025/03/05 08:07 DEBUG:filter_def already exists in session state
2025/03/05 08:07 DEBUG:security already exists in session state
2025/03/05 08:07 DEBUG:perc_target already exists in session state
2025/03/05 08:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 08:07 DEBUG:directories already exists in session state
2025/03/05 08:07 DEBUG:reference_dir already exists in session state
2025/03/05 08:07 DEBUG:data_dir already exists in session state
2025/03/05 08:07 DEBUG:output_dir already exists in session state
2025/03/05 08:07 DEBUG:logs_dir already exists in session state
2025/03/05 08:07 DEBUG:components_dir already exists in session state
2025/03/05 08:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 08:07 DEBUG:utils_dir already exists in session state
2025/03/05 08:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 08:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 08:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 08:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 08:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 08:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 08:07 DEBUG:original_data_fname already exists in session state
2025/03/05 08:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 08:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 08:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 08:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 08:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 08:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 08:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 08:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 08:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 08:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 08:07 DEBUG:source_data_fname already exists in session state
2025/03/05 08:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 08:07 INFO:Session_state variables initialized
2025/03/05 08:07 DEBUG:utils_dir: utils
2025/03/05 08:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 08:07 DEBUG:data_clean:        Unnamed: 0      ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WksSinceLastElection  QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0               0  NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...               4710.0                   2.0                 363.0                 1.0                 91.0
1               1  NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
2               2  NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...               4710.0                   2.0                 363.0                 1.0                 91.0
3               3  NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
4               4  NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...               4709.0                   2.0                 363.0                 1.0                 91.0
...           ...        ...                              ...                    ...        ...  ...                  ...                   ...                   ...                 ...                  ...
65273       78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...               4532.0                   5.0                 349.0                 2.0                 87.0
65274       78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...               4524.0                   6.0                 348.0                 2.0                 87.0
65275       78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...               4543.0                   4.0                 350.0                 1.0                 88.0
65276       78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...               4591.0                   1.0                 354.0                 1.0                 89.0
65277       78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...               4592.0                   1.0                 354.0                 1.0                 89.0

[65278 rows x 58 columns]
2025/03/05 08:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 08:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 08:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 08:07 DEBUG:raw_data:        index      ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... RegulatedEntityId AccountingUnitId  DonorId  CampaigningName   RegisterName IsIrishSource
0          0  NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
1          1  NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
2          2  NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
3          3  NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
4          4  NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
...      ...        ...                              ...                    ...          ...          ...  ...               ...              ...      ...              ...            ...           ...
65273  65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              3945              NaN  74198.0              NaN            NaN         False
65274  65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              3945              NaN  74184.0              NaN            NaN         False
65275  65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              3945              NaN  74576.0              NaN            NaN         False
65276  65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...                52              NaN  34241.0              NaN  Great Britain         False
65277  65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...                52              NaN  74743.0              NaN  Great Britain         False

[65278 rows x 30 columns]
2025/03/05 08:07 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000016EA958EC20>}
2025/03/05 08:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 08:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 08:07 DEBUG:logs_dir: logs
2025/03/05 08:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 08:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 08:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 08:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 08:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 08:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 08:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 08:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 08:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 08:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 08:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 08:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 08:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 08:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 08:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 08:07 DEBUG:data_dir: data
2025/03/05 08:07 DEBUG:app_pages_dir: app_pages
2025/03/05 08:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 08:07 DEBUG:output_dir: output
2025/03/05 08:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 08:07 DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Fin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/05 08:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 08:07 DEBUG:reference_dir: reference_files
2025/03/05 08:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 08:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 08:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 08:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:components_dir: components
2025/03/05 08:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 08:07 DEBUG:perc_target: 0.5
2025/03/05 08:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 08:07 INFO:Session state Setup complete
2025/03/05 08:07 INFO:initialize_session_state executed successfully
2025/03/05 08:07 INFO:Package setup complete
2025/03/05 08:07 INFO:setup_package executed successfully
2025/03/05 08:07 INFO:Setup completed successfully.
2025/03/05 08:07 INFO:Running Menu setup...
2025/03/05 08:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 INFO:App Version: v20.166
2025/03/05 08:07 INFO:Switched to page: Head Line Figures
2025/03/05 08:07 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 ERROR:Error in load_and_filter_data: 'str' object has no attribute 'date'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 29, in load_and_filter_data
    min_date = get_mindate(cleaned_df).date()
AttributeError: 'str' object has no attribute 'date'
2025/03/05 08:07 CRITICAL:Menu setup crashed: 'str' object has no attribute 'date'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 29, in load_and_filter_data
    min_date = get_mindate(cleaned_df).date()
AttributeError: 'str' object has no attribute 'date'
2025/03/05 08:07 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 INFO:Streamlit App Starting...
2025/03/05 08:07 INFO:Streamlit App Starting...
2025/03/05 08:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 08:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 08:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 08:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 08:07 INFO:Running App setup...
2025/03/05 08:07 INFO:Running App setup...
2025/03/05 08:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Setting up the package
2025/03/05 08:07 INFO:Setting up the package
2025/03/05 08:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 08:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 INFO:Version: v20.145
2025/03/05 08:07 INFO:Version: v20.145
2025/03/05 08:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 08:07 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 08:07 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 08:07 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 08:07 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 08:07 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 08:07 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 08:07 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 08:07 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 08:07 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 08:07 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 08:07 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 08:07 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 08:07 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 08:07 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 08:07 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 08:07 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 08:07 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 08:07 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 08:07 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 08:07 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 08:07 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 08:07 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 08:07 DEBUG:Initialised data_dir with value: data
2025/03/05 08:07 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 08:07 DEBUG:Initialised output_dir with value: output
2025/03/05 08:07 DEBUG:Initialised data_dir with value: data
2025/03/05 08:07 DEBUG:Initialised logs_dir with value: logs
2025/03/05 08:07 DEBUG:Initialised output_dir with value: output
2025/03/05 08:07 DEBUG:Initialised components_dir with value: components
2025/03/05 08:07 DEBUG:Initialised logs_dir with value: logs
2025/03/05 08:07 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 08:07 DEBUG:Initialised components_dir with value: components
2025/03/05 08:07 DEBUG:Initialised utils_dir with value: utils
2025/03/05 08:07 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 08:07 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 08:07 DEBUG:Initialised utils_dir with value: utils
2025/03/05 08:07 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 08:07 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 08:07 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 08:07 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 08:07 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 08:07 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 08:07 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 08:07 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 08:07 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 08:07 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 08:07 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 08:07 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 08:07 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 08:07 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 08:07 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 08:07 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 08:07 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 08:07 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 08:07 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 08:07 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 08:07 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 08:07 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 08:07 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 08:07 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 08:07 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 08:07 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 08:07 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 08:07 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 08:07 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 08:07 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 08:07 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 08:07 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 08:07 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:07 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 08:07 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 08:07 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:07 INFO:Session_state variables initialized
2025/03/05 08:07 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 08:07 DEBUG:components_dir: components
2025/03/05 08:07 INFO:Session_state variables initialized
2025/03/05 08:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 08:07 DEBUG:components_dir: components
2025/03/05 08:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 08:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 08:07 DEBUG:output_dir: output
2025/03/05 08:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 08:07 DEBUG:data_dir: data
2025/03/05 08:07 DEBUG:output_dir: output
2025/03/05 08:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 08:07 DEBUG:data_dir: data
2025/03/05 08:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 08:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 08:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 08:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 08:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 08:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 08:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 08:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 08:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 08:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 08:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 08:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 08:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 08:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 08:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 08:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 08:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 08:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 08:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 08:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 08:07 DEBUG:logs_dir: logs
2025/03/05 08:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 08:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 08:07 DEBUG:logs_dir: logs
2025/03/05 08:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 08:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 08:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 08:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 08:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 08:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 08:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 08:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 08:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 08:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 08:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 08:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 08:07 DEBUG:app_pages_dir: app_pages
2025/03/05 08:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 08:07 DEBUG:perc_target: 0.5
2025/03/05 08:07 DEBUG:app_pages_dir: app_pages
2025/03/05 08:07 DEBUG:utils_dir: utils
2025/03/05 08:07 DEBUG:perc_target: 0.5
2025/03/05 08:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:07 DEBUG:utils_dir: utils
2025/03/05 08:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 08:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 08:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 08:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 08:07 DEBUG:reference_dir: reference_files
2025/03/05 08:07 DEBUG:reference_dir: reference_files
2025/03/05 08:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 08:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 08:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 08:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 08:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 08:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 08:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 08:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 08:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 08:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 08:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 08:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 08:07 INFO:Session state Setup complete
2025/03/05 08:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:07 INFO:initialize_session_state executed successfully
2025/03/05 08:07 INFO:Session state Setup complete
2025/03/05 08:07 INFO:Package setup complete
2025/03/05 08:07 INFO:initialize_session_state executed successfully
2025/03/05 08:07 INFO:setup_package executed successfully
2025/03/05 08:07 INFO:Package setup complete
2025/03/05 08:07 INFO:Setup completed successfully.
2025/03/05 08:07 INFO:setup_package executed successfully
2025/03/05 08:07 INFO:Running Menu setup...
2025/03/05 08:07 INFO:Setup completed successfully.
2025/03/05 08:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Running Menu setup...
2025/03/05 08:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 INFO:get_git_version executed successfully
2025/03/05 08:07 INFO:App Version: v20.166
2025/03/05 08:07 INFO:App Version: v20.166
2025/03/05 08:07 INFO:Switched to page: Introduction
2025/03/05 08:07 INFO:Switched to page: Head Line Figures
2025/03/05 08:07 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:pagesetup executed successfully
2025/03/05 08:07 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 08:07 INFO:Menu setup completed successfully.
2025/03/05 08:07 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 08:07 INFO:No data found in session state, running firstload()
2025/03/05 08:07 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Running first load function.
2025/03/05 08:07 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 08:07 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 08:07 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:07 INFO:Saved file path: output\imported_raw.csv
2025/03/05 08:07 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 08:07 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 08:07 INFO:get_file_modification_time executed successfully
2025/03/05 08:07 INFO:Current modification time: 1740757862.6744745
2025/03/05 08:07 INFO:Last modification time: 1741105593.3717692
2025/03/05 08:07 INFO:is_file_updated executed successfully
2025/03/05 08:07 INFO:Loading preprocessed data. Using output\imported_raw.csv dated load_raw_data_last_modified instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 08:07 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 08:07 INFO:load_raw_data executed successfully
2025/03/05 08:07 INFO:get_raw_data executed successfully
2025/03/05 08:07 INFO:load_data_to_session executed successfully
2025/03/05 08:07 DEBUG:st.session_state.raw_data: 65278
2025/03/05 08:07 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Rows in Raw Data: 65278
2025/03/05 08:07 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 08:07 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 08:07 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 08:07 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 08:07 INFO:get_file_modification_time executed successfully
2025/03/05 08:07 INFO:Current modification time: 1741105593.3717692
2025/03/05 08:07 INFO:Last modification time: 1741105593.3717692
2025/03/05 08:07 INFO:is_file_updated executed successfully
2025/03/05 08:07 INFO:Loading preprocessed data. Using output\cleaned_data.csv dated load_raw_data_last_modified instead of output\cleaned_donations.csv
2025/03/05 08:07 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 08:07 INFO:load_cleaned_data executed successfully
2025/03/05 08:07 INFO:get_cleaned_data executed successfully
2025/03/05 08:07 INFO:load_data_to_session executed successfully
2025/03/05 08:07 DEBUG:st.session_state.raw_data: 65278
2025/03/05 08:07 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Original file path: output\cleaned_data.csv
2025/03/05 08:07 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 08:07 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 08:07 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 08:07 INFO:get_file_modification_time executed successfully
2025/03/05 08:07 INFO:Current modification time: 1741105598.5723538
2025/03/05 08:07 INFO:Last modification time: 1741105598.5723538
2025/03/05 08:07 INFO:is_file_updated executed successfully
2025/03/05 08:07 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/05 08:07 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 08:07 INFO:load_donorList_data executed successfully
2025/03/05 08:07 INFO:get_donor_data executed successfully
2025/03/05 08:07 INFO:load_data_to_session executed successfully
2025/03/05 08:07 DEBUG:st.session_state.data_donor: 25576
2025/03/05 08:07 DEBUG:st.session_state.data_clean: 65278
2025/03/05 08:07 DEBUG:Calling load_data_to_session with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Original file path: output\cleaned_data.csv
2025/03/05 08:07 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 08:07 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 08:07 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 08:07 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 08:07 INFO:get_file_modification_time executed successfully
2025/03/05 08:07 INFO:Current modification time: 1741105598.5723538
2025/03/05 08:07 INFO:Last modification time: 1741105598.5723538
2025/03/05 08:07 INFO:is_file_updated executed successfully
2025/03/05 08:07 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/05 08:07 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 08:07 INFO:load_regulated_entity_data executed successfully
2025/03/05 08:07 INFO:get_regentity_data executed successfully
2025/03/05 08:07 INFO:load_data_to_session executed successfully
2025/03/05 08:07 DEBUG:st.session_state.data_regentity: 1364
2025/03/05 08:07 DEBUG:st.session_state.data_donor: 25576
2025/03/05 08:07 DEBUG:st.session_state.data_clean: 65278
2025/03/05 08:07 INFO:firstload executed successfully
2025/03/05 08:07 INFO:Data first load completed successfully.
2025/03/05 08:07 INFO:initialise_data executed successfully
2025/03/05 08:07 INFO:App is fully loaded and ready!
2025/03/05 08:13 INFO:Logging is set up correctly! Current log level: ERROR
2025/03/05 08:13 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:13 INFO:get_git_version executed successfully
2025/03/05 08:13 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:13 INFO:get_git_version executed successfully
2025/03/05 08:13 INFO:Streamlit App Starting...
2025/03/05 08:13 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 08:13 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 08:13 INFO:Running App setup...
2025/03/05 08:13 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 08:13 INFO:Setting up the package
2025/03/05 08:13 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 08:13 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:13 INFO:get_git_version executed successfully
2025/03/05 08:13 INFO:Version: v20.145
2025/03/05 08:13 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 08:13 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:13 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 08:13 DEBUG:BASE_DIR already exists in session state
2025/03/05 08:13 DEBUG:filenames already exists in session state
2025/03/05 08:13 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 08:13 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 08:13 DEBUG:thresholds already exists in session state
2025/03/05 08:13 DEBUG:data_remappings already exists in session state
2025/03/05 08:13 DEBUG:filter_def already exists in session state
2025/03/05 08:13 DEBUG:security already exists in session state
2025/03/05 08:13 DEBUG:perc_target already exists in session state
2025/03/05 08:13 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 08:13 DEBUG:directories already exists in session state
2025/03/05 08:13 DEBUG:reference_dir already exists in session state
2025/03/05 08:13 DEBUG:data_dir already exists in session state
2025/03/05 08:13 DEBUG:output_dir already exists in session state
2025/03/05 08:13 DEBUG:logs_dir already exists in session state
2025/03/05 08:13 DEBUG:components_dir already exists in session state
2025/03/05 08:13 DEBUG:app_pages_dir already exists in session state
2025/03/05 08:13 DEBUG:utils_dir already exists in session state
2025/03/05 08:13 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 08:13 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 08:13 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 08:13 DEBUG:donor_map_fname already exists in session state
2025/03/05 08:13 DEBUG:politician_party_fname already exists in session state
2025/03/05 08:13 DEBUG:regentity_map_fname already exists in session state
2025/03/05 08:13 DEBUG:original_data_fname already exists in session state
2025/03/05 08:13 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 08:13 DEBUG:TEXT_FILE already exists in session state
2025/03/05 08:13 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 08:13 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 08:13 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 08:13 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 08:13 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 08:13 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 08:13 DEBUG:party_summary_fname already exists in session state
2025/03/05 08:13 DEBUG:imported_raw_fname already exists in session state
2025/03/05 08:13 DEBUG:source_data_fname already exists in session state
2025/03/05 08:13 DEBUG:Cash_ftr already exists in session state
2025/03/05 08:13 INFO:Session_state variables initialized
2025/03/05 08:13 DEBUG:components_dir: components
2025/03/05 08:13 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 08:13 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 08:13 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 08:13 DEBUG:output_dir: output
2025/03/05 08:13 DEBUG:data_dir: data
2025/03/05 08:13 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 08:13 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 08:13 DEBUG:raw_data:        index      ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... RegulatedEntityId AccountingUnitId  DonorId  CampaigningName   RegisterName IsIrishSource
0          0  NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
1          1  NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
2          2  NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
3          3  NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
4          4  NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
...      ...        ...                              ...                    ...          ...          ...  ...               ...              ...      ...              ...            ...           ...
65273  65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              3945              NaN  74198.0              NaN            NaN         False
65274  65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              3945              NaN  74184.0              NaN            NaN         False
65275  65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              3945              NaN  74576.0              NaN            NaN         False
65276  65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...                52              NaN  34241.0              NaN  Great Britain         False
65277  65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...                52              NaN  74743.0              NaN  Great Britain         False

[65278 rows x 30 columns]
2025/03/05 08:13 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 08:13 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 08:13 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 08:13 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 08:13 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 08:13 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 08:13 DEBUG:LOG_LEVEL: ERROR
2025/03/05 08:13 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 08:13 DEBUG:logs_dir: logs
2025/03/05 08:13 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 08:13 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 08:13 DEBUG:data_clean:        Unnamed: 0      ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WksSinceLastElection  QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0               0  NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...               4710.0                   2.0                 363.0                 1.0                 91.0
1               1  NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
2               2  NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...               4710.0                   2.0                 363.0                 1.0                 91.0
3               3  NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
4               4  NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...               4709.0                   2.0                 363.0                 1.0                 91.0
...           ...        ...                              ...                    ...        ...  ...                  ...                   ...                   ...                 ...                  ...
65273       78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...               4532.0                   5.0                 349.0                 2.0                 87.0
65274       78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...               4524.0                   6.0                 348.0                 2.0                 87.0
65275       78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...               4543.0                   4.0                 350.0                 1.0                 88.0
65276       78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...               4591.0                   1.0                 354.0                 1.0                 89.0
65277       78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...               4592.0                   1.0                 354.0                 1.0                 89.0

[65278 rows x 58 columns]
2025/03/05 08:13 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 08:13 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 08:13 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 08:13 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 08:13 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 08:13 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 08:13 DEBUG:app_pages_dir: app_pages
2025/03/05 08:13 DEBUG:perc_target: 0.5
2025/03/05 08:13 DEBUG:utils_dir: utils
2025/03/05 08:13 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 08:13 DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Fin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/05 08:13 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 08:13 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 08:13 DEBUG:reference_dir: reference_files
2025/03/05 08:13 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 08:13 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 08:13 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001596DE37130>}
2025/03/05 08:13 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 08:13 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 08:13 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 08:13 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 08:13 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 08:13 INFO:Session state Setup complete
2025/03/05 08:13 INFO:initialize_session_state executed successfully
2025/03/05 08:13 INFO:Package setup complete
2025/03/05 08:13 INFO:setup_package executed successfully
2025/03/05 08:13 INFO:Setup completed successfully.
2025/03/05 08:13 INFO:Running Menu setup...
2025/03/05 08:13 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 08:13 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:13 INFO:get_git_version executed successfully
2025/03/05 08:13 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:13 INFO:get_git_version executed successfully
2025/03/05 08:13 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 08:13 INFO:get_git_version executed successfully
2025/03/05 08:13 INFO:App Version: v20.166
2025/03/05 08:13 INFO:Switched to page: Head Line Figures
2025/03/05 08:13 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 08:13 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 08:13 ERROR:Error in load_and_filter_data: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 29, in load_and_filter_data
    min_date = st.session_state.min_date
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 08:13 CRITICAL:Menu setup crashed: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 29, in load_and_filter_data
    min_date = st.session_state.min_date
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:17 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 09:17 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:get_git_version executed successfully
2025/03/05 09:17 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:get_git_version executed successfully
2025/03/05 09:17 INFO:Streamlit App Starting...
2025/03/05 09:17 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:17 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:17 INFO:Running App setup...
2025/03/05 09:17 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Setting up the package
2025/03/05 09:17 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:17 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:get_git_version executed successfully
2025/03/05 09:17 INFO:Version: v20.145
2025/03/05 09:17 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:17 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:17 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:17 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:17 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:17 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:17 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:17 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:17 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:17 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:17 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:17 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:17 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:17 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:17 DEBUG:Initialised data_dir with value: data
2025/03/05 09:17 DEBUG:Initialised output_dir with value: output
2025/03/05 09:17 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:17 DEBUG:Initialised components_dir with value: components
2025/03/05 09:17 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:17 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:17 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:17 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:17 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:17 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:17 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:17 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:17 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:17 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:17 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:17 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:17 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:17 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:17 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:17 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:17 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:17 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:17 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:17 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:17 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:17 INFO:Session_state variables initialized
2025/03/05 09:17 DEBUG:components_dir: components
2025/03/05 09:17 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:17 DEBUG:logs_dir: logs
2025/03/05 09:17 DEBUG:perc_target: 0.5
2025/03/05 09:17 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:17 DEBUG:utils_dir: utils
2025/03/05 09:17 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:17 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:17 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:17 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:17 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:17 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:17 DEBUG:app_pages_dir: app_pages
2025/03/05 09:17 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:17 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:17 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:17 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:17 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:17 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:17 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:17 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:17 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:17 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:17 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:17 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:17 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:17 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:17 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:17 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:17 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:17 DEBUG:data_dir: data
2025/03/05 09:17 DEBUG:output_dir: output
2025/03/05 09:17 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:17 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:17 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:17 DEBUG:reference_dir: reference_files
2025/03/05 09:17 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:17 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:17 INFO:Session state Setup complete
2025/03/05 09:17 INFO:initialize_session_state executed successfully
2025/03/05 09:17 INFO:Package setup complete
2025/03/05 09:17 INFO:setup_package executed successfully
2025/03/05 09:17 INFO:Setup completed successfully.
2025/03/05 09:17 INFO:Running Menu setup...
2025/03/05 09:17 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:get_git_version executed successfully
2025/03/05 09:17 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:get_git_version executed successfully
2025/03/05 09:17 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:get_git_version executed successfully
2025/03/05 09:17 INFO:App Version: v20.166
2025/03/05 09:17 INFO:Switched to page: Introduction
2025/03/05 09:17 INFO:pagesetup executed successfully
2025/03/05 09:17 INFO:Menu setup completed successfully.
2025/03/05 09:17 INFO:No data found in session state, running firstload()
2025/03/05 09:17 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Running first load function.
2025/03/05 09:17 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:17 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:17 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:17 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:17 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:17 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:17 INFO:get_file_modification_time executed successfully
2025/03/05 09:17 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:17 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:17 INFO:is_file_updated executed successfully
2025/03/05 09:17 INFO:Loading preprocessed data. Using output\imported_raw.csv dated load_raw_data_last_modified instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 09:17 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:17 INFO:load_raw_data executed successfully
2025/03/05 09:17 INFO:get_raw_data executed successfully
2025/03/05 09:17 DEBUG:st.session_state.raw_data: 65278
2025/03/05 09:17 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Rows in Raw Data: 65278
2025/03/05 09:17 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 09:17 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 09:17 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 09:17 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 09:17 INFO:get_file_modification_time executed successfully
2025/03/05 09:17 INFO:Current modification time: 1741105593.3717692
2025/03/05 09:17 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:17 INFO:is_file_updated executed successfully
2025/03/05 09:17 INFO:Loading preprocessed data. Using output\cleaned_data.csv dated load_raw_data_last_modified instead of output\cleaned_donations.csv
2025/03/05 09:17 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:17 INFO:load_cleaned_data executed successfully
2025/03/05 09:17 INFO:get_cleaned_data executed successfully
2025/03/05 09:17 DEBUG:st.session_state.raw_data: 65278
2025/03/05 09:17 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Original file path: output\cleaned_data.csv
2025/03/05 09:17 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 09:17 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 09:17 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 09:17 INFO:get_file_modification_time executed successfully
2025/03/05 09:17 INFO:Current modification time: 1741105598.5723538
2025/03/05 09:17 INFO:Last modification time: 1741105598.5723538
2025/03/05 09:17 INFO:is_file_updated executed successfully
2025/03/05 09:17 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/05 09:17 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:17 INFO:load_donorList_data executed successfully
2025/03/05 09:17 INFO:get_donor_data executed successfully
2025/03/05 09:17 DEBUG:st.session_state.data_donor: 25576
2025/03/05 09:17 DEBUG:st.session_state.data_clean: 65278
2025/03/05 09:17 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Original file path: output\cleaned_data.csv
2025/03/05 09:17 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 09:17 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 09:17 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 09:17 INFO:get_file_modification_time executed successfully
2025/03/05 09:17 INFO:Current modification time: 1741105598.5723538
2025/03/05 09:17 INFO:Last modification time: 1741105598.5723538
2025/03/05 09:17 INFO:is_file_updated executed successfully
2025/03/05 09:17 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated load_donorlist_data_last_modified instead of output\cleaned_data.csv
2025/03/05 09:17 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:17 INFO:load_regulated_entity_data executed successfully
2025/03/05 09:17 INFO:get_regentity_data executed successfully
2025/03/05 09:17 DEBUG:st.session_state.data_regentity: 1364
2025/03/05 09:17 DEBUG:st.session_state.data_donor: 25576
2025/03/05 09:17 DEBUG:st.session_state.data_clean: 65278
2025/03/05 09:17 INFO:firstload executed successfully
2025/03/05 09:17 INFO:Data first load completed successfully.
2025/03/05 09:17 INFO:initialise_data executed successfully
2025/03/05 09:17 INFO:App is fully loaded and ready!
2025/03/05 09:17 INFO:Streamlit App Starting...
2025/03/05 09:17 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:17 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:17 INFO:Running App setup...
2025/03/05 09:17 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:Setting up the package
2025/03/05 09:17 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:17 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:get_git_version executed successfully
2025/03/05 09:17 INFO:Version: v20.145
2025/03/05 09:17 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:17 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 09:17 DEBUG:BASE_DIR already exists in session state
2025/03/05 09:17 DEBUG:filenames already exists in session state
2025/03/05 09:17 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 09:17 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 09:17 DEBUG:thresholds already exists in session state
2025/03/05 09:17 DEBUG:data_remappings already exists in session state
2025/03/05 09:17 DEBUG:filter_def already exists in session state
2025/03/05 09:17 DEBUG:security already exists in session state
2025/03/05 09:17 DEBUG:perc_target already exists in session state
2025/03/05 09:17 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 09:17 DEBUG:directories already exists in session state
2025/03/05 09:17 DEBUG:reference_dir already exists in session state
2025/03/05 09:17 DEBUG:data_dir already exists in session state
2025/03/05 09:17 DEBUG:output_dir already exists in session state
2025/03/05 09:17 DEBUG:logs_dir already exists in session state
2025/03/05 09:17 DEBUG:components_dir already exists in session state
2025/03/05 09:17 DEBUG:app_pages_dir already exists in session state
2025/03/05 09:17 DEBUG:utils_dir already exists in session state
2025/03/05 09:17 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 09:17 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 09:17 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 09:17 DEBUG:donor_map_fname already exists in session state
2025/03/05 09:17 DEBUG:politician_party_fname already exists in session state
2025/03/05 09:17 DEBUG:regentity_map_fname already exists in session state
2025/03/05 09:17 DEBUG:original_data_fname already exists in session state
2025/03/05 09:17 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 09:17 DEBUG:TEXT_FILE already exists in session state
2025/03/05 09:17 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 09:17 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 09:17 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 09:17 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 09:17 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 09:17 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 09:17 DEBUG:party_summary_fname already exists in session state
2025/03/05 09:17 DEBUG:imported_raw_fname already exists in session state
2025/03/05 09:17 DEBUG:source_data_fname already exists in session state
2025/03/05 09:17 DEBUG:Cash_ftr already exists in session state
2025/03/05 09:17 INFO:Session_state variables initialized
2025/03/05 09:17 DEBUG:components_dir: components
2025/03/05 09:17 DEBUG:raw_data:        index      ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... RegulatedEntityId AccountingUnitId  DonorId  CampaigningName   RegisterName IsIrishSource
0          0  NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
1          1  NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
2          2  NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
3          3  NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
4          4  NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
...      ...        ...                              ...                    ...          ...          ...  ...               ...              ...      ...              ...            ...           ...
65273  65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              3945              NaN  74198.0              NaN            NaN         False
65274  65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              3945              NaN  74184.0              NaN            NaN         False
65275  65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              3945              NaN  74576.0              NaN            NaN         False
65276  65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...                52              NaN  34241.0              NaN  Great Britain         False
65277  65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...                52              NaN  74743.0              NaN  Great Britain         False

[65278 rows x 30 columns]
2025/03/05 09:17 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:17 DEBUG:logs_dir: logs
2025/03/05 09:17 DEBUG:perc_target: 0.5
2025/03/05 09:17 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:17 DEBUG:utils_dir: utils
2025/03/05 09:17 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 09:17 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:17 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:17 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:17 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:17 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:17 DEBUG:data_clean:        Unnamed: 0      ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WksSinceLastElection  QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0               0  NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...               4710.0                   2.0                 363.0                 1.0                 91.0
1               1  NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
2               2  NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...               4710.0                   2.0                 363.0                 1.0                 91.0
3               3  NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
4               4  NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...               4709.0                   2.0                 363.0                 1.0                 91.0
...           ...        ...                              ...                    ...        ...  ...                  ...                   ...                   ...                 ...                  ...
65273       78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...               4532.0                   5.0                 349.0                 2.0                 87.0
65274       78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...               4524.0                   6.0                 348.0                 2.0                 87.0
65275       78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...               4543.0                   4.0                 350.0                 1.0                 88.0
65276       78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...               4591.0                   1.0                 354.0                 1.0                 89.0
65277       78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...               4592.0                   1.0                 354.0                 1.0                 89.0

[65278 rows x 58 columns]
2025/03/05 09:17 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:17 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:17 DEBUG:app_pages_dir: app_pages
2025/03/05 09:17 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:17 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:17 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:17 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:17 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:17 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:17 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:17 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:17 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:17 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:17 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:17 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:17 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:17 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:17 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:17 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:17 DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Fin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/05 09:17 DEBUG:data_dir: data
2025/03/05 09:17 DEBUG:output_dir: output
2025/03/05 09:17 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:17 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:17 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:17 DEBUG:reference_dir: reference_files
2025/03/05 09:17 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x00000264D01AA320>}
2025/03/05 09:17 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:17 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:17 INFO:Session state Setup complete
2025/03/05 09:17 INFO:initialize_session_state executed successfully
2025/03/05 09:17 INFO:Package setup complete
2025/03/05 09:17 INFO:setup_package executed successfully
2025/03/05 09:17 INFO:Setup completed successfully.
2025/03/05 09:17 INFO:Running Menu setup...
2025/03/05 09:17 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:17 INFO:get_git_version executed successfully
2025/03/05 09:17 INFO:App Version: v20.166
2025/03/05 09:17 INFO:Switched to page: Head Line Figures
2025/03/05 09:17 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:17 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:17 ERROR:Error in load_and_filter_data: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 29, in load_and_filter_data
    min_date = st.session_state.min_date
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:17 CRITICAL:Menu setup crashed: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 29, in load_and_filter_data
    min_date = st.session_state.min_date
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:21 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 09:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:get_git_version executed successfully
2025/03/05 09:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:get_git_version executed successfully
2025/03/05 09:21 INFO:Streamlit App Starting...
2025/03/05 09:21 INFO:Streamlit App Starting...
2025/03/05 09:21 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:21 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:21 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:21 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:21 INFO:Running App setup...
2025/03/05 09:21 INFO:Running App setup...
2025/03/05 09:21 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:Setting up the package
2025/03/05 09:21 INFO:Setting up the package
2025/03/05 09:21 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:21 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:get_git_version executed successfully
2025/03/05 09:21 INFO:get_git_version executed successfully
2025/03/05 09:21 INFO:Version: v20.145
2025/03/05 09:21 INFO:Version: v20.145
2025/03/05 09:21 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:21 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:21 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:21 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:21 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:21 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:21 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:21 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:21 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:21 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:21 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:21 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:21 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:21 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:21 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:21 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:21 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:21 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:21 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:21 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:21 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:21 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:21 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:21 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:21 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:21 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:21 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:21 DEBUG:Initialised data_dir with value: data
2025/03/05 09:21 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:21 DEBUG:Initialised output_dir with value: output
2025/03/05 09:21 DEBUG:Initialised data_dir with value: data
2025/03/05 09:21 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:21 DEBUG:Initialised output_dir with value: output
2025/03/05 09:21 DEBUG:Initialised components_dir with value: components
2025/03/05 09:21 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:21 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:21 DEBUG:Initialised components_dir with value: components
2025/03/05 09:21 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:21 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:21 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:21 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:21 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:21 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:21 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:21 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:21 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:21 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:21 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:21 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:21 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:21 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:21 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:21 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:21 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:21 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:21 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:21 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:21 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:21 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:21 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:21 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:21 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:21 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:21 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:21 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:21 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:21 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:21 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:21 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:21 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:21 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:21 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:21 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:21 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:21 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:21 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:21 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:21 INFO:Session_state variables initialized
2025/03/05 09:21 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:21 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:21 INFO:Session_state variables initialized
2025/03/05 09:21 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:21 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:21 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:21 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:21 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:21 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:21 DEBUG:logs_dir: logs
2025/03/05 09:21 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:21 DEBUG:components_dir: components
2025/03/05 09:21 DEBUG:logs_dir: logs
2025/03/05 09:21 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:21 DEBUG:components_dir: components
2025/03/05 09:21 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:21 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:21 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:21 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:21 DEBUG:app_pages_dir: app_pages
2025/03/05 09:21 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:21 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:21 DEBUG:app_pages_dir: app_pages
2025/03/05 09:21 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:21 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:21 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:21 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:21 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:21 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:21 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:21 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:21 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:21 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:21 DEBUG:reference_dir: reference_files
2025/03/05 09:21 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:21 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:21 DEBUG:reference_dir: reference_files
2025/03/05 09:21 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:21 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:21 DEBUG:utils_dir: utils
2025/03/05 09:21 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:21 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:21 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:21 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:21 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:21 DEBUG:perc_target: 0.5
2025/03/05 09:21 DEBUG:perc_target: 0.5
2025/03/05 09:21 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:21 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:21 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:21 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:21 DEBUG:data_dir: data
2025/03/05 09:21 DEBUG:data_dir: data
2025/03/05 09:21 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:21 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:21 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:21 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:21 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:21 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:21 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:21 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:21 DEBUG:output_dir: output
2025/03/05 09:21 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:21 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:21 DEBUG:output_dir: output
2025/03/05 09:21 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:21 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:21 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:21 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:21 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:21 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:21 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:21 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:21 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:21 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:21 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:21 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:21 INFO:Session state Setup complete
2025/03/05 09:21 DEBUG:utils_dir: utils
2025/03/05 09:21 INFO:initialize_session_state executed successfully
2025/03/05 09:21 INFO:Session state Setup complete
2025/03/05 09:21 INFO:Package setup complete
2025/03/05 09:21 INFO:initialize_session_state executed successfully
2025/03/05 09:21 INFO:setup_package executed successfully
2025/03/05 09:21 INFO:Package setup complete
2025/03/05 09:21 INFO:Setup completed successfully.
2025/03/05 09:21 INFO:setup_package executed successfully
2025/03/05 09:21 INFO:Running Menu setup...
2025/03/05 09:21 INFO:Setup completed successfully.
2025/03/05 09:21 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:Running Menu setup...
2025/03/05 09:21 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:get_git_version executed successfully
2025/03/05 09:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:get_git_version executed successfully
2025/03/05 09:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:get_git_version executed successfully
2025/03/05 09:21 INFO:get_git_version executed successfully
2025/03/05 09:21 INFO:App Version: v20.166
2025/03/05 09:21 INFO:App Version: v20.166
2025/03/05 09:21 INFO:Switched to page: Head Line Figures
2025/03/05 09:21 INFO:Switched to page: Introduction
2025/03/05 09:21 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:21 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:21 INFO:pagesetup executed successfully
2025/03/05 09:21 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:21 INFO:Menu setup completed successfully.
2025/03/05 09:21 INFO:No data found in session state, running firstload()
2025/03/05 09:21 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:Running first load function.
2025/03/05 09:21 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:21 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:21 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:21 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:21 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:21 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:21 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:21 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:21 INFO:get_file_modification_time executed successfully
2025/03/05 09:21 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:21 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:21 INFO:is_file_updated executed successfully
2025/03/05 09:21 INFO:Loading preprocessed data. Using output\imported_raw.csv dated load_raw_data_last_modified instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 09:21 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:21 ERROR:Error in load_raw_data: '<=' not supported between instances of 'str' and 'float'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 56, in load_raw_data
    st.session_state.min_date = pd.to_datetime(loaddata_df["ReceivedDate"].min())
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6507, in min
    return NDFrame.min(self, axis, skipna, numeric_only, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12388, in min
    return self._stat_function(
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12377, in _stat_function
    return self._reduce(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6457, in _reduce
    return op(delegate, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 1098, in reduction
    result = getattr(values, meth)(axis)
  File "H:\python310\lib\site-packages\numpy\_core\_methods.py", line 48, in _amin
    return umr_minimum(a, axis, None, out, keepdims, initial, where)
TypeError: '<=' not supported between instances of 'str' and 'float'
2025/03/05 09:21 CRITICAL:First load crashed: '<=' not supported between instances of 'str' and 'float'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 43, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 56, in load_raw_data
    st.session_state.min_date = pd.to_datetime(loaddata_df["ReceivedDate"].min())
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6507, in min
    return NDFrame.min(self, axis, skipna, numeric_only, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12388, in min
    return self._stat_function(
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12377, in _stat_function
    return self._reduce(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6457, in _reduce
    return op(delegate, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 1098, in reduction
    result = getattr(values, meth)(axis)
  File "H:\python310\lib\site-packages\numpy\_core\_methods.py", line 48, in _amin
    return umr_minimum(a, axis, None, out, keepdims, initial, where)
TypeError: '<=' not supported between instances of 'str' and 'float'
2025/03/05 09:33 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 INFO:Streamlit App Starting...
2025/03/05 09:33 INFO:Streamlit App Starting...
2025/03/05 09:33 INFO:Streamlit App Starting...
2025/03/05 09:33 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:33 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:33 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:33 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:33 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:33 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:33 INFO:Running App setup...
2025/03/05 09:33 INFO:Running App setup...
2025/03/05 09:33 INFO:Running App setup...
2025/03/05 09:33 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Setting up the package
2025/03/05 09:33 INFO:Setting up the package
2025/03/05 09:33 INFO:Setting up the package
2025/03/05 09:33 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:33 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:33 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 INFO:Version: v20.145
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 INFO:Version: v20.145
2025/03/05 09:33 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Version: v20.145
2025/03/05 09:33 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:33 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:33 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:33 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:33 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:33 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:33 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:33 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:33 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:33 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:33 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:33 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:33 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:33 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:33 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:33 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:33 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:33 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:33 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:33 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:33 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:33 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:33 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:33 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:33 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:33 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:33 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:33 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:33 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:33 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:33 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:33 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:33 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:33 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:33 DEBUG:Initialised data_dir with value: data
2025/03/05 09:33 DEBUG:Initialised output_dir with value: output
2025/03/05 09:33 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:33 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:33 DEBUG:Initialised data_dir with value: data
2025/03/05 09:33 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:33 DEBUG:Initialised components_dir with value: components
2025/03/05 09:33 DEBUG:Initialised output_dir with value: output
2025/03/05 09:33 DEBUG:Initialised data_dir with value: data
2025/03/05 09:33 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:33 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:33 DEBUG:Initialised output_dir with value: output
2025/03/05 09:33 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:33 DEBUG:Initialised components_dir with value: components
2025/03/05 09:33 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:33 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:33 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:33 DEBUG:Initialised components_dir with value: components
2025/03/05 09:33 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:33 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:33 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:33 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:33 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:33 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:33 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:33 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:33 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:33 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:33 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:33 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:33 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:33 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:33 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:33 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:33 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:33 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:33 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:33 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:33 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:33 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:33 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:33 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:33 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:33 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:33 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:33 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:33 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:33 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:33 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:33 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:33 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:33 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:33 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:33 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:33 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:33 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:33 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:33 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:33 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:33 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:33 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:33 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:33 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:33 INFO:Session_state variables initialized
2025/03/05 09:33 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:33 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:33 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:33 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 DEBUG:data_dir: data
2025/03/05 09:33 INFO:Session_state variables initialized
2025/03/05 09:33 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:33 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:33 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:33 INFO:Session_state variables initialized
2025/03/05 09:33 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:33 DEBUG:data_dir: data
2025/03/05 09:33 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:33 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:33 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:33 DEBUG:data_dir: data
2025/03/05 09:33 DEBUG:utils_dir: utils
2025/03/05 09:33 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:33 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:33 DEBUG:app_pages_dir: app_pages
2025/03/05 09:33 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:33 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:33 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:33 DEBUG:utils_dir: utils
2025/03/05 09:33 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:33 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:33 DEBUG:app_pages_dir: app_pages
2025/03/05 09:33 DEBUG:utils_dir: utils
2025/03/05 09:33 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:33 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:33 DEBUG:app_pages_dir: app_pages
2025/03/05 09:33 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:33 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:33 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:33 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:33 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:33 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:33 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:33 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:33 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:33 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:33 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:33 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:33 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:33 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:33 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:33 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:33 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:33 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:33 DEBUG:output_dir: output
2025/03/05 09:33 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:33 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:33 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:33 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:33 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:33 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:33 DEBUG:output_dir: output
2025/03/05 09:33 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:33 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:33 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:33 DEBUG:output_dir: output
2025/03/05 09:33 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:33 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:33 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:33 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:33 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:33 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:33 DEBUG:components_dir: components
2025/03/05 09:33 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:33 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:33 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:33 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:33 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:33 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:33 DEBUG:components_dir: components
2025/03/05 09:33 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:33 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:33 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:33 DEBUG:components_dir: components
2025/03/05 09:33 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:33 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:33 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:33 DEBUG:logs_dir: logs
2025/03/05 09:33 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:33 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:33 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:33 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:33 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:33 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:33 DEBUG:logs_dir: logs
2025/03/05 09:33 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:33 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:33 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:33 DEBUG:logs_dir: logs
2025/03/05 09:33 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:33 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:33 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:33 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:33 DEBUG:perc_target: 0.5
2025/03/05 09:33 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:33 DEBUG:reference_dir: reference_files
2025/03/05 09:33 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:33 DEBUG:perc_target: 0.5
2025/03/05 09:33 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:33 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:33 DEBUG:perc_target: 0.5
2025/03/05 09:33 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:33 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:33 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:33 DEBUG:reference_dir: reference_files
2025/03/05 09:33 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:33 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 DEBUG:reference_dir: reference_files
2025/03/05 09:33 INFO:Session state Setup complete
2025/03/05 09:33 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:33 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 INFO:initialize_session_state executed successfully
2025/03/05 09:33 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:33 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:33 INFO:Package setup complete
2025/03/05 09:33 INFO:Session state Setup complete
2025/03/05 09:33 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:33 INFO:setup_package executed successfully
2025/03/05 09:33 INFO:initialize_session_state executed successfully
2025/03/05 09:33 INFO:Session state Setup complete
2025/03/05 09:33 INFO:Setup completed successfully.
2025/03/05 09:33 INFO:Package setup complete
2025/03/05 09:33 INFO:initialize_session_state executed successfully
2025/03/05 09:33 INFO:Running Menu setup...
2025/03/05 09:33 INFO:setup_package executed successfully
2025/03/05 09:33 INFO:Package setup complete
2025/03/05 09:33 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Setup completed successfully.
2025/03/05 09:33 INFO:setup_package executed successfully
2025/03/05 09:33 INFO:Running Menu setup...
2025/03/05 09:33 INFO:Setup completed successfully.
2025/03/05 09:33 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Running Menu setup...
2025/03/05 09:33 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 INFO:get_git_version executed successfully
2025/03/05 09:33 INFO:App Version: v20.166
2025/03/05 09:33 INFO:App Version: v20.166
2025/03/05 09:33 INFO:App Version: v20.166
2025/03/05 09:33 INFO:Switched to page: Introduction
2025/03/05 09:33 INFO:Switched to page: Introduction
2025/03/05 09:33 INFO:pagesetup executed successfully
2025/03/05 09:33 INFO:Switched to page: Head Line Figures
2025/03/05 09:33 INFO:Menu setup completed successfully.
2025/03/05 09:33 INFO:pagesetup executed successfully
2025/03/05 09:33 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:No data found in session state, running firstload()
2025/03/05 09:33 INFO:Menu setup completed successfully.
2025/03/05 09:33 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:No data found in session state, running firstload()
2025/03/05 09:33 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:33 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:33 INFO:Running first load function.
2025/03/05 09:33 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:33 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:33 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:33 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:33 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 INFO:get_file_modification_time executed successfully
2025/03/05 09:33 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:33 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:33 INFO:is_file_updated executed successfully
2025/03/05 09:33 ERROR:Error in try_to_use_preprocessed_data: st.session_state has no attribute "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 27, in try_to_use_preprocessed_data
    f" dated {st.session_state.timestamp_key} instead of {originalfilepath}")
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:33 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 CRITICAL:First load crashed: st.session_state has no attribute "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 43, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 50, in load_raw_data
    loaddata_df = try_to_use_preprocessed_data(
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 27, in try_to_use_preprocessed_data
    f" dated {st.session_state.timestamp_key} instead of {originalfilepath}")
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:33 INFO:Running first load function.
2025/03/05 09:33 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:33 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:33 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:33 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:33 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:33 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:33 INFO:get_file_modification_time executed successfully
2025/03/05 09:33 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:33 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:33 INFO:is_file_updated executed successfully
2025/03/05 09:33 ERROR:Error in try_to_use_preprocessed_data: st.session_state has no attribute "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 27, in try_to_use_preprocessed_data
    f" dated {st.session_state.timestamp_key} instead of {originalfilepath}")
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:33 CRITICAL:First load crashed: st.session_state has no attribute "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 43, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 50, in load_raw_data
    loaddata_df = try_to_use_preprocessed_data(
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 27, in try_to_use_preprocessed_data
    f" dated {st.session_state.timestamp_key} instead of {originalfilepath}")
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "timestamp_key". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:38 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 INFO:Streamlit App Starting...
2025/03/05 09:38 INFO:Streamlit App Starting...
2025/03/05 09:38 INFO:Streamlit App Starting...
2025/03/05 09:38 INFO:Streamlit App Starting...
2025/03/05 09:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:38 INFO:Running App setup...
2025/03/05 09:38 INFO:Running App setup...
2025/03/05 09:38 INFO:Running App setup...
2025/03/05 09:38 INFO:Running App setup...
2025/03/05 09:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Setting up the package
2025/03/05 09:38 INFO:Setting up the package
2025/03/05 09:38 INFO:Setting up the package
2025/03/05 09:38 INFO:Setting up the package
2025/03/05 09:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 INFO:Version: v20.145
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 INFO:Version: v20.145
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Version: v20.145
2025/03/05 09:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Version: v20.145
2025/03/05 09:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:38 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:38 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:38 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:38 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:38 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:38 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:38 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:38 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:38 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:38 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:38 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:38 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:38 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:38 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:38 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:38 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:38 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:38 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:38 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:38 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:38 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:38 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:38 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:38 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:38 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:38 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:38 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:38 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:38 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:38 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:38 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:38 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:38 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:38 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:38 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:38 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:38 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:38 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:38 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:38 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:38 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:38 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:38 DEBUG:Initialised data_dir with value: data
2025/03/05 09:38 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:38 DEBUG:Initialised output_dir with value: output
2025/03/05 09:38 DEBUG:Initialised data_dir with value: data
2025/03/05 09:38 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:38 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:38 DEBUG:Initialised output_dir with value: output
2025/03/05 09:38 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:38 DEBUG:Initialised components_dir with value: components
2025/03/05 09:38 DEBUG:Initialised data_dir with value: data
2025/03/05 09:38 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:38 DEBUG:Initialised data_dir with value: data
2025/03/05 09:38 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:38 DEBUG:Initialised output_dir with value: output
2025/03/05 09:38 DEBUG:Initialised components_dir with value: components
2025/03/05 09:38 DEBUG:Initialised output_dir with value: output
2025/03/05 09:38 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:38 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:38 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:38 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:38 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:38 DEBUG:Initialised components_dir with value: components
2025/03/05 09:38 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:38 DEBUG:Initialised components_dir with value: components
2025/03/05 09:38 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:38 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:38 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:38 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:38 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:38 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:38 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:38 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:38 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:38 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:38 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:38 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:38 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:38 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:38 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:38 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:38 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:38 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:38 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:38 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:38 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:38 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:38 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:38 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:38 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:38 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:38 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:38 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:38 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:38 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:38 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:38 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:38 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:38 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:38 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:38 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:38 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:38 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:38 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:38 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:38 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:38 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:38 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:38 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:38 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:38 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:38 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:38 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:38 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:38 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:38 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:38 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:38 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:38 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:38 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:38 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:38 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:38 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:38 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:38 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:38 INFO:Session_state variables initialized
2025/03/05 09:38 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:38 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:38 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:38 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 INFO:Session_state variables initialized
2025/03/05 09:38 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:38 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:38 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:38 INFO:Session_state variables initialized
2025/03/05 09:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:38 INFO:Session_state variables initialized
2025/03/05 09:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:38 DEBUG:app_pages_dir: app_pages
2025/03/05 09:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:38 DEBUG:app_pages_dir: app_pages
2025/03/05 09:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:38 DEBUG:app_pages_dir: app_pages
2025/03/05 09:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:38 DEBUG:app_pages_dir: app_pages
2025/03/05 09:38 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:38 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:38 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:38 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:38 DEBUG:reference_dir: reference_files
2025/03/05 09:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:38 DEBUG:reference_dir: reference_files
2025/03/05 09:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:38 DEBUG:utils_dir: utils
2025/03/05 09:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:38 DEBUG:reference_dir: reference_files
2025/03/05 09:38 DEBUG:utils_dir: utils
2025/03/05 09:38 DEBUG:reference_dir: reference_files
2025/03/05 09:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 DEBUG:utils_dir: utils
2025/03/05 09:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:38 DEBUG:utils_dir: utils
2025/03/05 09:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:38 DEBUG:data_dir: data
2025/03/05 09:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:38 DEBUG:components_dir: components
2025/03/05 09:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:38 DEBUG:data_dir: data
2025/03/05 09:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:38 DEBUG:components_dir: components
2025/03/05 09:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:38 DEBUG:data_dir: data
2025/03/05 09:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:38 DEBUG:output_dir: output
2025/03/05 09:38 DEBUG:components_dir: components
2025/03/05 09:38 DEBUG:data_dir: data
2025/03/05 09:38 DEBUG:output_dir: output
2025/03/05 09:38 DEBUG:logs_dir: logs
2025/03/05 09:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:38 DEBUG:components_dir: components
2025/03/05 09:38 DEBUG:logs_dir: logs
2025/03/05 09:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:38 DEBUG:output_dir: output
2025/03/05 09:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:38 DEBUG:perc_target: 0.5
2025/03/05 09:38 DEBUG:logs_dir: logs
2025/03/05 09:38 DEBUG:output_dir: output
2025/03/05 09:38 DEBUG:perc_target: 0.5
2025/03/05 09:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:38 DEBUG:logs_dir: logs
2025/03/05 09:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:38 DEBUG:perc_target: 0.5
2025/03/05 09:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:38 DEBUG:perc_target: 0.5
2025/03/05 09:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:38 INFO:Session state Setup complete
2025/03/05 09:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:38 INFO:Session state Setup complete
2025/03/05 09:38 INFO:initialize_session_state executed successfully
2025/03/05 09:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:38 INFO:initialize_session_state executed successfully
2025/03/05 09:38 INFO:Package setup complete
2025/03/05 09:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:38 INFO:Session state Setup complete
2025/03/05 09:38 INFO:Package setup complete
2025/03/05 09:38 INFO:setup_package executed successfully
2025/03/05 09:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:38 INFO:initialize_session_state executed successfully
2025/03/05 09:38 INFO:setup_package executed successfully
2025/03/05 09:38 INFO:Setup completed successfully.
2025/03/05 09:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:38 INFO:Package setup complete
2025/03/05 09:38 INFO:Setup completed successfully.
2025/03/05 09:38 INFO:Running Menu setup...
2025/03/05 09:38 INFO:Session state Setup complete
2025/03/05 09:38 INFO:setup_package executed successfully
2025/03/05 09:38 INFO:Running Menu setup...
2025/03/05 09:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:initialize_session_state executed successfully
2025/03/05 09:38 INFO:Setup completed successfully.
2025/03/05 09:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Package setup complete
2025/03/05 09:38 INFO:Running Menu setup...
2025/03/05 09:38 INFO:setup_package executed successfully
2025/03/05 09:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Setup completed successfully.
2025/03/05 09:38 INFO:Running Menu setup...
2025/03/05 09:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 INFO:get_git_version executed successfully
2025/03/05 09:38 INFO:App Version: v20.166
2025/03/05 09:38 INFO:App Version: v20.166
2025/03/05 09:38 INFO:App Version: v20.166
2025/03/05 09:38 INFO:App Version: v20.166
2025/03/05 09:38 INFO:Switched to page: Introduction
2025/03/05 09:38 INFO:Switched to page: Introduction
2025/03/05 09:38 INFO:Switched to page: Head Line Figures
2025/03/05 09:38 INFO:Switched to page: Introduction
2025/03/05 09:38 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:pagesetup executed successfully
2025/03/05 09:38 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:38 INFO:Menu setup completed successfully.
2025/03/05 09:38 INFO:pagesetup executed successfully
2025/03/05 09:38 INFO:pagesetup executed successfully
2025/03/05 09:38 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:38 INFO:No data found in session state, running firstload()
2025/03/05 09:38 INFO:Menu setup completed successfully.
2025/03/05 09:38 INFO:Menu setup completed successfully.
2025/03/05 09:38 INFO:No data found in session state, running firstload()
2025/03/05 09:38 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:No data found in session state, running firstload()
2025/03/05 09:38 INFO:Running first load function.
2025/03/05 09:38 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:38 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:38 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:38 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:38 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 INFO:get_file_modification_time executed successfully
2025/03/05 09:38 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:38 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:38 INFO:is_file_updated executed successfully
2025/03/05 09:38 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741105593.3717692 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 09:38 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:38 ERROR:Error in load_raw_data: '<=' not supported between instances of 'str' and 'float'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"].min()))
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6507, in min
    return NDFrame.min(self, axis, skipna, numeric_only, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12388, in min
    return self._stat_function(
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12377, in _stat_function
    return self._reduce(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6457, in _reduce
    return op(delegate, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 1098, in reduction
    result = getattr(values, meth)(axis)
  File "H:\python310\lib\site-packages\numpy\_core\_methods.py", line 48, in _amin
    return umr_minimum(a, axis, None, out, keepdims, initial, where)
TypeError: '<=' not supported between instances of 'str' and 'float'
2025/03/05 09:38 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 CRITICAL:First load crashed: '<=' not supported between instances of 'str' and 'float'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 46, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"].min()))
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6507, in min
    return NDFrame.min(self, axis, skipna, numeric_only, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12388, in min
    return self._stat_function(
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12377, in _stat_function
    return self._reduce(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6457, in _reduce
    return op(delegate, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 1098, in reduction
    result = getattr(values, meth)(axis)
  File "H:\python310\lib\site-packages\numpy\_core\_methods.py", line 48, in _amin
    return umr_minimum(a, axis, None, out, keepdims, initial, where)
TypeError: '<=' not supported between instances of 'str' and 'float'
2025/03/05 09:38 INFO:Running first load function.
2025/03/05 09:38 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:38 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:38 ERROR:Error in load_raw_data: '<=' not supported between instances of 'str' and 'float'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"].min()))
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6507, in min
    return NDFrame.min(self, axis, skipna, numeric_only, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12388, in min
    return self._stat_function(
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12377, in _stat_function
    return self._reduce(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6457, in _reduce
    return op(delegate, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 1098, in reduction
    result = getattr(values, meth)(axis)
  File "H:\python310\lib\site-packages\numpy\_core\_methods.py", line 48, in _amin
    return umr_minimum(a, axis, None, out, keepdims, initial, where)
TypeError: '<=' not supported between instances of 'str' and 'float'
2025/03/05 09:38 CRITICAL:First load crashed: '<=' not supported between instances of 'str' and 'float'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 46, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"].min()))
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6507, in min
    return NDFrame.min(self, axis, skipna, numeric_only, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12388, in min
    return self._stat_function(
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12377, in _stat_function
    return self._reduce(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6457, in _reduce
    return op(delegate, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 1098, in reduction
    result = getattr(values, meth)(axis)
  File "H:\python310\lib\site-packages\numpy\_core\_methods.py", line 48, in _amin
    return umr_minimum(a, axis, None, out, keepdims, initial, where)
TypeError: '<=' not supported between instances of 'str' and 'float'
2025/03/05 09:38 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 INFO:Running first load function.
2025/03/05 09:38 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:38 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:38 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:38 ERROR:Error in load_raw_data: '<=' not supported between instances of 'str' and 'float'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"].min()))
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6507, in min
    return NDFrame.min(self, axis, skipna, numeric_only, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12388, in min
    return self._stat_function(
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12377, in _stat_function
    return self._reduce(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6457, in _reduce
    return op(delegate, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 1098, in reduction
    result = getattr(values, meth)(axis)
  File "H:\python310\lib\site-packages\numpy\_core\_methods.py", line 48, in _amin
    return umr_minimum(a, axis, None, out, keepdims, initial, where)
TypeError: '<=' not supported between instances of 'str' and 'float'
2025/03/05 09:38 CRITICAL:First load crashed: '<=' not supported between instances of 'str' and 'float'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 46, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"].min()))
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6507, in min
    return NDFrame.min(self, axis, skipna, numeric_only, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12388, in min
    return self._stat_function(
  File "H:\python310\lib\site-packages\pandas\core\generic.py", line 12377, in _stat_function
    return self._reduce(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 6457, in _reduce
    return op(delegate, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 147, in f
    result = alt(values, axis=axis, skipna=skipna, **kwds)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 404, in new_func
    result = func(values, axis=axis, skipna=skipna, mask=mask, **kwargs)
  File "H:\python310\lib\site-packages\pandas\core\nanops.py", line 1098, in reduction
    result = getattr(values, meth)(axis)
  File "H:\python310\lib\site-packages\numpy\_core\_methods.py", line 48, in _amin
    return umr_minimum(a, axis, None, out, keepdims, initial, where)
TypeError: '<=' not supported between instances of 'str' and 'float'
2025/03/05 09:42 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:Streamlit App Starting...
2025/03/05 09:42 INFO:Streamlit App Starting...
2025/03/05 09:42 INFO:Streamlit App Starting...
2025/03/05 09:42 INFO:Streamlit App Starting...
2025/03/05 09:42 INFO:Streamlit App Starting...
2025/03/05 09:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:42 INFO:Running App setup...
2025/03/05 09:42 INFO:Running App setup...
2025/03/05 09:42 INFO:Running App setup...
2025/03/05 09:42 INFO:Running App setup...
2025/03/05 09:42 INFO:Running App setup...
2025/03/05 09:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Setting up the package
2025/03/05 09:42 INFO:Setting up the package
2025/03/05 09:42 INFO:Setting up the package
2025/03/05 09:42 INFO:Setting up the package
2025/03/05 09:42 INFO:Setting up the package
2025/03/05 09:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:Version: v20.145
2025/03/05 09:42 INFO:Version: v20.145
2025/03/05 09:42 INFO:Version: v20.145
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:Version: v20.145
2025/03/05 09:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Version: v20.145
2025/03/05 09:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:42 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:42 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:42 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:42 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:42 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:42 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:42 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:42 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:42 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:42 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:42 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:42 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:42 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:42 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:42 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:42 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:42 DEBUG:Initialised data_dir with value: data
2025/03/05 09:42 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:42 DEBUG:Initialised output_dir with value: output
2025/03/05 09:42 DEBUG:Initialised data_dir with value: data
2025/03/05 09:42 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:42 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:42 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:42 DEBUG:Initialised output_dir with value: output
2025/03/05 09:42 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:42 DEBUG:Initialised data_dir with value: data
2025/03/05 09:42 DEBUG:Initialised components_dir with value: components
2025/03/05 09:42 DEBUG:Initialised data_dir with value: data
2025/03/05 09:42 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:42 DEBUG:Initialised data_dir with value: data
2025/03/05 09:42 DEBUG:Initialised output_dir with value: output
2025/03/05 09:42 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:42 DEBUG:Initialised output_dir with value: output
2025/03/05 09:42 DEBUG:Initialised components_dir with value: components
2025/03/05 09:42 DEBUG:Initialised output_dir with value: output
2025/03/05 09:42 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:42 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:42 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:42 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:42 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:42 DEBUG:Initialised components_dir with value: components
2025/03/05 09:42 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised components_dir with value: components
2025/03/05 09:42 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:42 DEBUG:Initialised components_dir with value: components
2025/03/05 09:42 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:42 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:42 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:42 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:42 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:42 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:42 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:42 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:42 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:42 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:42 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:42 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:42 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:42 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:42 INFO:Session_state variables initialized
2025/03/05 09:42 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:42 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:42 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 INFO:Session_state variables initialized
2025/03/05 09:42 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:42 INFO:Session_state variables initialized
2025/03/05 09:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 INFO:Session_state variables initialized
2025/03/05 09:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 INFO:Session_state variables initialized
2025/03/05 09:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:components_dir: components
2025/03/05 09:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:components_dir: components
2025/03/05 09:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:42 DEBUG:components_dir: components
2025/03/05 09:42 DEBUG:components_dir: components
2025/03/05 09:42 DEBUG:components_dir: components
2025/03/05 09:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:42 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:42 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:42 DEBUG:logs_dir: logs
2025/03/05 09:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:42 DEBUG:logs_dir: logs
2025/03/05 09:42 DEBUG:perc_target: 0.5
2025/03/05 09:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:42 DEBUG:perc_target: 0.5
2025/03/05 09:42 DEBUG:output_dir: output
2025/03/05 09:42 DEBUG:logs_dir: logs
2025/03/05 09:42 DEBUG:logs_dir: logs
2025/03/05 09:42 DEBUG:logs_dir: logs
2025/03/05 09:42 DEBUG:output_dir: output
2025/03/05 09:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:perc_target: 0.5
2025/03/05 09:42 DEBUG:perc_target: 0.5
2025/03/05 09:42 DEBUG:perc_target: 0.5
2025/03/05 09:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:output_dir: output
2025/03/05 09:42 DEBUG:output_dir: output
2025/03/05 09:42 DEBUG:output_dir: output
2025/03/05 09:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:utils_dir: utils
2025/03/05 09:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:42 DEBUG:utils_dir: utils
2025/03/05 09:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:42 DEBUG:utils_dir: utils
2025/03/05 09:42 DEBUG:utils_dir: utils
2025/03/05 09:42 DEBUG:utils_dir: utils
2025/03/05 09:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:reference_dir: reference_files
2025/03/05 09:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:42 DEBUG:reference_dir: reference_files
2025/03/05 09:42 DEBUG:app_pages_dir: app_pages
2025/03/05 09:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:42 DEBUG:app_pages_dir: app_pages
2025/03/05 09:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:reference_dir: reference_files
2025/03/05 09:42 DEBUG:app_pages_dir: app_pages
2025/03/05 09:42 DEBUG:reference_dir: reference_files
2025/03/05 09:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:data_dir: data
2025/03/05 09:42 DEBUG:app_pages_dir: app_pages
2025/03/05 09:42 DEBUG:reference_dir: reference_files
2025/03/05 09:42 DEBUG:app_pages_dir: app_pages
2025/03/05 09:42 DEBUG:data_dir: data
2025/03/05 09:42 INFO:Session state Setup complete
2025/03/05 09:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:42 INFO:Session state Setup complete
2025/03/05 09:42 INFO:initialize_session_state executed successfully
2025/03/05 09:42 DEBUG:data_dir: data
2025/03/05 09:42 DEBUG:data_dir: data
2025/03/05 09:42 DEBUG:data_dir: data
2025/03/05 09:42 INFO:initialize_session_state executed successfully
2025/03/05 09:42 INFO:Package setup complete
2025/03/05 09:42 INFO:Session state Setup complete
2025/03/05 09:42 INFO:Session state Setup complete
2025/03/05 09:42 INFO:Session state Setup complete
2025/03/05 09:42 INFO:Package setup complete
2025/03/05 09:42 INFO:setup_package executed successfully
2025/03/05 09:42 INFO:initialize_session_state executed successfully
2025/03/05 09:42 INFO:initialize_session_state executed successfully
2025/03/05 09:42 INFO:initialize_session_state executed successfully
2025/03/05 09:42 INFO:setup_package executed successfully
2025/03/05 09:42 INFO:Setup completed successfully.
2025/03/05 09:42 INFO:Package setup complete
2025/03/05 09:42 INFO:Package setup complete
2025/03/05 09:42 INFO:Package setup complete
2025/03/05 09:42 INFO:Setup completed successfully.
2025/03/05 09:42 INFO:Running Menu setup...
2025/03/05 09:42 INFO:setup_package executed successfully
2025/03/05 09:42 INFO:setup_package executed successfully
2025/03/05 09:42 INFO:setup_package executed successfully
2025/03/05 09:42 INFO:Running Menu setup...
2025/03/05 09:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Setup completed successfully.
2025/03/05 09:42 INFO:Setup completed successfully.
2025/03/05 09:42 INFO:Setup completed successfully.
2025/03/05 09:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Running Menu setup...
2025/03/05 09:42 INFO:Running Menu setup...
2025/03/05 09:42 INFO:Running Menu setup...
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:App Version: v20.166
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:get_git_version executed successfully
2025/03/05 09:42 INFO:App Version: v20.166
2025/03/05 09:42 INFO:App Version: v20.166
2025/03/05 09:42 INFO:Switched to page: Introduction
2025/03/05 09:42 INFO:App Version: v20.166
2025/03/05 09:42 INFO:App Version: v20.166
2025/03/05 09:42 INFO:Switched to page: Head Line Figures
2025/03/05 09:42 INFO:Switched to page: Introduction
2025/03/05 09:42 INFO:Switched to page: Introduction
2025/03/05 09:42 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Switched to page: Introduction
2025/03/05 09:42 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:42 INFO:pagesetup executed successfully
2025/03/05 09:42 INFO:pagesetup executed successfully
2025/03/05 09:42 INFO:pagesetup executed successfully
2025/03/05 09:42 INFO:pagesetup executed successfully
2025/03/05 09:42 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:42 INFO:Menu setup completed successfully.
2025/03/05 09:42 INFO:Menu setup completed successfully.
2025/03/05 09:42 INFO:Menu setup completed successfully.
2025/03/05 09:42 INFO:Menu setup completed successfully.
2025/03/05 09:42 INFO:No data found in session state, running firstload()
2025/03/05 09:42 INFO:No data found in session state, running firstload()
2025/03/05 09:42 INFO:No data found in session state, running firstload()
2025/03/05 09:42 INFO:No data found in session state, running firstload()
2025/03/05 09:42 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Running first load function.
2025/03/05 09:42 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:42 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:42 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:42 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:42 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 INFO:get_file_modification_time executed successfully
2025/03/05 09:42 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:42 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:42 INFO:is_file_updated executed successfully
2025/03/05 09:42 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741105593.3717692 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 09:42 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:42 ERROR:Error in load_raw_data: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"]).min())
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 1063, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 247, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, format)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 433, in _convert_listlike_datetimes
    return _array_strptime_with_fallback(arg, name, utc, format, exact, errors)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 467, in _array_strptime_with_fallback
    result, tz_out = array_strptime(arg, fmt, exact=exact, errors=errors, utc=utc)
  File "strptime.pyx", line 501, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 451, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 583, in pandas._libs.tslibs.strptime._parse_with_format
ValueError: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
2025/03/05 09:42 CRITICAL:First load crashed: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 46, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"]).min())
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 1063, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 247, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, format)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 433, in _convert_listlike_datetimes
    return _array_strptime_with_fallback(arg, name, utc, format, exact, errors)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 467, in _array_strptime_with_fallback
    result, tz_out = array_strptime(arg, fmt, exact=exact, errors=errors, utc=utc)
  File "strptime.pyx", line 501, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 451, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 583, in pandas._libs.tslibs.strptime._parse_with_format
ValueError: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
2025/03/05 09:42 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Running first load function.
2025/03/05 09:42 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:42 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:42 ERROR:Error in load_raw_data: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"]).min())
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 1063, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 247, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, format)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 433, in _convert_listlike_datetimes
    return _array_strptime_with_fallback(arg, name, utc, format, exact, errors)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 467, in _array_strptime_with_fallback
    result, tz_out = array_strptime(arg, fmt, exact=exact, errors=errors, utc=utc)
  File "strptime.pyx", line 501, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 451, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 583, in pandas._libs.tslibs.strptime._parse_with_format
ValueError: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
2025/03/05 09:42 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 CRITICAL:First load crashed: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 46, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"]).min())
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 1063, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 247, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, format)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 433, in _convert_listlike_datetimes
    return _array_strptime_with_fallback(arg, name, utc, format, exact, errors)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 467, in _array_strptime_with_fallback
    result, tz_out = array_strptime(arg, fmt, exact=exact, errors=errors, utc=utc)
  File "strptime.pyx", line 501, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 451, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 583, in pandas._libs.tslibs.strptime._parse_with_format
ValueError: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
2025/03/05 09:42 INFO:Running first load function.
2025/03/05 09:42 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:42 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:42 ERROR:Error in load_raw_data: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"]).min())
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 1063, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 247, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, format)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 433, in _convert_listlike_datetimes
    return _array_strptime_with_fallback(arg, name, utc, format, exact, errors)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 467, in _array_strptime_with_fallback
    result, tz_out = array_strptime(arg, fmt, exact=exact, errors=errors, utc=utc)
  File "strptime.pyx", line 501, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 451, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 583, in pandas._libs.tslibs.strptime._parse_with_format
ValueError: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
2025/03/05 09:42 CRITICAL:First load crashed: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 46, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"]).min())
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 1063, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 247, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, format)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 433, in _convert_listlike_datetimes
    return _array_strptime_with_fallback(arg, name, utc, format, exact, errors)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 467, in _array_strptime_with_fallback
    result, tz_out = array_strptime(arg, fmt, exact=exact, errors=errors, utc=utc)
  File "strptime.pyx", line 501, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 451, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 583, in pandas._libs.tslibs.strptime._parse_with_format
ValueError: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
2025/03/05 09:42 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 INFO:Running first load function.
2025/03/05 09:42 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:42 DEBUG:Original data file path pre raw data load: {originaldatafilepath}
2025/03/05 09:42 DEBUG:Processed data file path pre raw data load: {processeddatafilepath}
2025/03/05 09:42 ERROR:Error in load_raw_data: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"]).min())
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 1063, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 247, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, format)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 433, in _convert_listlike_datetimes
    return _array_strptime_with_fallback(arg, name, utc, format, exact, errors)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 467, in _array_strptime_with_fallback
    result, tz_out = array_strptime(arg, fmt, exact=exact, errors=errors, utc=utc)
  File "strptime.pyx", line 501, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 451, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 583, in pandas._libs.tslibs.strptime._parse_with_format
ValueError: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
2025/03/05 09:42 CRITICAL:First load crashed: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 46, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 75, in firstload
    load_data_to_session("raw_data", get_raw_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 13, in get_raw_data
    return load_raw_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\datasetupandclean.py", line 57, in load_raw_data
    pd.to_datetime(loaddata_df["ReceivedDate"]).min())
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 1063, in to_datetime
    cache_array = _maybe_cache(arg, format, cache, convert_listlike)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 247, in _maybe_cache
    cache_dates = convert_listlike(unique_dates, format)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 433, in _convert_listlike_datetimes
    return _array_strptime_with_fallback(arg, name, utc, format, exact, errors)
  File "H:\python310\lib\site-packages\pandas\core\tools\datetimes.py", line 467, in _array_strptime_with_fallback
    result, tz_out = array_strptime(arg, fmt, exact=exact, errors=errors, utc=utc)
  File "strptime.pyx", line 501, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 451, in pandas._libs.tslibs.strptime.array_strptime
  File "strptime.pyx", line 583, in pandas._libs.tslibs.strptime._parse_with_format
ValueError: time data "30/08/2019" doesn't match format "%m/%d/%Y", at position 1. You might want to try:
    - passing `format` if your strings have a consistent format;
    - passing `format='ISO8601'` if your strings are all ISO8601 but not necessarily in exactly the same format;
    - passing `format='mixed'`, and the format will be inferred for each element individually. You might want to use `dayfirst` alongside this.
2025/03/05 09:45 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:Streamlit App Starting...
2025/03/05 09:45 INFO:Streamlit App Starting...
2025/03/05 09:45 INFO:Streamlit App Starting...
2025/03/05 09:45 INFO:Streamlit App Starting...
2025/03/05 09:45 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:Streamlit App Starting...
2025/03/05 09:45 INFO:Streamlit App Starting...
2025/03/05 09:45 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:45 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:45 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:45 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:45 INFO:Running App setup...
2025/03/05 09:45 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:45 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:45 INFO:Running App setup...
2025/03/05 09:45 INFO:Running App setup...
2025/03/05 09:45 INFO:Running App setup...
2025/03/05 09:45 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:Running App setup...
2025/03/05 09:45 INFO:Running App setup...
2025/03/05 09:45 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:Setting up the package
2025/03/05 09:45 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:Setting up the package
2025/03/05 09:45 INFO:Setting up the package
2025/03/05 09:45 INFO:Setting up the package
2025/03/05 09:45 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:Setting up the package
2025/03/05 09:45 INFO:Setting up the package
2025/03/05 09:45 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:Version: v20.145
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:Version: v20.145
2025/03/05 09:45 INFO:Version: v20.145
2025/03/05 09:45 INFO:Version: v20.145
2025/03/05 09:45 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:Version: v20.145
2025/03/05 09:45 INFO:Version: v20.145
2025/03/05 09:45 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:45 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:45 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:45 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:45 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:45 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:45 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:45 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:45 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:45 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:45 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:45 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:45 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:45 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:45 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:45 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:45 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:45 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:45 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:45 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:45 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:45 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:45 DEBUG:Initialised data_dir with value: data
2025/03/05 09:45 DEBUG:Initialised output_dir with value: output
2025/03/05 09:45 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:45 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:45 DEBUG:Initialised data_dir with value: data
2025/03/05 09:45 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:45 DEBUG:Initialised components_dir with value: components
2025/03/05 09:45 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:45 DEBUG:Initialised output_dir with value: output
2025/03/05 09:45 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:45 DEBUG:Initialised data_dir with value: data
2025/03/05 09:45 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:45 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:45 DEBUG:Initialised data_dir with value: data
2025/03/05 09:45 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:45 DEBUG:Initialised data_dir with value: data
2025/03/05 09:45 DEBUG:Initialised output_dir with value: output
2025/03/05 09:45 DEBUG:Initialised data_dir with value: data
2025/03/05 09:45 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:45 DEBUG:Initialised output_dir with value: output
2025/03/05 09:45 DEBUG:Initialised components_dir with value: components
2025/03/05 09:45 DEBUG:Initialised output_dir with value: output
2025/03/05 09:45 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:45 DEBUG:Initialised output_dir with value: output
2025/03/05 09:45 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:45 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:45 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:45 DEBUG:Initialised components_dir with value: components
2025/03/05 09:45 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:45 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:Initialised components_dir with value: components
2025/03/05 09:45 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:45 DEBUG:Initialised components_dir with value: components
2025/03/05 09:45 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:45 DEBUG:Initialised components_dir with value: components
2025/03/05 09:45 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:45 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:45 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:45 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:45 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:45 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:45 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:45 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:45 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:45 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:45 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:45 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:45 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:45 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:45 INFO:Session_state variables initialized
2025/03/05 09:45 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:45 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:45 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:45 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:45 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:45 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:45 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:45 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:45 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 INFO:Session_state variables initialized
2025/03/05 09:45 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:45 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:utils_dir: utils
2025/03/05 09:45 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:45 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:45 INFO:Session_state variables initialized
2025/03/05 09:45 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:45 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:45 INFO:Session_state variables initialized
2025/03/05 09:45 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 INFO:Session_state variables initialized
2025/03/05 09:45 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:45 INFO:Session_state variables initialized
2025/03/05 09:45 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:utils_dir: utils
2025/03/05 09:45 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:45 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:45 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:utils_dir: utils
2025/03/05 09:45 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:45 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:utils_dir: utils
2025/03/05 09:45 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:utils_dir: utils
2025/03/05 09:45 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:45 DEBUG:utils_dir: utils
2025/03/05 09:45 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:45 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:45 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:45 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:45 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:45 DEBUG:reference_dir: reference_files
2025/03/05 09:45 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:45 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:45 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:reference_dir: reference_files
2025/03/05 09:45 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:45 DEBUG:perc_target: 0.5
2025/03/05 09:45 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:reference_dir: reference_files
2025/03/05 09:45 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:45 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:45 DEBUG:reference_dir: reference_files
2025/03/05 09:45 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:reference_dir: reference_files
2025/03/05 09:45 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:reference_dir: reference_files
2025/03/05 09:45 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:45 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:perc_target: 0.5
2025/03/05 09:45 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:45 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:45 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:perc_target: 0.5
2025/03/05 09:45 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:45 DEBUG:output_dir: output
2025/03/05 09:45 DEBUG:perc_target: 0.5
2025/03/05 09:45 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:45 DEBUG:perc_target: 0.5
2025/03/05 09:45 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:45 DEBUG:perc_target: 0.5
2025/03/05 09:45 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:45 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:45 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:45 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:45 DEBUG:app_pages_dir: app_pages
2025/03/05 09:45 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:45 DEBUG:output_dir: output
2025/03/05 09:45 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:45 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:45 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:output_dir: output
2025/03/05 09:45 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:45 DEBUG:logs_dir: logs
2025/03/05 09:45 DEBUG:output_dir: output
2025/03/05 09:45 DEBUG:app_pages_dir: app_pages
2025/03/05 09:45 DEBUG:output_dir: output
2025/03/05 09:45 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:output_dir: output
2025/03/05 09:45 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:app_pages_dir: app_pages
2025/03/05 09:45 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:45 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:app_pages_dir: app_pages
2025/03/05 09:45 DEBUG:logs_dir: logs
2025/03/05 09:45 DEBUG:app_pages_dir: app_pages
2025/03/05 09:45 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:app_pages_dir: app_pages
2025/03/05 09:45 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:logs_dir: logs
2025/03/05 09:45 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:45 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:45 DEBUG:logs_dir: logs
2025/03/05 09:45 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:logs_dir: logs
2025/03/05 09:45 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:logs_dir: logs
2025/03/05 09:45 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:45 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:45 DEBUG:components_dir: components
2025/03/05 09:45 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:45 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:45 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:45 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:45 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:45 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:45 DEBUG:components_dir: components
2025/03/05 09:45 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:45 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:45 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:45 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:45 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:45 DEBUG:components_dir: components
2025/03/05 09:45 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:45 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:components_dir: components
2025/03/05 09:45 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:components_dir: components
2025/03/05 09:45 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:components_dir: components
2025/03/05 09:45 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:45 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:45 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:45 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:45 DEBUG:data_dir: data
2025/03/05 09:45 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:45 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:45 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:45 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:45 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:45 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:45 DEBUG:data_dir: data
2025/03/05 09:45 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:45 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:45 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:data_dir: data
2025/03/05 09:45 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:45 INFO:Session state Setup complete
2025/03/05 09:45 INFO:initialize_session_state executed successfully
2025/03/05 09:45 INFO:Package setup complete
2025/03/05 09:45 INFO:setup_package executed successfully
2025/03/05 09:45 INFO:Setup completed successfully.
2025/03/05 09:45 DEBUG:data_dir: data
2025/03/05 09:45 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:45 INFO:Running Menu setup...
2025/03/05 09:45 INFO:Session state Setup complete
2025/03/05 09:45 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:data_dir: data
2025/03/05 09:45 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:45 DEBUG:data_dir: data
2025/03/05 09:45 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:initialize_session_state executed successfully
2025/03/05 09:45 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:45 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:45 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:45 INFO:Session state Setup complete
2025/03/05 09:45 INFO:Package setup complete
2025/03/05 09:45 INFO:Session state Setup complete
2025/03/05 09:45 INFO:Session state Setup complete
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:45 INFO:initialize_session_state executed successfully
2025/03/05 09:45 INFO:setup_package executed successfully
2025/03/05 09:45 INFO:initialize_session_state executed successfully
2025/03/05 09:45 INFO:initialize_session_state executed successfully
2025/03/05 09:45 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:45 INFO:Package setup complete
2025/03/05 09:45 INFO:Setup completed successfully.
2025/03/05 09:45 INFO:Package setup complete
2025/03/05 09:45 INFO:Package setup complete
2025/03/05 09:45 INFO:Session state Setup complete
2025/03/05 09:45 INFO:setup_package executed successfully
2025/03/05 09:45 INFO:Running Menu setup...
2025/03/05 09:45 INFO:setup_package executed successfully
2025/03/05 09:45 INFO:setup_package executed successfully
2025/03/05 09:45 INFO:initialize_session_state executed successfully
2025/03/05 09:45 INFO:Setup completed successfully.
2025/03/05 09:45 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:Setup completed successfully.
2025/03/05 09:45 INFO:Setup completed successfully.
2025/03/05 09:45 INFO:Package setup complete
2025/03/05 09:45 INFO:Running Menu setup...
2025/03/05 09:45 INFO:Running Menu setup...
2025/03/05 09:45 INFO:Running Menu setup...
2025/03/05 09:45 INFO:setup_package executed successfully
2025/03/05 09:45 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:Setup completed successfully.
2025/03/05 09:45 INFO:Running Menu setup...
2025/03/05 09:45 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:App Version: v20.166
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:get_git_version executed successfully
2025/03/05 09:45 INFO:App Version: v20.166
2025/03/05 09:45 INFO:App Version: v20.166
2025/03/05 09:45 INFO:Switched to page: Introduction
2025/03/05 09:45 INFO:App Version: v20.166
2025/03/05 09:45 INFO:App Version: v20.166
2025/03/05 09:45 INFO:App Version: v20.166
2025/03/05 09:45 INFO:Switched to page: Introduction
2025/03/05 09:45 INFO:Switched to page: Head Line Figures
2025/03/05 09:45 INFO:Switched to page: Introduction
2025/03/05 09:45 INFO:Switched to page: Introduction
2025/03/05 09:45 INFO:Switched to page: Introduction
2025/03/05 09:45 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:45 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:pagesetup executed successfully
2025/03/05 09:45 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:45 INFO:pagesetup executed successfully
2025/03/05 09:45 INFO:Menu setup completed successfully.
2025/03/05 09:45 INFO:pagesetup executed successfully
2025/03/05 09:45 INFO:pagesetup executed successfully
2025/03/05 09:45 INFO:pagesetup executed successfully
2025/03/05 09:45 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:45 INFO:Menu setup completed successfully.
2025/03/05 09:45 INFO:No data found in session state, running firstload()
2025/03/05 09:45 INFO:Menu setup completed successfully.
2025/03/05 09:45 INFO:Menu setup completed successfully.
2025/03/05 09:45 INFO:Menu setup completed successfully.
2025/03/05 09:45 INFO:No data found in session state, running firstload()
2025/03/05 09:45 INFO:No data found in session state, running firstload()
2025/03/05 09:45 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:45 INFO:No data found in session state, running firstload()
2025/03/05 09:45 INFO:No data found in session state, running firstload()
2025/03/05 09:46 INFO:Running first load function.
2025/03/05 09:46 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/05 09:46 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/05 09:46 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:46 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:46 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 INFO:get_file_modification_time executed successfully
2025/03/05 09:46 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:46 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:46 INFO:is_file_updated executed successfully
2025/03/05 09:46 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741105593.3717692 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:46 INFO:load_raw_data executed successfully
2025/03/05 09:46 INFO:get_raw_data executed successfully
2025/03/05 09:46 DEBUG:st.session_state.raw_data: 65278
2025/03/05 09:46 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Rows in Raw Data: 65278
2025/03/05 09:46 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 09:46 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 09:46 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 09:46 INFO:get_file_modification_time executed successfully
2025/03/05 09:46 INFO:Current modification time: 1741105593.3717692
2025/03/05 09:46 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:46 INFO:is_file_updated executed successfully
2025/03/05 09:46 INFO:Loading preprocessed data. Using output\cleaned_data.csv dated 1741105593.3717692 instead of output\cleaned_donations.csv
2025/03/05 09:46 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:46 INFO:load_cleaned_data executed successfully
2025/03/05 09:46 INFO:get_cleaned_data executed successfully
2025/03/05 09:46 DEBUG:st.session_state.raw_data: 65278
2025/03/05 09:46 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Original file path: output\cleaned_data.csv
2025/03/05 09:46 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 09:46 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 09:46 INFO:get_file_modification_time executed successfully
2025/03/05 09:46 INFO:Current modification time: 1741105598.5723538
2025/03/05 09:46 INFO:Last modification time: 1741105598.5723538
2025/03/05 09:46 INFO:is_file_updated executed successfully
2025/03/05 09:46 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated 1741105598.5723538 instead of output\cleaned_data.csv
2025/03/05 09:46 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:46 INFO:load_donorList_data executed successfully
2025/03/05 09:46 INFO:get_donor_data executed successfully
2025/03/05 09:46 DEBUG:st.session_state.data_donor: 25576
2025/03/05 09:46 DEBUG:st.session_state.data_clean: 65278
2025/03/05 09:46 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Original file path: output\cleaned_data.csv
2025/03/05 09:46 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 09:46 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 09:46 INFO:get_file_modification_time executed successfully
2025/03/05 09:46 INFO:Current modification time: 1741105598.5723538
2025/03/05 09:46 INFO:Last modification time: 1741105598.5723538
2025/03/05 09:46 INFO:is_file_updated executed successfully
2025/03/05 09:46 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741105598.5723538 instead of output\cleaned_data.csv
2025/03/05 09:46 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:46 INFO:load_regulated_entity_data executed successfully
2025/03/05 09:46 INFO:get_regentity_data executed successfully
2025/03/05 09:46 DEBUG:st.session_state.data_regentity: 1364
2025/03/05 09:46 DEBUG:st.session_state.data_donor: 25576
2025/03/05 09:46 DEBUG:st.session_state.data_clean: 65278
2025/03/05 09:46 INFO:firstload executed successfully
2025/03/05 09:46 INFO:Data first load completed successfully.
2025/03/05 09:46 INFO:initialise_data executed successfully
2025/03/05 09:46 INFO:App is fully loaded and ready!
2025/03/05 09:46 INFO:App is fully loaded and ready!
2025/03/05 09:46 INFO:App is fully loaded and ready!
2025/03/05 09:46 INFO:App is fully loaded and ready!
2025/03/05 09:46 INFO:App is fully loaded and ready!
2025/03/05 09:46 INFO:Streamlit App Starting...
2025/03/05 09:46 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:46 INFO:Running App setup...
2025/03/05 09:46 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Setting up the package
2025/03/05 09:46 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:Version: v20.145
2025/03/05 09:46 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 09:46 DEBUG:BASE_DIR already exists in session state
2025/03/05 09:46 DEBUG:filenames already exists in session state
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 09:46 DEBUG:thresholds already exists in session state
2025/03/05 09:46 DEBUG:data_remappings already exists in session state
2025/03/05 09:46 DEBUG:filter_def already exists in session state
2025/03/05 09:46 DEBUG:security already exists in session state
2025/03/05 09:46 DEBUG:perc_target already exists in session state
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 09:46 DEBUG:directories already exists in session state
2025/03/05 09:46 DEBUG:reference_dir already exists in session state
2025/03/05 09:46 DEBUG:data_dir already exists in session state
2025/03/05 09:46 DEBUG:output_dir already exists in session state
2025/03/05 09:46 DEBUG:logs_dir already exists in session state
2025/03/05 09:46 DEBUG:components_dir already exists in session state
2025/03/05 09:46 DEBUG:app_pages_dir already exists in session state
2025/03/05 09:46 DEBUG:utils_dir already exists in session state
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 09:46 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 09:46 DEBUG:donor_map_fname already exists in session state
2025/03/05 09:46 DEBUG:politician_party_fname already exists in session state
2025/03/05 09:46 DEBUG:regentity_map_fname already exists in session state
2025/03/05 09:46 DEBUG:original_data_fname already exists in session state
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 09:46 DEBUG:TEXT_FILE already exists in session state
2025/03/05 09:46 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 09:46 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 09:46 DEBUG:party_summary_fname already exists in session state
2025/03/05 09:46 DEBUG:imported_raw_fname already exists in session state
2025/03/05 09:46 DEBUG:source_data_fname already exists in session state
2025/03/05 09:46 DEBUG:Cash_ftr already exists in session state
2025/03/05 09:46 INFO:Session_state variables initialized
2025/03/05 09:46 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:utils_dir: utils
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:reference_dir: reference_files
2025/03/05 09:46 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:perc_target: 0.5
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:46 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:46 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:output_dir: output
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:app_pages_dir: app_pages
2025/03/05 09:46 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:logs_dir: logs
2025/03/05 09:46 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000018522DECAF0>}
2025/03/05 09:46 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:46 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:46 DEBUG:components_dir: components
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:46 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:data_dir: data
2025/03/05 09:46 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:46 INFO:Session state Setup complete
2025/03/05 09:46 INFO:initialize_session_state executed successfully
2025/03/05 09:46 INFO:Package setup complete
2025/03/05 09:46 INFO:setup_package executed successfully
2025/03/05 09:46 INFO:Setup completed successfully.
2025/03/05 09:46 INFO:Running Menu setup...
2025/03/05 09:46 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:App Version: v20.166
2025/03/05 09:46 INFO:Switched to page: Head Line Figures
2025/03/05 09:46 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:46 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:46 INFO:Streamlit App Starting...
2025/03/05 09:46 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:46 INFO:Running App setup...
2025/03/05 09:46 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Setting up the package
2025/03/05 09:46 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:Version: v20.145
2025/03/05 09:46 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 09:46 DEBUG:BASE_DIR already exists in session state
2025/03/05 09:46 DEBUG:filenames already exists in session state
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 09:46 DEBUG:thresholds already exists in session state
2025/03/05 09:46 DEBUG:data_remappings already exists in session state
2025/03/05 09:46 DEBUG:filter_def already exists in session state
2025/03/05 09:46 DEBUG:security already exists in session state
2025/03/05 09:46 DEBUG:perc_target already exists in session state
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 09:46 DEBUG:directories already exists in session state
2025/03/05 09:46 DEBUG:reference_dir already exists in session state
2025/03/05 09:46 DEBUG:data_dir already exists in session state
2025/03/05 09:46 DEBUG:output_dir already exists in session state
2025/03/05 09:46 DEBUG:logs_dir already exists in session state
2025/03/05 09:46 DEBUG:components_dir already exists in session state
2025/03/05 09:46 DEBUG:app_pages_dir already exists in session state
2025/03/05 09:46 DEBUG:utils_dir already exists in session state
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 09:46 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 09:46 DEBUG:donor_map_fname already exists in session state
2025/03/05 09:46 DEBUG:politician_party_fname already exists in session state
2025/03/05 09:46 DEBUG:regentity_map_fname already exists in session state
2025/03/05 09:46 DEBUG:original_data_fname already exists in session state
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 09:46 DEBUG:TEXT_FILE already exists in session state
2025/03/05 09:46 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 09:46 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 09:46 DEBUG:party_summary_fname already exists in session state
2025/03/05 09:46 DEBUG:imported_raw_fname already exists in session state
2025/03/05 09:46 DEBUG:source_data_fname already exists in session state
2025/03/05 09:46 DEBUG:Cash_ftr already exists in session state
2025/03/05 09:46 INFO:Session_state variables initialized
2025/03/05 09:46 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:utils_dir: utils
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:reference_dir: reference_files
2025/03/05 09:46 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:perc_target: 0.5
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:46 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:46 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:output_dir: output
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:app_pages_dir: app_pages
2025/03/05 09:46 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:logs_dir: logs
2025/03/05 09:46 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:menu_selection: {'title': 'Introduction', 'function': <function introduction_body at 0x0000018511C0CA60>}
2025/03/05 09:46 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:46 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:46 DEBUG:components_dir: components
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:46 DEBUG:error_logged: True
2025/03/05 09:46 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:data_dir: data
2025/03/05 09:46 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:46 INFO:Session state Setup complete
2025/03/05 09:46 INFO:initialize_session_state executed successfully
2025/03/05 09:46 INFO:Package setup complete
2025/03/05 09:46 INFO:setup_package executed successfully
2025/03/05 09:46 INFO:Setup completed successfully.
2025/03/05 09:46 INFO:Running Menu setup...
2025/03/05 09:46 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:App Version: v20.166
2025/03/05 09:46 INFO:Switched to page: Introduction
2025/03/05 09:46 INFO:pagesetup executed successfully
2025/03/05 09:46 INFO:Menu setup completed successfully.
2025/03/05 09:46 INFO:No data found in session state, running firstload()
2025/03/05 09:46 INFO:App is fully loaded and ready!
2025/03/05 09:46 INFO:Streamlit App Starting...
2025/03/05 09:46 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:46 INFO:Running App setup...
2025/03/05 09:46 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Setting up the package
2025/03/05 09:46 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:Version: v20.145
2025/03/05 09:46 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 09:46 DEBUG:BASE_DIR already exists in session state
2025/03/05 09:46 DEBUG:filenames already exists in session state
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 09:46 DEBUG:thresholds already exists in session state
2025/03/05 09:46 DEBUG:data_remappings already exists in session state
2025/03/05 09:46 DEBUG:filter_def already exists in session state
2025/03/05 09:46 DEBUG:security already exists in session state
2025/03/05 09:46 DEBUG:perc_target already exists in session state
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 09:46 DEBUG:directories already exists in session state
2025/03/05 09:46 DEBUG:reference_dir already exists in session state
2025/03/05 09:46 DEBUG:data_dir already exists in session state
2025/03/05 09:46 DEBUG:output_dir already exists in session state
2025/03/05 09:46 DEBUG:logs_dir already exists in session state
2025/03/05 09:46 DEBUG:components_dir already exists in session state
2025/03/05 09:46 DEBUG:app_pages_dir already exists in session state
2025/03/05 09:46 DEBUG:utils_dir already exists in session state
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 09:46 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 09:46 DEBUG:donor_map_fname already exists in session state
2025/03/05 09:46 DEBUG:politician_party_fname already exists in session state
2025/03/05 09:46 DEBUG:regentity_map_fname already exists in session state
2025/03/05 09:46 DEBUG:original_data_fname already exists in session state
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 09:46 DEBUG:TEXT_FILE already exists in session state
2025/03/05 09:46 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 09:46 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 09:46 DEBUG:party_summary_fname already exists in session state
2025/03/05 09:46 DEBUG:imported_raw_fname already exists in session state
2025/03/05 09:46 DEBUG:source_data_fname already exists in session state
2025/03/05 09:46 DEBUG:Cash_ftr already exists in session state
2025/03/05 09:46 INFO:Session_state variables initialized
2025/03/05 09:46 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:utils_dir: utils
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:reference_dir: reference_files
2025/03/05 09:46 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:perc_target: 0.5
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:46 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:46 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:output_dir: output
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:app_pages_dir: app_pages
2025/03/05 09:46 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:logs_dir: logs
2025/03/05 09:46 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x0000018522DED5A0>}
2025/03/05 09:46 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:46 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:46 DEBUG:components_dir: components
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:46 DEBUG:error_logged: True
2025/03/05 09:46 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:data_dir: data
2025/03/05 09:46 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:46 INFO:Session state Setup complete
2025/03/05 09:46 INFO:initialize_session_state executed successfully
2025/03/05 09:46 INFO:Package setup complete
2025/03/05 09:46 INFO:setup_package executed successfully
2025/03/05 09:46 INFO:Setup completed successfully.
2025/03/05 09:46 INFO:Running Menu setup...
2025/03/05 09:46 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:App Version: v20.166
2025/03/05 09:46 INFO:Switched to page: Bequeths
2025/03/05 09:46 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 54, in mod_bequeths_page
    display_data_page(filter_key="Bequests_ftr",
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page.py", line 20, in display_data_page
    cleaned_c_d_df) = load_and_filter_data(filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:46 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:Streamlit App Starting...
2025/03/05 09:46 INFO:Streamlit App Starting...
2025/03/05 09:46 INFO:Streamlit App Starting...
2025/03/05 09:46 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:46 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:46 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:46 INFO:Running App setup...
2025/03/05 09:46 INFO:Running App setup...
2025/03/05 09:46 INFO:Running App setup...
2025/03/05 09:46 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Setting up the package
2025/03/05 09:46 INFO:Setting up the package
2025/03/05 09:46 INFO:Setting up the package
2025/03/05 09:46 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:Version: v20.145
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:Version: v20.145
2025/03/05 09:46 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Version: v20.145
2025/03/05 09:46 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:46 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:46 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:46 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:46 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:46 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:46 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:46 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:46 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:46 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:46 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:46 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:46 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:46 DEBUG:Initialised data_dir with value: data
2025/03/05 09:46 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:46 DEBUG:Initialised output_dir with value: output
2025/03/05 09:46 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:46 DEBUG:Initialised data_dir with value: data
2025/03/05 09:46 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:46 DEBUG:Initialised data_dir with value: data
2025/03/05 09:46 DEBUG:Initialised output_dir with value: output
2025/03/05 09:46 DEBUG:Initialised components_dir with value: components
2025/03/05 09:46 DEBUG:Initialised output_dir with value: output
2025/03/05 09:46 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:46 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:46 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:46 DEBUG:Initialised components_dir with value: components
2025/03/05 09:46 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:46 DEBUG:Initialised components_dir with value: components
2025/03/05 09:46 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:46 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:46 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:46 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:46 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:46 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:46 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:46 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:46 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:46 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:46 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:46 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:46 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 INFO:Session_state variables initialized
2025/03/05 09:46 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:46 DEBUG:perc_target: 0.5
2025/03/05 09:46 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:46 INFO:Session_state variables initialized
2025/03/05 09:46 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 INFO:Session_state variables initialized
2025/03/05 09:46 DEBUG:perc_target: 0.5
2025/03/05 09:46 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:46 DEBUG:perc_target: 0.5
2025/03/05 09:46 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:46 DEBUG:app_pages_dir: app_pages
2025/03/05 09:46 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:46 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:app_pages_dir: app_pages
2025/03/05 09:46 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:data_dir: data
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:data_dir: data
2025/03/05 09:46 DEBUG:data_dir: data
2025/03/05 09:46 DEBUG:reference_dir: reference_files
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:46 DEBUG:reference_dir: reference_files
2025/03/05 09:46 DEBUG:reference_dir: reference_files
2025/03/05 09:46 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:46 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:46 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:46 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:output_dir: output
2025/03/05 09:46 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:output_dir: output
2025/03/05 09:46 DEBUG:components_dir: components
2025/03/05 09:46 DEBUG:output_dir: output
2025/03/05 09:46 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:components_dir: components
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:components_dir: components
2025/03/05 09:46 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:46 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:46 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:46 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:46 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:46 DEBUG:utils_dir: utils
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:46 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:46 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:utils_dir: utils
2025/03/05 09:46 DEBUG:logs_dir: logs
2025/03/05 09:46 DEBUG:utils_dir: utils
2025/03/05 09:46 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:46 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:46 DEBUG:logs_dir: logs
2025/03/05 09:46 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:logs_dir: logs
2025/03/05 09:46 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:46 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:46 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 INFO:Session state Setup complete
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 INFO:initialize_session_state executed successfully
2025/03/05 09:46 DEBUG:app_pages_dir: app_pages
2025/03/05 09:46 INFO:Session state Setup complete
2025/03/05 09:46 INFO:Package setup complete
2025/03/05 09:46 INFO:Session state Setup complete
2025/03/05 09:46 INFO:initialize_session_state executed successfully
2025/03/05 09:46 INFO:setup_package executed successfully
2025/03/05 09:46 INFO:initialize_session_state executed successfully
2025/03/05 09:46 INFO:Package setup complete
2025/03/05 09:46 INFO:Setup completed successfully.
2025/03/05 09:46 INFO:Package setup complete
2025/03/05 09:46 INFO:setup_package executed successfully
2025/03/05 09:46 INFO:Running Menu setup...
2025/03/05 09:46 INFO:setup_package executed successfully
2025/03/05 09:46 INFO:Setup completed successfully.
2025/03/05 09:46 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Setup completed successfully.
2025/03/05 09:46 INFO:Running Menu setup...
2025/03/05 09:46 INFO:Running Menu setup...
2025/03/05 09:46 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:App Version: v20.166
2025/03/05 09:46 INFO:App Version: v20.166
2025/03/05 09:46 INFO:App Version: v20.166
2025/03/05 09:46 INFO:Switched to page: Introduction
2025/03/05 09:46 INFO:Switched to page: Bequeths
2025/03/05 09:46 INFO:Switched to page: Head Line Figures
2025/03/05 09:46 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:pagesetup executed successfully
2025/03/05 09:46 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Menu setup completed successfully.
2025/03/05 09:46 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:46 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:46 INFO:No data found in session state, running firstload()
2025/03/05 09:46 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 54, in mod_bequeths_page
    display_data_page(filter_key="Bequests_ftr",
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page.py", line 20, in display_data_page
    cleaned_c_d_df) = load_and_filter_data(filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:46 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:46 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Running first load function.
2025/03/05 09:46 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/05 09:46 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/05 09:46 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:46 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:46 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 INFO:get_file_modification_time executed successfully
2025/03/05 09:46 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:46 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:46 INFO:is_file_updated executed successfully
2025/03/05 09:46 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741105593.3717692 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:46 INFO:load_raw_data executed successfully
2025/03/05 09:46 INFO:get_raw_data executed successfully
2025/03/05 09:46 DEBUG:st.session_state.raw_data: 65278
2025/03/05 09:46 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Rows in Raw Data: 65278
2025/03/05 09:46 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 09:46 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 09:46 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 09:46 INFO:get_file_modification_time executed successfully
2025/03/05 09:46 INFO:Current modification time: 1741105593.3717692
2025/03/05 09:46 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:46 INFO:is_file_updated executed successfully
2025/03/05 09:46 INFO:Loading preprocessed data. Using output\cleaned_data.csv dated 1741105593.3717692 instead of output\cleaned_donations.csv
2025/03/05 09:46 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:46 INFO:load_cleaned_data executed successfully
2025/03/05 09:46 INFO:get_cleaned_data executed successfully
2025/03/05 09:46 DEBUG:st.session_state.raw_data: 65278
2025/03/05 09:46 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Original file path: output\cleaned_data.csv
2025/03/05 09:46 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 09:46 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 09:46 INFO:get_file_modification_time executed successfully
2025/03/05 09:46 INFO:Current modification time: 1741105598.5723538
2025/03/05 09:46 INFO:Last modification time: 1741105598.5723538
2025/03/05 09:46 INFO:is_file_updated executed successfully
2025/03/05 09:46 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated 1741105598.5723538 instead of output\cleaned_data.csv
2025/03/05 09:46 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:46 INFO:load_donorList_data executed successfully
2025/03/05 09:46 INFO:get_donor_data executed successfully
2025/03/05 09:46 DEBUG:st.session_state.data_donor: 25576
2025/03/05 09:46 DEBUG:st.session_state.data_clean: 65278
2025/03/05 09:46 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Original file path: output\cleaned_data.csv
2025/03/05 09:46 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 09:46 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 09:46 INFO:get_file_modification_time executed successfully
2025/03/05 09:46 INFO:Current modification time: 1741105598.5723538
2025/03/05 09:46 INFO:Last modification time: 1741105598.5723538
2025/03/05 09:46 INFO:is_file_updated executed successfully
2025/03/05 09:46 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741105598.5723538 instead of output\cleaned_data.csv
2025/03/05 09:46 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:46 INFO:load_regulated_entity_data executed successfully
2025/03/05 09:46 INFO:get_regentity_data executed successfully
2025/03/05 09:46 DEBUG:st.session_state.data_regentity: 1364
2025/03/05 09:46 DEBUG:st.session_state.data_donor: 25576
2025/03/05 09:46 DEBUG:st.session_state.data_clean: 65278
2025/03/05 09:46 INFO:firstload executed successfully
2025/03/05 09:46 INFO:Data first load completed successfully.
2025/03/05 09:46 INFO:initialise_data executed successfully
2025/03/05 09:46 INFO:App is fully loaded and ready!
2025/03/05 09:46 INFO:Streamlit App Starting...
2025/03/05 09:46 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:46 INFO:Running App setup...
2025/03/05 09:46 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:Setting up the package
2025/03/05 09:46 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:Version: v20.145
2025/03/05 09:46 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 09:46 DEBUG:BASE_DIR already exists in session state
2025/03/05 09:46 DEBUG:filenames already exists in session state
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 09:46 DEBUG:thresholds already exists in session state
2025/03/05 09:46 DEBUG:data_remappings already exists in session state
2025/03/05 09:46 DEBUG:filter_def already exists in session state
2025/03/05 09:46 DEBUG:security already exists in session state
2025/03/05 09:46 DEBUG:perc_target already exists in session state
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 09:46 DEBUG:directories already exists in session state
2025/03/05 09:46 DEBUG:reference_dir already exists in session state
2025/03/05 09:46 DEBUG:data_dir already exists in session state
2025/03/05 09:46 DEBUG:output_dir already exists in session state
2025/03/05 09:46 DEBUG:logs_dir already exists in session state
2025/03/05 09:46 DEBUG:components_dir already exists in session state
2025/03/05 09:46 DEBUG:app_pages_dir already exists in session state
2025/03/05 09:46 DEBUG:utils_dir already exists in session state
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 09:46 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 09:46 DEBUG:donor_map_fname already exists in session state
2025/03/05 09:46 DEBUG:politician_party_fname already exists in session state
2025/03/05 09:46 DEBUG:regentity_map_fname already exists in session state
2025/03/05 09:46 DEBUG:original_data_fname already exists in session state
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 09:46 DEBUG:TEXT_FILE already exists in session state
2025/03/05 09:46 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 09:46 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 09:46 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 09:46 DEBUG:party_summary_fname already exists in session state
2025/03/05 09:46 DEBUG:imported_raw_fname already exists in session state
2025/03/05 09:46 DEBUG:source_data_fname already exists in session state
2025/03/05 09:46 DEBUG:Cash_ftr already exists in session state
2025/03/05 09:46 INFO:Session_state variables initialized
2025/03/05 09:46 DEBUG:perc_target: 0.5
2025/03/05 09:46 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:46 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:46 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:46 DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Fin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/05 09:46 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x0000013BC20E8940>}
2025/03/05 09:46 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:46 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:46 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:46 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 09:46 DEBUG:reference_dir: reference_files
2025/03/05 09:46 DEBUG:data_dir: data
2025/03/05 09:46 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:46 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:46 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:46 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:46 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:46 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:46 DEBUG:raw_data:        index      ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... RegulatedEntityId AccountingUnitId  DonorId  CampaigningName   RegisterName IsIrishSource
0          0  NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
1          1  NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
2          2  NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
3          3  NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
4          4  NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
...      ...        ...                              ...                    ...          ...          ...  ...               ...              ...      ...              ...            ...           ...
65273  65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              3945              NaN  74198.0              NaN            NaN         False
65274  65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              3945              NaN  74184.0              NaN            NaN         False
65275  65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              3945              NaN  74576.0              NaN            NaN         False
65276  65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...                52              NaN  34241.0              NaN  Great Britain         False
65277  65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...                52              NaN  74743.0              NaN  Great Britain         False

[65278 rows x 30 columns]
2025/03/05 09:46 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:46 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:46 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:46 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:46 DEBUG:output_dir: output
2025/03/05 09:46 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:46 DEBUG:components_dir: components
2025/03/05 09:46 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:46 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:46 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:46 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:46 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:46 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:46 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:46 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:46 DEBUG:data_clean:        Unnamed: 0      ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WksSinceLastElection  QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0               0  NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...               4710.0                   2.0                 363.0                 1.0                 91.0
1               1  NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
2               2  NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...               4710.0                   2.0                 363.0                 1.0                 91.0
3               3  NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
4               4  NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...               4709.0                   2.0                 363.0                 1.0                 91.0
...           ...        ...                              ...                    ...        ...  ...                  ...                   ...                   ...                 ...                  ...
65273       78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...               4532.0                   5.0                 349.0                 2.0                 87.0
65274       78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...               4524.0                   6.0                 348.0                 2.0                 87.0
65275       78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...               4543.0                   4.0                 350.0                 1.0                 88.0
65276       78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...               4591.0                   1.0                 354.0                 1.0                 89.0
65277       78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...               4592.0                   1.0                 354.0                 1.0                 89.0

[65278 rows x 58 columns]
2025/03/05 09:46 DEBUG:utils_dir: utils
2025/03/05 09:46 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:46 DEBUG:logs_dir: logs
2025/03/05 09:46 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:46 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:46 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:46 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:46 DEBUG:app_pages_dir: app_pages
2025/03/05 09:46 INFO:Session state Setup complete
2025/03/05 09:46 INFO:initialize_session_state executed successfully
2025/03/05 09:46 INFO:Package setup complete
2025/03/05 09:46 INFO:setup_package executed successfully
2025/03/05 09:46 INFO:Setup completed successfully.
2025/03/05 09:46 INFO:Running Menu setup...
2025/03/05 09:46 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:46 INFO:get_git_version executed successfully
2025/03/05 09:46 INFO:App Version: v20.166
2025/03/05 09:46 INFO:Switched to page: Head Line Figures
2025/03/05 09:46 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:46 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:46 ERROR:Error in load_and_filter_data: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 29, in load_and_filter_data
    min_date = st.session_state.min_date
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:46 CRITICAL:Menu setup crashed: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 29, in load_and_filter_data
    min_date = st.session_state.min_date
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "min_date". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:49 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:Streamlit App Starting...
2025/03/05 09:49 INFO:Streamlit App Starting...
2025/03/05 09:49 INFO:Streamlit App Starting...
2025/03/05 09:49 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:49 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:49 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:49 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:49 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:49 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:49 INFO:Running App setup...
2025/03/05 09:49 INFO:Running App setup...
2025/03/05 09:49 INFO:Running App setup...
2025/03/05 09:49 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Setting up the package
2025/03/05 09:49 INFO:Setting up the package
2025/03/05 09:49 INFO:Setting up the package
2025/03/05 09:49 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:49 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:49 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:Version: v20.145
2025/03/05 09:49 INFO:Version: v20.145
2025/03/05 09:49 INFO:Version: v20.145
2025/03/05 09:49 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:49 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:49 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:49 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:49 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 09:49 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:49 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:49 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:49 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:49 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:49 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 09:49 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:49 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:49 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 09:49 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:49 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:49 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:49 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:49 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:49 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:49 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:49 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:49 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:49 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:49 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:49 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:49 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:49 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:49 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 09:49 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:49 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:49 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 09:49 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:49 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:49 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:49 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:49 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:49 DEBUG:Initialised data_dir with value: data
2025/03/05 09:49 DEBUG:Initialised data_dir with value: data
2025/03/05 09:49 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 09:49 DEBUG:Initialised output_dir with value: output
2025/03/05 09:49 DEBUG:Initialised output_dir with value: output
2025/03/05 09:49 DEBUG:Initialised data_dir with value: data
2025/03/05 09:49 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:49 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:49 DEBUG:Initialised output_dir with value: output
2025/03/05 09:49 DEBUG:Initialised components_dir with value: components
2025/03/05 09:49 DEBUG:Initialised components_dir with value: components
2025/03/05 09:49 DEBUG:Initialised logs_dir with value: logs
2025/03/05 09:49 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:49 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:49 DEBUG:Initialised components_dir with value: components
2025/03/05 09:49 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:49 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:49 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 09:49 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:49 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:49 DEBUG:Initialised utils_dir with value: utils
2025/03/05 09:49 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:49 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:49 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:49 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:49 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:49 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:49 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:49 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:49 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 09:49 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:49 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:49 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:49 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:49 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:49 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:49 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:49 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:49 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:49 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:49 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:49 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 09:49 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:49 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:49 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 09:49 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:49 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:49 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 09:49 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:49 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:49 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:49 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 09:49 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 09:49 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:49 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:49 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 09:49 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:49 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:49 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 09:49 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 09:49 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:49 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:49 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 INFO:Session_state variables initialized
2025/03/05 09:49 INFO:Session_state variables initialized
2025/03/05 09:49 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 09:49 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:49 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:49 INFO:Session_state variables initialized
2025/03/05 09:49 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:49 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:49 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:49 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:49 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:49 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:49 DEBUG:perc_target: 0.5
2025/03/05 09:49 DEBUG:perc_target: 0.5
2025/03/05 09:49 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:49 DEBUG:output_dir: output
2025/03/05 09:49 DEBUG:output_dir: output
2025/03/05 09:49 DEBUG:perc_target: 0.5
2025/03/05 09:49 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:49 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:49 DEBUG:output_dir: output
2025/03/05 09:49 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:49 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:49 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:49 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:49 DEBUG:reference_dir: reference_files
2025/03/05 09:49 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:49 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:49 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:49 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:49 DEBUG:reference_dir: reference_files
2025/03/05 09:49 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:49 DEBUG:reference_dir: reference_files
2025/03/05 09:49 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:49 DEBUG:logs_dir: logs
2025/03/05 09:49 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:49 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:49 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:49 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:49 DEBUG:logs_dir: logs
2025/03/05 09:49 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:49 DEBUG:logs_dir: logs
2025/03/05 09:49 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:49 DEBUG:data_dir: data
2025/03/05 09:49 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:49 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:49 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:49 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:49 DEBUG:data_dir: data
2025/03/05 09:49 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:49 DEBUG:data_dir: data
2025/03/05 09:49 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:49 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:49 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:49 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:49 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:49 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:49 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:49 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:49 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:49 DEBUG:app_pages_dir: app_pages
2025/03/05 09:49 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:49 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:49 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 DEBUG:app_pages_dir: app_pages
2025/03/05 09:49 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:app_pages_dir: app_pages
2025/03/05 09:49 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:49 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:49 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:49 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:49 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:49 DEBUG:utils_dir: utils
2025/03/05 09:49 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:49 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:49 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:49 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:49 DEBUG:utils_dir: utils
2025/03/05 09:49 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:49 DEBUG:utils_dir: utils
2025/03/05 09:49 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:49 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:49 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:49 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:49 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:49 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:49 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:49 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:49 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:49 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:49 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:49 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:49 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:49 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:49 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:49 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:49 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:49 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:49 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:49 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:49 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:49 DEBUG:components_dir: components
2025/03/05 09:49 DEBUG:components_dir: components
2025/03/05 09:49 DEBUG:components_dir: components
2025/03/05 09:49 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:49 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:49 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:49 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:49 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:49 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:49 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:49 INFO:Session state Setup complete
2025/03/05 09:49 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:49 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:49 INFO:initialize_session_state executed successfully
2025/03/05 09:49 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:49 INFO:Session state Setup complete
2025/03/05 09:49 INFO:Package setup complete
2025/03/05 09:49 INFO:Session state Setup complete
2025/03/05 09:49 INFO:initialize_session_state executed successfully
2025/03/05 09:49 INFO:setup_package executed successfully
2025/03/05 09:49 INFO:initialize_session_state executed successfully
2025/03/05 09:49 INFO:Package setup complete
2025/03/05 09:49 INFO:Setup completed successfully.
2025/03/05 09:49 INFO:Package setup complete
2025/03/05 09:49 INFO:setup_package executed successfully
2025/03/05 09:49 INFO:Running Menu setup...
2025/03/05 09:49 INFO:setup_package executed successfully
2025/03/05 09:49 INFO:Setup completed successfully.
2025/03/05 09:49 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Setup completed successfully.
2025/03/05 09:49 INFO:Running Menu setup...
2025/03/05 09:49 INFO:Running Menu setup...
2025/03/05 09:49 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:App Version: v20.166
2025/03/05 09:49 INFO:App Version: v20.166
2025/03/05 09:49 INFO:App Version: v20.166
2025/03/05 09:49 INFO:Switched to page: Head Line Figures
2025/03/05 09:49 INFO:Switched to page: Head Line Figures
2025/03/05 09:49 INFO:Switched to page: Introduction
2025/03/05 09:49 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:49 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:49 INFO:pagesetup executed successfully
2025/03/05 09:49 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:49 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 09:49 INFO:Menu setup completed successfully.
2025/03/05 09:49 INFO:No data found in session state, running firstload()
2025/03/05 09:49 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Running first load function.
2025/03/05 09:49 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/05 09:49 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/05 09:49 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 INFO:Saved file path: output\imported_raw.csv
2025/03/05 09:49 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 09:49 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 INFO:get_file_modification_time executed successfully
2025/03/05 09:49 INFO:Current modification time: 1740757862.6744745
2025/03/05 09:49 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:49 INFO:is_file_updated executed successfully
2025/03/05 09:49 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741105593.3717692 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:49 INFO:load_raw_data executed successfully
2025/03/05 09:49 INFO:get_raw_data executed successfully
2025/03/05 09:49 DEBUG:st.session_state.raw_data: 65278
2025/03/05 09:49 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Rows in Raw Data: 65278
2025/03/05 09:49 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 09:49 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 09:49 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 09:49 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 09:49 INFO:get_file_modification_time executed successfully
2025/03/05 09:49 INFO:Current modification time: 1741105593.3717692
2025/03/05 09:49 INFO:Last modification time: 1741105593.3717692
2025/03/05 09:49 INFO:is_file_updated executed successfully
2025/03/05 09:49 INFO:Loading preprocessed data. Using output\cleaned_data.csv dated 1741105593.3717692 instead of output\cleaned_donations.csv
2025/03/05 09:49 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:49 INFO:load_cleaned_data executed successfully
2025/03/05 09:49 INFO:get_cleaned_data executed successfully
2025/03/05 09:49 DEBUG:st.session_state.raw_data: 65278
2025/03/05 09:49 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Original file path: output\cleaned_data.csv
2025/03/05 09:49 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 09:49 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 09:49 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 09:49 INFO:get_file_modification_time executed successfully
2025/03/05 09:49 INFO:Current modification time: 1741105598.5723538
2025/03/05 09:49 INFO:Last modification time: 1741105598.5723538
2025/03/05 09:49 INFO:is_file_updated executed successfully
2025/03/05 09:49 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated 1741105598.5723538 instead of output\cleaned_data.csv
2025/03/05 09:49 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:49 INFO:load_donorList_data executed successfully
2025/03/05 09:49 INFO:get_donor_data executed successfully
2025/03/05 09:49 DEBUG:st.session_state.data_donor: 25576
2025/03/05 09:49 DEBUG:st.session_state.data_clean: 65278
2025/03/05 09:49 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Original file path: output\cleaned_data.csv
2025/03/05 09:49 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 09:49 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 09:49 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 09:49 INFO:get_file_modification_time executed successfully
2025/03/05 09:49 INFO:Current modification time: 1741105598.5723538
2025/03/05 09:49 INFO:Last modification time: 1741105598.5723538
2025/03/05 09:49 INFO:is_file_updated executed successfully
2025/03/05 09:49 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741105598.5723538 instead of output\cleaned_data.csv
2025/03/05 09:49 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 09:49 INFO:load_regulated_entity_data executed successfully
2025/03/05 09:49 INFO:get_regentity_data executed successfully
2025/03/05 09:49 DEBUG:st.session_state.data_regentity: 1364
2025/03/05 09:49 DEBUG:st.session_state.data_donor: 25576
2025/03/05 09:49 DEBUG:st.session_state.data_clean: 65278
2025/03/05 09:49 INFO:firstload executed successfully
2025/03/05 09:49 INFO:Data first load completed successfully.
2025/03/05 09:49 INFO:initialise_data executed successfully
2025/03/05 09:49 INFO:App is fully loaded and ready!
2025/03/05 09:49 INFO:Streamlit App Starting...
2025/03/05 09:49 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 09:49 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 09:49 INFO:Running App setup...
2025/03/05 09:49 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:Setting up the package
2025/03/05 09:49 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:Version: v20.145
2025/03/05 09:49 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 09:49 DEBUG:BASE_DIR already exists in session state
2025/03/05 09:49 DEBUG:filenames already exists in session state
2025/03/05 09:49 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 09:49 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 09:49 DEBUG:thresholds already exists in session state
2025/03/05 09:49 DEBUG:data_remappings already exists in session state
2025/03/05 09:49 DEBUG:filter_def already exists in session state
2025/03/05 09:49 DEBUG:security already exists in session state
2025/03/05 09:49 DEBUG:perc_target already exists in session state
2025/03/05 09:49 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 09:49 DEBUG:directories already exists in session state
2025/03/05 09:49 DEBUG:reference_dir already exists in session state
2025/03/05 09:49 DEBUG:data_dir already exists in session state
2025/03/05 09:49 DEBUG:output_dir already exists in session state
2025/03/05 09:49 DEBUG:logs_dir already exists in session state
2025/03/05 09:49 DEBUG:components_dir already exists in session state
2025/03/05 09:49 DEBUG:app_pages_dir already exists in session state
2025/03/05 09:49 DEBUG:utils_dir already exists in session state
2025/03/05 09:49 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 09:49 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 09:49 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 09:49 DEBUG:donor_map_fname already exists in session state
2025/03/05 09:49 DEBUG:politician_party_fname already exists in session state
2025/03/05 09:49 DEBUG:regentity_map_fname already exists in session state
2025/03/05 09:49 DEBUG:original_data_fname already exists in session state
2025/03/05 09:49 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 09:49 DEBUG:TEXT_FILE already exists in session state
2025/03/05 09:49 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 09:49 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 09:49 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 09:49 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 09:49 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 09:49 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 09:49 DEBUG:party_summary_fname already exists in session state
2025/03/05 09:49 DEBUG:imported_raw_fname already exists in session state
2025/03/05 09:49 DEBUG:source_data_fname already exists in session state
2025/03/05 09:49 DEBUG:Cash_ftr already exists in session state
2025/03/05 09:49 INFO:Session_state variables initialized
2025/03/05 09:49 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 09:49 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 09:49 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 09:49 DEBUG:perc_target: 0.5
2025/03/05 09:49 DEBUG:output_dir: output
2025/03/05 09:49 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001959633BB50>}
2025/03/05 09:49 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 09:49 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 09:49 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 09:49 DEBUG:reference_dir: reference_files
2025/03/05 09:49 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 09:49 DEBUG:LOG_LEVEL: ERROR
2025/03/05 09:49 DEBUG:logs_dir: logs
2025/03/05 09:49 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 09:49 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 09:49 DEBUG:data_dir: data
2025/03/05 09:49 DEBUG:data_clean:        Unnamed: 0      ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... WksSinceLastElection  QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0               0  NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...               4710.0                   2.0                 363.0                 1.0                 91.0
1               1  NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
2               2  NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...               4710.0                   2.0                 363.0                 1.0                 91.0
3               3  NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...               4710.0                   2.0                 363.0                 1.0                 91.0
4               4  NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...               4709.0                   2.0                 363.0                 1.0                 91.0
...           ...        ...                              ...                    ...        ...  ...                  ...                   ...                   ...                 ...                  ...
65273       78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...               4532.0                   5.0                 349.0                 2.0                 87.0
65274       78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...               4524.0                   6.0                 348.0                 2.0                 87.0
65275       78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...               4543.0                   4.0                 350.0                 1.0                 88.0
65276       78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...               4591.0                   1.0                 354.0                 1.0                 89.0
65277       78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...               4592.0                   1.0                 354.0                 1.0                 89.0

[65278 rows x 58 columns]
2025/03/05 09:49 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 09:49 DEBUG:raw_data:        index      ECRef              RegulatedEntityName    RegulatedEntityType        Value AcceptedDate  ... RegulatedEntityId AccountingUnitId  DonorId  CampaigningName   RegisterName IsIrishSource
0          0  NC0408174                   Mr Andy Street        Regulated Donee    1,876.56   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
1          1  NC0408173                   Mr Andy Street        Regulated Donee    2,700.00   02/09/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
2          2  NC0408177                   Mr Andy Street        Regulated Donee    4,852.58   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
3          3  NC0408176                   Mr Andy Street        Regulated Donee    2,500.00   30/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
4          4  NC0408170                   Mr Andy Street        Regulated Donee    4,524.05   29/08/2019  ...              8015              NaN  86310.0              NaN  Great Britain         False
...      ...        ...                              ...                    ...          ...          ...  ...               ...              ...      ...              ...            ...           ...
65273  65273   C0242478               Vote Leave Limited  Permitted Participant   10,000.00          NaN  ...              3945              NaN  74198.0              NaN            NaN         False
65274  65274   C0242461               Vote Leave Limited  Permitted Participant  100,000.00          NaN  ...              3945              NaN  74184.0              NaN            NaN         False
65275  65275   C0243560               Vote Leave Limited  Permitted Participant   40,000.00          NaN  ...              3945              NaN  74576.0              NaN            NaN         False
65276  65276   C0319710  Conservative and Unionist Party        Political Party   50,000.00          NaN  ...                52              NaN  34241.0              NaN  Great Britain         False
65277  65277   C0319727  Conservative and Unionist Party        Political Party   15,000.00          NaN  ...                52              NaN  74743.0              NaN  Great Britain         False

[65278 rows x 30 columns]
2025/03/05 09:49 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 09:49 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 09:49 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 09:49 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 09:49 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 09:49 DEBUG:data_regentity:       RegulatedEntityId                              Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                                  English Democrats            Small Entity         99000.00               11    9000.000000
1                  19.0                         Legalise Cannabis Alliance            Small Entity         35500.00               13    2730.769231
2                  30.0        Upminster And Cranham Residents Association  Single Donation Entity         10000.00                1   10000.000000
3                  39.0                                          Sinn Fin     Medium Large Entity       2506699.11              359    6982.448774
4                  44.0  Independent Kidderminster Hospital And Health ...            Small Entity         31949.00                8    3993.625000
...                 ...                                                ...                     ...              ...              ...            ...
1359            10263.0                                    Jonathan Gullis  Single Donation Entity          2500.00                1    2500.000000
1360            10264.0                                      Robert Largan  Single Donation Entity          2000.00                1    2000.000000
1361            10265.0                                         Jane Dodds       Very Small Entity          3529.41                2    1764.705000
1362            10266.0                                        Phil Wilson  Single Donation Entity          2000.00                1    2000.000000
1363            10267.0                Scottish Unionist Association Trust       Very Small Entity        218870.07                3   72956.690000

[1364 rows x 6 columns]
2025/03/05 09:49 DEBUG:app_pages_dir: app_pages
2025/03/05 09:49 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 09:49 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 09:49 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 09:49 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 09:49 DEBUG:utils_dir: utils
2025/03/05 09:49 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 09:49 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 09:49 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 09:49 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 09:49 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 09:49 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 09:49 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 09:49 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 09:49 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 09:49 DEBUG:components_dir: components
2025/03/05 09:49 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 09:49 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 09:49 INFO:Session state Setup complete
2025/03/05 09:49 INFO:initialize_session_state executed successfully
2025/03/05 09:49 INFO:Package setup complete
2025/03/05 09:49 INFO:setup_package executed successfully
2025/03/05 09:49 INFO:Setup completed successfully.
2025/03/05 09:49 INFO:Running Menu setup...
2025/03/05 09:49 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 09:49 INFO:get_git_version executed successfully
2025/03/05 09:49 INFO:App Version: v20.166
2025/03/05 09:49 INFO:Switched to page: Head Line Figures
2025/03/05 09:49 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 09:49 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 09:49 ERROR:Error in load_and_filter_data: 'str' object has no attribute 'date'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 33, in load_and_filter_data
    min_date = cleaned_df["ReceivedDate"].min().date()
AttributeError: 'str' object has no attribute 'date'
2025/03/05 09:49 CRITICAL:Menu setup crashed: 'str' object has no attribute 'date'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 33, in load_and_filter_data
    min_date = cleaned_df["ReceivedDate"].min().date()
AttributeError: 'str' object has no attribute 'date'
2025/03/05 10:45 INFO:Logging is set up correctly! Current log level: ERROR
2025/03/05 10:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 10:45 INFO:get_git_version executed successfully
2025/03/05 10:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 10:45 INFO:get_git_version executed successfully
2025/03/05 10:45 INFO:Streamlit App Starting...
2025/03/05 10:45 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 10:45 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 10:45 INFO:Running App setup...
2025/03/05 10:45 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 10:45 INFO:Setting up the package
2025/03/05 10:45 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 10:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 10:45 INFO:get_git_version executed successfully
2025/03/05 10:45 INFO:Version: v20.145
2025/03/05 10:45 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 10:45 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 10:45 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 10:45 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 10:45 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 10:45 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 10:45 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 10:45 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 10:45 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 10:45 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 10:45 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 10:45 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 10:45 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 10:45 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 10:45 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 10:45 DEBUG:Initialised data_dir with value: data
2025/03/05 10:45 DEBUG:Initialised output_dir with value: output
2025/03/05 10:45 DEBUG:Initialised logs_dir with value: logs
2025/03/05 10:45 DEBUG:Initialised components_dir with value: components
2025/03/05 10:45 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 10:45 DEBUG:Initialised utils_dir with value: utils
2025/03/05 10:45 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 10:45 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 10:45 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 10:45 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 10:45 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 10:45 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 10:45 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 10:45 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 10:45 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 10:45 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 10:45 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 10:45 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 10:45 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 10:45 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 10:45 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 10:45 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 10:45 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 10:45 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 10:45 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 10:45 INFO:Session_state variables initialized
2025/03/05 10:45 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 10:45 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 10:45 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 10:45 DEBUG:perc_target: 0.5
2025/03/05 10:45 DEBUG:output_dir: output
2025/03/05 10:45 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 10:45 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 10:45 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 10:45 DEBUG:reference_dir: reference_files
2025/03/05 10:45 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 10:45 DEBUG:LOG_LEVEL: ERROR
2025/03/05 10:45 DEBUG:logs_dir: logs
2025/03/05 10:45 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 10:45 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 10:45 DEBUG:data_dir: data
2025/03/05 10:45 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 10:45 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 10:45 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 10:45 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 10:45 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 10:45 DEBUG:app_pages_dir: app_pages
2025/03/05 10:45 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 10:45 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 10:45 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 10:45 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 10:45 DEBUG:utils_dir: utils
2025/03/05 10:45 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 10:45 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 10:45 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 10:45 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 10:45 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 10:45 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 10:45 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 10:45 DEBUG:components_dir: components
2025/03/05 10:45 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 10:45 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 10:45 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 10:45 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 10:45 INFO:Session state Setup complete
2025/03/05 10:45 INFO:initialize_session_state executed successfully
2025/03/05 10:45 INFO:Package setup complete
2025/03/05 10:45 INFO:setup_package executed successfully
2025/03/05 10:45 INFO:Setup completed successfully.
2025/03/05 10:45 INFO:Running Menu setup...
2025/03/05 10:45 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 10:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 10:45 INFO:get_git_version executed successfully
2025/03/05 10:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 10:45 INFO:get_git_version executed successfully
2025/03/05 10:45 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 10:45 INFO:get_git_version executed successfully
2025/03/05 10:45 INFO:App Version: v20.166
2025/03/05 10:45 INFO:Switched to page: Head Line Figures
2025/03/05 10:45 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 10:45 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 10:45 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 10:45 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 11:06 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 11:06 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 11:06 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 11:06 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 11:06 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 11:06 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 11:06 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 11:06 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 11:06 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 11:06 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 11:06 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 11:06 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 11:06 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 11:06 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 11:06 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 11:06 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 11:06 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 11:06 DEBUG:Initialised data_dir with value: data
2025/03/05 11:06 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 11:06 DEBUG:Initialised output_dir with value: output
2025/03/05 11:06 DEBUG:Initialised data_dir with value: data
2025/03/05 11:06 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 11:06 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 11:06 DEBUG:Initialised logs_dir with value: logs
2025/03/05 11:06 DEBUG:Initialised output_dir with value: output
2025/03/05 11:06 DEBUG:Initialised data_dir with value: data
2025/03/05 11:06 DEBUG:Initialised data_dir with value: data
2025/03/05 11:06 DEBUG:Initialised components_dir with value: components
2025/03/05 11:06 DEBUG:Initialised logs_dir with value: logs
2025/03/05 11:06 DEBUG:Initialised output_dir with value: output
2025/03/05 11:06 DEBUG:Initialised output_dir with value: output
2025/03/05 11:06 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 11:06 DEBUG:Initialised components_dir with value: components
2025/03/05 11:06 DEBUG:Initialised logs_dir with value: logs
2025/03/05 11:06 DEBUG:Initialised logs_dir with value: logs
2025/03/05 11:06 DEBUG:Initialised utils_dir with value: utils
2025/03/05 11:06 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 11:06 DEBUG:Initialised components_dir with value: components
2025/03/05 11:06 DEBUG:Initialised components_dir with value: components
2025/03/05 11:06 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:Initialised utils_dir with value: utils
2025/03/05 11:06 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 11:06 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 11:06 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:Initialised utils_dir with value: utils
2025/03/05 11:06 DEBUG:Initialised utils_dir with value: utils
2025/03/05 11:06 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 11:06 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 11:06 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 11:06 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 11:06 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 11:06 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 11:06 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 11:06 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 11:06 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Head Line Figures
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Introduction
2025/03/05 11:06 INFO:Switched to page: Head Line Figures
2025/03/05 11:06 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Switched to page: Head Line Figures
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:No data found in session state, running firstload()
2025/03/05 11:06 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 11:06 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 11:06 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 11:06 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 11:06 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 73, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 11:06 INFO:Running first load function.
2025/03/05 11:06 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/05 11:06 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/05 11:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 INFO:Saved file path: output\imported_raw.csv
2025/03/05 11:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 11:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 INFO:get_file_modification_time executed successfully
2025/03/05 11:06 INFO:Current modification time: 1740757862.6744745
2025/03/05 11:06 INFO:Last modification time: 1741105593.3717692
2025/03/05 11:06 INFO:is_file_updated executed successfully
2025/03/05 11:06 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741105593.3717692 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 INFO:Importing file from output\imported_raw.csv
2025/03/05 11:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:06 INFO:Preprocessed data loaded successfully.
2025/03/05 11:06 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Cleaning up raw data
2025/03/05 11:06 ERROR:Session state variables not initialized!
2025/03/05 11:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Original file path: None
2025/03/05 11:06 INFO:Saved file path: output\cleaned_donations.csv
2025/03/05 11:06 ERROR:Error: originalfilepath is None!
2025/03/05 11:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:06 INFO:Data loaded, shape: (65278, 29)
2025/03/05 11:06 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/05 11:06 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 11:06 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 11:06 INFO:File deduplication complete, shape: (65278, 33)
2025/03/05 11:06 INFO:dedupe_entity_file executed successfully
2025/03/05 11:06 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/05 11:06 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/05 11:06 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/05 11:06 INFO:File deduplication complete, shape: (65278, 37)
2025/03/05 11:06 INFO:dedupe_entity_file executed successfully
2025/03/05 11:06 INFO:Raw Data cleanup completed
2025/03/05 11:06 INFO:Data shape: (65278, 37)
2025/03/05 11:06 INFO:Data saved to output\cleaned_donations.csv
2025/03/05 11:06 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/05 11:06 INFO:raw_data_cleanup executed successfully
2025/03/05 11:06 INFO:load_raw_data executed successfully
2025/03/05 11:06 INFO:get_raw_data executed successfully
2025/03/05 11:06 DEBUG:st.session_state.raw_data: 65278
2025/03/05 11:06 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Rows in Raw Data: 65278
2025/03/05 11:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 11:06 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 11:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 11:06 INFO:get_file_modification_time executed successfully
2025/03/05 11:06 INFO:Current modification time: 1741172774.2924385
2025/03/05 11:06 INFO:Last modification time: 1741105593.3717692
2025/03/05 11:06 INFO:is_file_updated executed successfully
2025/03/05 11:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:06 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/05 11:06 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/05 11:06 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/05 11:06 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/05 11:06 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/05 11:06 DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/05 11:06 DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/05 11:06 DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/05 11:06 DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/05 11:06 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/05 11:06 ERROR:Attempting to remove duplicates
2025/03/05 11:06 DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 43 columns]
2025/03/05 11:06 DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/05 11:06 INFO:Data Updated with PartyName and PartyId successfully
2025/03/05 11:06 INFO:map_mp_to_party executed successfully
2025/03/05 11:06 DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/05 11:06 DEBUG:Group assignment: group
RegulatedEntityName       53528
Small Medium Entity        4430
Small Entity               2251
Very Small Entity          1492
Medium Large Entity        1203
Large Entity               1194
Medium Entity               694
Single Donation Entity      486
Name: count, dtype: int64
2025/03/05 11:06 DEBUG:Group assignment: group
Very Small Entity         491
Single Donation Entity    486
Small Entity              241
Small Medium Entity       127
Medium Entity               5
RegulatedEntityName         5
Medium Large Entity         4
Large Entity                2
Name: count, dtype: int64
2025/03/05 11:06 DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/05 11:06 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:try to load previous election dates from file.
2025/03/05 11:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 INFO:Saved file path: reference_files\elections.csv
2025/03/05 11:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 11:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 INFO:get_file_modification_time executed successfully
2025/03/05 11:06 INFO:Current modification time: 1740757862.6744745
2025/03/05 11:06 INFO:Last modification time: 1740757862.6744745
2025/03/05 11:06 INFO:is_file_updated executed successfully
2025/03/05 11:06 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1740757862.6744745 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 INFO:Importing file from reference_files\elections.csv
2025/03/05 11:06 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/05 11:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:06 ERROR:Failed to load election dates from file.
2025/03/05 11:06 INFO:Election_dates_df empty - loading from pdpy.
2025/03/05 11:06 INFO:Election Dates loaded vis pdpy.
2025/03/05 11:06 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/05 11:06 INFO:Election Dates Loaded Successfully.
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 INFO:load_election_dates executed successfully
2025/03/05 11:06 DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/05 11:06 DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/05 11:06 INFO:Cleaned Data completed, shape: (65278, 57)
2025/03/05 11:06 INFO:load_cleaned_data executed successfully
2025/03/05 11:06 INFO:get_cleaned_data executed successfully
2025/03/05 11:06 DEBUG:st.session_state.raw_data: 65278
2025/03/05 11:06 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Original file path: output\cleaned_data.csv
2025/03/05 11:06 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 11:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 11:06 INFO:get_file_modification_time executed successfully
2025/03/05 11:06 INFO:Current modification time: 1741172778.734468
2025/03/05 11:06 INFO:Last modification time: 1741105598.5723538
2025/03/05 11:06 INFO:is_file_updated executed successfully
2025/03/05 11:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:06 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/05 11:06 INFO:Donor Data summary completed
2025/03/05 11:06 INFO:Data shape: (25576, 5)
2025/03/05 11:06 INFO:load_donorList_data executed successfully
2025/03/05 11:06 INFO:get_donor_data executed successfully
2025/03/05 11:06 DEBUG:st.session_state.data_donor: 25576
2025/03/05 11:06 DEBUG:st.session_state.data_clean: 65278
2025/03/05 11:06 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Original file path: output\cleaned_data.csv
2025/03/05 11:06 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 11:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 11:06 INFO:get_file_modification_time executed successfully
2025/03/05 11:06 INFO:Current modification time: 1741172778.734468
2025/03/05 11:06 INFO:Last modification time: 1741172778.734468
2025/03/05 11:06 INFO:is_file_updated executed successfully
2025/03/05 11:06 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741172778.734468 instead of output\cleaned_data.csv
2025/03/05 11:06 INFO:Importing file from output\cleaned_regentity.csv
2025/03/05 11:06 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/05 11:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:06 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025/03/05 11:06 INFO:Raw Data cleanup completed
2025/03/05 11:06 INFO:Data shape: (2150, 6)
2025/03/05 11:06 INFO:load_regulated_entity_data executed successfully
2025/03/05 11:06 INFO:get_regentity_data executed successfully
2025/03/05 11:06 DEBUG:st.session_state.data_regentity: 2150
2025/03/05 11:06 DEBUG:st.session_state.data_donor: 25576
2025/03/05 11:06 DEBUG:st.session_state.data_clean: 65278
2025/03/05 11:06 INFO:firstload executed successfully
2025/03/05 11:06 INFO:Data first load completed successfully.
2025/03/05 11:06 INFO:initialise_data executed successfully
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001F823A980D0>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Head Line Figures
2025/03/05 11:06 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_data executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:hlf_body executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:year_slider_value_by_year_n_entity: (2001, 2019)
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:year_slider_dons_by_year_n_entity: (2001, 2019)
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:year_slider_value_by_year_n_type: (2001, 2019)
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x000001F823A98B80>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:year_slider_dons_by_year_n_type: (2001, 2019)
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Bequeths
2025/03/05 11:06 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_data executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations_page at 0x000001F823A98C10>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Corporate Donations
2025/03/05 11:06 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_data executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorship_page at 0x000001F823A989D0>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Sponsorships
2025/03/05 11:06 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_data executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits_page at 0x000001F812920040>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Paid Visits
2025/03/05 11:06 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_data executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors_page at 0x000001F823A99240>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Dubious Donors
2025/03/05 11:06 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_data executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations_page at 0x000001F823A98DC0>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Dubious Donations
2025/03/05 11:06 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_data executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Corporate Donations per Entity', 'function': <function mod_corporate_donations_per_entity_page at 0x000001F823A98F70>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Corporate Donations per Entity
2025/03/05 11:06 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_per_group_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Sponsorship per Entity ', 'function': <function mod_sponsorships_per_entity_page at 0x000001F823A98A60>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Sponsorship per Entity 
2025/03/05 11:06 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_per_group_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:06 INFO:Streamlit App Starting...
2025/03/05 11:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:06 INFO:Running App setup...
2025/03/05 11:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:Setting up the package
2025/03/05 11:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:Version: v20.145
2025/03/05 11:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:06 DEBUG:filenames already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:06 DEBUG:thresholds already exists in session state
2025/03/05 11:06 DEBUG:data_remappings already exists in session state
2025/03/05 11:06 DEBUG:filter_def already exists in session state
2025/03/05 11:06 DEBUG:security already exists in session state
2025/03/05 11:06 DEBUG:perc_target already exists in session state
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:06 DEBUG:directories already exists in session state
2025/03/05 11:06 DEBUG:reference_dir already exists in session state
2025/03/05 11:06 DEBUG:data_dir already exists in session state
2025/03/05 11:06 DEBUG:output_dir already exists in session state
2025/03/05 11:06 DEBUG:logs_dir already exists in session state
2025/03/05 11:06 DEBUG:components_dir already exists in session state
2025/03/05 11:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:06 DEBUG:utils_dir already exists in session state
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:06 DEBUG:original_data_fname already exists in session state
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:06 DEBUG:source_data_fname already exists in session state
2025/03/05 11:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:06 INFO:Session_state variables initialized
2025/03/05 11:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:06 DEBUG:app_pages_dir: app_pages
2025/03/05 11:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:06 DEBUG:max_date: 2019-09-02
2025/03/05 11:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:06 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:06 DEBUG:perc_target: 0.5
2025/03/05 11:06 DEBUG:data_dir: data
2025/03/05 11:06 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:06 DEBUG:output_dir: output
2025/03/05 11:06 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:06 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:06 DEBUG:utils_dir: utils
2025/03/05 11:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:06 DEBUG:menu_selection: {'title': 'Paid Visits per Entity', 'function': <function mod_visits_per_regulated_entity at 0x000001F823A98940>}
2025/03/05 11:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:06 DEBUG:min_date: 2001-01-01
2025/03/05 11:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:06 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:06 DEBUG:logs_dir: logs
2025/03/05 11:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:06 DEBUG:components_dir: components
2025/03/05 11:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:06 DEBUG:reference_dir: reference_files
2025/03/05 11:06 INFO:Session state Setup complete
2025/03/05 11:06 INFO:initialize_session_state executed successfully
2025/03/05 11:06 INFO:Package setup complete
2025/03/05 11:06 INFO:setup_package executed successfully
2025/03/05 11:06 INFO:Setup completed successfully.
2025/03/05 11:06 INFO:Running Menu setup...
2025/03/05 11:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:get_git_version executed successfully
2025/03/05 11:06 INFO:App Version: v20.166
2025/03/05 11:06 INFO:Switched to page: Paid Visits per Entity
2025/03/05 11:06 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_summary_statistics executed successfully
2025/03/05 11:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:display_textual_insights executed successfully
2025/03/05 11:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:06 INFO:display_visualizations executed successfully
2025/03/05 11:06 INFO:display_per_group_data_page executed successfully
2025/03/05 11:06 INFO:pagesetup executed successfully
2025/03/05 11:06 INFO:Menu setup completed successfully.
2025/03/05 11:06 INFO:Data already loaded in session state.
2025/03/05 11:06 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Donors per Regulated Entity', 'function': <function mod_regulated_entity_per_donors_page at 0x000001F823A99120>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Donors per Regulated Entity
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Dubious Donors per Regulated Entity', 'function': <function mod_dubious_donors_per_entity_page at 0x000001F823A991B0>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Dubious Donors per Regulated Entity
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Dubious Donations per Regulated Entity', 'function': <function mod_dubious_donations_per_entity_page at 0x000001F823A98E50>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Dubious Donations per Regulated Entity
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Corporate Donations per Donor', 'function': <function mod_corporate_donations_per_donor_page at 0x000001F823A98D30>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Corporate Donations per Donor
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Sponsorships per Donor', 'function': <function mod_sponsorships_per_donor_page at 0x000001F823A98AF0>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Sponsorships per Donor
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Paid Visits per Donor', 'function': <function mod_visits_per_donor at 0x000001F823A988B0>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Paid Visits per Donor
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Regulated Entities per Donor', 'function': <function mod_regulated_donor_per_entity_page at 0x000001F823A99090>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Regulated Entities per Donor
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Dubious donations per Donor', 'function': <function mod_dubious_donations_per_donor_page at 0x000001F823A98EE0>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Dubious donations per Donor
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:07 INFO:Streamlit App Starting...
2025/03/05 11:07 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:07 INFO:Running App setup...
2025/03/05 11:07 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:Setting up the package
2025/03/05 11:07 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:Version: v20.145
2025/03/05 11:07 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:07 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:07 DEBUG:filenames already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:07 DEBUG:thresholds already exists in session state
2025/03/05 11:07 DEBUG:data_remappings already exists in session state
2025/03/05 11:07 DEBUG:filter_def already exists in session state
2025/03/05 11:07 DEBUG:security already exists in session state
2025/03/05 11:07 DEBUG:perc_target already exists in session state
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:07 DEBUG:directories already exists in session state
2025/03/05 11:07 DEBUG:reference_dir already exists in session state
2025/03/05 11:07 DEBUG:data_dir already exists in session state
2025/03/05 11:07 DEBUG:output_dir already exists in session state
2025/03/05 11:07 DEBUG:logs_dir already exists in session state
2025/03/05 11:07 DEBUG:components_dir already exists in session state
2025/03/05 11:07 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:07 DEBUG:utils_dir already exists in session state
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:07 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:07 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:07 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:07 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:07 DEBUG:original_data_fname already exists in session state
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:07 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:07 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:07 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:07 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:07 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:07 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:07 DEBUG:source_data_fname already exists in session state
2025/03/05 11:07 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:07 INFO:Session_state variables initialized
2025/03/05 11:07 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:07 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:07 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:07 DEBUG:app_pages_dir: app_pages
2025/03/05 11:07 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:07 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:07 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:07 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:07 DEBUG:max_date: 2019-09-02
2025/03/05 11:07 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:07 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:07 DEBUG:load_raw_data_last_modified: 1741172774.2924385
2025/03/05 11:07 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:07 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:07 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:07 DEBUG:perc_target: 0.5
2025/03/05 11:07 DEBUG:data_dir: data
2025/03/05 11:07 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:07 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:07 DEBUG:output_dir: output
2025/03/05 11:07 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:07 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:07 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:07 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:07 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:07 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:07 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:07 DEBUG:utils_dir: utils
2025/03/05 11:07 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:07 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party_page at 0x000001F823A99000>}
2025/03/05 11:07 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:07 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:07 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:07 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:07 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:07 DEBUG:min_date: 2001-01-01
2025/03/05 11:07 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:07 DEBUG:load_donorlist_data_last_modified: 1741172778.734468
2025/03/05 11:07 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:07 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:07 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:07 DEBUG:logs_dir: logs
2025/03/05 11:07 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:07 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:07 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:07 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:07 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:07 DEBUG:components_dir: components
2025/03/05 11:07 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:07 DEBUG:reference_dir: reference_files
2025/03/05 11:07 INFO:Session state Setup complete
2025/03/05 11:07 INFO:initialize_session_state executed successfully
2025/03/05 11:07 INFO:Package setup complete
2025/03/05 11:07 INFO:setup_package executed successfully
2025/03/05 11:07 INFO:Setup completed successfully.
2025/03/05 11:07 INFO:Running Menu setup...
2025/03/05 11:07 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:get_git_version executed successfully
2025/03/05 11:07 INFO:App Version: v20.166
2025/03/05 11:07 INFO:Switched to page: Donations by Political Party
2025/03/05 11:07 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:07 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_summary_statistics executed successfully
2025/03/05 11:07 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:display_textual_insights executed successfully
2025/03/05 11:07 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:07 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:07 INFO:display_visualizations executed successfully
2025/03/05 11:07 INFO:display_per_group_data_page executed successfully
2025/03/05 11:07 INFO:pagesetup executed successfully
2025/03/05 11:07 INFO:Menu setup completed successfully.
2025/03/05 11:07 INFO:Data already loaded in session state.
2025/03/05 11:07 INFO:App is fully loaded and ready!
2025/03/05 11:11 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 11:11 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:11 INFO:get_git_version executed successfully
2025/03/05 11:11 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:11 INFO:get_git_version executed successfully
2025/03/05 11:11 INFO:Streamlit App Starting...
2025/03/05 11:11 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:11 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:11 INFO:Running App setup...
2025/03/05 11:11 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:11 INFO:Setting up the package
2025/03/05 11:11 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:11 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:11 INFO:get_git_version executed successfully
2025/03/05 11:11 INFO:Version: v20.145
2025/03/05 11:11 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:11 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:11 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 11:11 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 11:11 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:11 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 11:11 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 11:11 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:11 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:11 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:11 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:11 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 11:11 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 11:11 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:11 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 11:11 DEBUG:Initialised data_dir with value: data
2025/03/05 11:11 DEBUG:Initialised output_dir with value: output
2025/03/05 11:11 DEBUG:Initialised logs_dir with value: logs
2025/03/05 11:11 DEBUG:Initialised components_dir with value: components
2025/03/05 11:11 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 11:11 DEBUG:Initialised utils_dir with value: utils
2025/03/05 11:11 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:11 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:11 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 11:11 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:11 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:11 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:11 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 11:11 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 11:11 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 11:11 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 11:11 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 11:11 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 11:11 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 11:11 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 11:11 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 11:11 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 11:11 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 11:11 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:11 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 11:11 INFO:Session_state variables initialized
2025/03/05 11:11 DEBUG:logs_dir: logs
2025/03/05 11:11 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:11 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:11 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:11 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:11 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:11 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:11 DEBUG:output_dir: output
2025/03/05 11:11 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:11 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:11 DEBUG:components_dir: components
2025/03/05 11:11 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:11 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:11 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:11 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:11 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:11 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:11 DEBUG:reference_dir: reference_files
2025/03/05 11:11 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:11 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:11 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:11 DEBUG:utils_dir: utils
2025/03/05 11:11 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:11 DEBUG:app_pages_dir: app_pages
2025/03/05 11:11 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:11 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:11 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:11 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:11 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:11 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:11 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:11 DEBUG:perc_target: 0.5
2025/03/05 11:11 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:11 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:11 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:11 DEBUG:data_dir: data
2025/03/05 11:11 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:11 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:11 INFO:Session state Setup complete
2025/03/05 11:11 INFO:initialize_session_state executed successfully
2025/03/05 11:11 INFO:Package setup complete
2025/03/05 11:11 INFO:setup_package executed successfully
2025/03/05 11:11 INFO:Setup completed successfully.
2025/03/05 11:11 INFO:Running Menu setup...
2025/03/05 11:11 CRITICAL:Menu setup crashed: module 'politicalpartyanalysis' has no attribute 'pagesetup'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
AttributeError: module 'politicalpartyanalysis' has no attribute 'pagesetup'
2025/03/05 11:11 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 11:11 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:Streamlit App Starting...
2025/03/05 11:12 INFO:Streamlit App Starting...
2025/03/05 11:12 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:12 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:12 INFO:Running App setup...
2025/03/05 11:12 INFO:Running App setup...
2025/03/05 11:12 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Setting up the package
2025/03/05 11:12 INFO:Setting up the package
2025/03/05 11:12 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:Version: v20.145
2025/03/05 11:12 INFO:Version: v20.145
2025/03/05 11:12 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 11:12 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 11:12 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:12 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:12 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 11:12 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 11:12 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 11:12 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 11:12 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:12 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:12 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:12 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:12 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:12 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:12 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:12 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:12 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 11:12 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 11:12 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 11:12 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 11:12 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:12 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:12 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 11:12 DEBUG:Initialised data_dir with value: data
2025/03/05 11:12 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 11:12 DEBUG:Initialised output_dir with value: output
2025/03/05 11:12 DEBUG:Initialised data_dir with value: data
2025/03/05 11:12 DEBUG:Initialised logs_dir with value: logs
2025/03/05 11:12 DEBUG:Initialised output_dir with value: output
2025/03/05 11:12 DEBUG:Initialised components_dir with value: components
2025/03/05 11:12 DEBUG:Initialised logs_dir with value: logs
2025/03/05 11:12 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 11:12 DEBUG:Initialised components_dir with value: components
2025/03/05 11:12 DEBUG:Initialised utils_dir with value: utils
2025/03/05 11:12 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 11:12 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:12 DEBUG:Initialised utils_dir with value: utils
2025/03/05 11:12 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:12 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:12 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 11:12 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:12 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:12 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 11:12 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:12 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:12 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:12 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:12 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 11:12 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:12 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 11:12 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 11:12 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 11:12 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 11:12 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 11:12 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 11:12 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 11:12 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 11:12 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 11:12 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 11:12 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 11:12 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 11:12 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 11:12 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 11:12 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 11:12 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 11:12 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 INFO:Session_state variables initialized
2025/03/05 11:12 DEBUG:Initialised Cash_ftr with value: {'DonationType': 'Cash'}
2025/03/05 11:12 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:12 INFO:Session_state variables initialized
2025/03/05 11:12 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:12 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:12 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:12 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:12 DEBUG:perc_target: 0.5
2025/03/05 11:12 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:12 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:12 DEBUG:perc_target: 0.5
2025/03/05 11:12 DEBUG:data_dir: data
2025/03/05 11:12 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:12 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:12 DEBUG:data_dir: data
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:12 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:12 DEBUG:app_pages_dir: app_pages
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:12 DEBUG:logs_dir: logs
2025/03/05 11:12 DEBUG:app_pages_dir: app_pages
2025/03/05 11:12 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:logs_dir: logs
2025/03/05 11:12 DEBUG:output_dir: output
2025/03/05 11:12 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:reference_dir: reference_files
2025/03/05 11:12 DEBUG:output_dir: output
2025/03/05 11:12 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:12 DEBUG:reference_dir: reference_files
2025/03/05 11:12 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:12 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:12 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:12 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:12 DEBUG:utils_dir: utils
2025/03/05 11:12 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:12 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:utils_dir: utils
2025/03/05 11:12 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:12 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:12 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:12 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:12 DEBUG:components_dir: components
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:12 DEBUG:components_dir: components
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:12 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:12 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:12 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:12 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:12 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:12 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:12 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:12 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:12 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:12 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:12 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:12 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:12 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:12 INFO:Session state Setup complete
2025/03/05 11:12 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:12 INFO:initialize_session_state executed successfully
2025/03/05 11:12 INFO:Session state Setup complete
2025/03/05 11:12 INFO:Package setup complete
2025/03/05 11:12 INFO:initialize_session_state executed successfully
2025/03/05 11:12 INFO:setup_package executed successfully
2025/03/05 11:12 INFO:Package setup complete
2025/03/05 11:12 INFO:Setup completed successfully.
2025/03/05 11:12 INFO:setup_package executed successfully
2025/03/05 11:12 INFO:Running Menu setup...
2025/03/05 11:12 INFO:Setup completed successfully.
2025/03/05 11:12 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Running Menu setup...
2025/03/05 11:12 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:App Version: v20.166
2025/03/05 11:12 INFO:App Version: v20.166
2025/03/05 11:12 INFO:Switched to page: Introduction
2025/03/05 11:12 INFO:Switched to page: Introduction
2025/03/05 11:12 INFO:pagesetup executed successfully
2025/03/05 11:12 INFO:pagesetup executed successfully
2025/03/05 11:12 INFO:Menu setup completed successfully.
2025/03/05 11:12 INFO:Menu setup completed successfully.
2025/03/05 11:12 INFO:No data found in session state, running firstload()
2025/03/05 11:12 INFO:No data found in session state, running firstload()
2025/03/05 11:12 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Running first load function.
2025/03/05 11:12 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/05 11:12 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/05 11:12 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 INFO:Saved file path: output\imported_raw.csv
2025/03/05 11:12 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 11:12 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 INFO:get_file_modification_time executed successfully
2025/03/05 11:12 INFO:Current modification time: 1740757862.6744745
2025/03/05 11:12 INFO:Last modification time: 1741172774.2924385
2025/03/05 11:12 INFO:is_file_updated executed successfully
2025/03/05 11:12 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741172774.2924385 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 INFO:Importing file from output\imported_raw.csv
2025/03/05 11:12 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:12 INFO:Preprocessed data loaded successfully.
2025/03/05 11:12 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Cleaning up raw data
2025/03/05 11:12 ERROR:Session state variables not initialized!
2025/03/05 11:12 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Original file path: None
2025/03/05 11:12 INFO:Saved file path: output\cleaned_donations.csv
2025/03/05 11:12 ERROR:Error: originalfilepath is None!
2025/03/05 11:12 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:12 INFO:Data loaded, shape: (65278, 29)
2025/03/05 11:12 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/05 11:12 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 11:12 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 11:12 INFO:File deduplication complete, shape: (65278, 33)
2025/03/05 11:12 INFO:dedupe_entity_file executed successfully
2025/03/05 11:12 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Running first load function.
2025/03/05 11:12 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/05 11:12 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/05 11:12 INFO:Preprocessed data loaded successfully.
2025/03/05 11:12 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Cleaning up raw data
2025/03/05 11:12 ERROR:Session state variables not initialized!
2025/03/05 11:12 INFO:Data loaded, shape: (65278, 29)
2025/03/05 11:12 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/05 11:12 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 11:12 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 11:12 INFO:File deduplication complete, shape: (65278, 33)
2025/03/05 11:12 INFO:dedupe_entity_file executed successfully
2025/03/05 11:12 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/05 11:12 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/05 11:12 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/05 11:12 INFO:File deduplication complete, shape: (65278, 37)
2025/03/05 11:12 INFO:dedupe_entity_file executed successfully
2025/03/05 11:12 INFO:Raw Data cleanup completed
2025/03/05 11:12 INFO:Data shape: (65278, 37)
2025/03/05 11:12 INFO:Data saved to output\cleaned_donations.csv
2025/03/05 11:12 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/05 11:12 INFO:raw_data_cleanup executed successfully
2025/03/05 11:12 INFO:load_raw_data executed successfully
2025/03/05 11:12 INFO:get_raw_data executed successfully
2025/03/05 11:12 DEBUG:st.session_state.raw_data: 65278
2025/03/05 11:12 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Rows in Raw Data: 65278
2025/03/05 11:12 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 11:12 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 11:12 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 11:12 INFO:get_file_modification_time executed successfully
2025/03/05 11:12 INFO:Current modification time: 1741173126.2026107
2025/03/05 11:12 INFO:Last modification time: 1741172774.2924385
2025/03/05 11:12 INFO:is_file_updated executed successfully
2025/03/05 11:12 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:12 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/05 11:12 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/05 11:12 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/05 11:12 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/05 11:12 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/05 11:12 DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/05 11:12 DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/05 11:12 DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/05 11:12 DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/05 11:12 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/05 11:12 ERROR:Attempting to remove duplicates
2025/03/05 11:12 DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 43 columns]
2025/03/05 11:12 DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/05 11:12 INFO:Data Updated with PartyName and PartyId successfully
2025/03/05 11:12 INFO:map_mp_to_party executed successfully
2025/03/05 11:12 DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/05 11:12 DEBUG:Group assignment: group
RegulatedEntityName       53528
Small Medium Entity        4430
Small Entity               2251
Very Small Entity          1492
Medium Large Entity        1203
Large Entity               1194
Medium Entity               694
Single Donation Entity      486
Name: count, dtype: int64
2025/03/05 11:12 DEBUG:Group assignment: group
Very Small Entity         491
Single Donation Entity    486
Small Entity              241
Small Medium Entity       127
Medium Entity               5
RegulatedEntityName         5
Medium Large Entity         4
Large Entity                2
Name: count, dtype: int64
2025/03/05 11:12 DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/05 11:12 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:12 DEBUG:try to load previous election dates from file.
2025/03/05 11:12 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 INFO:Saved file path: reference_files\elections.csv
2025/03/05 11:12 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 11:12 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 INFO:get_file_modification_time executed successfully
2025/03/05 11:12 INFO:Current modification time: 1740757862.6744745
2025/03/05 11:12 INFO:Last modification time: 1740757862.6744745
2025/03/05 11:12 INFO:is_file_updated executed successfully
2025/03/05 11:12 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1740757862.6744745 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 INFO:Importing file from reference_files\elections.csv
2025/03/05 11:12 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/05 11:12 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:12 ERROR:Failed to load election dates from file.
2025/03/05 11:12 INFO:Election_dates_df empty - loading from pdpy.
2025/03/05 11:12 INFO:Election Dates loaded vis pdpy.
2025/03/05 11:12 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/05 11:12 INFO:Election Dates Loaded Successfully.
2025/03/05 11:12 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:12 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:12 INFO:load_election_dates executed successfully
2025/03/05 11:12 DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/05 11:12 DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/05 11:12 INFO:Cleaned Data completed, shape: (65278, 57)
2025/03/05 11:12 INFO:load_cleaned_data executed successfully
2025/03/05 11:12 INFO:get_cleaned_data executed successfully
2025/03/05 11:12 DEBUG:st.session_state.raw_data: 65278
2025/03/05 11:12 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Original file path: output\cleaned_data.csv
2025/03/05 11:12 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 11:12 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 11:12 INFO:get_file_modification_time executed successfully
2025/03/05 11:12 INFO:Current modification time: 1741173130.349746
2025/03/05 11:12 INFO:Last modification time: 1741172778.734468
2025/03/05 11:12 INFO:is_file_updated executed successfully
2025/03/05 11:12 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:12 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/05 11:12 INFO:Donor Data summary completed
2025/03/05 11:12 INFO:Data shape: (25576, 5)
2025/03/05 11:12 INFO:load_donorList_data executed successfully
2025/03/05 11:12 INFO:get_donor_data executed successfully
2025/03/05 11:12 DEBUG:st.session_state.data_donor: 25576
2025/03/05 11:12 DEBUG:st.session_state.data_clean: 65278
2025/03/05 11:12 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Original file path: output\cleaned_data.csv
2025/03/05 11:12 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 11:12 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 11:12 INFO:get_file_modification_time executed successfully
2025/03/05 11:12 INFO:Current modification time: 1741173130.349746
2025/03/05 11:12 INFO:Last modification time: 1741173130.349746
2025/03/05 11:12 INFO:is_file_updated executed successfully
2025/03/05 11:12 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741173130.349746 instead of output\cleaned_data.csv
2025/03/05 11:12 INFO:Importing file from output\cleaned_regentity.csv
2025/03/05 11:12 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/05 11:12 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:12 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025/03/05 11:12 INFO:Raw Data cleanup completed
2025/03/05 11:12 INFO:Data shape: (2150, 6)
2025/03/05 11:12 INFO:load_regulated_entity_data executed successfully
2025/03/05 11:12 INFO:get_regentity_data executed successfully
2025/03/05 11:12 DEBUG:st.session_state.data_regentity: 2150
2025/03/05 11:12 DEBUG:st.session_state.data_donor: 25576
2025/03/05 11:12 DEBUG:st.session_state.data_clean: 65278
2025/03/05 11:12 INFO:firstload executed successfully
2025/03/05 11:12 INFO:Data first load completed successfully.
2025/03/05 11:12 INFO:initialise_data executed successfully
2025/03/05 11:12 INFO:App is fully loaded and ready!
2025/03/05 11:12 INFO:Streamlit App Starting...
2025/03/05 11:12 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:12 INFO:Running App setup...
2025/03/05 11:12 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Setting up the package
2025/03/05 11:12 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:Version: v20.145
2025/03/05 11:12 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:12 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:12 DEBUG:filenames already exists in session state
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:12 DEBUG:thresholds already exists in session state
2025/03/05 11:12 DEBUG:data_remappings already exists in session state
2025/03/05 11:12 DEBUG:filter_def already exists in session state
2025/03/05 11:12 DEBUG:security already exists in session state
2025/03/05 11:12 DEBUG:perc_target already exists in session state
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:12 DEBUG:directories already exists in session state
2025/03/05 11:12 DEBUG:reference_dir already exists in session state
2025/03/05 11:12 DEBUG:data_dir already exists in session state
2025/03/05 11:12 DEBUG:output_dir already exists in session state
2025/03/05 11:12 DEBUG:logs_dir already exists in session state
2025/03/05 11:12 DEBUG:components_dir already exists in session state
2025/03/05 11:12 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:12 DEBUG:utils_dir already exists in session state
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:12 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:12 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:12 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:12 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:12 DEBUG:original_data_fname already exists in session state
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:12 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:12 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:12 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:12 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:12 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:12 DEBUG:source_data_fname already exists in session state
2025/03/05 11:12 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:12 INFO:Session_state variables initialized
2025/03/05 11:12 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:12 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:12 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:12 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:12 DEBUG:perc_target: 0.5
2025/03/05 11:12 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:12 DEBUG:data_dir: data
2025/03/05 11:12 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:12 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:12 DEBUG:app_pages_dir: app_pages
2025/03/05 11:12 DEBUG:logs_dir: logs
2025/03/05 11:12 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:output_dir: output
2025/03/05 11:12 DEBUG:reference_dir: reference_files
2025/03/05 11:12 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:12 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:12 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:12 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:12 DEBUG:utils_dir: utils
2025/03/05 11:12 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:12 DEBUG:load_raw_data_last_modified: 1741173126.2026107
2025/03/05 11:12 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:12 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:12 DEBUG:components_dir: components
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:12 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:12 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:12 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:12 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:12 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:12 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:12 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:12 DEBUG:load_donorlist_data_last_modified: 1741173130.349746
2025/03/05 11:12 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:12 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000002F0B3E53EB0>}
2025/03/05 11:12 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:12 INFO:Session state Setup complete
2025/03/05 11:12 INFO:initialize_session_state executed successfully
2025/03/05 11:12 INFO:Package setup complete
2025/03/05 11:12 INFO:setup_package executed successfully
2025/03/05 11:12 INFO:Setup completed successfully.
2025/03/05 11:12 INFO:Running Menu setup...
2025/03/05 11:12 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:App Version: v20.166
2025/03/05 11:12 INFO:Switched to page: Head Line Figures
2025/03/05 11:12 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:load_and_filter_data executed successfully
2025/03/05 11:12 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:display_summary_statistics executed successfully
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 INFO:hlf_body executed successfully
2025/03/05 11:12 INFO:pagesetup executed successfully
2025/03/05 11:12 INFO:Menu setup completed successfully.
2025/03/05 11:12 INFO:Data already loaded in session state.
2025/03/05 11:12 INFO:App is fully loaded and ready!
2025/03/05 11:12 INFO:Streamlit App Starting...
2025/03/05 11:12 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:12 INFO:Running App setup...
2025/03/05 11:12 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Setting up the package
2025/03/05 11:12 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:Version: v20.145
2025/03/05 11:12 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:12 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:12 DEBUG:filenames already exists in session state
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:12 DEBUG:thresholds already exists in session state
2025/03/05 11:12 DEBUG:data_remappings already exists in session state
2025/03/05 11:12 DEBUG:filter_def already exists in session state
2025/03/05 11:12 DEBUG:security already exists in session state
2025/03/05 11:12 DEBUG:perc_target already exists in session state
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:12 DEBUG:directories already exists in session state
2025/03/05 11:12 DEBUG:reference_dir already exists in session state
2025/03/05 11:12 DEBUG:data_dir already exists in session state
2025/03/05 11:12 DEBUG:output_dir already exists in session state
2025/03/05 11:12 DEBUG:logs_dir already exists in session state
2025/03/05 11:12 DEBUG:components_dir already exists in session state
2025/03/05 11:12 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:12 DEBUG:utils_dir already exists in session state
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:12 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:12 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:12 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:12 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:12 DEBUG:original_data_fname already exists in session state
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:12 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:12 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:12 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:12 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:12 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:12 DEBUG:source_data_fname already exists in session state
2025/03/05 11:12 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:12 INFO:Session_state variables initialized
2025/03/05 11:12 DEBUG:year_slider_dons_by_year_n_entity: (2001, 2019)
2025/03/05 11:12 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:12 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:12 DEBUG:year_slider_value_by_year_n_entity: (2001, 2019)
2025/03/05 11:12 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:12 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:12 DEBUG:perc_target: 0.5
2025/03/05 11:12 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:12 DEBUG:year_slider_value_by_year_n_type: (2001, 2019)
2025/03/05 11:12 DEBUG:data_dir: data
2025/03/05 11:12 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:12 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:12 DEBUG:app_pages_dir: app_pages
2025/03/05 11:12 DEBUG:logs_dir: logs
2025/03/05 11:12 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:output_dir: output
2025/03/05 11:12 DEBUG:reference_dir: reference_files
2025/03/05 11:12 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:12 DEBUG:year_slider_dons_by_year_n_type: (2001, 2019)
2025/03/05 11:12 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:12 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:12 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:12 DEBUG:min_date: 2001-01-01
2025/03/05 11:12 DEBUG:utils_dir: utils
2025/03/05 11:12 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:12 DEBUG:load_raw_data_last_modified: 1741173126.2026107
2025/03/05 11:12 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:12 DEBUG:max_date: 2019-09-02
2025/03/05 11:12 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:12 DEBUG:components_dir: components
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:12 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:12 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:12 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:12 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:12 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:12 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:12 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:12 DEBUG:load_donorlist_data_last_modified: 1741173130.349746
2025/03/05 11:12 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:12 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations_page at 0x000002F0B3E65120>}
2025/03/05 11:12 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:12 INFO:Session state Setup complete
2025/03/05 11:12 INFO:initialize_session_state executed successfully
2025/03/05 11:12 INFO:Package setup complete
2025/03/05 11:12 INFO:setup_package executed successfully
2025/03/05 11:12 INFO:Setup completed successfully.
2025/03/05 11:12 INFO:Running Menu setup...
2025/03/05 11:12 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:App Version: v20.166
2025/03/05 11:12 INFO:Switched to page: Cash Donations
2025/03/05 11:12 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:load_and_filter_data executed successfully
2025/03/05 11:12 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:display_summary_statistics executed successfully
2025/03/05 11:12 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:display_textual_insights executed successfully
2025/03/05 11:12 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 INFO:display_visualizations executed successfully
2025/03/05 11:12 INFO:display_data_page executed successfully
2025/03/05 11:12 INFO:pagesetup executed successfully
2025/03/05 11:12 INFO:Menu setup completed successfully.
2025/03/05 11:12 INFO:Data already loaded in session state.
2025/03/05 11:12 INFO:App is fully loaded and ready!
2025/03/05 11:12 INFO:Streamlit App Starting...
2025/03/05 11:12 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:12 INFO:Running App setup...
2025/03/05 11:12 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Setting up the package
2025/03/05 11:12 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:Version: v20.145
2025/03/05 11:12 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:12 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:12 DEBUG:filenames already exists in session state
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:12 DEBUG:thresholds already exists in session state
2025/03/05 11:12 DEBUG:data_remappings already exists in session state
2025/03/05 11:12 DEBUG:filter_def already exists in session state
2025/03/05 11:12 DEBUG:security already exists in session state
2025/03/05 11:12 DEBUG:perc_target already exists in session state
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:12 DEBUG:directories already exists in session state
2025/03/05 11:12 DEBUG:reference_dir already exists in session state
2025/03/05 11:12 DEBUG:data_dir already exists in session state
2025/03/05 11:12 DEBUG:output_dir already exists in session state
2025/03/05 11:12 DEBUG:logs_dir already exists in session state
2025/03/05 11:12 DEBUG:components_dir already exists in session state
2025/03/05 11:12 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:12 DEBUG:utils_dir already exists in session state
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:12 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:12 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:12 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:12 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:12 DEBUG:original_data_fname already exists in session state
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:12 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:12 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:12 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:12 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:12 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:12 DEBUG:source_data_fname already exists in session state
2025/03/05 11:12 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:12 INFO:Session_state variables initialized
2025/03/05 11:12 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:12 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:12 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:12 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:12 DEBUG:perc_target: 0.5
2025/03/05 11:12 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:12 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:12 DEBUG:data_dir: data
2025/03/05 11:12 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:12 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:12 DEBUG:app_pages_dir: app_pages
2025/03/05 11:12 DEBUG:logs_dir: logs
2025/03/05 11:12 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:output_dir: output
2025/03/05 11:12 DEBUG:reference_dir: reference_files
2025/03/05 11:12 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:12 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:12 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:12 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:12 DEBUG:min_date: 2001-01-01
2025/03/05 11:12 DEBUG:utils_dir: utils
2025/03/05 11:12 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:12 DEBUG:load_raw_data_last_modified: 1741173126.2026107
2025/03/05 11:12 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:12 DEBUG:max_date: 2019-09-02
2025/03/05 11:12 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:12 DEBUG:components_dir: components
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:12 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:12 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:12 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:12 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:12 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:12 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:12 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:12 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:12 DEBUG:load_donorlist_data_last_modified: 1741173130.349746
2025/03/05 11:12 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:12 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000002F0B3E652D0>}
2025/03/05 11:12 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:12 INFO:Session state Setup complete
2025/03/05 11:12 INFO:initialize_session_state executed successfully
2025/03/05 11:12 INFO:Package setup complete
2025/03/05 11:12 INFO:setup_package executed successfully
2025/03/05 11:12 INFO:Setup completed successfully.
2025/03/05 11:12 INFO:Running Menu setup...
2025/03/05 11:12 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:App Version: v20.166
2025/03/05 11:12 INFO:Switched to page: Non Cash Donations
2025/03/05 11:12 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:load_and_filter_data executed successfully
2025/03/05 11:12 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:display_summary_statistics executed successfully
2025/03/05 11:12 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:display_textual_insights executed successfully
2025/03/05 11:12 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 INFO:display_visualizations executed successfully
2025/03/05 11:12 INFO:display_data_page executed successfully
2025/03/05 11:12 INFO:pagesetup executed successfully
2025/03/05 11:12 INFO:Menu setup completed successfully.
2025/03/05 11:12 INFO:Data already loaded in session state.
2025/03/05 11:12 INFO:App is fully loaded and ready!
2025/03/05 11:12 INFO:Streamlit App Starting...
2025/03/05 11:12 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:12 INFO:Running App setup...
2025/03/05 11:12 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:Setting up the package
2025/03/05 11:12 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:Version: v20.145
2025/03/05 11:12 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:12 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:12 DEBUG:filenames already exists in session state
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:12 DEBUG:thresholds already exists in session state
2025/03/05 11:12 DEBUG:data_remappings already exists in session state
2025/03/05 11:12 DEBUG:filter_def already exists in session state
2025/03/05 11:12 DEBUG:security already exists in session state
2025/03/05 11:12 DEBUG:perc_target already exists in session state
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:12 DEBUG:directories already exists in session state
2025/03/05 11:12 DEBUG:reference_dir already exists in session state
2025/03/05 11:12 DEBUG:data_dir already exists in session state
2025/03/05 11:12 DEBUG:output_dir already exists in session state
2025/03/05 11:12 DEBUG:logs_dir already exists in session state
2025/03/05 11:12 DEBUG:components_dir already exists in session state
2025/03/05 11:12 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:12 DEBUG:utils_dir already exists in session state
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:12 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:12 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:12 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:12 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:12 DEBUG:original_data_fname already exists in session state
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:12 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:12 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:12 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:12 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:12 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:12 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:12 DEBUG:source_data_fname already exists in session state
2025/03/05 11:12 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:12 INFO:Session_state variables initialized
2025/03/05 11:12 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:12 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:12 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:12 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:12 DEBUG:perc_target: 0.5
2025/03/05 11:12 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:12 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:12 DEBUG:data_dir: data
2025/03/05 11:12 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:12 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:12 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:12 DEBUG:app_pages_dir: app_pages
2025/03/05 11:12 DEBUG:logs_dir: logs
2025/03/05 11:12 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:12 DEBUG:output_dir: output
2025/03/05 11:12 DEBUG:reference_dir: reference_files
2025/03/05 11:12 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:12 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:12 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:12 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:12 DEBUG:min_date: 2001-01-01
2025/03/05 11:12 DEBUG:utils_dir: utils
2025/03/05 11:12 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:12 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:12 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:12 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:12 DEBUG:load_raw_data_last_modified: 1741173126.2026107
2025/03/05 11:12 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:12 DEBUG:max_date: 2019-09-02
2025/03/05 11:12 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:12 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:12 DEBUG:components_dir: components
2025/03/05 11:12 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:12 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:12 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:12 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:12 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:12 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:12 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:12 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:12 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:12 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:12 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:12 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:12 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:12 DEBUG:load_donorlist_data_last_modified: 1741173130.349746
2025/03/05 11:12 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:12 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:12 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:12 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations_page at 0x000002F0B3E65120>}
2025/03/05 11:12 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:12 INFO:Session state Setup complete
2025/03/05 11:12 INFO:initialize_session_state executed successfully
2025/03/05 11:12 INFO:Package setup complete
2025/03/05 11:12 INFO:setup_package executed successfully
2025/03/05 11:12 INFO:Setup completed successfully.
2025/03/05 11:12 INFO:Running Menu setup...
2025/03/05 11:12 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:get_git_version executed successfully
2025/03/05 11:12 INFO:App Version: v20.166
2025/03/05 11:12 INFO:Switched to page: Cash Donations
2025/03/05 11:12 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:load_and_filter_data executed successfully
2025/03/05 11:12 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:display_summary_statistics executed successfully
2025/03/05 11:12 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:display_textual_insights executed successfully
2025/03/05 11:12 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:12 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:12 INFO:display_visualizations executed successfully
2025/03/05 11:12 INFO:display_data_page executed successfully
2025/03/05 11:12 INFO:pagesetup executed successfully
2025/03/05 11:12 INFO:Menu setup completed successfully.
2025/03/05 11:12 INFO:Data already loaded in session state.
2025/03/05 11:12 INFO:App is fully loaded and ready!
2025/03/05 11:13 INFO:Streamlit App Starting...
2025/03/05 11:13 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:13 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:13 INFO:Running App setup...
2025/03/05 11:13 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:Setting up the package
2025/03/05 11:13 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:13 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:get_git_version executed successfully
2025/03/05 11:13 INFO:Version: v20.145
2025/03/05 11:13 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:13 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:13 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:13 DEBUG:filenames already exists in session state
2025/03/05 11:13 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:13 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:13 DEBUG:thresholds already exists in session state
2025/03/05 11:13 DEBUG:data_remappings already exists in session state
2025/03/05 11:13 DEBUG:filter_def already exists in session state
2025/03/05 11:13 DEBUG:security already exists in session state
2025/03/05 11:13 DEBUG:perc_target already exists in session state
2025/03/05 11:13 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:13 DEBUG:directories already exists in session state
2025/03/05 11:13 DEBUG:reference_dir already exists in session state
2025/03/05 11:13 DEBUG:data_dir already exists in session state
2025/03/05 11:13 DEBUG:output_dir already exists in session state
2025/03/05 11:13 DEBUG:logs_dir already exists in session state
2025/03/05 11:13 DEBUG:components_dir already exists in session state
2025/03/05 11:13 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:13 DEBUG:utils_dir already exists in session state
2025/03/05 11:13 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:13 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:13 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:13 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:13 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:13 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:13 DEBUG:original_data_fname already exists in session state
2025/03/05 11:13 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:13 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:13 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:13 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:13 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:13 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:13 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:13 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:13 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:13 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:13 DEBUG:source_data_fname already exists in session state
2025/03/05 11:13 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:13 INFO:Session_state variables initialized
2025/03/05 11:13 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:13 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:13 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:13 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:13 DEBUG:perc_target: 0.5
2025/03/05 11:13 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:13 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:13 DEBUG:data_dir: data
2025/03/05 11:13 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:13 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:13 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:13 DEBUG:app_pages_dir: app_pages
2025/03/05 11:13 DEBUG:logs_dir: logs
2025/03/05 11:13 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:13 DEBUG:output_dir: output
2025/03/05 11:13 DEBUG:reference_dir: reference_files
2025/03/05 11:13 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:13 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:13 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:13 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'Cash_ftr': {'DonationType': 'Cash'}, 'NonCash_ftr': {'DonationType': 'Non Cash'}}
2025/03/05 11:13 DEBUG:min_date: 2001-01-01
2025/03/05 11:13 DEBUG:utils_dir: utils
2025/03/05 11:13 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:13 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:13 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:13 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:13 DEBUG:load_raw_data_last_modified: 1741173126.2026107
2025/03/05 11:13 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:13 DEBUG:max_date: 2019-09-02
2025/03/05 11:13 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:13 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:13 DEBUG:components_dir: components
2025/03/05 11:13 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:13 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:13 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:13 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:13 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:13 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:13 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:13 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:13 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:13 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:13 DEBUG:Cash_ftr: {'DonationType': 'Cash'}
2025/03/05 11:13 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:13 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:13 DEBUG:load_donorlist_data_last_modified: 1741173130.349746
2025/03/05 11:13 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:13 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:13 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:13 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000002F0B3E652D0>}
2025/03/05 11:13 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:13 INFO:Session state Setup complete
2025/03/05 11:13 INFO:initialize_session_state executed successfully
2025/03/05 11:13 INFO:Package setup complete
2025/03/05 11:13 INFO:setup_package executed successfully
2025/03/05 11:13 INFO:Setup completed successfully.
2025/03/05 11:13 INFO:Running Menu setup...
2025/03/05 11:13 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:13 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:get_git_version executed successfully
2025/03/05 11:13 INFO:App Version: v20.166
2025/03/05 11:13 INFO:Switched to page: Non Cash Donations
2025/03/05 11:13 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:13 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:load_and_filter_data executed successfully
2025/03/05 11:13 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:display_summary_statistics executed successfully
2025/03/05 11:13 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:display_textual_insights executed successfully
2025/03/05 11:13 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:13 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:13 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:13 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:13 INFO:display_visualizations executed successfully
2025/03/05 11:13 INFO:display_data_page executed successfully
2025/03/05 11:13 INFO:pagesetup executed successfully
2025/03/05 11:13 INFO:Menu setup completed successfully.
2025/03/05 11:13 INFO:Data already loaded in session state.
2025/03/05 11:13 INFO:App is fully loaded and ready!
2025/03/05 11:38 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:Streamlit App Starting...
2025/03/05 11:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:38 INFO:Running App setup...
2025/03/05 11:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Setting up the package
2025/03/05 11:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:Version: v20.145
2025/03/05 11:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 11:38 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:38 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 11:38 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 11:38 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:38 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:38 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:38 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:38 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 11:38 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 11:38 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:38 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 11:38 DEBUG:Initialised data_dir with value: data
2025/03/05 11:38 DEBUG:Initialised output_dir with value: output
2025/03/05 11:38 DEBUG:Initialised logs_dir with value: logs
2025/03/05 11:38 DEBUG:Initialised components_dir with value: components
2025/03/05 11:38 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 11:38 DEBUG:Initialised utils_dir with value: utils
2025/03/05 11:38 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:38 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:38 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 11:38 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:38 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:38 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:38 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 11:38 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 11:38 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 11:38 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 11:38 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 11:38 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 11:38 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 11:38 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 11:38 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 11:38 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 11:38 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 11:38 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 DEBUG:Initialised Cash_ftr with value: None
2025/03/05 11:38 INFO:Session_state variables initialized
2025/03/05 11:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:38 DEBUG:reference_dir: reference_files
2025/03/05 11:38 DEBUG:data_dir: data
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:38 DEBUG:Cash_ftr: None
2025/03/05 11:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:38 DEBUG:output_dir: output
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:38 DEBUG:app_pages_dir: app_pages
2025/03/05 11:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:38 DEBUG:components_dir: components
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:38 DEBUG:utils_dir: utils
2025/03/05 11:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:38 DEBUG:perc_target: 0.5
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:38 DEBUG:logs_dir: logs
2025/03/05 11:38 INFO:Session state Setup complete
2025/03/05 11:38 INFO:initialize_session_state executed successfully
2025/03/05 11:38 INFO:Package setup complete
2025/03/05 11:38 INFO:setup_package executed successfully
2025/03/05 11:38 INFO:Setup completed successfully.
2025/03/05 11:38 INFO:Running Menu setup...
2025/03/05 11:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:App Version: v20.166
2025/03/05 11:38 INFO:Switched to page: Introduction
2025/03/05 11:38 INFO:pagesetup executed successfully
2025/03/05 11:38 INFO:Menu setup completed successfully.
2025/03/05 11:38 INFO:No data found in session state, running firstload()
2025/03/05 11:38 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Running first load function.
2025/03/05 11:38 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/05 11:38 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/05 11:38 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 INFO:Saved file path: output\imported_raw.csv
2025/03/05 11:38 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 11:38 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 INFO:get_file_modification_time executed successfully
2025/03/05 11:38 INFO:Current modification time: 1740757862.6744745
2025/03/05 11:38 INFO:Last modification time: 1741173126.2026107
2025/03/05 11:38 INFO:is_file_updated executed successfully
2025/03/05 11:38 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741173126.2026107 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 INFO:Importing file from output\imported_raw.csv
2025/03/05 11:38 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:38 INFO:Preprocessed data loaded successfully.
2025/03/05 11:38 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Cleaning up raw data
2025/03/05 11:38 ERROR:Session state variables not initialized!
2025/03/05 11:38 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Original file path: None
2025/03/05 11:38 INFO:Saved file path: output\cleaned_donations.csv
2025/03/05 11:38 ERROR:Error: originalfilepath is None!
2025/03/05 11:38 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:38 INFO:Data loaded, shape: (65278, 29)
2025/03/05 11:38 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/05 11:38 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 11:38 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 11:38 INFO:File deduplication complete, shape: (65278, 33)
2025/03/05 11:38 INFO:dedupe_entity_file executed successfully
2025/03/05 11:38 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/05 11:38 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/05 11:38 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/05 11:38 INFO:File deduplication complete, shape: (65278, 37)
2025/03/05 11:38 INFO:dedupe_entity_file executed successfully
2025/03/05 11:38 INFO:Raw Data cleanup completed
2025/03/05 11:38 INFO:Data shape: (65278, 37)
2025/03/05 11:38 INFO:Data saved to output\cleaned_donations.csv
2025/03/05 11:38 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/05 11:38 INFO:raw_data_cleanup executed successfully
2025/03/05 11:38 INFO:load_raw_data executed successfully
2025/03/05 11:38 INFO:get_raw_data executed successfully
2025/03/05 11:38 DEBUG:st.session_state.raw_data: 65278
2025/03/05 11:38 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Rows in Raw Data: 65278
2025/03/05 11:38 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 11:38 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 11:38 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 11:38 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 11:38 INFO:get_file_modification_time executed successfully
2025/03/05 11:38 INFO:Current modification time: 1741174708.2435687
2025/03/05 11:38 INFO:Last modification time: 1741173126.2026107
2025/03/05 11:38 INFO:is_file_updated executed successfully
2025/03/05 11:38 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:38 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/05 11:38 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/05 11:38 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/05 11:38 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/05 11:38 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/05 11:38 DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/05 11:38 DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/05 11:38 DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/05 11:38 DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/05 11:38 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/05 11:38 ERROR:Attempting to remove duplicates
2025/03/05 11:38 DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 43 columns]
2025/03/05 11:38 DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/05 11:38 INFO:Data Updated with PartyName and PartyId successfully
2025/03/05 11:38 INFO:map_mp_to_party executed successfully
2025/03/05 11:38 DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/05 11:38 DEBUG:Group assignment: group
RegulatedEntityName       53528
Small Medium Entity        4430
Small Entity               2251
Very Small Entity          1492
Medium Large Entity        1203
Large Entity               1194
Medium Entity               694
Single Donation Entity      486
Name: count, dtype: int64
2025/03/05 11:38 DEBUG:Group assignment: group
Very Small Entity         491
Single Donation Entity    486
Small Entity              241
Small Medium Entity       127
Medium Entity               5
RegulatedEntityName         5
Medium Large Entity         4
Large Entity                2
Name: count, dtype: int64
2025/03/05 11:38 DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/05 11:38 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:38 DEBUG:try to load previous election dates from file.
2025/03/05 11:38 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 INFO:Saved file path: reference_files\elections.csv
2025/03/05 11:38 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 11:38 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 INFO:get_file_modification_time executed successfully
2025/03/05 11:38 INFO:Current modification time: 1740757862.6744745
2025/03/05 11:38 INFO:Last modification time: 1740757862.6744745
2025/03/05 11:38 INFO:is_file_updated executed successfully
2025/03/05 11:38 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1740757862.6744745 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 INFO:Importing file from reference_files\elections.csv
2025/03/05 11:38 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/05 11:38 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:38 ERROR:Failed to load election dates from file.
2025/03/05 11:38 INFO:Election_dates_df empty - loading from pdpy.
2025/03/05 11:38 INFO:Election Dates loaded vis pdpy.
2025/03/05 11:38 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/05 11:38 INFO:Election Dates Loaded Successfully.
2025/03/05 11:38 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:38 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:38 INFO:load_election_dates executed successfully
2025/03/05 11:38 DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/05 11:38 DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/05 11:38 INFO:Cleaned Data completed, shape: (65278, 57)
2025/03/05 11:38 INFO:load_cleaned_data executed successfully
2025/03/05 11:38 INFO:get_cleaned_data executed successfully
2025/03/05 11:38 DEBUG:st.session_state.raw_data: 65278
2025/03/05 11:38 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Original file path: output\cleaned_data.csv
2025/03/05 11:38 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 11:38 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 11:38 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 11:38 INFO:get_file_modification_time executed successfully
2025/03/05 11:38 INFO:Current modification time: 1741174713.2652059
2025/03/05 11:38 INFO:Last modification time: 1741173130.349746
2025/03/05 11:38 INFO:is_file_updated executed successfully
2025/03/05 11:38 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:38 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/05 11:38 INFO:Donor Data summary completed
2025/03/05 11:38 INFO:Data shape: (25576, 5)
2025/03/05 11:38 INFO:load_donorList_data executed successfully
2025/03/05 11:38 INFO:get_donor_data executed successfully
2025/03/05 11:38 DEBUG:st.session_state.data_donor: 25576
2025/03/05 11:38 DEBUG:st.session_state.data_clean: 65278
2025/03/05 11:38 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Original file path: output\cleaned_data.csv
2025/03/05 11:38 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 11:38 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 11:38 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 11:38 INFO:get_file_modification_time executed successfully
2025/03/05 11:38 INFO:Current modification time: 1741174713.2652059
2025/03/05 11:38 INFO:Last modification time: 1741174713.2652059
2025/03/05 11:38 INFO:is_file_updated executed successfully
2025/03/05 11:38 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741174713.2652059 instead of output\cleaned_data.csv
2025/03/05 11:38 INFO:Importing file from output\cleaned_regentity.csv
2025/03/05 11:38 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/05 11:38 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 11:38 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025/03/05 11:38 INFO:Raw Data cleanup completed
2025/03/05 11:38 INFO:Data shape: (2150, 6)
2025/03/05 11:38 INFO:load_regulated_entity_data executed successfully
2025/03/05 11:38 INFO:get_regentity_data executed successfully
2025/03/05 11:38 DEBUG:st.session_state.data_regentity: 2150
2025/03/05 11:38 DEBUG:st.session_state.data_donor: 25576
2025/03/05 11:38 DEBUG:st.session_state.data_clean: 65278
2025/03/05 11:38 INFO:firstload executed successfully
2025/03/05 11:38 INFO:Data first load completed successfully.
2025/03/05 11:38 INFO:initialise_data executed successfully
2025/03/05 11:38 INFO:App is fully loaded and ready!
2025/03/05 11:38 INFO:Streamlit App Starting...
2025/03/05 11:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:38 INFO:Running App setup...
2025/03/05 11:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Setting up the package
2025/03/05 11:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:Version: v20.145
2025/03/05 11:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:38 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:38 DEBUG:filenames already exists in session state
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:38 DEBUG:thresholds already exists in session state
2025/03/05 11:38 DEBUG:data_remappings already exists in session state
2025/03/05 11:38 DEBUG:filter_def already exists in session state
2025/03/05 11:38 DEBUG:security already exists in session state
2025/03/05 11:38 DEBUG:perc_target already exists in session state
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:38 DEBUG:directories already exists in session state
2025/03/05 11:38 DEBUG:reference_dir already exists in session state
2025/03/05 11:38 DEBUG:data_dir already exists in session state
2025/03/05 11:38 DEBUG:output_dir already exists in session state
2025/03/05 11:38 DEBUG:logs_dir already exists in session state
2025/03/05 11:38 DEBUG:components_dir already exists in session state
2025/03/05 11:38 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:38 DEBUG:utils_dir already exists in session state
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:38 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:38 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:38 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:38 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:38 DEBUG:original_data_fname already exists in session state
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:38 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:38 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:38 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:38 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:38 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:38 DEBUG:source_data_fname already exists in session state
2025/03/05 11:38 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:38 INFO:Session_state variables initialized
2025/03/05 11:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:38 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001EFD608BA30>}
2025/03/05 11:38 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:38 DEBUG:reference_dir: reference_files
2025/03/05 11:38 DEBUG:data_dir: data
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:38 DEBUG:Cash_ftr: None
2025/03/05 11:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:38 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:38 DEBUG:output_dir: output
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:38 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:38 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:38 DEBUG:app_pages_dir: app_pages
2025/03/05 11:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:38 DEBUG:components_dir: components
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:38 DEBUG:utils_dir: utils
2025/03/05 11:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:38 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:38 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:38 DEBUG:perc_target: 0.5
2025/03/05 11:38 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:38 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:38 DEBUG:logs_dir: logs
2025/03/05 11:38 INFO:Session state Setup complete
2025/03/05 11:38 INFO:initialize_session_state executed successfully
2025/03/05 11:38 INFO:Package setup complete
2025/03/05 11:38 INFO:setup_package executed successfully
2025/03/05 11:38 INFO:Setup completed successfully.
2025/03/05 11:38 INFO:Running Menu setup...
2025/03/05 11:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:App Version: v20.166
2025/03/05 11:38 INFO:Switched to page: Head Line Figures
2025/03/05 11:38 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:load_and_filter_data executed successfully
2025/03/05 11:38 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:display_summary_statistics executed successfully
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 INFO:hlf_body executed successfully
2025/03/05 11:38 INFO:pagesetup executed successfully
2025/03/05 11:38 INFO:Menu setup completed successfully.
2025/03/05 11:38 INFO:Data already loaded in session state.
2025/03/05 11:38 INFO:App is fully loaded and ready!
2025/03/05 11:38 INFO:Streamlit App Starting...
2025/03/05 11:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:38 INFO:Running App setup...
2025/03/05 11:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Setting up the package
2025/03/05 11:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:Version: v20.145
2025/03/05 11:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:38 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:38 DEBUG:filenames already exists in session state
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:38 DEBUG:thresholds already exists in session state
2025/03/05 11:38 DEBUG:data_remappings already exists in session state
2025/03/05 11:38 DEBUG:filter_def already exists in session state
2025/03/05 11:38 DEBUG:security already exists in session state
2025/03/05 11:38 DEBUG:perc_target already exists in session state
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:38 DEBUG:directories already exists in session state
2025/03/05 11:38 DEBUG:reference_dir already exists in session state
2025/03/05 11:38 DEBUG:data_dir already exists in session state
2025/03/05 11:38 DEBUG:output_dir already exists in session state
2025/03/05 11:38 DEBUG:logs_dir already exists in session state
2025/03/05 11:38 DEBUG:components_dir already exists in session state
2025/03/05 11:38 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:38 DEBUG:utils_dir already exists in session state
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:38 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:38 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:38 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:38 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:38 DEBUG:original_data_fname already exists in session state
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:38 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:38 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:38 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:38 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:38 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:38 DEBUG:source_data_fname already exists in session state
2025/03/05 11:38 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:38 INFO:Session_state variables initialized
2025/03/05 11:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:38 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations_page at 0x000001EFD60A4D30>}
2025/03/05 11:38 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:38 DEBUG:reference_dir: reference_files
2025/03/05 11:38 DEBUG:data_dir: data
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:38 DEBUG:min_date: 2001-01-01
2025/03/05 11:38 DEBUG:year_slider_dons_by_year_n_type: (2001, 2019)
2025/03/05 11:38 DEBUG:Cash_ftr: None
2025/03/05 11:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:38 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:38 DEBUG:output_dir: output
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:38 DEBUG:max_date: 2019-09-02
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:38 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:38 DEBUG:year_slider_value_by_year_n_entity: (2001, 2019)
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:38 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:38 DEBUG:app_pages_dir: app_pages
2025/03/05 11:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:38 DEBUG:components_dir: components
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:38 DEBUG:utils_dir: utils
2025/03/05 11:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:38 DEBUG:year_slider_dons_by_year_n_entity: (2001, 2019)
2025/03/05 11:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:38 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:38 DEBUG:year_slider_value_by_year_n_type: (2001, 2019)
2025/03/05 11:38 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:38 DEBUG:perc_target: 0.5
2025/03/05 11:38 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:38 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:38 DEBUG:logs_dir: logs
2025/03/05 11:38 INFO:Session state Setup complete
2025/03/05 11:38 INFO:initialize_session_state executed successfully
2025/03/05 11:38 INFO:Package setup complete
2025/03/05 11:38 INFO:setup_package executed successfully
2025/03/05 11:38 INFO:Setup completed successfully.
2025/03/05 11:38 INFO:Running Menu setup...
2025/03/05 11:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:App Version: v20.166
2025/03/05 11:38 INFO:Switched to page: Cash Donations
2025/03/05 11:38 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:load_and_filter_data executed successfully
2025/03/05 11:38 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:display_summary_statistics executed successfully
2025/03/05 11:38 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:display_textual_insights executed successfully
2025/03/05 11:38 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 INFO:display_visualizations executed successfully
2025/03/05 11:38 INFO:display_data_page executed successfully
2025/03/05 11:38 INFO:pagesetup executed successfully
2025/03/05 11:38 INFO:Menu setup completed successfully.
2025/03/05 11:38 INFO:Data already loaded in session state.
2025/03/05 11:38 INFO:App is fully loaded and ready!
2025/03/05 11:38 INFO:Streamlit App Starting...
2025/03/05 11:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:38 INFO:Running App setup...
2025/03/05 11:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Setting up the package
2025/03/05 11:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:Version: v20.145
2025/03/05 11:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:38 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:38 DEBUG:filenames already exists in session state
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:38 DEBUG:thresholds already exists in session state
2025/03/05 11:38 DEBUG:data_remappings already exists in session state
2025/03/05 11:38 DEBUG:filter_def already exists in session state
2025/03/05 11:38 DEBUG:security already exists in session state
2025/03/05 11:38 DEBUG:perc_target already exists in session state
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:38 DEBUG:directories already exists in session state
2025/03/05 11:38 DEBUG:reference_dir already exists in session state
2025/03/05 11:38 DEBUG:data_dir already exists in session state
2025/03/05 11:38 DEBUG:output_dir already exists in session state
2025/03/05 11:38 DEBUG:logs_dir already exists in session state
2025/03/05 11:38 DEBUG:components_dir already exists in session state
2025/03/05 11:38 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:38 DEBUG:utils_dir already exists in session state
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:38 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:38 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:38 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:38 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:38 DEBUG:original_data_fname already exists in session state
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:38 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:38 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:38 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:38 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:38 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:38 DEBUG:source_data_fname already exists in session state
2025/03/05 11:38 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:38 INFO:Session_state variables initialized
2025/03/05 11:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:38 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000001EFD60A4EE0>}
2025/03/05 11:38 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:38 DEBUG:reference_dir: reference_files
2025/03/05 11:38 DEBUG:data_dir: data
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:38 DEBUG:min_date: 2001-01-01
2025/03/05 11:38 DEBUG:Cash_ftr: None
2025/03/05 11:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:38 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:38 DEBUG:output_dir: output
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:38 DEBUG:max_date: 2019-09-02
2025/03/05 11:38 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:38 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:38 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:38 DEBUG:app_pages_dir: app_pages
2025/03/05 11:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:38 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:38 DEBUG:components_dir: components
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:38 DEBUG:utils_dir: utils
2025/03/05 11:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:38 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:38 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:38 DEBUG:perc_target: 0.5
2025/03/05 11:38 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:38 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:38 DEBUG:logs_dir: logs
2025/03/05 11:38 INFO:Session state Setup complete
2025/03/05 11:38 INFO:initialize_session_state executed successfully
2025/03/05 11:38 INFO:Package setup complete
2025/03/05 11:38 INFO:setup_package executed successfully
2025/03/05 11:38 INFO:Setup completed successfully.
2025/03/05 11:38 INFO:Running Menu setup...
2025/03/05 11:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:App Version: v20.166
2025/03/05 11:38 INFO:Switched to page: Non Cash Donations
2025/03/05 11:38 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:load_and_filter_data executed successfully
2025/03/05 11:38 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:display_summary_statistics executed successfully
2025/03/05 11:38 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:display_textual_insights executed successfully
2025/03/05 11:38 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 INFO:display_visualizations executed successfully
2025/03/05 11:38 INFO:display_data_page executed successfully
2025/03/05 11:38 INFO:pagesetup executed successfully
2025/03/05 11:38 INFO:Menu setup completed successfully.
2025/03/05 11:38 INFO:Data already loaded in session state.
2025/03/05 11:38 INFO:App is fully loaded and ready!
2025/03/05 11:38 INFO:Streamlit App Starting...
2025/03/05 11:38 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:38 INFO:Running App setup...
2025/03/05 11:38 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:Setting up the package
2025/03/05 11:38 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:Version: v20.145
2025/03/05 11:38 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:38 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:38 DEBUG:filenames already exists in session state
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:38 DEBUG:thresholds already exists in session state
2025/03/05 11:38 DEBUG:data_remappings already exists in session state
2025/03/05 11:38 DEBUG:filter_def already exists in session state
2025/03/05 11:38 DEBUG:security already exists in session state
2025/03/05 11:38 DEBUG:perc_target already exists in session state
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:38 DEBUG:directories already exists in session state
2025/03/05 11:38 DEBUG:reference_dir already exists in session state
2025/03/05 11:38 DEBUG:data_dir already exists in session state
2025/03/05 11:38 DEBUG:output_dir already exists in session state
2025/03/05 11:38 DEBUG:logs_dir already exists in session state
2025/03/05 11:38 DEBUG:components_dir already exists in session state
2025/03/05 11:38 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:38 DEBUG:utils_dir already exists in session state
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:38 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:38 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:38 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:38 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:38 DEBUG:original_data_fname already exists in session state
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:38 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:38 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:38 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:38 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:38 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:38 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:38 DEBUG:source_data_fname already exists in session state
2025/03/05 11:38 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:38 INFO:Session_state variables initialized
2025/03/05 11:38 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:38 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations_page at 0x000001EFD60A5090>}
2025/03/05 11:38 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:38 DEBUG:reference_dir: reference_files
2025/03/05 11:38 DEBUG:data_dir: data
2025/03/05 11:38 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:38 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:38 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:38 DEBUG:min_date: 2001-01-01
2025/03/05 11:38 DEBUG:Cash_ftr: None
2025/03/05 11:38 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:38 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:38 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:38 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:38 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:38 DEBUG:output_dir: output
2025/03/05 11:38 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:38 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:38 DEBUG:max_date: 2019-09-02
2025/03/05 11:38 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:38 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:38 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:38 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:38 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:38 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:38 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:38 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:38 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:38 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:38 DEBUG:app_pages_dir: app_pages
2025/03/05 11:38 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:38 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:38 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:38 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:38 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:38 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:38 DEBUG:components_dir: components
2025/03/05 11:38 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:38 DEBUG:utils_dir: utils
2025/03/05 11:38 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:38 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:38 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:38 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:38 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:38 DEBUG:perc_target: 0.5
2025/03/05 11:38 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:38 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:38 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:38 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:38 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:38 DEBUG:logs_dir: logs
2025/03/05 11:38 INFO:Session state Setup complete
2025/03/05 11:38 INFO:initialize_session_state executed successfully
2025/03/05 11:38 INFO:Package setup complete
2025/03/05 11:38 INFO:setup_package executed successfully
2025/03/05 11:38 INFO:Setup completed successfully.
2025/03/05 11:38 INFO:Running Menu setup...
2025/03/05 11:38 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:get_git_version executed successfully
2025/03/05 11:38 INFO:App Version: v20.166
2025/03/05 11:38 INFO:Switched to page: Public Fund Donations
2025/03/05 11:38 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:load_and_filter_data executed successfully
2025/03/05 11:38 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:display_summary_statistics executed successfully
2025/03/05 11:38 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:display_textual_insights executed successfully
2025/03/05 11:38 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:38 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:38 INFO:display_visualizations executed successfully
2025/03/05 11:38 INFO:display_data_page executed successfully
2025/03/05 11:38 INFO:pagesetup executed successfully
2025/03/05 11:38 INFO:Menu setup completed successfully.
2025/03/05 11:38 INFO:Data already loaded in session state.
2025/03/05 11:38 INFO:App is fully loaded and ready!
2025/03/05 11:39 INFO:Streamlit App Starting...
2025/03/05 11:39 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:39 INFO:Running App setup...
2025/03/05 11:39 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:Setting up the package
2025/03/05 11:39 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:Version: v20.145
2025/03/05 11:39 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:39 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:39 DEBUG:filenames already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:39 DEBUG:thresholds already exists in session state
2025/03/05 11:39 DEBUG:data_remappings already exists in session state
2025/03/05 11:39 DEBUG:filter_def already exists in session state
2025/03/05 11:39 DEBUG:security already exists in session state
2025/03/05 11:39 DEBUG:perc_target already exists in session state
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:39 DEBUG:directories already exists in session state
2025/03/05 11:39 DEBUG:reference_dir already exists in session state
2025/03/05 11:39 DEBUG:data_dir already exists in session state
2025/03/05 11:39 DEBUG:output_dir already exists in session state
2025/03/05 11:39 DEBUG:logs_dir already exists in session state
2025/03/05 11:39 DEBUG:components_dir already exists in session state
2025/03/05 11:39 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:39 DEBUG:utils_dir already exists in session state
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:39 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:39 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:39 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:39 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:39 DEBUG:original_data_fname already exists in session state
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:39 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:39 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:39 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:39 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:39 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:39 DEBUG:source_data_fname already exists in session state
2025/03/05 11:39 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:39 INFO:Session_state variables initialized
2025/03/05 11:39 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:39 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors_page at 0x000001EFD60A4CA0>}
2025/03/05 11:39 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:39 DEBUG:reference_dir: reference_files
2025/03/05 11:39 DEBUG:data_dir: data
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:39 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:39 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:39 DEBUG:min_date: 2001-01-01
2025/03/05 11:39 DEBUG:Cash_ftr: None
2025/03/05 11:39 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:39 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:39 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:39 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:39 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:39 DEBUG:output_dir: output
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:39 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:39 DEBUG:max_date: 2019-09-02
2025/03/05 11:39 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:39 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:39 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:39 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:39 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:39 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:39 DEBUG:app_pages_dir: app_pages
2025/03/05 11:39 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:39 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:39 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:39 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:39 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:components_dir: components
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:39 DEBUG:utils_dir: utils
2025/03/05 11:39 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:39 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:39 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:39 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:39 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:39 DEBUG:perc_target: 0.5
2025/03/05 11:39 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:39 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:39 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:39 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:39 DEBUG:logs_dir: logs
2025/03/05 11:39 INFO:Session state Setup complete
2025/03/05 11:39 INFO:initialize_session_state executed successfully
2025/03/05 11:39 INFO:Package setup complete
2025/03/05 11:39 INFO:setup_package executed successfully
2025/03/05 11:39 INFO:Setup completed successfully.
2025/03/05 11:39 INFO:Running Menu setup...
2025/03/05 11:39 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:App Version: v20.166
2025/03/05 11:39 INFO:Switched to page: Dubious Donors
2025/03/05 11:39 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:load_and_filter_data executed successfully
2025/03/05 11:39 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_summary_statistics executed successfully
2025/03/05 11:39 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_textual_insights executed successfully
2025/03/05 11:39 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 INFO:display_visualizations executed successfully
2025/03/05 11:39 INFO:display_data_page executed successfully
2025/03/05 11:39 INFO:pagesetup executed successfully
2025/03/05 11:39 INFO:Menu setup completed successfully.
2025/03/05 11:39 INFO:Data already loaded in session state.
2025/03/05 11:39 INFO:App is fully loaded and ready!
2025/03/05 11:39 INFO:Streamlit App Starting...
2025/03/05 11:39 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:39 INFO:Running App setup...
2025/03/05 11:39 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:Setting up the package
2025/03/05 11:39 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:Version: v20.145
2025/03/05 11:39 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:39 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:39 DEBUG:filenames already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:39 DEBUG:thresholds already exists in session state
2025/03/05 11:39 DEBUG:data_remappings already exists in session state
2025/03/05 11:39 DEBUG:filter_def already exists in session state
2025/03/05 11:39 DEBUG:security already exists in session state
2025/03/05 11:39 DEBUG:perc_target already exists in session state
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:39 DEBUG:directories already exists in session state
2025/03/05 11:39 DEBUG:reference_dir already exists in session state
2025/03/05 11:39 DEBUG:data_dir already exists in session state
2025/03/05 11:39 DEBUG:output_dir already exists in session state
2025/03/05 11:39 DEBUG:logs_dir already exists in session state
2025/03/05 11:39 DEBUG:components_dir already exists in session state
2025/03/05 11:39 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:39 DEBUG:utils_dir already exists in session state
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:39 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:39 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:39 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:39 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:39 DEBUG:original_data_fname already exists in session state
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:39 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:39 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:39 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:39 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:39 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:39 DEBUG:source_data_fname already exists in session state
2025/03/05 11:39 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:39 INFO:Session_state variables initialized
2025/03/05 11:39 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:39 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits_page at 0x000001EFD608BEB0>}
2025/03/05 11:39 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:39 DEBUG:reference_dir: reference_files
2025/03/05 11:39 DEBUG:data_dir: data
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:39 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:39 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:39 DEBUG:min_date: 2001-01-01
2025/03/05 11:39 DEBUG:Cash_ftr: None
2025/03/05 11:39 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:39 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:39 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:39 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:39 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:39 DEBUG:output_dir: output
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:39 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:39 DEBUG:max_date: 2019-09-02
2025/03/05 11:39 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:39 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:39 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:39 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:39 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:39 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:39 DEBUG:app_pages_dir: app_pages
2025/03/05 11:39 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:39 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:39 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:39 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:39 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:components_dir: components
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:39 DEBUG:utils_dir: utils
2025/03/05 11:39 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:39 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:39 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:39 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:39 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:39 DEBUG:perc_target: 0.5
2025/03/05 11:39 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:39 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:39 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:39 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:39 DEBUG:logs_dir: logs
2025/03/05 11:39 INFO:Session state Setup complete
2025/03/05 11:39 INFO:initialize_session_state executed successfully
2025/03/05 11:39 INFO:Package setup complete
2025/03/05 11:39 INFO:setup_package executed successfully
2025/03/05 11:39 INFO:Setup completed successfully.
2025/03/05 11:39 INFO:Running Menu setup...
2025/03/05 11:39 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:App Version: v20.166
2025/03/05 11:39 INFO:Switched to page: Paid Visits
2025/03/05 11:39 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:load_and_filter_data executed successfully
2025/03/05 11:39 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_summary_statistics executed successfully
2025/03/05 11:39 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_textual_insights executed successfully
2025/03/05 11:39 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 INFO:display_visualizations executed successfully
2025/03/05 11:39 INFO:display_data_page executed successfully
2025/03/05 11:39 INFO:pagesetup executed successfully
2025/03/05 11:39 INFO:Menu setup completed successfully.
2025/03/05 11:39 INFO:Data already loaded in session state.
2025/03/05 11:39 INFO:App is fully loaded and ready!
2025/03/05 11:39 INFO:Streamlit App Starting...
2025/03/05 11:39 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:39 INFO:Running App setup...
2025/03/05 11:39 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:Setting up the package
2025/03/05 11:39 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:Version: v20.145
2025/03/05 11:39 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:39 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:39 DEBUG:filenames already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:39 DEBUG:thresholds already exists in session state
2025/03/05 11:39 DEBUG:data_remappings already exists in session state
2025/03/05 11:39 DEBUG:filter_def already exists in session state
2025/03/05 11:39 DEBUG:security already exists in session state
2025/03/05 11:39 DEBUG:perc_target already exists in session state
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:39 DEBUG:directories already exists in session state
2025/03/05 11:39 DEBUG:reference_dir already exists in session state
2025/03/05 11:39 DEBUG:data_dir already exists in session state
2025/03/05 11:39 DEBUG:output_dir already exists in session state
2025/03/05 11:39 DEBUG:logs_dir already exists in session state
2025/03/05 11:39 DEBUG:components_dir already exists in session state
2025/03/05 11:39 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:39 DEBUG:utils_dir already exists in session state
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:39 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:39 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:39 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:39 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:39 DEBUG:original_data_fname already exists in session state
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:39 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:39 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:39 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:39 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:39 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:39 DEBUG:source_data_fname already exists in session state
2025/03/05 11:39 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:39 INFO:Session_state variables initialized
2025/03/05 11:39 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:39 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorship_page at 0x000001EFD60A4430>}
2025/03/05 11:39 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:39 DEBUG:reference_dir: reference_files
2025/03/05 11:39 DEBUG:data_dir: data
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:39 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:39 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:39 DEBUG:min_date: 2001-01-01
2025/03/05 11:39 DEBUG:Cash_ftr: None
2025/03/05 11:39 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:39 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:39 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:39 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:39 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:39 DEBUG:output_dir: output
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:39 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:39 DEBUG:max_date: 2019-09-02
2025/03/05 11:39 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:39 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:39 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:39 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:39 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:39 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:39 DEBUG:app_pages_dir: app_pages
2025/03/05 11:39 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:39 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:39 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:39 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:39 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:components_dir: components
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:39 DEBUG:utils_dir: utils
2025/03/05 11:39 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:39 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:39 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:39 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:39 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:39 DEBUG:perc_target: 0.5
2025/03/05 11:39 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:39 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:39 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:39 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:39 DEBUG:logs_dir: logs
2025/03/05 11:39 INFO:Session state Setup complete
2025/03/05 11:39 INFO:initialize_session_state executed successfully
2025/03/05 11:39 INFO:Package setup complete
2025/03/05 11:39 INFO:setup_package executed successfully
2025/03/05 11:39 INFO:Setup completed successfully.
2025/03/05 11:39 INFO:Running Menu setup...
2025/03/05 11:39 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:App Version: v20.166
2025/03/05 11:39 INFO:Switched to page: Sponsorships
2025/03/05 11:39 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:load_and_filter_data executed successfully
2025/03/05 11:39 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_summary_statistics executed successfully
2025/03/05 11:39 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_textual_insights executed successfully
2025/03/05 11:39 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 INFO:display_visualizations executed successfully
2025/03/05 11:39 INFO:display_data_page executed successfully
2025/03/05 11:39 INFO:pagesetup executed successfully
2025/03/05 11:39 INFO:Menu setup completed successfully.
2025/03/05 11:39 INFO:Data already loaded in session state.
2025/03/05 11:39 INFO:App is fully loaded and ready!
2025/03/05 11:39 INFO:Streamlit App Starting...
2025/03/05 11:39 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:39 INFO:Running App setup...
2025/03/05 11:39 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:Setting up the package
2025/03/05 11:39 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:Version: v20.145
2025/03/05 11:39 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:39 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:39 DEBUG:filenames already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:39 DEBUG:thresholds already exists in session state
2025/03/05 11:39 DEBUG:data_remappings already exists in session state
2025/03/05 11:39 DEBUG:filter_def already exists in session state
2025/03/05 11:39 DEBUG:security already exists in session state
2025/03/05 11:39 DEBUG:perc_target already exists in session state
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:39 DEBUG:directories already exists in session state
2025/03/05 11:39 DEBUG:reference_dir already exists in session state
2025/03/05 11:39 DEBUG:data_dir already exists in session state
2025/03/05 11:39 DEBUG:output_dir already exists in session state
2025/03/05 11:39 DEBUG:logs_dir already exists in session state
2025/03/05 11:39 DEBUG:components_dir already exists in session state
2025/03/05 11:39 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:39 DEBUG:utils_dir already exists in session state
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:39 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:39 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:39 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:39 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:39 DEBUG:original_data_fname already exists in session state
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:39 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:39 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:39 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:39 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:39 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:39 DEBUG:source_data_fname already exists in session state
2025/03/05 11:39 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:39 INFO:Session_state variables initialized
2025/03/05 11:39 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:39 DEBUG:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x000001EFD60A45E0>}
2025/03/05 11:39 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:39 DEBUG:reference_dir: reference_files
2025/03/05 11:39 DEBUG:data_dir: data
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:39 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:39 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:39 DEBUG:min_date: 2001-01-01
2025/03/05 11:39 DEBUG:Cash_ftr: None
2025/03/05 11:39 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:39 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:39 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:39 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:39 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:39 DEBUG:output_dir: output
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:39 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:39 DEBUG:max_date: 2019-09-02
2025/03/05 11:39 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:39 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:39 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:39 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:39 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:39 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:39 DEBUG:app_pages_dir: app_pages
2025/03/05 11:39 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:39 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:39 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:39 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:39 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:components_dir: components
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:39 DEBUG:utils_dir: utils
2025/03/05 11:39 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:39 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:39 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:39 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:39 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:39 DEBUG:perc_target: 0.5
2025/03/05 11:39 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:39 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:39 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:39 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:39 DEBUG:logs_dir: logs
2025/03/05 11:39 INFO:Session state Setup complete
2025/03/05 11:39 INFO:initialize_session_state executed successfully
2025/03/05 11:39 INFO:Package setup complete
2025/03/05 11:39 INFO:setup_package executed successfully
2025/03/05 11:39 INFO:Setup completed successfully.
2025/03/05 11:39 INFO:Running Menu setup...
2025/03/05 11:39 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:App Version: v20.166
2025/03/05 11:39 INFO:Switched to page: Bequeths
2025/03/05 11:39 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:load_and_filter_data executed successfully
2025/03/05 11:39 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_summary_statistics executed successfully
2025/03/05 11:39 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_textual_insights executed successfully
2025/03/05 11:39 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 INFO:display_visualizations executed successfully
2025/03/05 11:39 INFO:display_data_page executed successfully
2025/03/05 11:39 INFO:pagesetup executed successfully
2025/03/05 11:39 INFO:Menu setup completed successfully.
2025/03/05 11:39 INFO:Data already loaded in session state.
2025/03/05 11:39 INFO:App is fully loaded and ready!
2025/03/05 11:39 INFO:Streamlit App Starting...
2025/03/05 11:39 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:39 INFO:Running App setup...
2025/03/05 11:39 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:Setting up the package
2025/03/05 11:39 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:Version: v20.145
2025/03/05 11:39 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:39 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:39 DEBUG:filenames already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:39 DEBUG:thresholds already exists in session state
2025/03/05 11:39 DEBUG:data_remappings already exists in session state
2025/03/05 11:39 DEBUG:filter_def already exists in session state
2025/03/05 11:39 DEBUG:security already exists in session state
2025/03/05 11:39 DEBUG:perc_target already exists in session state
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:39 DEBUG:directories already exists in session state
2025/03/05 11:39 DEBUG:reference_dir already exists in session state
2025/03/05 11:39 DEBUG:data_dir already exists in session state
2025/03/05 11:39 DEBUG:output_dir already exists in session state
2025/03/05 11:39 DEBUG:logs_dir already exists in session state
2025/03/05 11:39 DEBUG:components_dir already exists in session state
2025/03/05 11:39 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:39 DEBUG:utils_dir already exists in session state
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:39 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:39 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:39 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:39 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:39 DEBUG:original_data_fname already exists in session state
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:39 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:39 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:39 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:39 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:39 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:39 DEBUG:source_data_fname already exists in session state
2025/03/05 11:39 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:39 INFO:Session_state variables initialized
2025/03/05 11:39 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:39 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations_page at 0x000001EFD60A5090>}
2025/03/05 11:39 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:39 DEBUG:reference_dir: reference_files
2025/03/05 11:39 DEBUG:data_dir: data
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:39 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:39 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:39 DEBUG:min_date: 2001-01-01
2025/03/05 11:39 DEBUG:Cash_ftr: None
2025/03/05 11:39 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:39 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:39 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:39 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:39 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:39 DEBUG:output_dir: output
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:39 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:39 DEBUG:max_date: 2019-09-02
2025/03/05 11:39 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:39 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:39 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:39 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:39 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:39 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:39 DEBUG:app_pages_dir: app_pages
2025/03/05 11:39 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:39 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:39 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:39 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:39 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:components_dir: components
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:39 DEBUG:utils_dir: utils
2025/03/05 11:39 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:39 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:39 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:39 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:39 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:39 DEBUG:perc_target: 0.5
2025/03/05 11:39 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:39 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:39 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:39 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:39 DEBUG:logs_dir: logs
2025/03/05 11:39 INFO:Session state Setup complete
2025/03/05 11:39 INFO:initialize_session_state executed successfully
2025/03/05 11:39 INFO:Package setup complete
2025/03/05 11:39 INFO:setup_package executed successfully
2025/03/05 11:39 INFO:Setup completed successfully.
2025/03/05 11:39 INFO:Running Menu setup...
2025/03/05 11:39 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:App Version: v20.166
2025/03/05 11:39 INFO:Switched to page: Public Fund Donations
2025/03/05 11:39 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:load_and_filter_data executed successfully
2025/03/05 11:39 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_summary_statistics executed successfully
2025/03/05 11:39 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_textual_insights executed successfully
2025/03/05 11:39 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 INFO:display_visualizations executed successfully
2025/03/05 11:39 INFO:display_data_page executed successfully
2025/03/05 11:39 INFO:pagesetup executed successfully
2025/03/05 11:39 INFO:Menu setup completed successfully.
2025/03/05 11:39 INFO:Data already loaded in session state.
2025/03/05 11:39 INFO:App is fully loaded and ready!
2025/03/05 11:39 INFO:Streamlit App Starting...
2025/03/05 11:39 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:39 INFO:Running App setup...
2025/03/05 11:39 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:Setting up the package
2025/03/05 11:39 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:Version: v20.145
2025/03/05 11:39 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:39 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:39 DEBUG:filenames already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:39 DEBUG:thresholds already exists in session state
2025/03/05 11:39 DEBUG:data_remappings already exists in session state
2025/03/05 11:39 DEBUG:filter_def already exists in session state
2025/03/05 11:39 DEBUG:security already exists in session state
2025/03/05 11:39 DEBUG:perc_target already exists in session state
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:39 DEBUG:directories already exists in session state
2025/03/05 11:39 DEBUG:reference_dir already exists in session state
2025/03/05 11:39 DEBUG:data_dir already exists in session state
2025/03/05 11:39 DEBUG:output_dir already exists in session state
2025/03/05 11:39 DEBUG:logs_dir already exists in session state
2025/03/05 11:39 DEBUG:components_dir already exists in session state
2025/03/05 11:39 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:39 DEBUG:utils_dir already exists in session state
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:39 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:39 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:39 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:39 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:39 DEBUG:original_data_fname already exists in session state
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:39 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:39 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:39 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:39 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:39 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:39 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:39 DEBUG:source_data_fname already exists in session state
2025/03/05 11:39 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:39 INFO:Session_state variables initialized
2025/03/05 11:39 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:39 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000001EFD60A4EE0>}
2025/03/05 11:39 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:39 DEBUG:reference_dir: reference_files
2025/03/05 11:39 DEBUG:data_dir: data
2025/03/05 11:39 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:39 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:39 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:39 DEBUG:min_date: 2001-01-01
2025/03/05 11:39 DEBUG:Cash_ftr: None
2025/03/05 11:39 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:39 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:39 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:39 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:39 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:39 DEBUG:output_dir: output
2025/03/05 11:39 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:39 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:39 DEBUG:max_date: 2019-09-02
2025/03/05 11:39 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:39 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:39 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:39 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:39 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:39 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:39 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:39 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:39 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:39 DEBUG:app_pages_dir: app_pages
2025/03/05 11:39 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:39 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:39 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:39 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:39 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:39 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:39 DEBUG:components_dir: components
2025/03/05 11:39 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:39 DEBUG:utils_dir: utils
2025/03/05 11:39 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:39 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:39 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:39 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:39 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:39 DEBUG:perc_target: 0.5
2025/03/05 11:39 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:39 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:39 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:39 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:39 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:39 DEBUG:logs_dir: logs
2025/03/05 11:39 INFO:Session state Setup complete
2025/03/05 11:39 INFO:initialize_session_state executed successfully
2025/03/05 11:39 INFO:Package setup complete
2025/03/05 11:39 INFO:setup_package executed successfully
2025/03/05 11:39 INFO:Setup completed successfully.
2025/03/05 11:39 INFO:Running Menu setup...
2025/03/05 11:39 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:get_git_version executed successfully
2025/03/05 11:39 INFO:App Version: v20.166
2025/03/05 11:39 INFO:Switched to page: Non Cash Donations
2025/03/05 11:39 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:load_and_filter_data executed successfully
2025/03/05 11:39 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_summary_statistics executed successfully
2025/03/05 11:39 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:display_textual_insights executed successfully
2025/03/05 11:39 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:39 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:39 INFO:display_visualizations executed successfully
2025/03/05 11:39 INFO:display_data_page executed successfully
2025/03/05 11:39 INFO:pagesetup executed successfully
2025/03/05 11:39 INFO:Menu setup completed successfully.
2025/03/05 11:39 INFO:Data already loaded in session state.
2025/03/05 11:39 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations_page at 0x000001EFD60A5090>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Public Fund Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x000001EFD60A45E0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Bequeths
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations_page at 0x000001EFD60A5090>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Public Fund Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000001EFD60A4EE0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Non Cash Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations_page at 0x000001EFD60A5090>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Public Fund Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x000001EFD60A45E0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Bequeths
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000001EFD60A4EE0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Non Cash Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations_page at 0x000001EFD60A4D30>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Cash Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000001EFD60A4EE0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Non Cash Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations_page at 0x000001EFD60A4D30>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Cash Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000001EFD60A4EE0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Non Cash Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations_page at 0x000001EFD60A4D30>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Cash Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000001EFD60A4EE0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Non Cash Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations_page at 0x000001EFD60A5090>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Public Fund Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x000001EFD60A45E0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Bequeths
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Corporate Donations', 'function': <function mod_corporate_donations_page at 0x000001EFD60A4670>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Corporate Donations
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Sponsorships', 'function': <function mod_sponsorship_page at 0x000001EFD60A4430>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Sponsorships
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:40 INFO:Streamlit App Starting...
2025/03/05 11:40 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:40 INFO:Running App setup...
2025/03/05 11:40 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:Setting up the package
2025/03/05 11:40 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:Version: v20.145
2025/03/05 11:40 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:40 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:40 DEBUG:filenames already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:40 DEBUG:thresholds already exists in session state
2025/03/05 11:40 DEBUG:data_remappings already exists in session state
2025/03/05 11:40 DEBUG:filter_def already exists in session state
2025/03/05 11:40 DEBUG:security already exists in session state
2025/03/05 11:40 DEBUG:perc_target already exists in session state
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:40 DEBUG:directories already exists in session state
2025/03/05 11:40 DEBUG:reference_dir already exists in session state
2025/03/05 11:40 DEBUG:data_dir already exists in session state
2025/03/05 11:40 DEBUG:output_dir already exists in session state
2025/03/05 11:40 DEBUG:logs_dir already exists in session state
2025/03/05 11:40 DEBUG:components_dir already exists in session state
2025/03/05 11:40 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:40 DEBUG:utils_dir already exists in session state
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:40 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:40 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:40 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:40 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:40 DEBUG:original_data_fname already exists in session state
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:40 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:40 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:40 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:40 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:40 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:40 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:40 DEBUG:source_data_fname already exists in session state
2025/03/05 11:40 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:40 INFO:Session_state variables initialized
2025/03/05 11:40 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:40 DEBUG:menu_selection: {'title': 'Paid Visits', 'function': <function mod_visits_page at 0x000001EFD608BEB0>}
2025/03/05 11:40 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:40 DEBUG:reference_dir: reference_files
2025/03/05 11:40 DEBUG:data_dir: data
2025/03/05 11:40 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:40 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:40 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:40 DEBUG:min_date: 2001-01-01
2025/03/05 11:40 DEBUG:Cash_ftr: None
2025/03/05 11:40 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:40 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:40 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:40 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:40 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:40 DEBUG:output_dir: output
2025/03/05 11:40 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:40 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:40 DEBUG:max_date: 2019-09-02
2025/03/05 11:40 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:40 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:40 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:40 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:40 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:40 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:40 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:40 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:40 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:40 DEBUG:app_pages_dir: app_pages
2025/03/05 11:40 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:40 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:40 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:40 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:40 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:40 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:40 DEBUG:components_dir: components
2025/03/05 11:40 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:40 DEBUG:utils_dir: utils
2025/03/05 11:40 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:40 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:40 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:40 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:40 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:40 DEBUG:perc_target: 0.5
2025/03/05 11:40 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:40 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:40 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:40 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:40 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:40 DEBUG:logs_dir: logs
2025/03/05 11:40 INFO:Session state Setup complete
2025/03/05 11:40 INFO:initialize_session_state executed successfully
2025/03/05 11:40 INFO:Package setup complete
2025/03/05 11:40 INFO:setup_package executed successfully
2025/03/05 11:40 INFO:Setup completed successfully.
2025/03/05 11:40 INFO:Running Menu setup...
2025/03/05 11:40 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:get_git_version executed successfully
2025/03/05 11:40 INFO:App Version: v20.166
2025/03/05 11:40 INFO:Switched to page: Paid Visits
2025/03/05 11:40 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:load_and_filter_data executed successfully
2025/03/05 11:40 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_summary_statistics executed successfully
2025/03/05 11:40 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:display_textual_insights executed successfully
2025/03/05 11:40 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:40 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:40 INFO:display_visualizations executed successfully
2025/03/05 11:40 INFO:display_data_page executed successfully
2025/03/05 11:40 INFO:pagesetup executed successfully
2025/03/05 11:40 INFO:Menu setup completed successfully.
2025/03/05 11:40 INFO:Data already loaded in session state.
2025/03/05 11:40 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors_page at 0x000001EFD60A4CA0>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Dubious Donors
2025/03/05 11:42 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_data executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Dubious Donations', 'function': <function mod_dubious_donations_page at 0x000001EFD60A4820>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Dubious Donations
2025/03/05 11:42 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_data executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Cash Donations per Entity', 'function': <function mod_cash_donations_per_entity_page at 0x000001EFD60A4E50>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Cash Donations per Entity
2025/03/05 11:42 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_per_group_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Non Cash Donations per Entity', 'function': <function mod_non_cash_donations_per_entity_page at 0x000001EFD60A5000>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Non Cash Donations per Entity
2025/03/05 11:42 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_per_group_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Public Fund Donations per Entity', 'function': <function mod_publicfund_donations_per_entity_page at 0x000001EFD60A51B0>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Public Fund Donations per Entity
2025/03/05 11:42 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_per_group_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Corporate Donations per Entity', 'function': <function mod_corporate_donations_per_entity_page at 0x000001EFD60A49D0>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Corporate Donations per Entity
2025/03/05 11:42 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_per_group_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Sponsorship per Entity ', 'function': <function mod_sponsorships_per_entity_page at 0x000001EFD60A44C0>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Sponsorship per Entity 
2025/03/05 11:42 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_per_group_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Paid Visits per Entity', 'function': <function mod_visits_per_regulated_entity at 0x000001EFD60A43A0>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Paid Visits per Entity
2025/03/05 11:42 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_per_group_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Donors per Regulated Entity', 'function': <function mod_regulated_donor_per_entity_page at 0x000001EFD60A4AF0>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Donors per Regulated Entity
2025/03/05 11:42 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_per_group_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:42 INFO:Streamlit App Starting...
2025/03/05 11:42 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:42 INFO:Running App setup...
2025/03/05 11:42 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:Setting up the package
2025/03/05 11:42 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:Version: v20.145
2025/03/05 11:42 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:42 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:42 DEBUG:filenames already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:42 DEBUG:thresholds already exists in session state
2025/03/05 11:42 DEBUG:data_remappings already exists in session state
2025/03/05 11:42 DEBUG:filter_def already exists in session state
2025/03/05 11:42 DEBUG:security already exists in session state
2025/03/05 11:42 DEBUG:perc_target already exists in session state
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:42 DEBUG:directories already exists in session state
2025/03/05 11:42 DEBUG:reference_dir already exists in session state
2025/03/05 11:42 DEBUG:data_dir already exists in session state
2025/03/05 11:42 DEBUG:output_dir already exists in session state
2025/03/05 11:42 DEBUG:logs_dir already exists in session state
2025/03/05 11:42 DEBUG:components_dir already exists in session state
2025/03/05 11:42 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:42 DEBUG:utils_dir already exists in session state
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:42 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:42 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:42 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:42 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:42 DEBUG:original_data_fname already exists in session state
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:42 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:42 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:42 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:42 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:42 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:42 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:42 DEBUG:source_data_fname already exists in session state
2025/03/05 11:42 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:42 INFO:Session_state variables initialized
2025/03/05 11:42 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:42 DEBUG:menu_selection: {'title': 'Dubious Donors per Regulated Entity', 'function': <function mod_dubious_donors_per_entity_page at 0x000001EFD60A4C10>}
2025/03/05 11:42 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:42 DEBUG:reference_dir: reference_files
2025/03/05 11:42 DEBUG:data_dir: data
2025/03/05 11:42 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:42 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:42 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:42 DEBUG:min_date: 2001-01-01
2025/03/05 11:42 DEBUG:Cash_ftr: None
2025/03/05 11:42 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:42 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:42 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:42 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:42 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:42 DEBUG:output_dir: output
2025/03/05 11:42 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:42 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:42 DEBUG:max_date: 2019-09-02
2025/03/05 11:42 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:42 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:42 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:42 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:42 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:42 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:42 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:42 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:42 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:42 DEBUG:app_pages_dir: app_pages
2025/03/05 11:42 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:42 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:42 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:42 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:42 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:42 DEBUG:components_dir: components
2025/03/05 11:42 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:42 DEBUG:utils_dir: utils
2025/03/05 11:42 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:42 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:42 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:42 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:42 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:42 DEBUG:perc_target: 0.5
2025/03/05 11:42 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:42 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:42 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:42 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:42 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:42 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:42 DEBUG:logs_dir: logs
2025/03/05 11:42 INFO:Session state Setup complete
2025/03/05 11:42 INFO:initialize_session_state executed successfully
2025/03/05 11:42 INFO:Package setup complete
2025/03/05 11:42 INFO:setup_package executed successfully
2025/03/05 11:42 INFO:Setup completed successfully.
2025/03/05 11:42 INFO:Running Menu setup...
2025/03/05 11:42 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:get_git_version executed successfully
2025/03/05 11:42 INFO:App Version: v20.166
2025/03/05 11:42 INFO:Switched to page: Dubious Donors per Regulated Entity
2025/03/05 11:42 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:42 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_summary_statistics executed successfully
2025/03/05 11:42 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:display_textual_insights executed successfully
2025/03/05 11:42 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:42 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:42 INFO:display_visualizations executed successfully
2025/03/05 11:42 INFO:display_per_group_data_page executed successfully
2025/03/05 11:42 INFO:pagesetup executed successfully
2025/03/05 11:42 INFO:Menu setup completed successfully.
2025/03/05 11:42 INFO:Data already loaded in session state.
2025/03/05 11:42 INFO:App is fully loaded and ready!
2025/03/05 11:43 INFO:Streamlit App Starting...
2025/03/05 11:43 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:43 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:43 INFO:Running App setup...
2025/03/05 11:43 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:Setting up the package
2025/03/05 11:43 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:43 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:get_git_version executed successfully
2025/03/05 11:43 INFO:Version: v20.145
2025/03/05 11:43 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:43 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:43 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:43 DEBUG:filenames already exists in session state
2025/03/05 11:43 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:43 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:43 DEBUG:thresholds already exists in session state
2025/03/05 11:43 DEBUG:data_remappings already exists in session state
2025/03/05 11:43 DEBUG:filter_def already exists in session state
2025/03/05 11:43 DEBUG:security already exists in session state
2025/03/05 11:43 DEBUG:perc_target already exists in session state
2025/03/05 11:43 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:43 DEBUG:directories already exists in session state
2025/03/05 11:43 DEBUG:reference_dir already exists in session state
2025/03/05 11:43 DEBUG:data_dir already exists in session state
2025/03/05 11:43 DEBUG:output_dir already exists in session state
2025/03/05 11:43 DEBUG:logs_dir already exists in session state
2025/03/05 11:43 DEBUG:components_dir already exists in session state
2025/03/05 11:43 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:43 DEBUG:utils_dir already exists in session state
2025/03/05 11:43 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:43 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:43 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:43 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:43 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:43 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:43 DEBUG:original_data_fname already exists in session state
2025/03/05 11:43 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:43 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:43 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:43 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:43 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:43 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:43 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:43 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:43 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:43 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:43 DEBUG:source_data_fname already exists in session state
2025/03/05 11:43 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:43 INFO:Session_state variables initialized
2025/03/05 11:43 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:43 DEBUG:menu_selection: {'title': 'Dubious Donations per Regulated Entity', 'function': <function mod_dubious_donations_per_entity_page at 0x000001EFD60A48B0>}
2025/03/05 11:43 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:43 DEBUG:reference_dir: reference_files
2025/03/05 11:43 DEBUG:data_dir: data
2025/03/05 11:43 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:43 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:43 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:43 DEBUG:min_date: 2001-01-01
2025/03/05 11:43 DEBUG:Cash_ftr: None
2025/03/05 11:43 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:43 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:43 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:43 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:43 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:43 DEBUG:output_dir: output
2025/03/05 11:43 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:43 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:43 DEBUG:max_date: 2019-09-02
2025/03/05 11:43 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:43 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:43 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:43 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:43 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:43 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:43 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:43 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:43 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:43 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:43 DEBUG:app_pages_dir: app_pages
2025/03/05 11:43 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:43 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:43 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:43 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:43 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:43 DEBUG:components_dir: components
2025/03/05 11:43 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:43 DEBUG:utils_dir: utils
2025/03/05 11:43 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:43 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:43 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:43 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:43 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:43 DEBUG:perc_target: 0.5
2025/03/05 11:43 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:43 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:43 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:43 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:43 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:43 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:43 DEBUG:logs_dir: logs
2025/03/05 11:43 INFO:Session state Setup complete
2025/03/05 11:43 INFO:initialize_session_state executed successfully
2025/03/05 11:43 INFO:Package setup complete
2025/03/05 11:43 INFO:setup_package executed successfully
2025/03/05 11:43 INFO:Setup completed successfully.
2025/03/05 11:43 INFO:Running Menu setup...
2025/03/05 11:43 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:43 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:get_git_version executed successfully
2025/03/05 11:43 INFO:App Version: v20.166
2025/03/05 11:43 INFO:Switched to page: Dubious Donations per Regulated Entity
2025/03/05 11:43 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:43 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:43 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:display_summary_statistics executed successfully
2025/03/05 11:43 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:display_textual_insights executed successfully
2025/03/05 11:43 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:43 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:43 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:43 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:43 INFO:display_visualizations executed successfully
2025/03/05 11:43 INFO:display_per_group_data_page executed successfully
2025/03/05 11:43 INFO:pagesetup executed successfully
2025/03/05 11:43 INFO:Menu setup completed successfully.
2025/03/05 11:43 INFO:Data already loaded in session state.
2025/03/05 11:43 INFO:App is fully loaded and ready!
2025/03/05 11:44 INFO:Streamlit App Starting...
2025/03/05 11:44 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:44 INFO:Running App setup...
2025/03/05 11:44 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:Setting up the package
2025/03/05 11:44 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:Version: v20.145
2025/03/05 11:44 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:44 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:44 DEBUG:filenames already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:44 DEBUG:thresholds already exists in session state
2025/03/05 11:44 DEBUG:data_remappings already exists in session state
2025/03/05 11:44 DEBUG:filter_def already exists in session state
2025/03/05 11:44 DEBUG:security already exists in session state
2025/03/05 11:44 DEBUG:perc_target already exists in session state
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:44 DEBUG:directories already exists in session state
2025/03/05 11:44 DEBUG:reference_dir already exists in session state
2025/03/05 11:44 DEBUG:data_dir already exists in session state
2025/03/05 11:44 DEBUG:output_dir already exists in session state
2025/03/05 11:44 DEBUG:logs_dir already exists in session state
2025/03/05 11:44 DEBUG:components_dir already exists in session state
2025/03/05 11:44 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:44 DEBUG:utils_dir already exists in session state
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:44 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:44 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:44 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:44 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:44 DEBUG:original_data_fname already exists in session state
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:44 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:44 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:44 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:44 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:44 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:44 DEBUG:source_data_fname already exists in session state
2025/03/05 11:44 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:44 INFO:Session_state variables initialized
2025/03/05 11:44 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:44 DEBUG:menu_selection: {'title': 'Dubious Donors per Regulated Entity', 'function': <function mod_dubious_donors_per_entity_page at 0x000001EFD60A4C10>}
2025/03/05 11:44 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:44 DEBUG:reference_dir: reference_files
2025/03/05 11:44 DEBUG:data_dir: data
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:44 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:44 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:44 DEBUG:min_date: 2001-01-01
2025/03/05 11:44 DEBUG:Cash_ftr: None
2025/03/05 11:44 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:44 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:44 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:44 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:44 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:44 DEBUG:output_dir: output
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:44 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:44 DEBUG:max_date: 2019-09-02
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:44 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:44 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:44 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:44 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:44 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:44 DEBUG:app_pages_dir: app_pages
2025/03/05 11:44 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:44 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:44 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:44 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:44 DEBUG:components_dir: components
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:44 DEBUG:utils_dir: utils
2025/03/05 11:44 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:44 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:44 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:44 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:44 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:44 DEBUG:perc_target: 0.5
2025/03/05 11:44 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:44 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:44 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:44 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:44 DEBUG:logs_dir: logs
2025/03/05 11:44 INFO:Session state Setup complete
2025/03/05 11:44 INFO:initialize_session_state executed successfully
2025/03/05 11:44 INFO:Package setup complete
2025/03/05 11:44 INFO:setup_package executed successfully
2025/03/05 11:44 INFO:Setup completed successfully.
2025/03/05 11:44 INFO:Running Menu setup...
2025/03/05 11:44 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:App Version: v20.166
2025/03/05 11:44 INFO:Switched to page: Dubious Donors per Regulated Entity
2025/03/05 11:44 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:44 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_summary_statistics executed successfully
2025/03/05 11:44 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_textual_insights executed successfully
2025/03/05 11:44 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 INFO:display_visualizations executed successfully
2025/03/05 11:44 INFO:display_per_group_data_page executed successfully
2025/03/05 11:44 INFO:pagesetup executed successfully
2025/03/05 11:44 INFO:Menu setup completed successfully.
2025/03/05 11:44 INFO:Data already loaded in session state.
2025/03/05 11:44 INFO:App is fully loaded and ready!
2025/03/05 11:44 INFO:Streamlit App Starting...
2025/03/05 11:44 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:44 INFO:Running App setup...
2025/03/05 11:44 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:Setting up the package
2025/03/05 11:44 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:Version: v20.145
2025/03/05 11:44 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:44 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:44 DEBUG:filenames already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:44 DEBUG:thresholds already exists in session state
2025/03/05 11:44 DEBUG:data_remappings already exists in session state
2025/03/05 11:44 DEBUG:filter_def already exists in session state
2025/03/05 11:44 DEBUG:security already exists in session state
2025/03/05 11:44 DEBUG:perc_target already exists in session state
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:44 DEBUG:directories already exists in session state
2025/03/05 11:44 DEBUG:reference_dir already exists in session state
2025/03/05 11:44 DEBUG:data_dir already exists in session state
2025/03/05 11:44 DEBUG:output_dir already exists in session state
2025/03/05 11:44 DEBUG:logs_dir already exists in session state
2025/03/05 11:44 DEBUG:components_dir already exists in session state
2025/03/05 11:44 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:44 DEBUG:utils_dir already exists in session state
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:44 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:44 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:44 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:44 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:44 DEBUG:original_data_fname already exists in session state
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:44 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:44 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:44 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:44 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:44 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:44 DEBUG:source_data_fname already exists in session state
2025/03/05 11:44 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:44 INFO:Session_state variables initialized
2025/03/05 11:44 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:44 DEBUG:menu_selection: {'title': 'Dubious Donations per Regulated Entity', 'function': <function mod_dubious_donations_per_entity_page at 0x000001EFD60A48B0>}
2025/03/05 11:44 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:44 DEBUG:reference_dir: reference_files
2025/03/05 11:44 DEBUG:data_dir: data
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:44 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:44 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:44 DEBUG:min_date: 2001-01-01
2025/03/05 11:44 DEBUG:Cash_ftr: None
2025/03/05 11:44 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:44 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:44 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:44 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:44 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:44 DEBUG:output_dir: output
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:44 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:44 DEBUG:max_date: 2019-09-02
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:44 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:44 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:44 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:44 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:44 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:44 DEBUG:app_pages_dir: app_pages
2025/03/05 11:44 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:44 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:44 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:44 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:44 DEBUG:components_dir: components
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:44 DEBUG:utils_dir: utils
2025/03/05 11:44 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:44 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:44 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:44 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:44 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:44 DEBUG:perc_target: 0.5
2025/03/05 11:44 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:44 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:44 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:44 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:44 DEBUG:logs_dir: logs
2025/03/05 11:44 INFO:Session state Setup complete
2025/03/05 11:44 INFO:initialize_session_state executed successfully
2025/03/05 11:44 INFO:Package setup complete
2025/03/05 11:44 INFO:setup_package executed successfully
2025/03/05 11:44 INFO:Setup completed successfully.
2025/03/05 11:44 INFO:Running Menu setup...
2025/03/05 11:44 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:App Version: v20.166
2025/03/05 11:44 INFO:Switched to page: Dubious Donations per Regulated Entity
2025/03/05 11:44 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:44 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_summary_statistics executed successfully
2025/03/05 11:44 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_textual_insights executed successfully
2025/03/05 11:44 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 INFO:display_visualizations executed successfully
2025/03/05 11:44 INFO:display_per_group_data_page executed successfully
2025/03/05 11:44 INFO:pagesetup executed successfully
2025/03/05 11:44 INFO:Menu setup completed successfully.
2025/03/05 11:44 INFO:Data already loaded in session state.
2025/03/05 11:44 INFO:App is fully loaded and ready!
2025/03/05 11:44 INFO:Streamlit App Starting...
2025/03/05 11:44 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:44 INFO:Running App setup...
2025/03/05 11:44 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:Setting up the package
2025/03/05 11:44 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:Version: v20.145
2025/03/05 11:44 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:44 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:44 DEBUG:filenames already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:44 DEBUG:thresholds already exists in session state
2025/03/05 11:44 DEBUG:data_remappings already exists in session state
2025/03/05 11:44 DEBUG:filter_def already exists in session state
2025/03/05 11:44 DEBUG:security already exists in session state
2025/03/05 11:44 DEBUG:perc_target already exists in session state
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:44 DEBUG:directories already exists in session state
2025/03/05 11:44 DEBUG:reference_dir already exists in session state
2025/03/05 11:44 DEBUG:data_dir already exists in session state
2025/03/05 11:44 DEBUG:output_dir already exists in session state
2025/03/05 11:44 DEBUG:logs_dir already exists in session state
2025/03/05 11:44 DEBUG:components_dir already exists in session state
2025/03/05 11:44 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:44 DEBUG:utils_dir already exists in session state
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:44 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:44 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:44 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:44 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:44 DEBUG:original_data_fname already exists in session state
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:44 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:44 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:44 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:44 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:44 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:44 DEBUG:source_data_fname already exists in session state
2025/03/05 11:44 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:44 INFO:Session_state variables initialized
2025/03/05 11:44 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:44 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001EFD608BA30>}
2025/03/05 11:44 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:44 DEBUG:reference_dir: reference_files
2025/03/05 11:44 DEBUG:data_dir: data
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:44 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:44 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:44 DEBUG:min_date: 2001-01-01
2025/03/05 11:44 DEBUG:Cash_ftr: None
2025/03/05 11:44 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:44 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:44 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:44 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:44 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:44 DEBUG:output_dir: output
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:44 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:44 DEBUG:max_date: 2019-09-02
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:44 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:44 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:44 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:44 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:44 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:44 DEBUG:app_pages_dir: app_pages
2025/03/05 11:44 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:44 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:44 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:44 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:44 DEBUG:components_dir: components
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:44 DEBUG:utils_dir: utils
2025/03/05 11:44 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:44 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:44 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:44 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:44 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:44 DEBUG:perc_target: 0.5
2025/03/05 11:44 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:44 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:44 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:44 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:44 DEBUG:logs_dir: logs
2025/03/05 11:44 INFO:Session state Setup complete
2025/03/05 11:44 INFO:initialize_session_state executed successfully
2025/03/05 11:44 INFO:Package setup complete
2025/03/05 11:44 INFO:setup_package executed successfully
2025/03/05 11:44 INFO:Setup completed successfully.
2025/03/05 11:44 INFO:Running Menu setup...
2025/03/05 11:44 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:App Version: v20.166
2025/03/05 11:44 INFO:Switched to page: Head Line Figures
2025/03/05 11:44 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:load_and_filter_data executed successfully
2025/03/05 11:44 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_summary_statistics executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 INFO:hlf_body executed successfully
2025/03/05 11:44 INFO:pagesetup executed successfully
2025/03/05 11:44 INFO:Menu setup completed successfully.
2025/03/05 11:44 INFO:Data already loaded in session state.
2025/03/05 11:44 INFO:App is fully loaded and ready!
2025/03/05 11:44 INFO:Streamlit App Starting...
2025/03/05 11:44 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:44 INFO:Running App setup...
2025/03/05 11:44 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:Setting up the package
2025/03/05 11:44 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:Version: v20.145
2025/03/05 11:44 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:44 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:44 DEBUG:filenames already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:44 DEBUG:thresholds already exists in session state
2025/03/05 11:44 DEBUG:data_remappings already exists in session state
2025/03/05 11:44 DEBUG:filter_def already exists in session state
2025/03/05 11:44 DEBUG:security already exists in session state
2025/03/05 11:44 DEBUG:perc_target already exists in session state
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:44 DEBUG:directories already exists in session state
2025/03/05 11:44 DEBUG:reference_dir already exists in session state
2025/03/05 11:44 DEBUG:data_dir already exists in session state
2025/03/05 11:44 DEBUG:output_dir already exists in session state
2025/03/05 11:44 DEBUG:logs_dir already exists in session state
2025/03/05 11:44 DEBUG:components_dir already exists in session state
2025/03/05 11:44 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:44 DEBUG:utils_dir already exists in session state
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:44 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:44 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:44 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:44 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:44 DEBUG:original_data_fname already exists in session state
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:44 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:44 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:44 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:44 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:44 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:44 DEBUG:source_data_fname already exists in session state
2025/03/05 11:44 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:44 INFO:Session_state variables initialized
2025/03/05 11:44 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:44 DEBUG:menu_selection: {'title': 'Dubious Donations per Regulated Entity', 'function': <function mod_dubious_donations_per_entity_page at 0x000001EFD60A48B0>}
2025/03/05 11:44 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:44 DEBUG:reference_dir: reference_files
2025/03/05 11:44 DEBUG:data_dir: data
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:44 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:44 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:44 DEBUG:min_date: 2001-01-01
2025/03/05 11:44 DEBUG:year_slider_dons_by_year_n_type: (2001, 2019)
2025/03/05 11:44 DEBUG:Cash_ftr: None
2025/03/05 11:44 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:44 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:44 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:44 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:44 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:44 DEBUG:output_dir: output
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:44 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:44 DEBUG:max_date: 2019-09-02
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:44 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:44 DEBUG:year_slider_value_by_year_n_entity: (2001, 2019)
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:44 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:44 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:44 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:44 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:44 DEBUG:app_pages_dir: app_pages
2025/03/05 11:44 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:44 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:44 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:44 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:44 DEBUG:components_dir: components
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:44 DEBUG:utils_dir: utils
2025/03/05 11:44 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:44 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:44 DEBUG:year_slider_dons_by_year_n_entity: (2001, 2019)
2025/03/05 11:44 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:44 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:44 DEBUG:year_slider_value_by_year_n_type: (2001, 2019)
2025/03/05 11:44 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:44 DEBUG:perc_target: 0.5
2025/03/05 11:44 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:44 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:44 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:44 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:44 DEBUG:logs_dir: logs
2025/03/05 11:44 INFO:Session state Setup complete
2025/03/05 11:44 INFO:initialize_session_state executed successfully
2025/03/05 11:44 INFO:Package setup complete
2025/03/05 11:44 INFO:setup_package executed successfully
2025/03/05 11:44 INFO:Setup completed successfully.
2025/03/05 11:44 INFO:Running Menu setup...
2025/03/05 11:44 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:App Version: v20.166
2025/03/05 11:44 INFO:Switched to page: Dubious Donations per Regulated Entity
2025/03/05 11:44 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:44 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_summary_statistics executed successfully
2025/03/05 11:44 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_textual_insights executed successfully
2025/03/05 11:44 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 INFO:display_visualizations executed successfully
2025/03/05 11:44 INFO:display_per_group_data_page executed successfully
2025/03/05 11:44 INFO:pagesetup executed successfully
2025/03/05 11:44 INFO:Menu setup completed successfully.
2025/03/05 11:44 INFO:Data already loaded in session state.
2025/03/05 11:44 INFO:App is fully loaded and ready!
2025/03/05 11:44 INFO:Streamlit App Starting...
2025/03/05 11:44 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:44 INFO:Running App setup...
2025/03/05 11:44 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:Setting up the package
2025/03/05 11:44 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:Version: v20.145
2025/03/05 11:44 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:44 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:44 DEBUG:filenames already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:44 DEBUG:thresholds already exists in session state
2025/03/05 11:44 DEBUG:data_remappings already exists in session state
2025/03/05 11:44 DEBUG:filter_def already exists in session state
2025/03/05 11:44 DEBUG:security already exists in session state
2025/03/05 11:44 DEBUG:perc_target already exists in session state
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:44 DEBUG:directories already exists in session state
2025/03/05 11:44 DEBUG:reference_dir already exists in session state
2025/03/05 11:44 DEBUG:data_dir already exists in session state
2025/03/05 11:44 DEBUG:output_dir already exists in session state
2025/03/05 11:44 DEBUG:logs_dir already exists in session state
2025/03/05 11:44 DEBUG:components_dir already exists in session state
2025/03/05 11:44 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:44 DEBUG:utils_dir already exists in session state
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:44 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:44 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:44 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:44 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:44 DEBUG:original_data_fname already exists in session state
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:44 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:44 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:44 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:44 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:44 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:44 DEBUG:source_data_fname already exists in session state
2025/03/05 11:44 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:44 INFO:Session_state variables initialized
2025/03/05 11:44 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:44 DEBUG:menu_selection: {'title': 'Cash Donations per Donor', 'function': <function mod_cash_donations_per_donor_page at 0x000001EFD60A4DC0>}
2025/03/05 11:44 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:44 DEBUG:reference_dir: reference_files
2025/03/05 11:44 DEBUG:data_dir: data
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:44 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:44 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:44 DEBUG:min_date: 2001-01-01
2025/03/05 11:44 DEBUG:Cash_ftr: None
2025/03/05 11:44 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:44 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:44 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:44 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:44 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:44 DEBUG:output_dir: output
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:44 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:44 DEBUG:max_date: 2019-09-02
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:44 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:44 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:44 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:44 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:44 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:44 DEBUG:app_pages_dir: app_pages
2025/03/05 11:44 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:44 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:44 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:44 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:44 DEBUG:components_dir: components
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:44 DEBUG:utils_dir: utils
2025/03/05 11:44 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:44 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:44 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:44 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:44 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:44 DEBUG:perc_target: 0.5
2025/03/05 11:44 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:44 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:44 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:44 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:44 DEBUG:logs_dir: logs
2025/03/05 11:44 INFO:Session state Setup complete
2025/03/05 11:44 INFO:initialize_session_state executed successfully
2025/03/05 11:44 INFO:Package setup complete
2025/03/05 11:44 INFO:setup_package executed successfully
2025/03/05 11:44 INFO:Setup completed successfully.
2025/03/05 11:44 INFO:Running Menu setup...
2025/03/05 11:44 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:App Version: v20.166
2025/03/05 11:44 INFO:Switched to page: Cash Donations per Donor
2025/03/05 11:44 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:44 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_summary_statistics executed successfully
2025/03/05 11:44 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_textual_insights executed successfully
2025/03/05 11:44 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 INFO:display_visualizations executed successfully
2025/03/05 11:44 INFO:display_per_group_data_page executed successfully
2025/03/05 11:44 INFO:pagesetup executed successfully
2025/03/05 11:44 INFO:Menu setup completed successfully.
2025/03/05 11:44 INFO:Data already loaded in session state.
2025/03/05 11:44 INFO:App is fully loaded and ready!
2025/03/05 11:44 INFO:Streamlit App Starting...
2025/03/05 11:44 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:44 INFO:Running App setup...
2025/03/05 11:44 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:Setting up the package
2025/03/05 11:44 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:Version: v20.145
2025/03/05 11:44 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:44 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:44 DEBUG:filenames already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:44 DEBUG:thresholds already exists in session state
2025/03/05 11:44 DEBUG:data_remappings already exists in session state
2025/03/05 11:44 DEBUG:filter_def already exists in session state
2025/03/05 11:44 DEBUG:security already exists in session state
2025/03/05 11:44 DEBUG:perc_target already exists in session state
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:44 DEBUG:directories already exists in session state
2025/03/05 11:44 DEBUG:reference_dir already exists in session state
2025/03/05 11:44 DEBUG:data_dir already exists in session state
2025/03/05 11:44 DEBUG:output_dir already exists in session state
2025/03/05 11:44 DEBUG:logs_dir already exists in session state
2025/03/05 11:44 DEBUG:components_dir already exists in session state
2025/03/05 11:44 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:44 DEBUG:utils_dir already exists in session state
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:44 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:44 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:44 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:44 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:44 DEBUG:original_data_fname already exists in session state
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:44 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:44 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:44 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:44 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:44 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:44 DEBUG:source_data_fname already exists in session state
2025/03/05 11:44 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:44 INFO:Session_state variables initialized
2025/03/05 11:44 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:44 DEBUG:menu_selection: {'title': 'Non Cash Donations per Donor', 'function': <function mod_non_cash_donations_per_donor_page at 0x000001EFD60A4F70>}
2025/03/05 11:44 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:44 DEBUG:reference_dir: reference_files
2025/03/05 11:44 DEBUG:data_dir: data
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:44 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:44 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:44 DEBUG:min_date: 2001-01-01
2025/03/05 11:44 DEBUG:Cash_ftr: None
2025/03/05 11:44 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:44 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:44 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:44 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:44 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:44 DEBUG:output_dir: output
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:44 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:44 DEBUG:max_date: 2019-09-02
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:44 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:44 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:44 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:44 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:44 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:44 DEBUG:app_pages_dir: app_pages
2025/03/05 11:44 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:44 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:44 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:44 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:44 DEBUG:components_dir: components
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:44 DEBUG:utils_dir: utils
2025/03/05 11:44 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:44 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:44 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:44 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:44 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:44 DEBUG:perc_target: 0.5
2025/03/05 11:44 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:44 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:44 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:44 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:44 DEBUG:logs_dir: logs
2025/03/05 11:44 INFO:Session state Setup complete
2025/03/05 11:44 INFO:initialize_session_state executed successfully
2025/03/05 11:44 INFO:Package setup complete
2025/03/05 11:44 INFO:setup_package executed successfully
2025/03/05 11:44 INFO:Setup completed successfully.
2025/03/05 11:44 INFO:Running Menu setup...
2025/03/05 11:44 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:App Version: v20.166
2025/03/05 11:44 INFO:Switched to page: Non Cash Donations per Donor
2025/03/05 11:44 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:44 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_summary_statistics executed successfully
2025/03/05 11:44 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_textual_insights executed successfully
2025/03/05 11:44 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 INFO:display_visualizations executed successfully
2025/03/05 11:44 INFO:display_per_group_data_page executed successfully
2025/03/05 11:44 INFO:pagesetup executed successfully
2025/03/05 11:44 INFO:Menu setup completed successfully.
2025/03/05 11:44 INFO:Data already loaded in session state.
2025/03/05 11:44 INFO:App is fully loaded and ready!
2025/03/05 11:44 INFO:Streamlit App Starting...
2025/03/05 11:44 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:44 INFO:Running App setup...
2025/03/05 11:44 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:Setting up the package
2025/03/05 11:44 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:Version: v20.145
2025/03/05 11:44 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:44 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:44 DEBUG:filenames already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:44 DEBUG:thresholds already exists in session state
2025/03/05 11:44 DEBUG:data_remappings already exists in session state
2025/03/05 11:44 DEBUG:filter_def already exists in session state
2025/03/05 11:44 DEBUG:security already exists in session state
2025/03/05 11:44 DEBUG:perc_target already exists in session state
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:44 DEBUG:directories already exists in session state
2025/03/05 11:44 DEBUG:reference_dir already exists in session state
2025/03/05 11:44 DEBUG:data_dir already exists in session state
2025/03/05 11:44 DEBUG:output_dir already exists in session state
2025/03/05 11:44 DEBUG:logs_dir already exists in session state
2025/03/05 11:44 DEBUG:components_dir already exists in session state
2025/03/05 11:44 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:44 DEBUG:utils_dir already exists in session state
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:44 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:44 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:44 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:44 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:44 DEBUG:original_data_fname already exists in session state
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:44 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:44 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:44 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:44 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:44 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:44 DEBUG:source_data_fname already exists in session state
2025/03/05 11:44 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:44 INFO:Session_state variables initialized
2025/03/05 11:44 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:44 DEBUG:menu_selection: {'title': 'Public Fund Donations per Donor', 'function': <function mod_publicfund_donations_per_donor_page at 0x000001EFD60A5120>}
2025/03/05 11:44 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:44 DEBUG:reference_dir: reference_files
2025/03/05 11:44 DEBUG:data_dir: data
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:44 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:44 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:44 DEBUG:min_date: 2001-01-01
2025/03/05 11:44 DEBUG:Cash_ftr: None
2025/03/05 11:44 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:44 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:44 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:44 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:44 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:44 DEBUG:output_dir: output
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:44 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:44 DEBUG:max_date: 2019-09-02
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:44 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:44 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:44 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:44 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:44 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:44 DEBUG:app_pages_dir: app_pages
2025/03/05 11:44 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:44 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:44 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:44 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:44 DEBUG:components_dir: components
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:44 DEBUG:utils_dir: utils
2025/03/05 11:44 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:44 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:44 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:44 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:44 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:44 DEBUG:perc_target: 0.5
2025/03/05 11:44 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:44 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:44 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:44 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:44 DEBUG:logs_dir: logs
2025/03/05 11:44 INFO:Session state Setup complete
2025/03/05 11:44 INFO:initialize_session_state executed successfully
2025/03/05 11:44 INFO:Package setup complete
2025/03/05 11:44 INFO:setup_package executed successfully
2025/03/05 11:44 INFO:Setup completed successfully.
2025/03/05 11:44 INFO:Running Menu setup...
2025/03/05 11:44 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:App Version: v20.166
2025/03/05 11:44 INFO:Switched to page: Public Fund Donations per Donor
2025/03/05 11:44 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:44 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_summary_statistics executed successfully
2025/03/05 11:44 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_textual_insights executed successfully
2025/03/05 11:44 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 INFO:display_visualizations executed successfully
2025/03/05 11:44 INFO:display_per_group_data_page executed successfully
2025/03/05 11:44 INFO:pagesetup executed successfully
2025/03/05 11:44 INFO:Menu setup completed successfully.
2025/03/05 11:44 INFO:Data already loaded in session state.
2025/03/05 11:44 INFO:App is fully loaded and ready!
2025/03/05 11:44 INFO:Streamlit App Starting...
2025/03/05 11:44 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:44 INFO:Running App setup...
2025/03/05 11:44 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:Setting up the package
2025/03/05 11:44 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:Version: v20.145
2025/03/05 11:44 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:44 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:44 DEBUG:filenames already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:44 DEBUG:thresholds already exists in session state
2025/03/05 11:44 DEBUG:data_remappings already exists in session state
2025/03/05 11:44 DEBUG:filter_def already exists in session state
2025/03/05 11:44 DEBUG:security already exists in session state
2025/03/05 11:44 DEBUG:perc_target already exists in session state
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:44 DEBUG:directories already exists in session state
2025/03/05 11:44 DEBUG:reference_dir already exists in session state
2025/03/05 11:44 DEBUG:data_dir already exists in session state
2025/03/05 11:44 DEBUG:output_dir already exists in session state
2025/03/05 11:44 DEBUG:logs_dir already exists in session state
2025/03/05 11:44 DEBUG:components_dir already exists in session state
2025/03/05 11:44 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:44 DEBUG:utils_dir already exists in session state
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:44 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:44 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:44 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:44 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:44 DEBUG:original_data_fname already exists in session state
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:44 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:44 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:44 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:44 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:44 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:44 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:44 DEBUG:source_data_fname already exists in session state
2025/03/05 11:44 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:44 INFO:Session_state variables initialized
2025/03/05 11:44 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:44 DEBUG:menu_selection: {'title': 'Corporate Donations per Donor', 'function': <function mod_corporate_donations_per_donor_page at 0x000001EFD60A4790>}
2025/03/05 11:44 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:44 DEBUG:reference_dir: reference_files
2025/03/05 11:44 DEBUG:data_dir: data
2025/03/05 11:44 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:44 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:44 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:44 DEBUG:min_date: 2001-01-01
2025/03/05 11:44 DEBUG:Cash_ftr: None
2025/03/05 11:44 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:44 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:44 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:44 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:44 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:44 DEBUG:output_dir: output
2025/03/05 11:44 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:44 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:44 DEBUG:max_date: 2019-09-02
2025/03/05 11:44 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:44 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:44 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:44 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:44 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:44 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:44 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:44 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:44 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:44 DEBUG:app_pages_dir: app_pages
2025/03/05 11:44 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:44 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:44 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:44 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:44 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:44 DEBUG:components_dir: components
2025/03/05 11:44 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:44 DEBUG:utils_dir: utils
2025/03/05 11:44 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:44 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:44 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:44 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:44 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:44 DEBUG:perc_target: 0.5
2025/03/05 11:44 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:44 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:44 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:44 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:44 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:44 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:44 DEBUG:logs_dir: logs
2025/03/05 11:44 INFO:Session state Setup complete
2025/03/05 11:44 INFO:initialize_session_state executed successfully
2025/03/05 11:44 INFO:Package setup complete
2025/03/05 11:44 INFO:setup_package executed successfully
2025/03/05 11:44 INFO:Setup completed successfully.
2025/03/05 11:44 INFO:Running Menu setup...
2025/03/05 11:44 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:get_git_version executed successfully
2025/03/05 11:44 INFO:App Version: v20.166
2025/03/05 11:44 INFO:Switched to page: Corporate Donations per Donor
2025/03/05 11:44 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:44 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_summary_statistics executed successfully
2025/03/05 11:44 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:display_textual_insights executed successfully
2025/03/05 11:44 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:44 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:44 INFO:display_visualizations executed successfully
2025/03/05 11:44 INFO:display_per_group_data_page executed successfully
2025/03/05 11:44 INFO:pagesetup executed successfully
2025/03/05 11:44 INFO:Menu setup completed successfully.
2025/03/05 11:44 INFO:Data already loaded in session state.
2025/03/05 11:44 INFO:App is fully loaded and ready!
2025/03/05 11:50 INFO:Streamlit App Starting...
2025/03/05 11:50 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:50 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:50 INFO:Running App setup...
2025/03/05 11:50 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:Setting up the package
2025/03/05 11:50 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:50 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:get_git_version executed successfully
2025/03/05 11:50 INFO:Version: v20.145
2025/03/05 11:50 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:50 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:50 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:50 DEBUG:filenames already exists in session state
2025/03/05 11:50 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:50 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:50 DEBUG:thresholds already exists in session state
2025/03/05 11:50 DEBUG:data_remappings already exists in session state
2025/03/05 11:50 DEBUG:filter_def already exists in session state
2025/03/05 11:50 DEBUG:security already exists in session state
2025/03/05 11:50 DEBUG:perc_target already exists in session state
2025/03/05 11:50 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:50 DEBUG:directories already exists in session state
2025/03/05 11:50 DEBUG:reference_dir already exists in session state
2025/03/05 11:50 DEBUG:data_dir already exists in session state
2025/03/05 11:50 DEBUG:output_dir already exists in session state
2025/03/05 11:50 DEBUG:logs_dir already exists in session state
2025/03/05 11:50 DEBUG:components_dir already exists in session state
2025/03/05 11:50 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:50 DEBUG:utils_dir already exists in session state
2025/03/05 11:50 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:50 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:50 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:50 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:50 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:50 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:50 DEBUG:original_data_fname already exists in session state
2025/03/05 11:50 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:50 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:50 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:50 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:50 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:50 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:50 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:50 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:50 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:50 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:50 DEBUG:source_data_fname already exists in session state
2025/03/05 11:50 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:50 INFO:Session_state variables initialized
2025/03/05 11:50 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:50 DEBUG:menu_selection: {'title': 'Sponsorships per Donor', 'function': <function mod_sponsorships_per_donor_page at 0x000001EFD60A4550>}
2025/03/05 11:50 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:50 DEBUG:reference_dir: reference_files
2025/03/05 11:50 DEBUG:data_dir: data
2025/03/05 11:50 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:50 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:50 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:50 DEBUG:min_date: 2001-01-01
2025/03/05 11:50 DEBUG:Cash_ftr: None
2025/03/05 11:50 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:50 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:50 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:50 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:50 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:50 DEBUG:output_dir: output
2025/03/05 11:50 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:50 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:50 DEBUG:max_date: 2019-09-02
2025/03/05 11:50 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:50 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:50 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:50 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:50 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:50 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:50 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:50 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:50 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:50 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:50 DEBUG:app_pages_dir: app_pages
2025/03/05 11:50 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:50 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:50 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:50 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:50 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:50 DEBUG:components_dir: components
2025/03/05 11:50 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:50 DEBUG:utils_dir: utils
2025/03/05 11:50 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:50 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:50 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:50 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:50 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:50 DEBUG:perc_target: 0.5
2025/03/05 11:50 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:50 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:50 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:50 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:50 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:50 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:50 DEBUG:logs_dir: logs
2025/03/05 11:50 INFO:Session state Setup complete
2025/03/05 11:50 INFO:initialize_session_state executed successfully
2025/03/05 11:50 INFO:Package setup complete
2025/03/05 11:50 INFO:setup_package executed successfully
2025/03/05 11:50 INFO:Setup completed successfully.
2025/03/05 11:50 INFO:Running Menu setup...
2025/03/05 11:50 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:50 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:get_git_version executed successfully
2025/03/05 11:50 INFO:App Version: v20.166
2025/03/05 11:50 INFO:Switched to page: Sponsorships per Donor
2025/03/05 11:50 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:50 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:50 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:display_summary_statistics executed successfully
2025/03/05 11:50 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:display_textual_insights executed successfully
2025/03/05 11:50 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:50 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:50 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:50 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:50 INFO:display_visualizations executed successfully
2025/03/05 11:50 INFO:display_per_group_data_page executed successfully
2025/03/05 11:50 INFO:pagesetup executed successfully
2025/03/05 11:50 INFO:Menu setup completed successfully.
2025/03/05 11:50 INFO:Data already loaded in session state.
2025/03/05 11:50 INFO:App is fully loaded and ready!
2025/03/05 11:51 INFO:Streamlit App Starting...
2025/03/05 11:51 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:51 INFO:Running App setup...
2025/03/05 11:51 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:Setting up the package
2025/03/05 11:51 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:Version: v20.145
2025/03/05 11:51 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:51 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:51 DEBUG:filenames already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:51 DEBUG:thresholds already exists in session state
2025/03/05 11:51 DEBUG:data_remappings already exists in session state
2025/03/05 11:51 DEBUG:filter_def already exists in session state
2025/03/05 11:51 DEBUG:security already exists in session state
2025/03/05 11:51 DEBUG:perc_target already exists in session state
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:51 DEBUG:directories already exists in session state
2025/03/05 11:51 DEBUG:reference_dir already exists in session state
2025/03/05 11:51 DEBUG:data_dir already exists in session state
2025/03/05 11:51 DEBUG:output_dir already exists in session state
2025/03/05 11:51 DEBUG:logs_dir already exists in session state
2025/03/05 11:51 DEBUG:components_dir already exists in session state
2025/03/05 11:51 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:51 DEBUG:utils_dir already exists in session state
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:51 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:51 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:51 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:51 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:51 DEBUG:original_data_fname already exists in session state
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:51 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:51 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:51 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:51 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:51 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:51 DEBUG:source_data_fname already exists in session state
2025/03/05 11:51 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:51 INFO:Session_state variables initialized
2025/03/05 11:51 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:51 DEBUG:menu_selection: {'title': 'Paid Visits per Donor', 'function': <function mod_visits_per_donor at 0x000001EFD60A4310>}
2025/03/05 11:51 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:51 DEBUG:reference_dir: reference_files
2025/03/05 11:51 DEBUG:data_dir: data
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:51 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:51 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:51 DEBUG:min_date: 2001-01-01
2025/03/05 11:51 DEBUG:Cash_ftr: None
2025/03/05 11:51 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:51 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:51 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:51 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:51 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:51 DEBUG:output_dir: output
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:51 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:51 DEBUG:max_date: 2019-09-02
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:51 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:51 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:51 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:51 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:51 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:51 DEBUG:app_pages_dir: app_pages
2025/03/05 11:51 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:51 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:51 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:51 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:51 DEBUG:components_dir: components
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:51 DEBUG:utils_dir: utils
2025/03/05 11:51 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:51 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:51 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:51 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:51 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:51 DEBUG:perc_target: 0.5
2025/03/05 11:51 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:51 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:51 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:51 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:51 DEBUG:logs_dir: logs
2025/03/05 11:51 INFO:Session state Setup complete
2025/03/05 11:51 INFO:initialize_session_state executed successfully
2025/03/05 11:51 INFO:Package setup complete
2025/03/05 11:51 INFO:setup_package executed successfully
2025/03/05 11:51 INFO:Setup completed successfully.
2025/03/05 11:51 INFO:Running Menu setup...
2025/03/05 11:51 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:App Version: v20.166
2025/03/05 11:51 INFO:Switched to page: Paid Visits per Donor
2025/03/05 11:51 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:51 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_summary_statistics executed successfully
2025/03/05 11:51 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_textual_insights executed successfully
2025/03/05 11:51 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 INFO:display_visualizations executed successfully
2025/03/05 11:51 INFO:display_per_group_data_page executed successfully
2025/03/05 11:51 INFO:pagesetup executed successfully
2025/03/05 11:51 INFO:Menu setup completed successfully.
2025/03/05 11:51 INFO:Data already loaded in session state.
2025/03/05 11:51 INFO:App is fully loaded and ready!
2025/03/05 11:51 INFO:Streamlit App Starting...
2025/03/05 11:51 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:51 INFO:Running App setup...
2025/03/05 11:51 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:Setting up the package
2025/03/05 11:51 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:Version: v20.145
2025/03/05 11:51 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:51 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:51 DEBUG:filenames already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:51 DEBUG:thresholds already exists in session state
2025/03/05 11:51 DEBUG:data_remappings already exists in session state
2025/03/05 11:51 DEBUG:filter_def already exists in session state
2025/03/05 11:51 DEBUG:security already exists in session state
2025/03/05 11:51 DEBUG:perc_target already exists in session state
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:51 DEBUG:directories already exists in session state
2025/03/05 11:51 DEBUG:reference_dir already exists in session state
2025/03/05 11:51 DEBUG:data_dir already exists in session state
2025/03/05 11:51 DEBUG:output_dir already exists in session state
2025/03/05 11:51 DEBUG:logs_dir already exists in session state
2025/03/05 11:51 DEBUG:components_dir already exists in session state
2025/03/05 11:51 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:51 DEBUG:utils_dir already exists in session state
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:51 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:51 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:51 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:51 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:51 DEBUG:original_data_fname already exists in session state
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:51 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:51 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:51 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:51 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:51 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:51 DEBUG:source_data_fname already exists in session state
2025/03/05 11:51 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:51 INFO:Session_state variables initialized
2025/03/05 11:51 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:51 DEBUG:menu_selection: {'title': 'Regulated Entities per Donor', 'function': <function mod_regulated_entity_per_donors_page at 0x000001EFD60A4B80>}
2025/03/05 11:51 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:51 DEBUG:reference_dir: reference_files
2025/03/05 11:51 DEBUG:data_dir: data
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:51 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:51 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:51 DEBUG:min_date: 2001-01-01
2025/03/05 11:51 DEBUG:Cash_ftr: None
2025/03/05 11:51 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:51 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:51 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:51 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:51 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:51 DEBUG:output_dir: output
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:51 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:51 DEBUG:max_date: 2019-09-02
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:51 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:51 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:51 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:51 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:51 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:51 DEBUG:app_pages_dir: app_pages
2025/03/05 11:51 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:51 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:51 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:51 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:51 DEBUG:components_dir: components
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:51 DEBUG:utils_dir: utils
2025/03/05 11:51 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:51 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:51 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:51 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:51 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:51 DEBUG:perc_target: 0.5
2025/03/05 11:51 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:51 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:51 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:51 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:51 DEBUG:logs_dir: logs
2025/03/05 11:51 INFO:Session state Setup complete
2025/03/05 11:51 INFO:initialize_session_state executed successfully
2025/03/05 11:51 INFO:Package setup complete
2025/03/05 11:51 INFO:setup_package executed successfully
2025/03/05 11:51 INFO:Setup completed successfully.
2025/03/05 11:51 INFO:Running Menu setup...
2025/03/05 11:51 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:App Version: v20.166
2025/03/05 11:51 INFO:Switched to page: Regulated Entities per Donor
2025/03/05 11:51 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:51 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_summary_statistics executed successfully
2025/03/05 11:51 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_textual_insights executed successfully
2025/03/05 11:51 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 INFO:display_visualizations executed successfully
2025/03/05 11:51 INFO:display_per_group_data_page executed successfully
2025/03/05 11:51 INFO:pagesetup executed successfully
2025/03/05 11:51 INFO:Menu setup completed successfully.
2025/03/05 11:51 INFO:Data already loaded in session state.
2025/03/05 11:51 INFO:App is fully loaded and ready!
2025/03/05 11:51 INFO:Streamlit App Starting...
2025/03/05 11:51 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:51 INFO:Running App setup...
2025/03/05 11:51 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:Setting up the package
2025/03/05 11:51 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:Version: v20.145
2025/03/05 11:51 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:51 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:51 DEBUG:filenames already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:51 DEBUG:thresholds already exists in session state
2025/03/05 11:51 DEBUG:data_remappings already exists in session state
2025/03/05 11:51 DEBUG:filter_def already exists in session state
2025/03/05 11:51 DEBUG:security already exists in session state
2025/03/05 11:51 DEBUG:perc_target already exists in session state
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:51 DEBUG:directories already exists in session state
2025/03/05 11:51 DEBUG:reference_dir already exists in session state
2025/03/05 11:51 DEBUG:data_dir already exists in session state
2025/03/05 11:51 DEBUG:output_dir already exists in session state
2025/03/05 11:51 DEBUG:logs_dir already exists in session state
2025/03/05 11:51 DEBUG:components_dir already exists in session state
2025/03/05 11:51 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:51 DEBUG:utils_dir already exists in session state
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:51 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:51 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:51 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:51 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:51 DEBUG:original_data_fname already exists in session state
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:51 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:51 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:51 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:51 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:51 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:51 DEBUG:source_data_fname already exists in session state
2025/03/05 11:51 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:51 INFO:Session_state variables initialized
2025/03/05 11:51 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:51 DEBUG:menu_selection: {'title': 'Dubious donations per Donor', 'function': <function mod_dubious_donations_per_donor_page at 0x000001EFD60A4940>}
2025/03/05 11:51 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:51 DEBUG:reference_dir: reference_files
2025/03/05 11:51 DEBUG:data_dir: data
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:51 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:51 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:51 DEBUG:min_date: 2001-01-01
2025/03/05 11:51 DEBUG:Cash_ftr: None
2025/03/05 11:51 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:51 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:51 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:51 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:51 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:51 DEBUG:output_dir: output
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:51 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:51 DEBUG:max_date: 2019-09-02
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:51 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:51 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:51 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:51 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:51 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:51 DEBUG:app_pages_dir: app_pages
2025/03/05 11:51 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:51 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:51 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:51 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:51 DEBUG:components_dir: components
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:51 DEBUG:utils_dir: utils
2025/03/05 11:51 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:51 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:51 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:51 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:51 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:51 DEBUG:perc_target: 0.5
2025/03/05 11:51 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:51 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:51 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:51 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:51 DEBUG:logs_dir: logs
2025/03/05 11:51 INFO:Session state Setup complete
2025/03/05 11:51 INFO:initialize_session_state executed successfully
2025/03/05 11:51 INFO:Package setup complete
2025/03/05 11:51 INFO:setup_package executed successfully
2025/03/05 11:51 INFO:Setup completed successfully.
2025/03/05 11:51 INFO:Running Menu setup...
2025/03/05 11:51 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:App Version: v20.166
2025/03/05 11:51 INFO:Switched to page: Dubious donations per Donor
2025/03/05 11:51 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:51 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_summary_statistics executed successfully
2025/03/05 11:51 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_textual_insights executed successfully
2025/03/05 11:51 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 INFO:display_visualizations executed successfully
2025/03/05 11:51 INFO:display_per_group_data_page executed successfully
2025/03/05 11:51 INFO:pagesetup executed successfully
2025/03/05 11:51 INFO:Menu setup completed successfully.
2025/03/05 11:51 INFO:Data already loaded in session state.
2025/03/05 11:51 INFO:App is fully loaded and ready!
2025/03/05 11:51 INFO:Streamlit App Starting...
2025/03/05 11:51 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:51 INFO:Running App setup...
2025/03/05 11:51 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:Setting up the package
2025/03/05 11:51 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:Version: v20.145
2025/03/05 11:51 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:51 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:51 DEBUG:filenames already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:51 DEBUG:thresholds already exists in session state
2025/03/05 11:51 DEBUG:data_remappings already exists in session state
2025/03/05 11:51 DEBUG:filter_def already exists in session state
2025/03/05 11:51 DEBUG:security already exists in session state
2025/03/05 11:51 DEBUG:perc_target already exists in session state
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:51 DEBUG:directories already exists in session state
2025/03/05 11:51 DEBUG:reference_dir already exists in session state
2025/03/05 11:51 DEBUG:data_dir already exists in session state
2025/03/05 11:51 DEBUG:output_dir already exists in session state
2025/03/05 11:51 DEBUG:logs_dir already exists in session state
2025/03/05 11:51 DEBUG:components_dir already exists in session state
2025/03/05 11:51 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:51 DEBUG:utils_dir already exists in session state
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:51 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:51 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:51 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:51 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:51 DEBUG:original_data_fname already exists in session state
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:51 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:51 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:51 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:51 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:51 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:51 DEBUG:source_data_fname already exists in session state
2025/03/05 11:51 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:51 INFO:Session_state variables initialized
2025/03/05 11:51 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:51 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party_page at 0x000001EFD60A4A60>}
2025/03/05 11:51 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:51 DEBUG:reference_dir: reference_files
2025/03/05 11:51 DEBUG:data_dir: data
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:51 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:51 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:51 DEBUG:min_date: 2001-01-01
2025/03/05 11:51 DEBUG:Cash_ftr: None
2025/03/05 11:51 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:51 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:51 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:51 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:51 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:51 DEBUG:output_dir: output
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:51 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:51 DEBUG:max_date: 2019-09-02
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:51 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:51 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:51 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:51 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:51 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:51 DEBUG:app_pages_dir: app_pages
2025/03/05 11:51 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:51 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:51 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:51 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:51 DEBUG:components_dir: components
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:51 DEBUG:utils_dir: utils
2025/03/05 11:51 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:51 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:51 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:51 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:51 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:51 DEBUG:perc_target: 0.5
2025/03/05 11:51 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:51 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:51 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:51 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:51 DEBUG:logs_dir: logs
2025/03/05 11:51 INFO:Session state Setup complete
2025/03/05 11:51 INFO:initialize_session_state executed successfully
2025/03/05 11:51 INFO:Package setup complete
2025/03/05 11:51 INFO:setup_package executed successfully
2025/03/05 11:51 INFO:Setup completed successfully.
2025/03/05 11:51 INFO:Running Menu setup...
2025/03/05 11:51 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:App Version: v20.166
2025/03/05 11:51 INFO:Switched to page: Donations by Political Party
2025/03/05 11:51 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:51 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_summary_statistics executed successfully
2025/03/05 11:51 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_textual_insights executed successfully
2025/03/05 11:51 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 INFO:display_visualizations executed successfully
2025/03/05 11:51 INFO:display_per_group_data_page executed successfully
2025/03/05 11:51 INFO:pagesetup executed successfully
2025/03/05 11:51 INFO:Menu setup completed successfully.
2025/03/05 11:51 INFO:Data already loaded in session state.
2025/03/05 11:51 INFO:App is fully loaded and ready!
2025/03/05 11:51 INFO:Streamlit App Starting...
2025/03/05 11:51 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:51 INFO:Running App setup...
2025/03/05 11:51 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:Setting up the package
2025/03/05 11:51 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:Version: v20.145
2025/03/05 11:51 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:51 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:51 DEBUG:filenames already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:51 DEBUG:thresholds already exists in session state
2025/03/05 11:51 DEBUG:data_remappings already exists in session state
2025/03/05 11:51 DEBUG:filter_def already exists in session state
2025/03/05 11:51 DEBUG:security already exists in session state
2025/03/05 11:51 DEBUG:perc_target already exists in session state
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:51 DEBUG:directories already exists in session state
2025/03/05 11:51 DEBUG:reference_dir already exists in session state
2025/03/05 11:51 DEBUG:data_dir already exists in session state
2025/03/05 11:51 DEBUG:output_dir already exists in session state
2025/03/05 11:51 DEBUG:logs_dir already exists in session state
2025/03/05 11:51 DEBUG:components_dir already exists in session state
2025/03/05 11:51 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:51 DEBUG:utils_dir already exists in session state
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:51 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:51 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:51 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:51 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:51 DEBUG:original_data_fname already exists in session state
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:51 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:51 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:51 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:51 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:51 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:51 DEBUG:source_data_fname already exists in session state
2025/03/05 11:51 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:51 INFO:Session_state variables initialized
2025/03/05 11:51 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:51 DEBUG:menu_selection: {'title': 'Dubious donations per Donor', 'function': <function mod_dubious_donations_per_donor_page at 0x000001EFD60A4940>}
2025/03/05 11:51 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:51 DEBUG:reference_dir: reference_files
2025/03/05 11:51 DEBUG:data_dir: data
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:51 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:51 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:51 DEBUG:min_date: 2001-01-01
2025/03/05 11:51 DEBUG:Cash_ftr: None
2025/03/05 11:51 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:51 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:51 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:51 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:51 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:51 DEBUG:output_dir: output
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:51 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:51 DEBUG:max_date: 2019-09-02
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:51 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:51 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:51 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:51 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:51 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:51 DEBUG:app_pages_dir: app_pages
2025/03/05 11:51 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:51 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:51 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:51 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:51 DEBUG:components_dir: components
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:51 DEBUG:utils_dir: utils
2025/03/05 11:51 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:51 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:51 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:51 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:51 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:51 DEBUG:perc_target: 0.5
2025/03/05 11:51 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:51 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:51 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:51 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:51 DEBUG:logs_dir: logs
2025/03/05 11:51 INFO:Session state Setup complete
2025/03/05 11:51 INFO:initialize_session_state executed successfully
2025/03/05 11:51 INFO:Package setup complete
2025/03/05 11:51 INFO:setup_package executed successfully
2025/03/05 11:51 INFO:Setup completed successfully.
2025/03/05 11:51 INFO:Running Menu setup...
2025/03/05 11:51 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:App Version: v20.166
2025/03/05 11:51 INFO:Switched to page: Dubious donations per Donor
2025/03/05 11:51 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:51 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_summary_statistics executed successfully
2025/03/05 11:51 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_textual_insights executed successfully
2025/03/05 11:51 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 INFO:display_visualizations executed successfully
2025/03/05 11:51 INFO:display_per_group_data_page executed successfully
2025/03/05 11:51 INFO:pagesetup executed successfully
2025/03/05 11:51 INFO:Menu setup completed successfully.
2025/03/05 11:51 INFO:Data already loaded in session state.
2025/03/05 11:51 INFO:App is fully loaded and ready!
2025/03/05 11:51 INFO:Streamlit App Starting...
2025/03/05 11:51 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:51 INFO:Running App setup...
2025/03/05 11:51 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:Setting up the package
2025/03/05 11:51 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:Version: v20.145
2025/03/05 11:51 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:51 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:51 DEBUG:filenames already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:51 DEBUG:thresholds already exists in session state
2025/03/05 11:51 DEBUG:data_remappings already exists in session state
2025/03/05 11:51 DEBUG:filter_def already exists in session state
2025/03/05 11:51 DEBUG:security already exists in session state
2025/03/05 11:51 DEBUG:perc_target already exists in session state
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:51 DEBUG:directories already exists in session state
2025/03/05 11:51 DEBUG:reference_dir already exists in session state
2025/03/05 11:51 DEBUG:data_dir already exists in session state
2025/03/05 11:51 DEBUG:output_dir already exists in session state
2025/03/05 11:51 DEBUG:logs_dir already exists in session state
2025/03/05 11:51 DEBUG:components_dir already exists in session state
2025/03/05 11:51 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:51 DEBUG:utils_dir already exists in session state
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:51 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:51 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:51 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:51 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:51 DEBUG:original_data_fname already exists in session state
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:51 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:51 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:51 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:51 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:51 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:51 DEBUG:source_data_fname already exists in session state
2025/03/05 11:51 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:51 INFO:Session_state variables initialized
2025/03/05 11:51 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:51 DEBUG:menu_selection: {'title': 'Regulated Entities per Donor', 'function': <function mod_regulated_entity_per_donors_page at 0x000001EFD60A4B80>}
2025/03/05 11:51 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:51 DEBUG:reference_dir: reference_files
2025/03/05 11:51 DEBUG:data_dir: data
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:51 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:51 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:51 DEBUG:min_date: 2001-01-01
2025/03/05 11:51 DEBUG:Cash_ftr: None
2025/03/05 11:51 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:51 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:51 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:51 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:51 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:51 DEBUG:output_dir: output
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:51 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:51 DEBUG:max_date: 2019-09-02
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:51 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:51 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:51 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:51 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:51 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:51 DEBUG:app_pages_dir: app_pages
2025/03/05 11:51 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:51 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:51 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:51 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:51 DEBUG:components_dir: components
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:51 DEBUG:utils_dir: utils
2025/03/05 11:51 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:51 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:51 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:51 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:51 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:51 DEBUG:perc_target: 0.5
2025/03/05 11:51 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:51 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:51 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:51 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:51 DEBUG:logs_dir: logs
2025/03/05 11:51 INFO:Session state Setup complete
2025/03/05 11:51 INFO:initialize_session_state executed successfully
2025/03/05 11:51 INFO:Package setup complete
2025/03/05 11:51 INFO:setup_package executed successfully
2025/03/05 11:51 INFO:Setup completed successfully.
2025/03/05 11:51 INFO:Running Menu setup...
2025/03/05 11:51 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:App Version: v20.166
2025/03/05 11:51 INFO:Switched to page: Regulated Entities per Donor
2025/03/05 11:51 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:51 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_summary_statistics executed successfully
2025/03/05 11:51 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_textual_insights executed successfully
2025/03/05 11:51 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 INFO:display_visualizations executed successfully
2025/03/05 11:51 INFO:display_per_group_data_page executed successfully
2025/03/05 11:51 INFO:pagesetup executed successfully
2025/03/05 11:51 INFO:Menu setup completed successfully.
2025/03/05 11:51 INFO:Data already loaded in session state.
2025/03/05 11:51 INFO:App is fully loaded and ready!
2025/03/05 11:51 INFO:Streamlit App Starting...
2025/03/05 11:51 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:51 INFO:Running App setup...
2025/03/05 11:51 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:Setting up the package
2025/03/05 11:51 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:Version: v20.145
2025/03/05 11:51 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:51 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:51 DEBUG:filenames already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:51 DEBUG:thresholds already exists in session state
2025/03/05 11:51 DEBUG:data_remappings already exists in session state
2025/03/05 11:51 DEBUG:filter_def already exists in session state
2025/03/05 11:51 DEBUG:security already exists in session state
2025/03/05 11:51 DEBUG:perc_target already exists in session state
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:51 DEBUG:directories already exists in session state
2025/03/05 11:51 DEBUG:reference_dir already exists in session state
2025/03/05 11:51 DEBUG:data_dir already exists in session state
2025/03/05 11:51 DEBUG:output_dir already exists in session state
2025/03/05 11:51 DEBUG:logs_dir already exists in session state
2025/03/05 11:51 DEBUG:components_dir already exists in session state
2025/03/05 11:51 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:51 DEBUG:utils_dir already exists in session state
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:51 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:51 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:51 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:51 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:51 DEBUG:original_data_fname already exists in session state
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:51 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:51 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:51 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:51 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:51 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:51 DEBUG:source_data_fname already exists in session state
2025/03/05 11:51 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:51 INFO:Session_state variables initialized
2025/03/05 11:51 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:51 DEBUG:menu_selection: {'title': 'Dubious Donors', 'function': <function mod_dubious_donors_page at 0x000001EFD60A4CA0>}
2025/03/05 11:51 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:51 DEBUG:reference_dir: reference_files
2025/03/05 11:51 DEBUG:data_dir: data
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:51 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:51 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:51 DEBUG:min_date: 2001-01-01
2025/03/05 11:51 DEBUG:Cash_ftr: None
2025/03/05 11:51 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:51 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:51 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:51 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:51 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:51 DEBUG:output_dir: output
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:51 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:51 DEBUG:max_date: 2019-09-02
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:51 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:51 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:51 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:51 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:51 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:51 DEBUG:app_pages_dir: app_pages
2025/03/05 11:51 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:51 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:51 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:51 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:51 DEBUG:components_dir: components
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:51 DEBUG:utils_dir: utils
2025/03/05 11:51 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:51 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:51 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:51 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:51 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:51 DEBUG:perc_target: 0.5
2025/03/05 11:51 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:51 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:51 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:51 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:51 DEBUG:logs_dir: logs
2025/03/05 11:51 INFO:Session state Setup complete
2025/03/05 11:51 INFO:initialize_session_state executed successfully
2025/03/05 11:51 INFO:Package setup complete
2025/03/05 11:51 INFO:setup_package executed successfully
2025/03/05 11:51 INFO:Setup completed successfully.
2025/03/05 11:51 INFO:Running Menu setup...
2025/03/05 11:51 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:App Version: v20.166
2025/03/05 11:51 INFO:Switched to page: Dubious Donors
2025/03/05 11:51 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:load_and_filter_data executed successfully
2025/03/05 11:51 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_summary_statistics executed successfully
2025/03/05 11:51 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_textual_insights executed successfully
2025/03/05 11:51 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 INFO:display_visualizations executed successfully
2025/03/05 11:51 INFO:display_data_page executed successfully
2025/03/05 11:51 INFO:pagesetup executed successfully
2025/03/05 11:51 INFO:Menu setup completed successfully.
2025/03/05 11:51 INFO:Data already loaded in session state.
2025/03/05 11:51 INFO:App is fully loaded and ready!
2025/03/05 11:51 INFO:Streamlit App Starting...
2025/03/05 11:51 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:51 INFO:Running App setup...
2025/03/05 11:51 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:Setting up the package
2025/03/05 11:51 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:Version: v20.145
2025/03/05 11:51 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:51 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:51 DEBUG:filenames already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:51 DEBUG:thresholds already exists in session state
2025/03/05 11:51 DEBUG:data_remappings already exists in session state
2025/03/05 11:51 DEBUG:filter_def already exists in session state
2025/03/05 11:51 DEBUG:security already exists in session state
2025/03/05 11:51 DEBUG:perc_target already exists in session state
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:51 DEBUG:directories already exists in session state
2025/03/05 11:51 DEBUG:reference_dir already exists in session state
2025/03/05 11:51 DEBUG:data_dir already exists in session state
2025/03/05 11:51 DEBUG:output_dir already exists in session state
2025/03/05 11:51 DEBUG:logs_dir already exists in session state
2025/03/05 11:51 DEBUG:components_dir already exists in session state
2025/03/05 11:51 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:51 DEBUG:utils_dir already exists in session state
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:51 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:51 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:51 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:51 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:51 DEBUG:original_data_fname already exists in session state
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:51 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:51 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:51 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:51 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:51 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:51 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:51 DEBUG:source_data_fname already exists in session state
2025/03/05 11:51 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:51 INFO:Session_state variables initialized
2025/03/05 11:51 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:51 DEBUG:menu_selection: {'title': 'Donations by Political Party', 'function': <function mod_donations_per_political_party_page at 0x000001EFD60A4A60>}
2025/03/05 11:51 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:51 DEBUG:reference_dir: reference_files
2025/03/05 11:51 DEBUG:data_dir: data
2025/03/05 11:51 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:51 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:51 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:51 DEBUG:min_date: 2001-01-01
2025/03/05 11:51 DEBUG:Cash_ftr: None
2025/03/05 11:51 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:51 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:51 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:51 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:51 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:51 DEBUG:output_dir: output
2025/03/05 11:51 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:51 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:51 DEBUG:max_date: 2019-09-02
2025/03/05 11:51 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:51 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:51 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:51 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:51 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:51 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:51 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:51 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:51 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:51 DEBUG:app_pages_dir: app_pages
2025/03/05 11:51 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:51 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:51 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:51 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:51 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:51 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 11:51 DEBUG:components_dir: components
2025/03/05 11:51 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:51 DEBUG:utils_dir: utils
2025/03/05 11:51 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:51 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:51 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:51 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:51 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:51 DEBUG:perc_target: 0.5
2025/03/05 11:51 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:51 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:51 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:51 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:51 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:51 DEBUG:logs_dir: logs
2025/03/05 11:51 INFO:Session state Setup complete
2025/03/05 11:51 INFO:initialize_session_state executed successfully
2025/03/05 11:51 INFO:Package setup complete
2025/03/05 11:51 INFO:setup_package executed successfully
2025/03/05 11:51 INFO:Setup completed successfully.
2025/03/05 11:51 INFO:Running Menu setup...
2025/03/05 11:51 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:get_git_version executed successfully
2025/03/05 11:51 INFO:App Version: v20.166
2025/03/05 11:51 INFO:Switched to page: Donations by Political Party
2025/03/05 11:51 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:51 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_summary_statistics executed successfully
2025/03/05 11:51 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:display_textual_insights executed successfully
2025/03/05 11:51 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:51 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:51 INFO:display_visualizations executed successfully
2025/03/05 11:51 INFO:display_per_group_data_page executed successfully
2025/03/05 11:51 INFO:pagesetup executed successfully
2025/03/05 11:51 INFO:Menu setup completed successfully.
2025/03/05 11:51 INFO:Data already loaded in session state.
2025/03/05 11:51 INFO:App is fully loaded and ready!
2025/03/05 11:52 INFO:Streamlit App Starting...
2025/03/05 11:52 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:52 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:52 INFO:Running App setup...
2025/03/05 11:52 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:Setting up the package
2025/03/05 11:52 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:52 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:get_git_version executed successfully
2025/03/05 11:52 INFO:Version: v20.145
2025/03/05 11:52 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:52 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:52 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:52 DEBUG:filenames already exists in session state
2025/03/05 11:52 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:52 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:52 DEBUG:thresholds already exists in session state
2025/03/05 11:52 DEBUG:data_remappings already exists in session state
2025/03/05 11:52 DEBUG:filter_def already exists in session state
2025/03/05 11:52 DEBUG:security already exists in session state
2025/03/05 11:52 DEBUG:perc_target already exists in session state
2025/03/05 11:52 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:52 DEBUG:directories already exists in session state
2025/03/05 11:52 DEBUG:reference_dir already exists in session state
2025/03/05 11:52 DEBUG:data_dir already exists in session state
2025/03/05 11:52 DEBUG:output_dir already exists in session state
2025/03/05 11:52 DEBUG:logs_dir already exists in session state
2025/03/05 11:52 DEBUG:components_dir already exists in session state
2025/03/05 11:52 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:52 DEBUG:utils_dir already exists in session state
2025/03/05 11:52 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:52 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:52 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:52 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:52 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:52 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:52 DEBUG:original_data_fname already exists in session state
2025/03/05 11:52 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:52 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:52 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:52 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:52 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:52 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:52 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:52 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:52 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:52 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:52 DEBUG:source_data_fname already exists in session state
2025/03/05 11:52 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:52 INFO:Session_state variables initialized
2025/03/05 11:52 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:52 DEBUG:menu_selection: {'title': 'Corporate Donations per Entity', 'function': <function mod_corporate_donations_per_entity_page at 0x000001EFD60A49D0>}
2025/03/05 11:52 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:52 DEBUG:reference_dir: reference_files
2025/03/05 11:52 DEBUG:data_dir: data
2025/03/05 11:52 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:52 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:52 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:52 DEBUG:min_date: 2001-01-01
2025/03/05 11:52 DEBUG:Cash_ftr: None
2025/03/05 11:52 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:52 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:52 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:52 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:52 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:52 DEBUG:output_dir: output
2025/03/05 11:52 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:52 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:52 DEBUG:max_date: 2019-09-02
2025/03/05 11:52 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:52 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:52 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:52 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:52 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:52 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:52 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:52 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:52 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:52 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:52 DEBUG:app_pages_dir: app_pages
2025/03/05 11:52 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:52 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:52 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:52 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:52 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:52 DEBUG:components_dir: components
2025/03/05 11:52 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:52 DEBUG:utils_dir: utils
2025/03/05 11:52 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:52 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:52 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:52 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:52 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:52 DEBUG:perc_target: 0.5
2025/03/05 11:52 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:52 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:52 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:52 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:52 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:52 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:52 DEBUG:logs_dir: logs
2025/03/05 11:52 INFO:Session state Setup complete
2025/03/05 11:52 INFO:initialize_session_state executed successfully
2025/03/05 11:52 INFO:Package setup complete
2025/03/05 11:52 INFO:setup_package executed successfully
2025/03/05 11:52 INFO:Setup completed successfully.
2025/03/05 11:52 INFO:Running Menu setup...
2025/03/05 11:52 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:52 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:get_git_version executed successfully
2025/03/05 11:52 INFO:App Version: v20.166
2025/03/05 11:52 INFO:Switched to page: Corporate Donations per Entity
2025/03/05 11:52 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 11:52 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:load_and_filter_pergroup executed successfully
2025/03/05 11:52 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:display_summary_statistics executed successfully
2025/03/05 11:52 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:display_textual_insights executed successfully
2025/03/05 11:52 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 11:52 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:52 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:52 INFO:display_visualizations executed successfully
2025/03/05 11:52 INFO:display_per_group_data_page executed successfully
2025/03/05 11:52 INFO:pagesetup executed successfully
2025/03/05 11:52 INFO:Menu setup completed successfully.
2025/03/05 11:52 INFO:Data already loaded in session state.
2025/03/05 11:52 INFO:App is fully loaded and ready!
2025/03/05 11:52 INFO:Streamlit App Starting...
2025/03/05 11:52 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 11:52 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 11:52 INFO:Running App setup...
2025/03/05 11:52 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:Setting up the package
2025/03/05 11:52 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 11:52 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:get_git_version executed successfully
2025/03/05 11:52 INFO:Version: v20.145
2025/03/05 11:52 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:52 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 11:52 DEBUG:BASE_DIR already exists in session state
2025/03/05 11:52 DEBUG:filenames already exists in session state
2025/03/05 11:52 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 11:52 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 11:52 DEBUG:thresholds already exists in session state
2025/03/05 11:52 DEBUG:data_remappings already exists in session state
2025/03/05 11:52 DEBUG:filter_def already exists in session state
2025/03/05 11:52 DEBUG:security already exists in session state
2025/03/05 11:52 DEBUG:perc_target already exists in session state
2025/03/05 11:52 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 11:52 DEBUG:directories already exists in session state
2025/03/05 11:52 DEBUG:reference_dir already exists in session state
2025/03/05 11:52 DEBUG:data_dir already exists in session state
2025/03/05 11:52 DEBUG:output_dir already exists in session state
2025/03/05 11:52 DEBUG:logs_dir already exists in session state
2025/03/05 11:52 DEBUG:components_dir already exists in session state
2025/03/05 11:52 DEBUG:app_pages_dir already exists in session state
2025/03/05 11:52 DEBUG:utils_dir already exists in session state
2025/03/05 11:52 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 11:52 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 11:52 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 11:52 DEBUG:donor_map_fname already exists in session state
2025/03/05 11:52 DEBUG:politician_party_fname already exists in session state
2025/03/05 11:52 DEBUG:regentity_map_fname already exists in session state
2025/03/05 11:52 DEBUG:original_data_fname already exists in session state
2025/03/05 11:52 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 11:52 DEBUG:TEXT_FILE already exists in session state
2025/03/05 11:52 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 11:52 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 11:52 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 11:52 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 11:52 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 11:52 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 11:52 DEBUG:party_summary_fname already exists in session state
2025/03/05 11:52 DEBUG:imported_raw_fname already exists in session state
2025/03/05 11:52 DEBUG:source_data_fname already exists in session state
2025/03/05 11:52 DEBUG:Cash_ftr already exists in session state
2025/03/05 11:52 INFO:Session_state variables initialized
2025/03/05 11:52 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 11:52 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001EFD608BA30>}
2025/03/05 11:52 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 11:52 DEBUG:reference_dir: reference_files
2025/03/05 11:52 DEBUG:data_dir: data
2025/03/05 11:52 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 11:52 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 11:52 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 11:52 DEBUG:min_date: 2001-01-01
2025/03/05 11:52 DEBUG:Cash_ftr: None
2025/03/05 11:52 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 11:52 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 11:52 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 11:52 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 11:52 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 11:52 DEBUG:output_dir: output
2025/03/05 11:52 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 11:52 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 11:52 DEBUG:max_date: 2019-09-02
2025/03/05 11:52 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 11:52 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 11:52 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 11:52 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 11:52 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 11:52 DEBUG:year_slider_rightfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:52 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 11:52 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 11:52 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 11:52 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 11:52 DEBUG:app_pages_dir: app_pages
2025/03/05 11:52 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 11:52 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 11:52 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 11:52 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 11:52 DEBUG:LOG_LEVEL: ERROR
2025/03/05 11:52 DEBUG:components_dir: components
2025/03/05 11:52 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 11:52 DEBUG:utils_dir: utils
2025/03/05 11:52 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 11:52 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 11:52 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 11:52 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 11:52 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 11:52 DEBUG:perc_target: 0.5
2025/03/05 11:52 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 11:52 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 11:52 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 11:52 DEBUG:year_slider_leftfilter_keytarget_label_vis: (2001, 2019)
2025/03/05 11:52 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 11:52 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 11:52 DEBUG:logs_dir: logs
2025/03/05 11:52 INFO:Session state Setup complete
2025/03/05 11:52 INFO:initialize_session_state executed successfully
2025/03/05 11:52 INFO:Package setup complete
2025/03/05 11:52 INFO:setup_package executed successfully
2025/03/05 11:52 INFO:Setup completed successfully.
2025/03/05 11:52 INFO:Running Menu setup...
2025/03/05 11:52 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 11:52 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:get_git_version executed successfully
2025/03/05 11:52 INFO:App Version: v20.166
2025/03/05 11:52 INFO:Switched to page: Head Line Figures
2025/03/05 11:52 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 11:52 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:load_and_filter_data executed successfully
2025/03/05 11:52 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:display_summary_statistics executed successfully
2025/03/05 11:52 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:52 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:52 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:52 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 11:52 INFO:plot_bar_line_by_year executed successfully
2025/03/05 11:52 INFO:hlf_body executed successfully
2025/03/05 11:52 INFO:pagesetup executed successfully
2025/03/05 11:52 INFO:Menu setup completed successfully.
2025/03/05 11:52 INFO:Data already loaded in session state.
2025/03/05 11:52 INFO:App is fully loaded and ready!
2025/03/05 12:06 INFO:Streamlit App Starting...
2025/03/05 12:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 12:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 12:06 INFO:Running App setup...
2025/03/05 12:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:Setting up the package
2025/03/05 12:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 12:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:get_git_version executed successfully
2025/03/05 12:06 INFO:Version: v20.145
2025/03/05 12:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 12:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 12:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 12:06 DEBUG:filenames already exists in session state
2025/03/05 12:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 12:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 12:06 DEBUG:thresholds already exists in session state
2025/03/05 12:06 DEBUG:data_remappings already exists in session state
2025/03/05 12:06 DEBUG:filter_def already exists in session state
2025/03/05 12:06 DEBUG:security already exists in session state
2025/03/05 12:06 DEBUG:perc_target already exists in session state
2025/03/05 12:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 12:06 DEBUG:directories already exists in session state
2025/03/05 12:06 DEBUG:reference_dir already exists in session state
2025/03/05 12:06 DEBUG:data_dir already exists in session state
2025/03/05 12:06 DEBUG:output_dir already exists in session state
2025/03/05 12:06 DEBUG:logs_dir already exists in session state
2025/03/05 12:06 DEBUG:components_dir already exists in session state
2025/03/05 12:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 12:06 DEBUG:utils_dir already exists in session state
2025/03/05 12:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 12:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 12:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 12:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 12:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 12:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 12:06 DEBUG:original_data_fname already exists in session state
2025/03/05 12:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 12:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 12:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 12:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 12:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 12:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 12:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 12:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 12:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 12:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 12:06 DEBUG:source_data_fname already exists in session state
2025/03/05 12:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 12:06 INFO:Session_state variables initialized
2025/03/05 12:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 12:06 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations_page at 0x000001EFD60A4D30>}
2025/03/05 12:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 12:06 DEBUG:reference_dir: reference_files
2025/03/05 12:06 DEBUG:data_dir: data
2025/03/05 12:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 12:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 12:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 12:06 DEBUG:min_date: 2001-01-01
2025/03/05 12:06 DEBUG:year_slider_dons_by_year_n_type: (2001, 2019)
2025/03/05 12:06 DEBUG:Cash_ftr: None
2025/03/05 12:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 12:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 12:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 12:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 12:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 12:06 DEBUG:output_dir: output
2025/03/05 12:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 12:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 12:06 DEBUG:max_date: 2019-09-02
2025/03/05 12:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 12:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 12:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 12:06 DEBUG:year_slider_value_by_year_n_entity: (2001, 2019)
2025/03/05 12:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 12:06 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 12:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 12:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 12:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 12:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 12:06 DEBUG:app_pages_dir: app_pages
2025/03/05 12:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 12:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 12:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 12:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 12:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 12:06 DEBUG:components_dir: components
2025/03/05 12:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 12:06 DEBUG:utils_dir: utils
2025/03/05 12:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 12:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 12:06 DEBUG:year_slider_dons_by_year_n_entity: (2001, 2019)
2025/03/05 12:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 12:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 12:06 DEBUG:year_slider_value_by_year_n_type: (2001, 2019)
2025/03/05 12:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 12:06 DEBUG:perc_target: 0.5
2025/03/05 12:06 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 12:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 12:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 12:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 12:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 12:06 DEBUG:logs_dir: logs
2025/03/05 12:06 INFO:Session state Setup complete
2025/03/05 12:06 INFO:initialize_session_state executed successfully
2025/03/05 12:06 INFO:Package setup complete
2025/03/05 12:06 INFO:setup_package executed successfully
2025/03/05 12:06 INFO:Setup completed successfully.
2025/03/05 12:06 INFO:Running Menu setup...
2025/03/05 12:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 12:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:get_git_version executed successfully
2025/03/05 12:06 INFO:App Version: v20.166
2025/03/05 12:06 INFO:Switched to page: Cash Donations
2025/03/05 12:06 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 12:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:load_and_filter_data executed successfully
2025/03/05 12:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:display_summary_statistics executed successfully
2025/03/05 12:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:display_textual_insights executed successfully
2025/03/05 12:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 12:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 12:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 12:06 INFO:display_visualizations executed successfully
2025/03/05 12:06 INFO:display_data_page executed successfully
2025/03/05 12:06 INFO:pagesetup executed successfully
2025/03/05 12:06 INFO:Menu setup completed successfully.
2025/03/05 12:06 INFO:Data already loaded in session state.
2025/03/05 12:06 INFO:App is fully loaded and ready!
2025/03/05 12:06 INFO:Streamlit App Starting...
2025/03/05 12:06 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 12:06 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 12:06 INFO:Running App setup...
2025/03/05 12:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:Setting up the package
2025/03/05 12:06 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 12:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:get_git_version executed successfully
2025/03/05 12:06 INFO:Version: v20.145
2025/03/05 12:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 12:06 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 12:06 DEBUG:BASE_DIR already exists in session state
2025/03/05 12:06 DEBUG:filenames already exists in session state
2025/03/05 12:06 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 12:06 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 12:06 DEBUG:thresholds already exists in session state
2025/03/05 12:06 DEBUG:data_remappings already exists in session state
2025/03/05 12:06 DEBUG:filter_def already exists in session state
2025/03/05 12:06 DEBUG:security already exists in session state
2025/03/05 12:06 DEBUG:perc_target already exists in session state
2025/03/05 12:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 12:06 DEBUG:directories already exists in session state
2025/03/05 12:06 DEBUG:reference_dir already exists in session state
2025/03/05 12:06 DEBUG:data_dir already exists in session state
2025/03/05 12:06 DEBUG:output_dir already exists in session state
2025/03/05 12:06 DEBUG:logs_dir already exists in session state
2025/03/05 12:06 DEBUG:components_dir already exists in session state
2025/03/05 12:06 DEBUG:app_pages_dir already exists in session state
2025/03/05 12:06 DEBUG:utils_dir already exists in session state
2025/03/05 12:06 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 12:06 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 12:06 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 12:06 DEBUG:donor_map_fname already exists in session state
2025/03/05 12:06 DEBUG:politician_party_fname already exists in session state
2025/03/05 12:06 DEBUG:regentity_map_fname already exists in session state
2025/03/05 12:06 DEBUG:original_data_fname already exists in session state
2025/03/05 12:06 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 12:06 DEBUG:TEXT_FILE already exists in session state
2025/03/05 12:06 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 12:06 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 12:06 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 12:06 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 12:06 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 12:06 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 12:06 DEBUG:party_summary_fname already exists in session state
2025/03/05 12:06 DEBUG:imported_raw_fname already exists in session state
2025/03/05 12:06 DEBUG:source_data_fname already exists in session state
2025/03/05 12:06 DEBUG:Cash_ftr already exists in session state
2025/03/05 12:06 INFO:Session_state variables initialized
2025/03/05 12:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 12:06 DEBUG:menu_selection: {'title': 'Non Cash Donations', 'function': <function mod_non_cash_donations_page at 0x000001EFD60A4EE0>}
2025/03/05 12:06 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 12:06 DEBUG:reference_dir: reference_files
2025/03/05 12:06 DEBUG:data_dir: data
2025/03/05 12:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 12:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 12:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 12:06 DEBUG:min_date: 2001-01-01
2025/03/05 12:06 DEBUG:Cash_ftr: None
2025/03/05 12:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 12:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 12:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 12:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 12:06 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 12:06 DEBUG:output_dir: output
2025/03/05 12:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 12:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 12:06 DEBUG:max_date: 2019-09-02
2025/03/05 12:06 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 12:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 12:06 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 12:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 12:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 12:06 DEBUG:load_donorlist_data_last_modified: 1741174713.2652059
2025/03/05 12:06 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 12:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 12:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 12:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 12:06 DEBUG:app_pages_dir: app_pages
2025/03/05 12:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 12:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 12:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 12:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 12:06 DEBUG:LOG_LEVEL: ERROR
2025/03/05 12:06 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 12:06 DEBUG:components_dir: components
2025/03/05 12:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 12:06 DEBUG:utils_dir: utils
2025/03/05 12:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 12:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 12:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 12:06 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 12:06 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 12:06 DEBUG:perc_target: 0.5
2025/03/05 12:06 DEBUG:load_raw_data_last_modified: 1741174708.2435687
2025/03/05 12:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 12:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 12:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 12:06 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 12:06 DEBUG:logs_dir: logs
2025/03/05 12:06 INFO:Session state Setup complete
2025/03/05 12:06 INFO:initialize_session_state executed successfully
2025/03/05 12:06 INFO:Package setup complete
2025/03/05 12:06 INFO:setup_package executed successfully
2025/03/05 12:06 INFO:Setup completed successfully.
2025/03/05 12:06 INFO:Running Menu setup...
2025/03/05 12:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 12:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:get_git_version executed successfully
2025/03/05 12:06 INFO:App Version: v20.166
2025/03/05 12:06 INFO:Switched to page: Non Cash Donations
2025/03/05 12:06 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 12:06 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:load_and_filter_data executed successfully
2025/03/05 12:06 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:display_summary_statistics executed successfully
2025/03/05 12:06 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:display_textual_insights executed successfully
2025/03/05 12:06 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 12:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 12:06 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 12:06 INFO:plot_bar_line_by_year executed successfully
2025/03/05 12:06 INFO:display_visualizations executed successfully
2025/03/05 12:06 INFO:display_data_page executed successfully
2025/03/05 12:06 INFO:pagesetup executed successfully
2025/03/05 12:06 INFO:Menu setup completed successfully.
2025/03/05 12:06 INFO:Data already loaded in session state.
2025/03/05 12:06 INFO:App is fully loaded and ready!
2025/03/05 01:21 INFO:Streamlit App Starting...
2025/03/05 01:21 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 01:21 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 01:21 INFO:Running App setup...
2025/03/05 01:21 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 01:21 INFO:Setting up the package
2025/03/05 01:21 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 01:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:21 INFO:get_git_version executed successfully
2025/03/05 01:21 INFO:Version: v20.145
2025/03/05 01:21 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 01:21 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:21 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 01:21 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 01:21 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:21 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 01:21 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 01:21 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:21 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:21 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:21 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:21 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 01:21 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 01:21 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:21 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 01:21 DEBUG:Initialised data_dir with value: data
2025/03/05 01:21 DEBUG:Initialised output_dir with value: output
2025/03/05 01:21 DEBUG:Initialised logs_dir with value: logs
2025/03/05 01:21 DEBUG:Initialised components_dir with value: components
2025/03/05 01:21 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 01:21 DEBUG:Initialised utils_dir with value: utils
2025/03/05 01:21 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:21 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:21 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 01:21 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:21 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:21 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:21 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 01:21 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 01:21 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 01:21 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 01:21 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 01:21 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 01:21 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 01:21 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 01:21 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 01:21 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 01:21 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 01:21 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:21 DEBUG:Initialised Cash_ftr with value: None
2025/03/05 01:21 INFO:Session_state variables initialized
2025/03/05 01:21 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:21 DEBUG:reference_dir: reference_files
2025/03/05 01:21 DEBUG:data_dir: data
2025/03/05 01:21 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 01:21 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:21 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 01:21 DEBUG:Cash_ftr: None
2025/03/05 01:21 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:21 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:21 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:21 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:21 DEBUG:output_dir: output
2025/03/05 01:21 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 01:21 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 01:21 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:21 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 01:21 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 01:21 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:21 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:21 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 01:21 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:21 DEBUG:app_pages_dir: app_pages
2025/03/05 01:21 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 01:21 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:21 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 01:21 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 01:21 DEBUG:LOG_LEVEL: ERROR
2025/03/05 01:21 DEBUG:components_dir: components
2025/03/05 01:21 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:21 DEBUG:utils_dir: utils
2025/03/05 01:21 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 01:21 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 01:21 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:21 DEBUG:perc_target: 0.5
2025/03/05 01:21 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 01:21 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:21 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 01:21 DEBUG:logs_dir: logs
2025/03/05 01:21 INFO:Session state Setup complete
2025/03/05 01:21 INFO:initialize_session_state executed successfully
2025/03/05 01:21 INFO:Package setup complete
2025/03/05 01:21 INFO:setup_package executed successfully
2025/03/05 01:21 INFO:Setup completed successfully.
2025/03/05 01:21 INFO:Running Menu setup...
2025/03/05 01:21 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 01:21 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:21 INFO:get_git_version executed successfully
2025/03/05 01:21 INFO:App Version: v20.166
2025/03/05 01:21 INFO:Switched to page: Introduction
2025/03/05 01:21 INFO:pagesetup executed successfully
2025/03/05 01:21 INFO:Menu setup completed successfully.
2025/03/05 01:21 INFO:No data found in session state, running firstload()
2025/03/05 01:21 INFO:App is fully loaded and ready!
2025/03/05 01:26 INFO:Streamlit App Starting...
2025/03/05 01:26 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 01:26 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 01:26 INFO:Running App setup...
2025/03/05 01:26 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 01:26 INFO:Setting up the package
2025/03/05 01:26 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 01:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:26 INFO:get_git_version executed successfully
2025/03/05 01:26 INFO:Version: v20.145
2025/03/05 01:26 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 01:26 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:26 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 01:26 DEBUG:BASE_DIR already exists in session state
2025/03/05 01:26 DEBUG:filenames already exists in session state
2025/03/05 01:26 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 01:26 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 01:26 DEBUG:thresholds already exists in session state
2025/03/05 01:26 DEBUG:data_remappings already exists in session state
2025/03/05 01:26 DEBUG:filter_def already exists in session state
2025/03/05 01:26 DEBUG:security already exists in session state
2025/03/05 01:26 DEBUG:perc_target already exists in session state
2025/03/05 01:26 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 01:26 DEBUG:directories already exists in session state
2025/03/05 01:26 DEBUG:reference_dir already exists in session state
2025/03/05 01:26 DEBUG:data_dir already exists in session state
2025/03/05 01:26 DEBUG:output_dir already exists in session state
2025/03/05 01:26 DEBUG:logs_dir already exists in session state
2025/03/05 01:26 DEBUG:components_dir already exists in session state
2025/03/05 01:26 DEBUG:app_pages_dir already exists in session state
2025/03/05 01:26 DEBUG:utils_dir already exists in session state
2025/03/05 01:26 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 01:26 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 01:26 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 01:26 DEBUG:donor_map_fname already exists in session state
2025/03/05 01:26 DEBUG:politician_party_fname already exists in session state
2025/03/05 01:26 DEBUG:regentity_map_fname already exists in session state
2025/03/05 01:26 DEBUG:original_data_fname already exists in session state
2025/03/05 01:26 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 01:26 DEBUG:TEXT_FILE already exists in session state
2025/03/05 01:26 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 01:26 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 01:26 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 01:26 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 01:26 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 01:26 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 01:26 DEBUG:party_summary_fname already exists in session state
2025/03/05 01:26 DEBUG:imported_raw_fname already exists in session state
2025/03/05 01:26 DEBUG:source_data_fname already exists in session state
2025/03/05 01:26 DEBUG:Cash_ftr already exists in session state
2025/03/05 01:26 INFO:Session_state variables initialized
2025/03/05 01:26 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:26 DEBUG:menu_selection: {'title': 'Cash Donations per Entity', 'function': <function mod_cash_donations_per_entity_page at 0x000001EFD60A4E50>}
2025/03/05 01:26 DEBUG:reference_dir: reference_files
2025/03/05 01:26 DEBUG:data_dir: data
2025/03/05 01:26 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 01:26 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:26 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 01:26 DEBUG:Cash_ftr: None
2025/03/05 01:26 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:26 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:26 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:26 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:26 DEBUG:output_dir: output
2025/03/05 01:26 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 01:26 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 01:26 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:26 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 01:26 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 01:26 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:26 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:26 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 01:26 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:26 DEBUG:app_pages_dir: app_pages
2025/03/05 01:26 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 01:26 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:26 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 01:26 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 01:26 DEBUG:LOG_LEVEL: ERROR
2025/03/05 01:26 DEBUG:components_dir: components
2025/03/05 01:26 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:26 DEBUG:utils_dir: utils
2025/03/05 01:26 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 01:26 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 01:26 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:26 DEBUG:perc_target: 0.5
2025/03/05 01:26 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 01:26 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:26 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 01:26 DEBUG:logs_dir: logs
2025/03/05 01:26 INFO:Session state Setup complete
2025/03/05 01:26 INFO:initialize_session_state executed successfully
2025/03/05 01:26 INFO:Package setup complete
2025/03/05 01:26 INFO:setup_package executed successfully
2025/03/05 01:26 INFO:Setup completed successfully.
2025/03/05 01:26 INFO:Running Menu setup...
2025/03/05 01:26 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 01:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:26 INFO:get_git_version executed successfully
2025/03/05 01:26 INFO:App Version: v20.166
2025/03/05 01:26 INFO:Switched to page: Cash Donations per Entity
2025/03/05 01:26 DEBUG:Calling display_per_group_data_page with args={args}, kwargs={kwargs}
2025/03/05 01:26 DEBUG:Calling load_and_filter_pergroup with args={args}, kwargs={kwargs}
2025/03/05 01:26 ERROR:Error in load_and_filter_pergroup: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 370, in load_and_filter_pergroup
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/05 01:26 CRITICAL:Menu setup crashed: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 97, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\app_pages\mod_page_calls.py", line 154, in mod_cash_donations_per_entity_page
    display_per_group_data_page(filter_key="CashDonations_ftr",
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\modular_page_per_donor.py", line 31, in display_per_group_data_page
    ) = load_and_filter_pergroup(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 370, in load_and_filter_pergroup
    cleaned_df = st.session_state["data_clean"]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'
2025/03/05 01:26 INFO:Streamlit App Starting...
2025/03/05 01:26 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 01:26 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 01:26 INFO:Running App setup...
2025/03/05 01:26 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 01:26 INFO:Setting up the package
2025/03/05 01:26 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 01:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:26 INFO:get_git_version executed successfully
2025/03/05 01:26 INFO:Version: v20.145
2025/03/05 01:26 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 01:26 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:26 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 01:26 DEBUG:BASE_DIR already exists in session state
2025/03/05 01:26 DEBUG:filenames already exists in session state
2025/03/05 01:26 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 01:26 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 01:26 DEBUG:thresholds already exists in session state
2025/03/05 01:26 DEBUG:data_remappings already exists in session state
2025/03/05 01:26 DEBUG:filter_def already exists in session state
2025/03/05 01:26 DEBUG:security already exists in session state
2025/03/05 01:26 DEBUG:perc_target already exists in session state
2025/03/05 01:26 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 01:26 DEBUG:directories already exists in session state
2025/03/05 01:26 DEBUG:reference_dir already exists in session state
2025/03/05 01:26 DEBUG:data_dir already exists in session state
2025/03/05 01:26 DEBUG:output_dir already exists in session state
2025/03/05 01:26 DEBUG:logs_dir already exists in session state
2025/03/05 01:26 DEBUG:components_dir already exists in session state
2025/03/05 01:26 DEBUG:app_pages_dir already exists in session state
2025/03/05 01:26 DEBUG:utils_dir already exists in session state
2025/03/05 01:26 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 01:26 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 01:26 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 01:26 DEBUG:donor_map_fname already exists in session state
2025/03/05 01:26 DEBUG:politician_party_fname already exists in session state
2025/03/05 01:26 DEBUG:regentity_map_fname already exists in session state
2025/03/05 01:26 DEBUG:original_data_fname already exists in session state
2025/03/05 01:26 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 01:26 DEBUG:TEXT_FILE already exists in session state
2025/03/05 01:26 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 01:26 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 01:26 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 01:26 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 01:26 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 01:26 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 01:26 DEBUG:party_summary_fname already exists in session state
2025/03/05 01:26 DEBUG:imported_raw_fname already exists in session state
2025/03/05 01:26 DEBUG:source_data_fname already exists in session state
2025/03/05 01:26 DEBUG:Cash_ftr already exists in session state
2025/03/05 01:26 INFO:Session_state variables initialized
2025/03/05 01:26 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:26 DEBUG:menu_selection: {'title': 'Head Line Figures', 'function': <function hlf_body at 0x000001EFD608BA30>}
2025/03/05 01:26 DEBUG:reference_dir: reference_files
2025/03/05 01:26 DEBUG:data_dir: data
2025/03/05 01:26 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 01:26 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:26 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 01:26 DEBUG:Cash_ftr: None
2025/03/05 01:26 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:26 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:26 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:26 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:26 DEBUG:output_dir: output
2025/03/05 01:26 DEBUG:error_logged: True
2025/03/05 01:26 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 01:26 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 01:26 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:26 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 01:26 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 01:26 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:26 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:26 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 01:26 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:26 DEBUG:app_pages_dir: app_pages
2025/03/05 01:26 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 01:26 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:26 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 01:26 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 01:26 DEBUG:LOG_LEVEL: ERROR
2025/03/05 01:26 DEBUG:components_dir: components
2025/03/05 01:26 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:26 DEBUG:utils_dir: utils
2025/03/05 01:26 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 01:26 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 01:26 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:26 DEBUG:perc_target: 0.5
2025/03/05 01:26 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 01:26 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:26 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 01:26 DEBUG:logs_dir: logs
2025/03/05 01:26 INFO:Session state Setup complete
2025/03/05 01:26 INFO:initialize_session_state executed successfully
2025/03/05 01:26 INFO:Package setup complete
2025/03/05 01:26 INFO:setup_package executed successfully
2025/03/05 01:26 INFO:Setup completed successfully.
2025/03/05 01:26 INFO:Running Menu setup...
2025/03/05 01:26 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 01:26 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:26 INFO:get_git_version executed successfully
2025/03/05 01:26 INFO:App Version: v20.166
2025/03/05 01:26 INFO:Switched to page: Head Line Figures
2025/03/05 01:26 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 01:26 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 01:26 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 97, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 01:27 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 INFO:Streamlit App Starting...
2025/03/05 01:27 INFO:Streamlit App Starting...
2025/03/05 01:27 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 01:27 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 01:27 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 01:27 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 01:27 INFO:Running App setup...
2025/03/05 01:27 INFO:Running App setup...
2025/03/05 01:27 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Setting up the package
2025/03/05 01:27 INFO:Setting up the package
2025/03/05 01:27 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 01:27 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 INFO:Version: v20.145
2025/03/05 01:27 INFO:Version: v20.145
2025/03/05 01:27 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:27 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 01:27 DEBUG:Initialised LOG_LEVEL with value: ERROR
2025/03/05 01:27 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:Initialised BASE_DIR with value: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:27 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:27 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 01:27 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/05 01:27 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 01:27 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/05 01:27 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:27 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:27 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:27 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:27 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:27 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:27 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:27 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:27 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 01:27 DEBUG:Initialised perc_target with value: 0.5
2025/03/05 01:27 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 01:27 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/05 01:27 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:27 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:27 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 01:27 DEBUG:Initialised reference_dir with value: reference_files
2025/03/05 01:27 DEBUG:Initialised data_dir with value: data
2025/03/05 01:27 DEBUG:Initialised data_dir with value: data
2025/03/05 01:27 DEBUG:Initialised output_dir with value: output
2025/03/05 01:27 DEBUG:Initialised output_dir with value: output
2025/03/05 01:27 DEBUG:Initialised logs_dir with value: logs
2025/03/05 01:27 DEBUG:Initialised logs_dir with value: logs
2025/03/05 01:27 DEBUG:Initialised components_dir with value: components
2025/03/05 01:27 DEBUG:Initialised components_dir with value: components
2025/03/05 01:27 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 01:27 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/05 01:27 DEBUG:Initialised utils_dir with value: utils
2025/03/05 01:27 DEBUG:Initialised utils_dir with value: utils
2025/03/05 01:27 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:27 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:27 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:27 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:27 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 01:27 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/05 01:27 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:27 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:27 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:27 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:27 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:27 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:27 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 01:27 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/05 01:27 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 01:27 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/05 01:27 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 01:27 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/05 01:27 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 01:27 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/05 01:27 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 01:27 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/05 01:27 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 01:27 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/05 01:27 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 01:27 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/05 01:27 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 01:27 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/05 01:27 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 01:27 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/05 01:27 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 01:27 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/05 01:27 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 01:27 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/05 01:27 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 DEBUG:Initialised Cash_ftr with value: None
2025/03/05 01:27 DEBUG:Initialised Cash_ftr with value: None
2025/03/05 01:27 INFO:Session_state variables initialized
2025/03/05 01:27 INFO:Session_state variables initialized
2025/03/05 01:27 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 01:27 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 01:27 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 01:27 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 01:27 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 01:27 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 01:27 DEBUG:Cash_ftr: None
2025/03/05 01:27 DEBUG:Cash_ftr: None
2025/03/05 01:27 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 01:27 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 01:27 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 01:27 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 01:27 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 01:27 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 01:27 DEBUG:utils_dir: utils
2025/03/05 01:27 DEBUG:utils_dir: utils
2025/03/05 01:27 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 01:27 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 01:27 DEBUG:output_dir: output
2025/03/05 01:27 DEBUG:output_dir: output
2025/03/05 01:27 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:27 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:27 DEBUG:logs_dir: logs
2025/03/05 01:27 DEBUG:logs_dir: logs
2025/03/05 01:27 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:27 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:27 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:27 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:27 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:27 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:27 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 01:27 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 01:27 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 DEBUG:perc_target: 0.5
2025/03/05 01:27 DEBUG:perc_target: 0.5
2025/03/05 01:27 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:27 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:27 DEBUG:components_dir: components
2025/03/05 01:27 DEBUG:components_dir: components
2025/03/05 01:27 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:27 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:27 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:27 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:27 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 01:27 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 01:27 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:27 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:27 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:27 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:27 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 01:27 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 01:27 DEBUG:LOG_LEVEL: ERROR
2025/03/05 01:27 DEBUG:LOG_LEVEL: ERROR
2025/03/05 01:27 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:27 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:27 DEBUG:reference_dir: reference_files
2025/03/05 01:27 DEBUG:reference_dir: reference_files
2025/03/05 01:27 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:27 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:27 DEBUG:app_pages_dir: app_pages
2025/03/05 01:27 DEBUG:app_pages_dir: app_pages
2025/03/05 01:27 DEBUG:data_dir: data
2025/03/05 01:27 DEBUG:data_dir: data
2025/03/05 01:27 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:27 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:27 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 01:27 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 01:27 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 01:27 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 01:27 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 01:27 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 01:27 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 01:27 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 01:27 INFO:Session state Setup complete
2025/03/05 01:27 INFO:Session state Setup complete
2025/03/05 01:27 INFO:initialize_session_state executed successfully
2025/03/05 01:27 INFO:initialize_session_state executed successfully
2025/03/05 01:27 INFO:Package setup complete
2025/03/05 01:27 INFO:Package setup complete
2025/03/05 01:27 INFO:setup_package executed successfully
2025/03/05 01:27 INFO:setup_package executed successfully
2025/03/05 01:27 INFO:Setup completed successfully.
2025/03/05 01:27 INFO:Setup completed successfully.
2025/03/05 01:27 INFO:Running Menu setup...
2025/03/05 01:27 INFO:Running Menu setup...
2025/03/05 01:27 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 INFO:App Version: v20.166
2025/03/05 01:27 INFO:App Version: v20.166
2025/03/05 01:27 INFO:Switched to page: Head Line Figures
2025/03/05 01:27 INFO:Switched to page: Introduction
2025/03/05 01:27 DEBUG:Calling hlf_body with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 01:27 INFO:pagesetup executed successfully
2025/03/05 01:27 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 97, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\dashboard_demo-1\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 27, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\components\modular_page_blocks.py", line 24, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/05 01:27 INFO:Menu setup completed successfully.
2025/03/05 01:27 INFO:No data found in session state, running firstload()
2025/03/05 01:27 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Running first load function.
2025/03/05 01:27 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/05 01:27 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/05 01:27 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 INFO:Saved file path: output\imported_raw.csv
2025/03/05 01:27 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 01:27 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 INFO:get_file_modification_time executed successfully
2025/03/05 01:27 INFO:Current modification time: 1740757862.6744745
2025/03/05 01:27 INFO:Last modification time: 1741174708.2435687
2025/03/05 01:27 INFO:is_file_updated executed successfully
2025/03/05 01:27 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741174708.2435687 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 INFO:Importing file from output\imported_raw.csv
2025/03/05 01:27 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 01:27 INFO:Preprocessed data loaded successfully.
2025/03/05 01:27 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Cleaning up raw data
2025/03/05 01:27 ERROR:Session state variables not initialized!
2025/03/05 01:27 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Original file path: None
2025/03/05 01:27 INFO:Saved file path: output\cleaned_donations.csv
2025/03/05 01:27 ERROR:Error: originalfilepath is None!
2025/03/05 01:27 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 01:27 INFO:Data loaded, shape: (65278, 29)
2025/03/05 01:27 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/05 01:27 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 01:27 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/05 01:27 INFO:File deduplication complete, shape: (65278, 33)
2025/03/05 01:27 INFO:dedupe_entity_file executed successfully
2025/03/05 01:27 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/05 01:27 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/05 01:27 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/05 01:27 INFO:File deduplication complete, shape: (65278, 37)
2025/03/05 01:27 INFO:dedupe_entity_file executed successfully
2025/03/05 01:27 INFO:Raw Data cleanup completed
2025/03/05 01:27 INFO:Data shape: (65278, 37)
2025/03/05 01:27 INFO:Data saved to output\cleaned_donations.csv
2025/03/05 01:27 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/05 01:27 INFO:raw_data_cleanup executed successfully
2025/03/05 01:27 INFO:load_raw_data executed successfully
2025/03/05 01:27 INFO:get_raw_data executed successfully
2025/03/05 01:27 DEBUG:st.session_state.raw_data: 65278
2025/03/05 01:27 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Rows in Raw Data: 65278
2025/03/05 01:27 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Original file path: output\cleaned_donations.csv
2025/03/05 01:27 INFO:Saved file path: output\cleaned_data.csv
2025/03/05 01:27 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/05 01:27 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/05 01:27 INFO:get_file_modification_time executed successfully
2025/03/05 01:27 INFO:Current modification time: 1741181244.7779672
2025/03/05 01:27 INFO:Last modification time: 1741174708.2435687
2025/03/05 01:27 INFO:is_file_updated executed successfully
2025/03/05 01:27 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 01:27 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/05 01:27 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/05 01:27 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/05 01:27 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/05 01:27 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Loaded politician_party_dict:    RegulatedEntityId  RegulatedEntityId     PartyName
0               6304               6304  Conservative
1               6423               6423  Conservative
2               1425               1425  Conservative
3               2061               2061  Conservative
4               6417               6417       Unknown
2025/03/05 01:27 DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/05 01:27 DEBUG:Updated loaddata_df with PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/05 01:27 DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/05 01:27 DEBUG:loaddata_df after merging:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909      <NA>  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908      <NA>  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908      <NA>  8015.0

[5 rows x 43 columns]
2025/03/05 01:27 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/05 01:27 ERROR:Attempting to remove duplicates
2025/03/05 01:27 DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived    PartyName PartyId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909  Andy Street  8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908  Andy Street  8015.0

[5 rows x 43 columns]
2025/03/05 01:27 DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/05 01:27 INFO:Data Updated with PartyName and PartyId successfully
2025/03/05 01:27 INFO:map_mp_to_party executed successfully
2025/03/05 01:27 DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/05 01:27 DEBUG:Group assignment: group
RegulatedEntityName       53528
Small Medium Entity        4430
Small Entity               2251
Very Small Entity          1492
Medium Large Entity        1203
Large Entity               1194
Medium Entity               694
Single Donation Entity      486
Name: count, dtype: int64
2025/03/05 01:27 DEBUG:Group assignment: group
Very Small Entity         491
Single Donation Entity    486
Small Entity              241
Small Medium Entity       127
Medium Entity               5
RegulatedEntityName         5
Medium Large Entity         4
Large Entity                2
Name: count, dtype: int64
2025/03/05 01:27 DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/05 01:27 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:27 DEBUG:try to load previous election dates from file.
2025/03/05 01:27 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 INFO:Saved file path: reference_files\elections.csv
2025/03/05 01:27 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/05 01:27 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 INFO:get_file_modification_time executed successfully
2025/03/05 01:27 INFO:Current modification time: 1740757862.6744745
2025/03/05 01:27 INFO:Last modification time: 1740757862.6744745
2025/03/05 01:27 INFO:is_file_updated executed successfully
2025/03/05 01:27 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1740757862.6744745 instead of source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 INFO:Importing file from reference_files\elections.csv
2025/03/05 01:27 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/05 01:27 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 01:27 ERROR:Failed to load election dates from file.
2025/03/05 01:27 INFO:Election_dates_df empty - loading from pdpy.
2025/03/05 01:27 INFO:Election Dates loaded vis pdpy.
2025/03/05 01:27 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/05 01:27 INFO:Election Dates Loaded Successfully.
2025/03/05 01:27 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 01:27 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 01:27 INFO:load_election_dates executed successfully
2025/03/05 01:27 DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/05 01:27 DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/05 01:27 INFO:Cleaned Data completed, shape: (65278, 57)
2025/03/05 01:27 INFO:load_cleaned_data executed successfully
2025/03/05 01:27 INFO:get_cleaned_data executed successfully
2025/03/05 01:27 DEBUG:st.session_state.raw_data: 65278
2025/03/05 01:27 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Original file path: output\cleaned_data.csv
2025/03/05 01:27 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/05 01:27 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 01:27 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 01:27 INFO:get_file_modification_time executed successfully
2025/03/05 01:27 INFO:Current modification time: 1741181249.6606314
2025/03/05 01:27 INFO:Last modification time: 1741174713.2652059
2025/03/05 01:27 INFO:is_file_updated executed successfully
2025/03/05 01:27 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 01:27 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/05 01:27 INFO:Donor Data summary completed
2025/03/05 01:27 INFO:Data shape: (25576, 5)
2025/03/05 01:27 INFO:load_donorList_data executed successfully
2025/03/05 01:27 INFO:get_donor_data executed successfully
2025/03/05 01:27 DEBUG:st.session_state.data_donor: 25576
2025/03/05 01:27 DEBUG:st.session_state.data_clean: 65278
2025/03/05 01:27 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Original file path: output\cleaned_data.csv
2025/03/05 01:27 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/05 01:27 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/05 01:27 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Getting modification time for output\cleaned_data.csv
2025/03/05 01:27 INFO:get_file_modification_time executed successfully
2025/03/05 01:27 INFO:Current modification time: 1741181249.6606314
2025/03/05 01:27 INFO:Last modification time: 1741181249.6606314
2025/03/05 01:27 INFO:is_file_updated executed successfully
2025/03/05 01:27 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741181249.6606314 instead of output\cleaned_data.csv
2025/03/05 01:27 INFO:Importing file from output\cleaned_regentity.csv
2025/03/05 01:27 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/05 01:27 INFO:try_to_use_preprocessed_data executed successfully
2025/03/05 01:27 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025/03/05 01:27 INFO:Raw Data cleanup completed
2025/03/05 01:27 INFO:Data shape: (2150, 6)
2025/03/05 01:27 INFO:load_regulated_entity_data executed successfully
2025/03/05 01:27 INFO:get_regentity_data executed successfully
2025/03/05 01:27 DEBUG:st.session_state.data_regentity: 2150
2025/03/05 01:27 DEBUG:st.session_state.data_donor: 25576
2025/03/05 01:27 DEBUG:st.session_state.data_clean: 65278
2025/03/05 01:27 INFO:firstload executed successfully
2025/03/05 01:27 INFO:Data first load completed successfully.
2025/03/05 01:27 INFO:initialise_data executed successfully
2025/03/05 01:27 INFO:App is fully loaded and ready!
2025/03/05 01:27 INFO:Streamlit App Starting...
2025/03/05 01:27 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 01:27 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 01:27 INFO:Running App setup...
2025/03/05 01:27 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:Setting up the package
2025/03/05 01:27 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 INFO:Version: v20.145
2025/03/05 01:27 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 01:27 DEBUG:BASE_DIR already exists in session state
2025/03/05 01:27 DEBUG:filenames already exists in session state
2025/03/05 01:27 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 01:27 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 01:27 DEBUG:thresholds already exists in session state
2025/03/05 01:27 DEBUG:data_remappings already exists in session state
2025/03/05 01:27 DEBUG:filter_def already exists in session state
2025/03/05 01:27 DEBUG:security already exists in session state
2025/03/05 01:27 DEBUG:perc_target already exists in session state
2025/03/05 01:27 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 01:27 DEBUG:directories already exists in session state
2025/03/05 01:27 DEBUG:reference_dir already exists in session state
2025/03/05 01:27 DEBUG:data_dir already exists in session state
2025/03/05 01:27 DEBUG:output_dir already exists in session state
2025/03/05 01:27 DEBUG:logs_dir already exists in session state
2025/03/05 01:27 DEBUG:components_dir already exists in session state
2025/03/05 01:27 DEBUG:app_pages_dir already exists in session state
2025/03/05 01:27 DEBUG:utils_dir already exists in session state
2025/03/05 01:27 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 01:27 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 01:27 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 01:27 DEBUG:donor_map_fname already exists in session state
2025/03/05 01:27 DEBUG:politician_party_fname already exists in session state
2025/03/05 01:27 DEBUG:regentity_map_fname already exists in session state
2025/03/05 01:27 DEBUG:original_data_fname already exists in session state
2025/03/05 01:27 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 01:27 DEBUG:TEXT_FILE already exists in session state
2025/03/05 01:27 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 01:27 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 01:27 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 01:27 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 01:27 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 01:27 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 01:27 DEBUG:party_summary_fname already exists in session state
2025/03/05 01:27 DEBUG:imported_raw_fname already exists in session state
2025/03/05 01:27 DEBUG:source_data_fname already exists in session state
2025/03/05 01:27 DEBUG:Cash_ftr already exists in session state
2025/03/05 01:27 INFO:Session_state variables initialized
2025/03/05 01:27 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 01:27 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 01:27 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 01:27 DEBUG:load_donorlist_data_last_modified: 1741181249.6606314
2025/03/05 01:27 DEBUG:Cash_ftr: None
2025/03/05 01:27 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 01:27 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 01:27 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 01:27 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 01:27 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 01:27 DEBUG:utils_dir: utils
2025/03/05 01:27 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 01:27 DEBUG:output_dir: output
2025/03/05 01:27 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:27 DEBUG:logs_dir: logs
2025/03/05 01:27 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:27 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:27 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:27 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 01:27 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 01:27 DEBUG:menu_selection: {'title': 'Cash Donations', 'function': <function mod_cash_donations_page at 0x0000023239CE04C0>}
2025/03/05 01:27 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:27 DEBUG:perc_target: 0.5
2025/03/05 01:27 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:27 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:27 DEBUG:components_dir: components
2025/03/05 01:27 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:27 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:27 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 01:27 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:27 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:27 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 01:27 DEBUG:load_raw_data_last_modified: 1741181244.7779672
2025/03/05 01:27 DEBUG:LOG_LEVEL: ERROR
2025/03/05 01:27 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:27 DEBUG:reference_dir: reference_files
2025/03/05 01:27 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 01:27 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:27 DEBUG:app_pages_dir: app_pages
2025/03/05 01:27 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 01:27 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 01:27 DEBUG:data_dir: data
2025/03/05 01:27 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:27 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 01:27 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 01:27 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 01:27 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 01:27 INFO:Session state Setup complete
2025/03/05 01:27 INFO:initialize_session_state executed successfully
2025/03/05 01:27 INFO:Package setup complete
2025/03/05 01:27 INFO:setup_package executed successfully
2025/03/05 01:27 INFO:Setup completed successfully.
2025/03/05 01:27 INFO:Running Menu setup...
2025/03/05 01:27 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:get_git_version executed successfully
2025/03/05 01:27 INFO:App Version: v20.166
2025/03/05 01:27 INFO:Switched to page: Cash Donations
2025/03/05 01:27 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:load_and_filter_data executed successfully
2025/03/05 01:27 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:display_summary_statistics executed successfully
2025/03/05 01:27 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:display_textual_insights executed successfully
2025/03/05 01:27 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 01:27 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:plot_bar_line_by_year executed successfully
2025/03/05 01:27 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 01:27 INFO:plot_bar_line_by_year executed successfully
2025/03/05 01:27 INFO:display_visualizations executed successfully
2025/03/05 01:27 INFO:display_data_page executed successfully
2025/03/05 01:27 INFO:pagesetup executed successfully
2025/03/05 01:27 INFO:Menu setup completed successfully.
2025/03/05 01:27 INFO:Data already loaded in session state.
2025/03/05 01:27 INFO:App is fully loaded and ready!
2025/03/05 01:28 INFO:Streamlit App Starting...
2025/03/05 01:28 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 01:28 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 01:28 INFO:Running App setup...
2025/03/05 01:28 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:Setting up the package
2025/03/05 01:28 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 01:28 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:get_git_version executed successfully
2025/03/05 01:28 INFO:Version: v20.145
2025/03/05 01:28 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:28 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 01:28 DEBUG:BASE_DIR already exists in session state
2025/03/05 01:28 DEBUG:filenames already exists in session state
2025/03/05 01:28 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 01:28 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 01:28 DEBUG:thresholds already exists in session state
2025/03/05 01:28 DEBUG:data_remappings already exists in session state
2025/03/05 01:28 DEBUG:filter_def already exists in session state
2025/03/05 01:28 DEBUG:security already exists in session state
2025/03/05 01:28 DEBUG:perc_target already exists in session state
2025/03/05 01:28 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 01:28 DEBUG:directories already exists in session state
2025/03/05 01:28 DEBUG:reference_dir already exists in session state
2025/03/05 01:28 DEBUG:data_dir already exists in session state
2025/03/05 01:28 DEBUG:output_dir already exists in session state
2025/03/05 01:28 DEBUG:logs_dir already exists in session state
2025/03/05 01:28 DEBUG:components_dir already exists in session state
2025/03/05 01:28 DEBUG:app_pages_dir already exists in session state
2025/03/05 01:28 DEBUG:utils_dir already exists in session state
2025/03/05 01:28 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 01:28 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 01:28 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 01:28 DEBUG:donor_map_fname already exists in session state
2025/03/05 01:28 DEBUG:politician_party_fname already exists in session state
2025/03/05 01:28 DEBUG:regentity_map_fname already exists in session state
2025/03/05 01:28 DEBUG:original_data_fname already exists in session state
2025/03/05 01:28 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 01:28 DEBUG:TEXT_FILE already exists in session state
2025/03/05 01:28 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 01:28 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 01:28 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 01:28 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 01:28 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 01:28 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 01:28 DEBUG:party_summary_fname already exists in session state
2025/03/05 01:28 DEBUG:imported_raw_fname already exists in session state
2025/03/05 01:28 DEBUG:source_data_fname already exists in session state
2025/03/05 01:28 DEBUG:Cash_ftr already exists in session state
2025/03/05 01:28 INFO:Session_state variables initialized
2025/03/05 01:28 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 01:28 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 01:28 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 01:28 DEBUG:load_donorlist_data_last_modified: 1741181249.6606314
2025/03/05 01:28 DEBUG:Cash_ftr: None
2025/03/05 01:28 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 01:28 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 01:28 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 01:28 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 01:28 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 01:28 DEBUG:utils_dir: utils
2025/03/05 01:28 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 01:28 DEBUG:min_date: 2001-01-01
2025/03/05 01:28 DEBUG:output_dir: output
2025/03/05 01:28 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:28 DEBUG:logs_dir: logs
2025/03/05 01:28 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:28 DEBUG:max_date: 2019-09-02
2025/03/05 01:28 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:28 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:28 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 01:28 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 01:28 DEBUG:menu_selection: {'title': 'Public Fund Donations', 'function': <function mod_publicfund_donations_page at 0x0000023239CE0820>}
2025/03/05 01:28 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:28 DEBUG:perc_target: 0.5
2025/03/05 01:28 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:28 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:28 DEBUG:components_dir: components
2025/03/05 01:28 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:28 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:28 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 01:28 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:28 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:28 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 01:28 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 01:28 DEBUG:load_raw_data_last_modified: 1741181244.7779672
2025/03/05 01:28 DEBUG:LOG_LEVEL: ERROR
2025/03/05 01:28 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:28 DEBUG:reference_dir: reference_files
2025/03/05 01:28 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 01:28 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:28 DEBUG:app_pages_dir: app_pages
2025/03/05 01:28 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 01:28 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 01:28 DEBUG:data_dir: data
2025/03/05 01:28 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:28 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 01:28 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 01:28 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 01:28 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 01:28 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 01:28 INFO:Session state Setup complete
2025/03/05 01:28 INFO:initialize_session_state executed successfully
2025/03/05 01:28 INFO:Package setup complete
2025/03/05 01:28 INFO:setup_package executed successfully
2025/03/05 01:28 INFO:Setup completed successfully.
2025/03/05 01:28 INFO:Running Menu setup...
2025/03/05 01:28 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 01:28 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:get_git_version executed successfully
2025/03/05 01:28 INFO:App Version: v20.166
2025/03/05 01:28 INFO:Switched to page: Public Fund Donations
2025/03/05 01:28 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 01:28 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:load_and_filter_data executed successfully
2025/03/05 01:28 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:display_summary_statistics executed successfully
2025/03/05 01:28 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:display_textual_insights executed successfully
2025/03/05 01:28 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 01:28 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:plot_bar_line_by_year executed successfully
2025/03/05 01:28 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:plot_bar_line_by_year executed successfully
2025/03/05 01:28 INFO:display_visualizations executed successfully
2025/03/05 01:28 INFO:display_data_page executed successfully
2025/03/05 01:28 INFO:pagesetup executed successfully
2025/03/05 01:28 INFO:Menu setup completed successfully.
2025/03/05 01:28 INFO:Data already loaded in session state.
2025/03/05 01:28 INFO:App is fully loaded and ready!
2025/03/05 01:28 INFO:Streamlit App Starting...
2025/03/05 01:28 INFO:Current Working Directory: H:\VScode\dashboard_demo-1
2025/03/05 01:28 INFO:running H:\VScode\dashboard_demo-1, H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py
2025/03/05 01:28 INFO:Running App setup...
2025/03/05 01:28 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:Setting up the package
2025/03/05 01:28 INFO:Module directory: H:\VScode\dashboard_demo-1
2025/03/05 01:28 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:get_git_version executed successfully
2025/03/05 01:28 INFO:Version: v20.145
2025/03/05 01:28 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:28 DEBUG:LOG_LEVEL already exists in session state
2025/03/05 01:28 DEBUG:BASE_DIR already exists in session state
2025/03/05 01:28 DEBUG:filenames already exists in session state
2025/03/05 01:28 DEBUG:PLACEHOLDER_DATE already exists in session state
2025/03/05 01:28 DEBUG:PLACEHOLDER_ID already exists in session state
2025/03/05 01:28 DEBUG:thresholds already exists in session state
2025/03/05 01:28 DEBUG:data_remappings already exists in session state
2025/03/05 01:28 DEBUG:filter_def already exists in session state
2025/03/05 01:28 DEBUG:security already exists in session state
2025/03/05 01:28 DEBUG:perc_target already exists in session state
2025/03/05 01:28 DEBUG:RERUN_MP_PARTY_MEMBERSHIP already exists in session state
2025/03/05 01:28 DEBUG:directories already exists in session state
2025/03/05 01:28 DEBUG:reference_dir already exists in session state
2025/03/05 01:28 DEBUG:data_dir already exists in session state
2025/03/05 01:28 DEBUG:output_dir already exists in session state
2025/03/05 01:28 DEBUG:logs_dir already exists in session state
2025/03/05 01:28 DEBUG:components_dir already exists in session state
2025/03/05 01:28 DEBUG:app_pages_dir already exists in session state
2025/03/05 01:28 DEBUG:utils_dir already exists in session state
2025/03/05 01:28 DEBUG:Donor_dedupe_cleaned_fname already exists in session state
2025/03/05 01:28 DEBUG:ListofPoliticalPeople_fname already exists in session state
2025/03/05 01:28 DEBUG:mppartymemb_fname already exists in session state
2025/03/05 01:28 DEBUG:donor_map_fname already exists in session state
2025/03/05 01:28 DEBUG:politician_party_fname already exists in session state
2025/03/05 01:28 DEBUG:regentity_map_fname already exists in session state
2025/03/05 01:28 DEBUG:original_data_fname already exists in session state
2025/03/05 01:28 DEBUG:CREDENTIALS_FILE already exists in session state
2025/03/05 01:28 DEBUG:TEXT_FILE already exists in session state
2025/03/05 01:28 DEBUG:ELECTION_DATES already exists in session state
2025/03/05 01:28 DEBUG:LAST_MODIFIED_DATES already exists in session state
2025/03/05 01:28 DEBUG:cleaned_data_fname already exists in session state
2025/03/05 01:28 DEBUG:cleaned_donations_fname already exists in session state
2025/03/05 01:28 DEBUG:cleaned_donorlist_fname already exists in session state
2025/03/05 01:28 DEBUG:cleaned_regentity_fname already exists in session state
2025/03/05 01:28 DEBUG:party_summary_fname already exists in session state
2025/03/05 01:28 DEBUG:imported_raw_fname already exists in session state
2025/03/05 01:28 DEBUG:source_data_fname already exists in session state
2025/03/05 01:28 DEBUG:Cash_ftr already exists in session state
2025/03/05 01:28 INFO:Session_state variables initialized
2025/03/05 01:28 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/05 01:28 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/05 01:28 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/05 01:28 DEBUG:load_donorlist_data_last_modified: 1741181249.6606314
2025/03/05 01:28 DEBUG:Cash_ftr: None
2025/03/05 01:28 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/05 01:28 DEBUG:data_donor:          DonorId                          Donor Name  Donations Value  Donation Events  Donation Mean
0            1.0    Joseph Rowntree Refrom Trust Ltd         53000.00                2   26500.000000
1            2.0    Birkenhead North End Labour Club        118680.84                2   59340.420000
2            3.0                Bord Institute Trust         26625.00                3    8875.000000
3            4.0        Branksome Liberal Club Trust         74495.89               14    5321.135000
4            5.0                    Bridgwater Trust          7700.00                3    2566.666667
...          ...                                 ...              ...              ...            ...
25571    87478.0                       Martin Thomas          3529.41                2    1764.705000
25572    87479.0                    Ishbel A Mcneill         11520.00                1   11520.000000
25573    87480.0                           Ann C Hay        157350.07                1  157350.070000
25574    87482.0  Glasgow Unionist Association Trust         50000.00                1   50000.000000
25575  1000001.0                  Unidentified Donor        697021.67               84    8297.877024

[25576 rows x 5 columns]
2025/03/05 01:28 DEBUG:data_clean:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ... QtrsTillNextElection QtrsSinceLastElection YrsTillNextElection YrsSinceLastElection
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...                  2.0                 363.0                 1.0                 91.0
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...                  2.0                 363.0                 1.0                 91.0
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...                  2.0                 363.0                 1.0                 91.0
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...                  2.0                 363.0                 1.0                 91.0
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...                  2.0                 363.0                 1.0                 91.0
...          ...                              ...                    ...        ...  ...                  ...                   ...                 ...                  ...
78740   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...                  5.0                 349.0                 2.0                 87.0
78741   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                  6.0                 348.0                 2.0                 87.0
78742   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                  4.0                 350.0                 1.0                 88.0
78743   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                  1.0                 354.0                 1.0                 89.0
78744   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                  1.0                 354.0                 1.0                 89.0

[65278 rows x 57 columns]
2025/03/05 01:28 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/05 01:28 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/05 01:28 DEBUG:utils_dir: utils
2025/03/05 01:28 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/05 01:28 DEBUG:min_date: 2001-01-01
2025/03/05 01:28 DEBUG:output_dir: output
2025/03/05 01:28 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/05 01:28 DEBUG:logs_dir: logs
2025/03/05 01:28 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/05 01:28 DEBUG:max_date: 2019-09-02
2025/03/05 01:28 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/dashboard_demo-1'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/05 01:28 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/05 01:28 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/05 01:28 DEBUG:raw_data:            ECRef      OriginalRegulatedEntityName    RegulatedEntityType      Value  ...                 CleanedDonorName CleanedDonorId  DonorId                        DonorName
0      NC0408174                   Mr Andy Street        Regulated Donee    1876.56  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
1      NC0408173                   Mr Andy Street        Regulated Donee    2700.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
2      NC0408177                   Mr Andy Street        Regulated Donee    4852.58  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
3      NC0408176                   Mr Andy Street        Regulated Donee    2500.00  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
4      NC0408170                   Mr Andy Street        Regulated Donee    4524.05  ...  Conservative And Unionist Party        86310.0  86310.0  Conservative And Unionist Party
...          ...                              ...                    ...        ...  ...                              ...            ...      ...                              ...
65273   C0242478               Vote Leave Limited  Permitted Participant   10000.00  ...      Shaftesbury Investments Ltd        74198.0  74198.0      Shaftesbury Investments Ltd
65274   C0242461               Vote Leave Limited  Permitted Participant  100000.00  ...                Mr Jeremy Hosking        74184.0  74184.0                Mr Jeremy Hosking
65275   C0243560               Vote Leave Limited  Permitted Participant   40000.00  ...                    Anthony Clake        23556.0  23556.0                    Anthony Clake
65276   C0319710  Conservative And Unionist Party        Political Party   50000.00  ...                Mr Peter A Dubens         2146.0   2146.0                Mr Peter A Dubens
65277   C0319727  Conservative And Unionist Party        Political Party   15000.00  ...                 Mr Ravi S Kailas        74743.0  74743.0                 Mr Ravi S Kailas

[65278 rows x 37 columns]
2025/03/05 01:28 DEBUG:menu_selection: {'title': 'Bequeths', 'function': <function mod_bequeths_page at 0x0000023239CC7D00>}
2025/03/05 01:28 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/05 01:28 DEBUG:perc_target: 0.5
2025/03/05 01:28 DEBUG:BASE_DIR: H:\VScode\dashboard_demo-1
2025/03/05 01:28 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/05 01:28 DEBUG:components_dir: components
2025/03/05 01:28 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/05 01:28 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/05 01:28 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/05 01:28 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/05 01:28 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/05 01:28 DEBUG:year_slider_rightfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 01:28 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/05 01:28 DEBUG:load_raw_data_last_modified: 1741181244.7779672
2025/03/05 01:28 DEBUG:LOG_LEVEL: ERROR
2025/03/05 01:28 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/05 01:28 DEBUG:reference_dir: reference_files
2025/03/05 01:28 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/05 01:28 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/05 01:28 DEBUG:app_pages_dir: app_pages
2025/03/05 01:28 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/05 01:28 DEBUG:data_regentity:       RegulatedEntityId                Regulated Entity Name  Regulated Entity Group  Donations Value  Donation Events  Donation Mean
0                  17.0                    English Democrats     Medium Large Entity          5000.00                1        5000.00
1                  17.0                    English Democrats     RegulatedEntityName         90000.00                9       10000.00
2                  17.0                    English Democrats            Small Entity          4000.00                1        4000.00
3                  19.0           Legalise Cannabis Alliance     Medium Large Entity          1500.00                1        1500.00
4                  19.0           Legalise Cannabis Alliance     RegulatedEntityName          5200.00                1        5200.00
...                 ...                                  ...                     ...              ...              ...            ...
2145            10264.0                        Robert Largan     Small Medium Entity          2000.00                1        2000.00
2146            10265.0                           Jane Dodds     RegulatedEntityName          1764.70                1        1764.70
2147            10265.0                           Jane Dodds            Small Entity          1764.71                1        1764.71
2148            10266.0                          Phil Wilson  Single Donation Entity          2000.00                1        2000.00
2149            10267.0  Scottish Unionist Association Trust     RegulatedEntityName        218870.07                3       72956.69

[2150 rows x 6 columns]
2025/03/05 01:28 DEBUG:data_dir: data
2025/03/05 01:28 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/05 01:28 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/05 01:28 DEBUG:year_slider_leftfiltered_keytarget_label_vis: (2001, 2019)
2025/03/05 01:28 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/05 01:28 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/05 01:28 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/05 01:28 INFO:Session state Setup complete
2025/03/05 01:28 INFO:initialize_session_state executed successfully
2025/03/05 01:28 INFO:Package setup complete
2025/03/05 01:28 INFO:setup_package executed successfully
2025/03/05 01:28 INFO:Setup completed successfully.
2025/03/05 01:28 INFO:Running Menu setup...
2025/03/05 01:28 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/05 01:28 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:get_git_version executed successfully
2025/03/05 01:28 INFO:App Version: v20.166
2025/03/05 01:28 INFO:Switched to page: Bequeths
2025/03/05 01:28 DEBUG:Calling display_data_page with args={args}, kwargs={kwargs}
2025/03/05 01:28 DEBUG:Calling load_and_filter_data with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:load_and_filter_data executed successfully
2025/03/05 01:28 DEBUG:Calling display_summary_statistics with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:display_summary_statistics executed successfully
2025/03/05 01:28 DEBUG:Calling display_textual_insights with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:display_textual_insights executed successfully
2025/03/05 01:28 DEBUG:Calling display_visualizations with args={args}, kwargs={kwargs}
2025/03/05 01:28 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:plot_bar_line_by_year executed successfully
2025/03/05 01:28 DEBUG:Calling plot_bar_line_by_year with args={args}, kwargs={kwargs}
2025/03/05 01:28 INFO:plot_bar_line_by_year executed successfully
2025/03/05 01:28 INFO:display_visualizations executed successfully
2025/03/05 01:28 INFO:display_data_page executed successfully
2025/03/05 01:28 INFO:pagesetup executed successfully
2025/03/05 01:28 INFO:Menu setup completed successfully.
2025/03/05 01:28 INFO:Data already loaded in session state.
2025/03/05 01:28 INFO:App is fully loaded and ready!
