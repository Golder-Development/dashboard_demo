2025/03/06 08:02 CRITICAL:App setup crashed: module 'setup' has no attribute 'setup_package'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 36, in <module>
    setup.setup_package()
AttributeError: module 'setup' has no attribute 'setup_package'
2025/03/06 08:02 ERROR:Session state variables not initialized!
2025/03/06 08:02 ERROR:Error: originalfilepath is None!
2025/03/06 08:02 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:02 ERROR:No data found in session state! data.clean_and_enhance
2025/03/06 08:02 ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 78, in firstload
    logger.debug(f"st.session_state.raw_data: {len(st.session_state.data_clean)}")
TypeError: object of type 'NoneType' has no len()
2025/03/06 08:02 CRITICAL:First load crashed: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 78, in firstload
    logger.debug(f"st.session_state.raw_data: {len(st.session_state.data_clean)}")
TypeError: object of type 'NoneType' has no len()
2025/03/06 08:06 ERROR:Session state variables not initialized!
2025/03/06 08:06 ERROR:Error: originalfilepath is None!
2025/03/06 08:06 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:06 ERROR:No data found in session state! data.clean_and_enhance
2025/03/06 08:06 ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    f" {len(st.session_state.data_clean)}")
TypeError: object of type 'NoneType' has no len()
2025/03/06 08:06 CRITICAL:First load crashed: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    f" {len(st.session_state.data_clean)}")
TypeError: object of type 'NoneType' has no len()
2025/03/06 08:09 ERROR:Session state variables not initialized!
2025/03/06 08:09 ERROR:Error: originalfilepath is None!
2025/03/06 08:09 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:09 ERROR:No data found in session state! data.clean_and_enhance
2025/03/06 08:09 ERROR:Error in firstload: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    f" {len(st.session_state.data_clean)}")
TypeError: object of type 'NoneType' has no len()
2025/03/06 08:09 CRITICAL:First load crashed: object of type 'NoneType' has no len()
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 80, in firstload
    f" {len(st.session_state.data_clean)}")
TypeError: object of type 'NoneType' has no len()
2025/03/06 08:10 ERROR:Session state variables not initialized!
2025/03/06 08:10 ERROR:Error: originalfilepath is None!
2025/03/06 08:10 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:10 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 08:10 ERROR:Attempting to remove duplicates
2025/03/06 08:10 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 08:10 ERROR:Failed to load election dates from file.
2025/03/06 08:14 ERROR:Session state variables not initialized!
2025/03/06 08:14 ERROR:Error: originalfilepath is None!
2025/03/06 08:14 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:14 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 08:14 ERROR:Attempting to remove duplicates
2025/03/06 08:14 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 08:14 ERROR:Failed to load election dates from file.
2025/03/06 08:14 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 08:23 ERROR:Session state variables not initialized!
2025/03/06 08:23 ERROR:Error: originalfilepath is None!
2025/03/06 08:23 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:23 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 08:23 ERROR:Attempting to remove duplicates
2025/03/06 08:23 ERROR:Error in load_cleaned_data: 'int' object is not subscriptable
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 237, in load_cleaned_data
    loadclean_df["RegEntity_Group"] = calc.determine_groups_optimized(
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 422, in determine_groups_optimized
    entity_totals["group"] = entity_totals["total_measure"].apply(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 4924, in apply
    ).apply()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1427, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1507, in apply_standard
    mapped = obj._map_values(
  File "H:\python310\lib\site-packages\pandas\core\base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
  File "H:\python310\lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
  File "lib.pyx", line 2972, in pandas._libs.lib.map_infer
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 423, in <lambda>
    lambda row: assign_group(row["total_measure"], thresholds_dict, row[entity],axis=1)
TypeError: 'int' object is not subscriptable
2025/03/06 08:23 CRITICAL:First load crashed: 'int' object is not subscriptable
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 78, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 26, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 237, in load_cleaned_data
    loadclean_df["RegEntity_Group"] = calc.determine_groups_optimized(
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 422, in determine_groups_optimized
    entity_totals["group"] = entity_totals["total_measure"].apply(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 4924, in apply
    ).apply()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1427, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1507, in apply_standard
    mapped = obj._map_values(
  File "H:\python310\lib\site-packages\pandas\core\base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
  File "H:\python310\lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
  File "lib.pyx", line 2972, in pandas._libs.lib.map_infer
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 423, in <lambda>
    lambda row: assign_group(row["total_measure"], thresholds_dict, row[entity],axis=1)
TypeError: 'int' object is not subscriptable
2025/03/06 08:27 ERROR:Session state variables not initialized!
2025/03/06 08:27 ERROR:Error: originalfilepath is None!
2025/03/06 08:28 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:28 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 08:28 ERROR:Attempting to remove duplicates
2025/03/06 08:28 ERROR:Error in load_cleaned_data: determine_groups_optimized.<locals>.<lambda>() got an unexpected keyword argument 'axis'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 237, in load_cleaned_data
    loadclean_df["RegEntity_Group"] = calc.determine_groups_optimized(
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 422, in determine_groups_optimized
    entity_totals["group"] = entity_totals["total_measure"].apply(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 4924, in apply
    ).apply()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1427, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1507, in apply_standard
    mapped = obj._map_values(
  File "H:\python310\lib\site-packages\pandas\core\base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
  File "H:\python310\lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
  File "lib.pyx", line 2972, in pandas._libs.lib.map_infer
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1496, in curried
    return func(x, *self.args, **self.kwargs)
TypeError: determine_groups_optimized.<locals>.<lambda>() got an unexpected keyword argument 'axis'
2025/03/06 08:28 CRITICAL:First load crashed: determine_groups_optimized.<locals>.<lambda>() got an unexpected keyword argument 'axis'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 78, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 26, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 237, in load_cleaned_data
    loadclean_df["RegEntity_Group"] = calc.determine_groups_optimized(
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 422, in determine_groups_optimized
    entity_totals["group"] = entity_totals["total_measure"].apply(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 4924, in apply
    ).apply()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1427, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1507, in apply_standard
    mapped = obj._map_values(
  File "H:\python310\lib\site-packages\pandas\core\base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
  File "H:\python310\lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
  File "lib.pyx", line 2972, in pandas._libs.lib.map_infer
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1496, in curried
    return func(x, *self.args, **self.kwargs)
TypeError: determine_groups_optimized.<locals>.<lambda>() got an unexpected keyword argument 'axis'
2025/03/06 08:28 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:28 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 08:28 ERROR:Attempting to remove duplicates
2025/03/06 08:28 ERROR:Error in load_cleaned_data: determine_groups_optimized.<locals>.<lambda>() got an unexpected keyword argument 'axis'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 237, in load_cleaned_data
    loadclean_df["RegEntity_Group"] = calc.determine_groups_optimized(
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 422, in determine_groups_optimized
    entity_totals["group"] = entity_totals["total_measure"].apply(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 4924, in apply
    ).apply()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1427, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1507, in apply_standard
    mapped = obj._map_values(
  File "H:\python310\lib\site-packages\pandas\core\base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
  File "H:\python310\lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
  File "lib.pyx", line 2972, in pandas._libs.lib.map_infer
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1496, in curried
    return func(x, *self.args, **self.kwargs)
TypeError: determine_groups_optimized.<locals>.<lambda>() got an unexpected keyword argument 'axis'
2025/03/06 08:28 CRITICAL:First load crashed: determine_groups_optimized.<locals>.<lambda>() got an unexpected keyword argument 'axis'
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 78, in firstload
    load_data_to_session("data_clean", get_cleaned_data)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 69, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\data_loader.py", line 26, in get_cleaned_data
    return load_cleaned_data(
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\dashboard_demo-1\data\clean_and_enhance.py", line 237, in load_cleaned_data
    loadclean_df["RegEntity_Group"] = calc.determine_groups_optimized(
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 422, in determine_groups_optimized
    entity_totals["group"] = entity_totals["total_measure"].apply(
  File "H:\python310\lib\site-packages\pandas\core\series.py", line 4924, in apply
    ).apply()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1427, in apply
    return self.apply_standard()
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1507, in apply_standard
    mapped = obj._map_values(
  File "H:\python310\lib\site-packages\pandas\core\base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
  File "H:\python310\lib\site-packages\pandas\core\algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
  File "lib.pyx", line 2972, in pandas._libs.lib.map_infer
  File "H:\python310\lib\site-packages\pandas\core\apply.py", line 1496, in curried
    return func(x, *self.args, **self.kwargs)
TypeError: determine_groups_optimized.<locals>.<lambda>() got an unexpected keyword argument 'axis'
2025/03/06 08:29 ERROR:Error in pagesetup: unexpected indent (calculations.py, line 422)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 10, in pagesetup
    from app_pages.headlinefigures import hlf_body
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 7, in <module>
    from components.calculations import (
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 422
    entity_totals["group"] = entity_totals.apply(
IndentationError: unexpected indent
2025/03/06 08:29 ERROR:Error in pagesetup: cannot import name 'hlf_body' from 'app_pages.headlinefigures' (H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 10, in pagesetup
    from app_pages.headlinefigures import hlf_body
ImportError: cannot import name 'hlf_body' from 'app_pages.headlinefigures' (H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py)
2025/03/06 08:29 CRITICAL:Menu setup crashed: unexpected indent (calculations.py, line 422)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 10, in pagesetup
    from app_pages.headlinefigures import hlf_body
  File "H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py", line 7, in <module>
    from components.calculations import (
  File "H:\VScode\dashboard_demo-1\components\calculations.py", line 422
    entity_totals["group"] = entity_totals.apply(
IndentationError: unexpected indent
2025/03/06 08:29 CRITICAL:Menu setup crashed: cannot import name 'hlf_body' from 'app_pages.headlinefigures' (H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py)
Traceback (most recent call last):
  File "H:\VScode\dashboard_demo-1\PoliticalPartyAnalysisDashboard.py", line 46, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\dashboard_demo-1\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\dashboard_demo-1\politicalpartyanalysis.py", line 10, in pagesetup
    from app_pages.headlinefigures import hlf_body
ImportError: cannot import name 'hlf_body' from 'app_pages.headlinefigures' (H:\VScode\dashboard_demo-1\app_pages\headlinefigures.py)
2025/03/06 08:30 ERROR:Session state variables not initialized!
2025/03/06 08:30 ERROR:Error: originalfilepath is None!
2025/03/06 08:30 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 08:30 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 08:30 ERROR:Attempting to remove duplicates
2025/03/06 08:30 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 08:30 ERROR:Failed to load election dates from file.
2025/03/06 08:30 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 09:09 ERROR:Session state variables not initialized!
2025/03/06 09:09 ERROR:Error: originalfilepath is None!
2025/03/06 09:09 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 09:09 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 09:09 ERROR:Attempting to remove duplicates
2025/03/06 09:09 ERROR:Failed to load election dates from file.
2025/03/06 09:09 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 09:29 ERROR:Session state variables not initialized!
2025/03/06 09:29 ERROR:Error: originalfilepath is None!
2025/03/06 09:29 ERROR:Error in firstload: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 74, in firstload
    st.session_state.data_clean is None:
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:29 CRITICAL:First load crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 80, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 74, in firstload
    st.session_state.data_clean is None:
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:30 ERROR:Session state variables not initialized!
2025/03/06 09:30 ERROR:Error: originalfilepath is None!
2025/03/06 09:30 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 09:31 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 09:31 ERROR:Attempting to remove duplicates
2025/03/06 09:31 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 09:31 ERROR:Failed to load election dates from file.
2025/03/06 09:31 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 09:46 ERROR:Session state variables not initialized!
2025/03/06 09:46 ERROR:Error: originalfilepath is None!
2025/03/06 09:46 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 09:46 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 09:46 ERROR:Attempting to remove duplicates
2025/03/06 09:46 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 09:46 ERROR:Failed to load election dates from file.
2025/03/06 09:47 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 09:51 ERROR:Session state variables not initialized!
2025/03/06 09:51 ERROR:Error: originalfilepath is None!
2025/03/06 09:51 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 09:51 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 09:51 ERROR:Attempting to remove duplicates
2025/03/06 09:51 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 09:51 ERROR:Failed to load election dates from file.
2025/03/06 09:51 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 09:51 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:51 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\headlinefigures.py", line 30, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:51 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\mod_page_calls.py", line 246, in mod_publicfund_donations
    display_data_page(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\modular_page.py", line 20, in display_data_page
    cleaned_c_d_df) = load_and_filter_data(filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:52 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:52 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\mod_page_calls.py", line 246, in mod_publicfund_donations
    display_data_page(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\modular_page.py", line 20, in display_data_page
    cleaned_c_d_df) = load_and_filter_data(filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:52 ERROR:Session state variables not initialized!
2025/03/06 09:52 ERROR:Error: originalfilepath is None!
2025/03/06 09:52 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 09:52 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 09:52 ERROR:Attempting to remove duplicates
2025/03/06 09:52 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 09:52 ERROR:Failed to load election dates from file.
2025/03/06 09:52 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 09:53 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:53 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\headlinefigures.py", line 30, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:56 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:56 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\headlinefigures.py", line 30, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:56 ERROR:Session state variables not initialized!
2025/03/06 09:56 ERROR:Error: originalfilepath is None!
2025/03/06 09:56 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 09:56 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 09:56 ERROR:Attempting to remove duplicates
2025/03/06 09:57 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 09:57 ERROR:Failed to load election dates from file.
2025/03/06 09:57 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 09:57 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:57 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\headlinefigures.py", line 30, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 09:57 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\mod_page_calls.py", line 194, in mod_cash_donations
    display_data_page(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\modular_page.py", line 20, in display_data_page
    cleaned_c_d_df) = load_and_filter_data(filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 10:07 ERROR:Session state variables not initialized!
2025/03/06 10:07 ERROR:Error: originalfilepath is None!
2025/03/06 10:07 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 10:07 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 10:07 ERROR:Attempting to remove duplicates
2025/03/06 10:07 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 10:07 ERROR:Failed to load election dates from file.
2025/03/06 10:07 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 10:08 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 10:08 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\headlinefigures.py", line 30, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 01:27 ERROR:Session state variables not initialized!
2025/03/06 01:27 ERROR:Error: originalfilepath is None!
2025/03/06 01:27 ERROR:Error in load_and_filter_data: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 01:27 CRITICAL:Menu setup crashed: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 452, in __getitem__
    return self._getitem(widget_id, key)
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 497, in _getitem
    raise KeyError
KeyError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 130, in __getattr__
    return self[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 101, in __getitem__
    return get_session_state()[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\safe_session_state.py", line 96, in __getitem__
    return self._state[key]
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state.py", line 454, in __getitem__
    raise KeyError(_missing_key_error_message(key))
KeyError: 'st.session_state has no key "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 45, in <module>
    politicalpartyanalysis.pagesetup()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\politicalpartyanalysis.py", line 83, in pagesetup
    app.run()  # Run the  app
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\multi_page.py", line 47, in run
    page["function"]()  # Run the selected page's function
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\app_pages\headlinefigures.py", line 30, in hlf_body
    load_and_filter_data(filter_key=filter_key,
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\components\modular_page_blocks.py", line 29, in load_and_filter_data
    cleaned_df = st.session_state.data_clean
  File "H:\python310\lib\site-packages\streamlit\runtime\state\session_state_proxy.py", line 132, in __getattr__
    raise AttributeError(_missing_attr_error_message(key))
AttributeError: st.session_state has no attribute "data_clean". Did you forget to initialize it? More info: https://docs.streamlit.io/develop/concepts/architecture/session-state#initialization
2025/03/06 01:27 ERROR:Session state variables not initialized!
2025/03/06 01:27 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 01:27 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 01:27 ERROR:Attempting to remove duplicates
2025/03/06 01:27 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 01:27 ERROR:Failed to load election dates from file.
2025/03/06 01:27 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 01:45 ERROR:Session state variables not initialized!
2025/03/06 01:45 ERROR:Error: originalfilepath is None!
2025/03/06 01:45 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 01:45 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 01:45 ERROR:Attempting to remove duplicates
2025/03/06 01:45 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 01:45 ERROR:Failed to load election dates from file.
2025/03/06 01:46 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 01:51 ERROR:Session state variables not initialized!
2025/03/06 01:51 ERROR:Error: originalfilepath is None!
2025/03/06 01:51 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 01:51 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 01:51 ERROR:Attempting to remove duplicates
2025/03/06 01:51 ERROR:Error in map_mp_to_party: 'PartyName'
Traceback (most recent call last):
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'PartyName'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\politicalperson.py", line 177, in map_mp_to_party
    loaddata_df['PartyName'].unique())
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
  File "H:\python310\lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'PartyName'
2025/03/06 01:51 ERROR:Error mapping MPs to party membership: 'PartyName'
2025/03/06 01:51 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 01:51 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 01:51 CRITICAL:First load crashed: 'RegEntity_Group'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 64, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 93, in firstload
    load_data_to_session("data_regentity", get_regentity_data)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 66, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 51, in get_regentity_data
    return load_regulated_entity_data(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\load_donor_regent_lists.py", line 120, in load_regulated_entity_data
    regent_df.groupby(
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "H:\python310\lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "H:\python310\lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'RegEntity_Group'
2025/03/06 01:58 ERROR:Session state variables not initialized!
2025/03/06 01:58 ERROR:Error: originalfilepath is None!
2025/03/06 01:58 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 01:58 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 01:58 ERROR:Attempting to remove duplicates
2025/03/06 01:58 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 01:58 ERROR:Failed to load election dates from file.
2025/03/06 01:58 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 02:00 ERROR:Session state variables not initialized!
2025/03/06 02:00 ERROR:Error: originalfilepath is None!
2025/03/06 02:00 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 02:00 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 02:00 ERROR:Attempting to remove duplicates
2025/03/06 02:00 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 02:00 ERROR:Failed to load election dates from file.
2025/03/06 02:00 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 02:01 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/06 02:01 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:get_git_version executed successfully
2025/03/06 02:01 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:get_git_version executed successfully
2025/03/06 02:01 INFO:Streamlit App Starting...
2025/03/06 02:01 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:01 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 02:01 INFO:Running App setup...
2025/03/06 02:01 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Setting up the package
2025/03/06 02:01 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:01 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:get_git_version executed successfully
2025/03/06 02:01 INFO:Version: v39.164
2025/03/06 02:01 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:01 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:01 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:01 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 02:01 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 02:01 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:01 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:01 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:01 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:01 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 02:01 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 02:01 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:01 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 02:01 DEBUG:Initialised data_dir with value: data
2025/03/06 02:01 DEBUG:Initialised output_dir with value: output
2025/03/06 02:01 DEBUG:Initialised logs_dir with value: logs
2025/03/06 02:01 DEBUG:Initialised components_dir with value: components
2025/03/06 02:01 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 02:01 DEBUG:Initialised utils_dir with value: utils
2025/03/06 02:01 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:01 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:01 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 02:01 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:01 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:01 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:01 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 02:01 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 02:01 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 02:01 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 02:01 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 02:01 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 02:01 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 02:01 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 02:01 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 02:01 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 02:01 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 02:01 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:01 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 02:01 INFO:Session_state variables initialized
2025/03/06 02:01 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:01 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:01 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 02:01 DEBUG:app_pages_dir: app_pages
2025/03/06 02:01 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:01 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 02:01 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 02:01 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 02:01 DEBUG:data_dir: data
2025/03/06 02:01 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 02:01 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:01 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:01 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 02:01 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:01 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:01 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 02:01 DEBUG:utils_dir: utils
2025/03/06 02:01 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:01 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 02:01 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:01 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:01 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:01 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:01 DEBUG:perc_target: 0.5
2025/03/06 02:01 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 02:01 DEBUG:Cash_ftr: None
2025/03/06 02:01 DEBUG:output_dir: output
2025/03/06 02:01 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 02:01 DEBUG:components_dir: components
2025/03/06 02:01 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 02:01 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:01 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 02:01 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:01 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 02:01 DEBUG:logs_dir: logs
2025/03/06 02:01 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 02:01 DEBUG:reference_dir: reference_files
2025/03/06 02:01 INFO:Session state Setup complete
2025/03/06 02:01 INFO:initialize_session_state executed successfully
2025/03/06 02:01 INFO:Package setup complete
2025/03/06 02:01 INFO:setup_package executed successfully
2025/03/06 02:01 INFO:Setup completed successfully.
2025/03/06 02:01 INFO:Running Menu setup...
2025/03/06 02:01 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:get_git_version executed successfully
2025/03/06 02:01 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:get_git_version executed successfully
2025/03/06 02:01 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:get_git_version executed successfully
2025/03/06 02:01 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:get_git_version executed successfully
2025/03/06 02:01 INFO:App Version: v39.193
2025/03/06 02:01 INFO:Switched to page: Introduction
2025/03/06 02:01 INFO:pagesetup executed successfully
2025/03/06 02:01 INFO:Menu setup completed successfully.
2025/03/06 02:01 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Running first load function.
2025/03/06 02:01 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/06 02:01 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/06 02:01 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:01 INFO:Saved file path: output\imported_raw.csv
2025/03/06 02:01 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 02:01 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 02:01 INFO:get_file_modification_time executed successfully
2025/03/06 02:01 INFO:Current modification time: 1741252096.5157416
2025/03/06 02:01 INFO:Last modification time: 1741269629.3880677
2025/03/06 02:01 INFO:is_file_updated executed successfully
2025/03/06 02:01 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741269629.3880677 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 02:01 INFO:Importing file from output\imported_raw.csv
2025/03/06 02:01 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:01 INFO:Preprocessed data loaded successfully.
2025/03/06 02:01 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Cleaning up raw data
2025/03/06 02:01 ERROR:Session state variables not initialized!
2025/03/06 02:01 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Original file path: None
2025/03/06 02:01 INFO:Saved file path: output\cleaned_donations.csv
2025/03/06 02:01 ERROR:Error: originalfilepath is None!
2025/03/06 02:01 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:01 INFO:Data loaded, shape: (65278, 29)
2025/03/06 02:01 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/06 02:01 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:01 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:01 INFO:File deduplication complete, shape: (65278, 33)
2025/03/06 02:01 INFO:dedupe_entity_file executed successfully
2025/03/06 02:01 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/06 02:01 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/06 02:01 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/06 02:01 INFO:File deduplication complete, shape: (65278, 37)
2025/03/06 02:01 INFO:dedupe_entity_file executed successfully
2025/03/06 02:01 INFO:Raw Data cleanup completed
2025/03/06 02:01 INFO:Data shape: (65278, 37)
2025/03/06 02:01 INFO:Data saved to output\cleaned_donations.csv
2025/03/06 02:01 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/06 02:01 INFO:raw_data_cleanup executed successfully
2025/03/06 02:01 INFO:load_raw_data executed successfully
2025/03/06 02:01 INFO:get_raw_data executed successfully
2025/03/06 02:01 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:01 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Rows in Raw Data: 65278
2025/03/06 02:01 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Original file path: output\cleaned_donations.csv
2025/03/06 02:01 INFO:Saved file path: output\cleaned_data.csv
2025/03/06 02:01 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/06 02:01 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/06 02:01 INFO:get_file_modification_time executed successfully
2025/03/06 02:01 INFO:Current modification time: 1741269690.2553887
2025/03/06 02:01 INFO:Last modification time: 1741269629.3880677
2025/03/06 02:01 INFO:is_file_updated executed successfully
2025/03/06 02:01 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:01 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 02:01 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/06 02:01 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/06 02:01 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/06 02:01 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:RegulatedEntityName PreParty Dedupe uniques: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/06 02:01 DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/06 02:01 DEBUG:Loaded RegulatedEntityNameMatch:    PartyId                                          PartyName
0       17                                  English Democrats
1       19                         Legalise Cannabis Alliance
2       30        Upminster And Cranham Residents Association
3       44  Independent Kidderminster Hospital And Health ...
4       46                           Scottish Socialist Party
2025/03/06 02:01 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 02:01 ERROR:Attempting to remove duplicates
2025/03/06 02:01 DEBUG:loaddata_df after updating PartyName and PartyId:        ECRef OriginalRegulatedEntityName RegulatedEntityType    Value AcceptedDate AccountingUnitName  ... EventCount YearReceived MonthReceived YearMonthReceived RegulatedEntityName RegulatedEntityId
0  NC0408174              Mr Andy Street     Regulated Donee  1876.56   02/09/2019                     ...          1         2019             9            201909         Andy Street            8015.0
1  NC0408173              Mr Andy Street     Regulated Donee  2700.00   02/09/2019                     ...          1         2019             9            201909         Andy Street            8015.0
2  NC0408177              Mr Andy Street     Regulated Donee  4852.58   30/08/2019                     ...          1         2019             8            201908         Andy Street            8015.0
3  NC0408176              Mr Andy Street     Regulated Donee  2500.00   30/08/2019                     ...          1         2019             8            201908         Andy Street            8015.0
4  NC0408170              Mr Andy Street     Regulated Donee  4524.05   29/08/2019                     ...          1         2019             8            201908         Andy Street            8015.0

[5 rows x 43 columns]
2025/03/06 02:01 DEBUG:loaddata_df PartyName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/06 02:01 DEBUG:loaddata_df RegulatedEntityName unique values: ['Andy Street' 'Conservative Group For Europe' 'Progress Ltd' ...
 'A Minority Pastime Limited' 'Cruelty Free International'
 'Society For The Protection Of Unborn Children']
2025/03/06 02:01 INFO:Data Updated with PartyName and PartyId successfully
2025/03/06 02:01 INFO:map_mp_to_party executed successfully
2025/03/06 02:01 DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/06 02:01 DEBUG:Group assignment: group
Conservative And Unionist Party    20356
Labour Party                       18126
Liberal Democrats                  12191
Small Medium Entity                 4430
Small Entity                        2251
Uk Independence Party (Ukip)        1810
Very Small Entity                   1492
Medium Large Entity                 1203
Large Entity                        1194
Green Party                         1045
Medium Entity                        694
Single Donation Entity               486
Name: count, dtype: int64
2025/03/06 02:01 DEBUG:Group assignment: group
Very Small Entity                  491
Single Donation Entity             486
Small Entity                       241
Small Medium Entity                127
Medium Entity                        5
Medium Large Entity                  4
Large Entity                         2
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025/03/06 02:01 DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/06 02:01 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:01 DEBUG:try to load previous election dates from file.
2025/03/06 02:01 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:01 INFO:Saved file path: reference_files\elections.csv
2025/03/06 02:01 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 02:01 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 02:01 INFO:get_file_modification_time executed successfully
2025/03/06 02:01 INFO:Current modification time: 1741252096.5157416
2025/03/06 02:01 INFO:Last modification time: 1741252096.5157416
2025/03/06 02:01 INFO:is_file_updated executed successfully
2025/03/06 02:01 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1741252096.5157416 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 02:01 INFO:Importing file from reference_files\elections.csv
2025/03/06 02:01 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 02:01 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:01 ERROR:Failed to load election dates from file.
2025/03/06 02:01 INFO:Election_dates_df empty - loading from pdpy.
2025/03/06 02:01 INFO:Election Dates loaded vis pdpy.
2025/03/06 02:01 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/06 02:01 INFO:Election Dates Loaded Successfully.
2025/03/06 02:01 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/06 02:01 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/06 02:01 INFO:load_election_dates executed successfully
2025/03/06 02:01 DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/06 02:01 DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/06 02:01 INFO:Cleaned Data completed, shape: (65278, 57)
2025/03/06 02:01 INFO:Data successfully cleaned
2025/03/06 02:01 INFO:Data has 65278 rows and 57 columns
2025/03/06 02:01 INFO:load_cleaned_data executed successfully
2025/03/06 02:01 INFO:get_cleaned_data executed successfully
2025/03/06 02:01 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:01 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Original file path: output\cleaned_data.csv
2025/03/06 02:01 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/06 02:01 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 02:01 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 02:01 INFO:get_file_modification_time executed successfully
2025/03/06 02:01 INFO:Current modification time: 1741269695.371512
2025/03/06 02:01 INFO:Last modification time: 1741269634.6748164
2025/03/06 02:01 INFO:is_file_updated executed successfully
2025/03/06 02:01 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:01 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/06 02:01 INFO:Donor Data summary completed
2025/03/06 02:01 INFO:Data shape: (25576, 5)
2025/03/06 02:01 INFO:load_donorList_data executed successfully
2025/03/06 02:01 INFO:get_donor_data executed successfully
2025/03/06 02:01 DEBUG:st.session_state.data_donor: 25576
2025/03/06 02:01 DEBUG:st.session_state.data_clean: 65278
2025/03/06 02:01 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Original file path: output\cleaned_data.csv
2025/03/06 02:01 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/06 02:01 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 02:01 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:01 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 02:01 INFO:get_file_modification_time executed successfully
2025/03/06 02:01 INFO:Current modification time: 1741269695.371512
2025/03/06 02:01 INFO:Last modification time: 1741269695.371512
2025/03/06 02:01 INFO:is_file_updated executed successfully
2025/03/06 02:01 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741269695.371512 instead of output\cleaned_data.csv
2025/03/06 02:01 INFO:Importing file from output\cleaned_regentity.csv
2025/03/06 02:01 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 02:01 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:01 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025/03/06 02:01 INFO:Raw Data cleanup completed
2025/03/06 02:01 INFO:Data shape: (3289, 6)
2025/03/06 02:01 INFO:load_regulated_entity_data executed successfully
2025/03/06 02:01 INFO:get_regentity_data executed successfully
2025/03/06 02:01 DEBUG:st.session_state.data_regentity: 3289
2025/03/06 02:01 DEBUG:st.session_state.data_donor: 25576
2025/03/06 02:01 DEBUG:st.session_state.data_clean: 65278
2025/03/06 02:01 INFO:firstload executed successfully
2025/03/06 02:01 INFO:Data first load completed successfully.
2025/03/06 02:01 INFO:initialise_data executed successfully
2025/03/06 02:01 INFO:App is fully loaded and ready!
2025/03/06 02:04 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/06 02:04 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:get_git_version executed successfully
2025/03/06 02:04 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:get_git_version executed successfully
2025/03/06 02:04 INFO:Streamlit App Starting...
2025/03/06 02:04 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:04 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 02:04 INFO:Running App setup...
2025/03/06 02:04 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Setting up the package
2025/03/06 02:04 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:04 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:get_git_version executed successfully
2025/03/06 02:04 INFO:Version: v39.164
2025/03/06 02:04 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:04 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:04 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:04 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 02:04 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 02:04 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:04 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:04 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:04 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:04 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 02:04 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 02:04 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:04 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 02:04 DEBUG:Initialised data_dir with value: data
2025/03/06 02:04 DEBUG:Initialised output_dir with value: output
2025/03/06 02:04 DEBUG:Initialised logs_dir with value: logs
2025/03/06 02:04 DEBUG:Initialised components_dir with value: components
2025/03/06 02:04 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 02:04 DEBUG:Initialised utils_dir with value: utils
2025/03/06 02:04 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:04 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:04 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 02:04 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:04 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:04 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:04 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 02:04 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 02:04 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 02:04 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 02:04 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 02:04 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 02:04 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 02:04 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 02:04 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 02:04 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 02:04 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 02:04 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:04 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 02:04 INFO:Session_state variables initialized
2025/03/06 02:04 DEBUG:data_dir: data
2025/03/06 02:04 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:04 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 02:04 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 02:04 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:04 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:04 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 02:04 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 02:04 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 02:04 DEBUG:components_dir: components
2025/03/06 02:04 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 02:04 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:04 DEBUG:output_dir: output
2025/03/06 02:04 DEBUG:Cash_ftr: None
2025/03/06 02:04 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 02:04 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 02:04 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:04 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:04 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:04 DEBUG:perc_target: 0.5
2025/03/06 02:04 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:04 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:04 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 02:04 DEBUG:app_pages_dir: app_pages
2025/03/06 02:04 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:04 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 02:04 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 02:04 DEBUG:utils_dir: utils
2025/03/06 02:04 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:04 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 02:04 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:04 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:04 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 02:04 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:04 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 02:04 DEBUG:reference_dir: reference_files
2025/03/06 02:04 DEBUG:logs_dir: logs
2025/03/06 02:04 INFO:Session state Setup complete
2025/03/06 02:04 INFO:initialize_session_state executed successfully
2025/03/06 02:04 INFO:Package setup complete
2025/03/06 02:04 INFO:setup_package executed successfully
2025/03/06 02:04 INFO:Setup completed successfully.
2025/03/06 02:04 INFO:Running Menu setup...
2025/03/06 02:04 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:get_git_version executed successfully
2025/03/06 02:04 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:get_git_version executed successfully
2025/03/06 02:04 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:get_git_version executed successfully
2025/03/06 02:04 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:get_git_version executed successfully
2025/03/06 02:04 INFO:App Version: v39.193
2025/03/06 02:04 INFO:Switched to page: Introduction
2025/03/06 02:04 INFO:pagesetup executed successfully
2025/03/06 02:04 INFO:Menu setup completed successfully.
2025/03/06 02:04 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Running first load function.
2025/03/06 02:04 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/06 02:04 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/06 02:04 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:04 INFO:Saved file path: output\imported_raw.csv
2025/03/06 02:04 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 02:04 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 02:04 INFO:get_file_modification_time executed successfully
2025/03/06 02:04 INFO:Current modification time: 1741252096.5157416
2025/03/06 02:04 INFO:Last modification time: 1741269690.2553887
2025/03/06 02:04 INFO:is_file_updated executed successfully
2025/03/06 02:04 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741269690.2553887 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 02:04 INFO:Importing file from output\imported_raw.csv
2025/03/06 02:04 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:04 INFO:Preprocessed data loaded successfully.
2025/03/06 02:04 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Cleaning up raw data
2025/03/06 02:04 ERROR:Session state variables not initialized!
2025/03/06 02:04 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Original file path: None
2025/03/06 02:04 INFO:Saved file path: output\cleaned_donations.csv
2025/03/06 02:04 ERROR:Error: originalfilepath is None!
2025/03/06 02:04 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:04 INFO:Data loaded, shape: (65278, 29)
2025/03/06 02:04 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/06 02:04 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:04 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:04 INFO:File deduplication complete, shape: (65278, 33)
2025/03/06 02:04 INFO:dedupe_entity_file executed successfully
2025/03/06 02:04 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/06 02:04 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/06 02:04 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/06 02:04 INFO:File deduplication complete, shape: (65278, 37)
2025/03/06 02:04 INFO:dedupe_entity_file executed successfully
2025/03/06 02:04 INFO:Raw Data cleanup completed
2025/03/06 02:04 INFO:Data shape: (65278, 37)
2025/03/06 02:04 INFO:Data saved to output\cleaned_donations.csv
2025/03/06 02:04 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/06 02:04 INFO:raw_data_cleanup executed successfully
2025/03/06 02:04 INFO:load_raw_data executed successfully
2025/03/06 02:04 INFO:get_raw_data executed successfully
2025/03/06 02:04 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:04 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Rows in Raw Data: 65278
2025/03/06 02:04 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Original file path: output\cleaned_donations.csv
2025/03/06 02:04 INFO:Saved file path: output\cleaned_data.csv
2025/03/06 02:04 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/06 02:04 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/06 02:04 INFO:get_file_modification_time executed successfully
2025/03/06 02:04 INFO:Current modification time: 1741269885.0947666
2025/03/06 02:04 INFO:Last modification time: 1741269690.2553887
2025/03/06 02:04 INFO:is_file_updated executed successfully
2025/03/06 02:04 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:04 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 02:04 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/06 02:04 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/06 02:04 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/06 02:04 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/06 02:04 ERROR:Error in map_mp_to_party: 'function' object has no attribute 'count'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\politicalperson.py", line 12, in map_mp_to_party
    loaddata_df['RegulatedEntityName'].unique.count())
AttributeError: 'function' object has no attribute 'count'
2025/03/06 02:04 ERROR:Error mapping MPs to party membership: 'function' object has no attribute 'count'
2025/03/06 02:04 INFO:load_cleaned_data executed successfully
2025/03/06 02:04 INFO:get_cleaned_data executed successfully
2025/03/06 02:04 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:04 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Original file path: output\cleaned_data.csv
2025/03/06 02:04 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/06 02:04 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 02:04 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 02:04 INFO:get_file_modification_time executed successfully
2025/03/06 02:04 INFO:Current modification time: 1741269695.371512
2025/03/06 02:04 INFO:Last modification time: 1741269695.371512
2025/03/06 02:04 INFO:is_file_updated executed successfully
2025/03/06 02:04 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated 1741269695.371512 instead of output\cleaned_data.csv
2025/03/06 02:04 INFO:Importing file from output\cleaned_donorlist.csv
2025/03/06 02:04 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 02:04 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:04 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/06 02:04 INFO:Donor Data summary completed
2025/03/06 02:04 INFO:Data shape: (25576, 5)
2025/03/06 02:04 INFO:load_donorList_data executed successfully
2025/03/06 02:04 INFO:get_donor_data executed successfully
2025/03/06 02:04 DEBUG:st.session_state.data_donor: 25576
2025/03/06 02:04 DEBUG:st.session_state.data_clean: 65278
2025/03/06 02:04 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Original file path: output\cleaned_data.csv
2025/03/06 02:04 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/06 02:04 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 02:04 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:04 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 02:04 INFO:get_file_modification_time executed successfully
2025/03/06 02:04 INFO:Current modification time: 1741269695.371512
2025/03/06 02:04 INFO:Last modification time: 1741269695.371512
2025/03/06 02:04 INFO:is_file_updated executed successfully
2025/03/06 02:04 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741269695.371512 instead of output\cleaned_data.csv
2025/03/06 02:04 INFO:Importing file from output\cleaned_regentity.csv
2025/03/06 02:04 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 02:04 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:04 CRITICAL:First load crashed: 'RegEntity_Group'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 64, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 93, in firstload
    load_data_to_session("data_regentity", get_regentity_data)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 66, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 51, in get_regentity_data
    return load_regulated_entity_data(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\load_donor_regent_lists.py", line 120, in load_regulated_entity_data
    regent_df.groupby(
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "H:\python310\lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "H:\python310\lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'RegEntity_Group'
2025/03/06 02:06 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 INFO:Streamlit App Starting...
2025/03/06 02:06 INFO:Streamlit App Starting...
2025/03/06 02:06 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 02:06 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 02:06 INFO:Running App setup...
2025/03/06 02:06 INFO:Running App setup...
2025/03/06 02:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Setting up the package
2025/03/06 02:06 INFO:Setting up the package
2025/03/06 02:06 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 INFO:Version: v39.164
2025/03/06 02:06 INFO:Version: v39.164
2025/03/06 02:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:06 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:06 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 02:06 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 02:06 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 02:06 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 02:06 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:06 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:06 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:06 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:06 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:06 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:06 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:06 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:06 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 02:06 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 02:06 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 02:06 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 02:06 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:06 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:06 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 02:06 DEBUG:Initialised data_dir with value: data
2025/03/06 02:06 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 02:06 DEBUG:Initialised output_dir with value: output
2025/03/06 02:06 DEBUG:Initialised data_dir with value: data
2025/03/06 02:06 DEBUG:Initialised logs_dir with value: logs
2025/03/06 02:06 DEBUG:Initialised output_dir with value: output
2025/03/06 02:06 DEBUG:Initialised components_dir with value: components
2025/03/06 02:06 DEBUG:Initialised logs_dir with value: logs
2025/03/06 02:06 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 02:06 DEBUG:Initialised components_dir with value: components
2025/03/06 02:06 DEBUG:Initialised utils_dir with value: utils
2025/03/06 02:06 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 02:06 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:06 DEBUG:Initialised utils_dir with value: utils
2025/03/06 02:06 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:06 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:06 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 02:06 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:06 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:06 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 02:06 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:06 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:06 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:06 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:06 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 02:06 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:06 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 02:06 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 02:06 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 02:06 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 02:06 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 02:06 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 02:06 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 02:06 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 02:06 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 02:06 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 02:06 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 02:06 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 02:06 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 02:06 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 02:06 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 02:06 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 02:06 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 02:06 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 02:06 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 02:06 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 02:06 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:06 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 02:06 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 02:06 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:06 INFO:Session_state variables initialized
2025/03/06 02:06 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 02:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:06 INFO:Session_state variables initialized
2025/03/06 02:06 DEBUG:utils_dir: utils
2025/03/06 02:06 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:06 DEBUG:output_dir: output
2025/03/06 02:06 DEBUG:utils_dir: utils
2025/03/06 02:06 DEBUG:app_pages_dir: app_pages
2025/03/06 02:06 DEBUG:output_dir: output
2025/03/06 02:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 02:06 DEBUG:app_pages_dir: app_pages
2025/03/06 02:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:06 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 02:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 02:06 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:06 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 02:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 02:06 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 02:06 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 02:06 DEBUG:logs_dir: logs
2025/03/06 02:06 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 02:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:06 DEBUG:logs_dir: logs
2025/03/06 02:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 02:06 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 02:06 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 02:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:06 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 02:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:06 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:06 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 02:06 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:06 DEBUG:components_dir: components
2025/03/06 02:06 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 02:06 DEBUG:reference_dir: reference_files
2025/03/06 02:06 DEBUG:components_dir: components
2025/03/06 02:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 02:06 DEBUG:reference_dir: reference_files
2025/03/06 02:06 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 02:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 02:06 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:06 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 02:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 02:06 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:06 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 02:06 DEBUG:data_dir: data
2025/03/06 02:06 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 02:06 DEBUG:data_dir: data
2025/03/06 02:06 DEBUG:perc_target: 0.5
2025/03/06 02:06 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 02:06 DEBUG:Cash_ftr: None
2025/03/06 02:06 DEBUG:perc_target: 0.5
2025/03/06 02:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 02:06 DEBUG:Cash_ftr: None
2025/03/06 02:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 02:06 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 02:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:06 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 02:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:06 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:06 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:06 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 02:06 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:06 INFO:Session state Setup complete
2025/03/06 02:06 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 02:06 INFO:initialize_session_state executed successfully
2025/03/06 02:06 INFO:Session state Setup complete
2025/03/06 02:06 INFO:Package setup complete
2025/03/06 02:06 INFO:initialize_session_state executed successfully
2025/03/06 02:06 INFO:setup_package executed successfully
2025/03/06 02:06 INFO:Package setup complete
2025/03/06 02:06 INFO:Setup completed successfully.
2025/03/06 02:06 INFO:setup_package executed successfully
2025/03/06 02:06 INFO:Running Menu setup...
2025/03/06 02:06 INFO:Setup completed successfully.
2025/03/06 02:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Running Menu setup...
2025/03/06 02:06 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 INFO:get_git_version executed successfully
2025/03/06 02:06 INFO:App Version: v39.193
2025/03/06 02:06 INFO:App Version: v39.193
2025/03/06 02:06 INFO:Switched to page: Introduction
2025/03/06 02:06 INFO:Switched to page: Introduction
2025/03/06 02:06 INFO:pagesetup executed successfully
2025/03/06 02:06 INFO:Menu setup completed successfully.
2025/03/06 02:06 INFO:pagesetup executed successfully
2025/03/06 02:06 INFO:Menu setup completed successfully.
2025/03/06 02:06 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Running first load function.
2025/03/06 02:06 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/06 02:06 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/06 02:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:06 INFO:Saved file path: output\imported_raw.csv
2025/03/06 02:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 02:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 02:06 INFO:get_file_modification_time executed successfully
2025/03/06 02:06 INFO:Current modification time: 1741252096.5157416
2025/03/06 02:06 INFO:Last modification time: 1741269885.0947666
2025/03/06 02:06 INFO:is_file_updated executed successfully
2025/03/06 02:06 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741269885.0947666 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 02:06 INFO:Importing file from output\imported_raw.csv
2025/03/06 02:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:06 INFO:Preprocessed data loaded successfully.
2025/03/06 02:06 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Cleaning up raw data
2025/03/06 02:06 ERROR:Session state variables not initialized!
2025/03/06 02:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Original file path: None
2025/03/06 02:06 INFO:Saved file path: output\cleaned_donations.csv
2025/03/06 02:06 ERROR:Error: originalfilepath is None!
2025/03/06 02:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:06 INFO:Data loaded, shape: (65278, 29)
2025/03/06 02:06 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/06 02:06 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:06 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:06 INFO:File deduplication complete, shape: (65278, 33)
2025/03/06 02:06 INFO:dedupe_entity_file executed successfully
2025/03/06 02:06 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/06 02:06 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/06 02:06 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/06 02:06 INFO:File deduplication complete, shape: (65278, 37)
2025/03/06 02:06 INFO:dedupe_entity_file executed successfully
2025/03/06 02:06 INFO:Raw Data cleanup completed
2025/03/06 02:06 INFO:Data shape: (65278, 37)
2025/03/06 02:06 INFO:Data saved to output\cleaned_donations.csv
2025/03/06 02:06 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/06 02:06 INFO:raw_data_cleanup executed successfully
2025/03/06 02:06 INFO:load_raw_data executed successfully
2025/03/06 02:06 INFO:get_raw_data executed successfully
2025/03/06 02:06 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:06 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:06 DEBUG:Rows in Raw Data: 65278
2025/03/06 02:06 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Original file path: output\cleaned_donations.csv
2025/03/06 02:06 INFO:Saved file path: output\cleaned_data.csv
2025/03/06 02:06 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/06 02:06 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:06 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/06 02:06 INFO:get_file_modification_time executed successfully
2025/03/06 02:06 INFO:Current modification time: 1741270018.2539763
2025/03/06 02:06 INFO:Last modification time: 1741269885.0947666
2025/03/06 02:06 INFO:is_file_updated executed successfully
2025/03/06 02:06 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:06 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 02:06 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/06 02:06 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/06 02:06 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/06 02:07 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/06 02:07 ERROR:Error in map_mp_to_party: object of type 'method' has no len()
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\politicalperson.py", line 12, in map_mp_to_party
    len(loaddata_df['RegulatedEntityName'].unique))
TypeError: object of type 'method' has no len()
2025/03/06 02:07 ERROR:Error mapping MPs to party membership: object of type 'method' has no len()
2025/03/06 02:07 INFO:load_cleaned_data executed successfully
2025/03/06 02:07 INFO:get_cleaned_data executed successfully
2025/03/06 02:07 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:07 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:Original file path: output\cleaned_data.csv
2025/03/06 02:07 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/06 02:07 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 02:07 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 02:07 INFO:get_file_modification_time executed successfully
2025/03/06 02:07 INFO:Current modification time: 1741269695.371512
2025/03/06 02:07 INFO:Last modification time: 1741269695.371512
2025/03/06 02:07 INFO:is_file_updated executed successfully
2025/03/06 02:07 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated 1741269695.371512 instead of output\cleaned_data.csv
2025/03/06 02:07 INFO:Importing file from output\cleaned_donorlist.csv
2025/03/06 02:07 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 02:07 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:07 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/06 02:07 INFO:Donor Data summary completed
2025/03/06 02:07 INFO:Data shape: (25576, 5)
2025/03/06 02:07 INFO:load_donorList_data executed successfully
2025/03/06 02:07 INFO:get_donor_data executed successfully
2025/03/06 02:07 DEBUG:st.session_state.data_donor: 25576
2025/03/06 02:07 DEBUG:st.session_state.data_clean: 65278
2025/03/06 02:07 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:Original file path: output\cleaned_data.csv
2025/03/06 02:07 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/06 02:07 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 02:07 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 02:07 INFO:get_file_modification_time executed successfully
2025/03/06 02:07 INFO:Current modification time: 1741269695.371512
2025/03/06 02:07 INFO:Last modification time: 1741269695.371512
2025/03/06 02:07 INFO:is_file_updated executed successfully
2025/03/06 02:07 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741269695.371512 instead of output\cleaned_data.csv
2025/03/06 02:07 INFO:Importing file from output\cleaned_regentity.csv
2025/03/06 02:07 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 02:07 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:07 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 CRITICAL:First load crashed: 'RegEntity_Group'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 64, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 93, in firstload
    load_data_to_session("data_regentity", get_regentity_data)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 66, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 51, in get_regentity_data
    return load_regulated_entity_data(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\load_donor_regent_lists.py", line 120, in load_regulated_entity_data
    regent_df.groupby(
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "H:\python310\lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "H:\python310\lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'RegEntity_Group'
2025/03/06 02:07 INFO:Running first load function.
2025/03/06 02:07 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 02:07 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:get_raw_data executed successfully
2025/03/06 02:07 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:07 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:get_cleaned_data executed successfully
2025/03/06 02:07 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:07 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 INFO:get_donor_data executed successfully
2025/03/06 02:07 DEBUG:st.session_state.data_donor: 25576
2025/03/06 02:07 DEBUG:st.session_state.data_clean: 65278
2025/03/06 02:07 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/06 02:07 ERROR:Error in load_regulated_entity_data: 'RegEntity_Group'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\load_donor_regent_lists.py", line 120, in load_regulated_entity_data
    regent_df.groupby(
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "H:\python310\lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "H:\python310\lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'RegEntity_Group'
2025/03/06 02:07 CRITICAL:First load crashed: 'RegEntity_Group'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 64, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 93, in firstload
    load_data_to_session("data_regentity", get_regentity_data)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 66, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 51, in get_regentity_data
    return load_regulated_entity_data(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\load_donor_regent_lists.py", line 120, in load_regulated_entity_data
    regent_df.groupby(
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "H:\python310\lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "H:\python310\lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'RegEntity_Group'
2025/03/06 02:08 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 INFO:Streamlit App Starting...
2025/03/06 02:08 INFO:Streamlit App Starting...
2025/03/06 02:08 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 02:08 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 02:08 INFO:Running App setup...
2025/03/06 02:08 INFO:Running App setup...
2025/03/06 02:08 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Setting up the package
2025/03/06 02:08 INFO:Setting up the package
2025/03/06 02:08 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 INFO:Version: v39.164
2025/03/06 02:08 INFO:Version: v39.164
2025/03/06 02:08 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:08 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:08 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 02:08 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 02:08 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 02:08 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 02:08 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:08 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:08 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:08 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:08 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:08 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:08 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:08 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:08 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 02:08 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 02:08 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 02:08 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 02:08 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:08 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:08 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 02:08 DEBUG:Initialised data_dir with value: data
2025/03/06 02:08 DEBUG:Initialised output_dir with value: output
2025/03/06 02:08 DEBUG:Initialised logs_dir with value: logs
2025/03/06 02:08 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 02:08 DEBUG:Initialised components_dir with value: components
2025/03/06 02:08 DEBUG:Initialised data_dir with value: data
2025/03/06 02:08 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 02:08 DEBUG:Initialised output_dir with value: output
2025/03/06 02:08 DEBUG:Initialised utils_dir with value: utils
2025/03/06 02:08 DEBUG:Initialised logs_dir with value: logs
2025/03/06 02:08 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:08 DEBUG:Initialised components_dir with value: components
2025/03/06 02:08 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:08 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 02:08 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 02:08 DEBUG:Initialised utils_dir with value: utils
2025/03/06 02:08 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:08 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:08 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:08 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:08 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:08 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 02:08 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 02:08 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:08 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 02:08 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:08 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 02:08 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:08 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 02:08 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 02:08 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 02:08 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 02:08 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 02:08 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 02:08 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 02:08 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 02:08 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 02:08 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 02:08 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 02:08 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 02:08 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 02:08 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 02:08 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 02:08 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 02:08 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 02:08 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 02:08 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 02:08 INFO:Session_state variables initialized
2025/03/06 02:08 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 02:08 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 02:08 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 DEBUG:reference_dir: reference_files
2025/03/06 02:08 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 02:08 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 02:08 INFO:Session_state variables initialized
2025/03/06 02:08 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:08 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 02:08 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 02:08 DEBUG:reference_dir: reference_files
2025/03/06 02:08 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 02:08 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 02:08 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:08 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:08 DEBUG:logs_dir: logs
2025/03/06 02:08 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:08 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 02:08 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:08 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 02:08 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 02:08 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:08 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:08 DEBUG:logs_dir: logs
2025/03/06 02:08 DEBUG:utils_dir: utils
2025/03/06 02:08 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:08 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 02:08 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:08 DEBUG:data_dir: data
2025/03/06 02:08 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 02:08 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:08 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:08 DEBUG:components_dir: components
2025/03/06 02:08 DEBUG:utils_dir: utils
2025/03/06 02:08 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 02:08 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 02:08 DEBUG:app_pages_dir: app_pages
2025/03/06 02:08 DEBUG:data_dir: data
2025/03/06 02:08 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 02:08 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:08 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:08 DEBUG:components_dir: components
2025/03/06 02:08 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 02:08 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 02:08 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:08 DEBUG:app_pages_dir: app_pages
2025/03/06 02:08 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 02:08 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 02:08 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 02:08 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:08 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:08 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 02:08 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 02:08 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:08 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 02:08 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 02:08 DEBUG:Cash_ftr: None
2025/03/06 02:08 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 02:08 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:08 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:08 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 02:08 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 02:08 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:08 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 02:08 DEBUG:output_dir: output
2025/03/06 02:08 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:08 DEBUG:Cash_ftr: None
2025/03/06 02:08 DEBUG:perc_target: 0.5
2025/03/06 02:08 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:08 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 02:08 INFO:Session state Setup complete
2025/03/06 02:08 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:08 INFO:initialize_session_state executed successfully
2025/03/06 02:08 DEBUG:output_dir: output
2025/03/06 02:08 INFO:Package setup complete
2025/03/06 02:08 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:08 INFO:setup_package executed successfully
2025/03/06 02:08 DEBUG:perc_target: 0.5
2025/03/06 02:08 INFO:Setup completed successfully.
2025/03/06 02:08 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:08 INFO:Running Menu setup...
2025/03/06 02:08 INFO:Session state Setup complete
2025/03/06 02:08 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:initialize_session_state executed successfully
2025/03/06 02:08 INFO:Package setup complete
2025/03/06 02:08 INFO:setup_package executed successfully
2025/03/06 02:08 INFO:Setup completed successfully.
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Running Menu setup...
2025/03/06 02:08 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 INFO:get_git_version executed successfully
2025/03/06 02:08 INFO:App Version: v39.193
2025/03/06 02:08 INFO:App Version: v39.193
2025/03/06 02:08 INFO:Switched to page: Introduction
2025/03/06 02:08 INFO:Switched to page: Introduction
2025/03/06 02:08 INFO:pagesetup executed successfully
2025/03/06 02:08 INFO:Menu setup completed successfully.
2025/03/06 02:08 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:pagesetup executed successfully
2025/03/06 02:08 INFO:Menu setup completed successfully.
2025/03/06 02:08 INFO:Running first load function.
2025/03/06 02:08 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/06 02:08 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/06 02:08 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 INFO:Saved file path: output\imported_raw.csv
2025/03/06 02:08 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 02:08 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 INFO:get_file_modification_time executed successfully
2025/03/06 02:08 INFO:Current modification time: 1741252096.5157416
2025/03/06 02:08 INFO:Last modification time: 1741270018.2539763
2025/03/06 02:08 INFO:is_file_updated executed successfully
2025/03/06 02:08 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741270018.2539763 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 INFO:Importing file from output\imported_raw.csv
2025/03/06 02:08 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:08 INFO:Preprocessed data loaded successfully.
2025/03/06 02:08 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Cleaning up raw data
2025/03/06 02:08 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Running first load function.
2025/03/06 02:08 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/06 02:08 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/06 02:08 INFO:Preprocessed data loaded successfully.
2025/03/06 02:08 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Cleaning up raw data
2025/03/06 02:08 ERROR:Session state variables not initialized!
2025/03/06 02:08 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Original file path: None
2025/03/06 02:08 INFO:Saved file path: output\cleaned_donations.csv
2025/03/06 02:08 ERROR:Error: originalfilepath is None!
2025/03/06 02:08 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:08 INFO:Data loaded, shape: (65278, 29)
2025/03/06 02:08 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/06 02:08 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:08 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:08 INFO:File deduplication complete, shape: (65278, 33)
2025/03/06 02:08 INFO:dedupe_entity_file executed successfully
2025/03/06 02:08 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/06 02:08 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/06 02:08 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/06 02:08 INFO:File deduplication complete, shape: (65278, 37)
2025/03/06 02:08 INFO:dedupe_entity_file executed successfully
2025/03/06 02:08 INFO:Raw Data cleanup completed
2025/03/06 02:08 INFO:Data shape: (65278, 37)
2025/03/06 02:08 INFO:Data saved to output\cleaned_donations.csv
2025/03/06 02:08 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/06 02:08 INFO:raw_data_cleanup executed successfully
2025/03/06 02:08 INFO:load_raw_data executed successfully
2025/03/06 02:08 INFO:get_raw_data executed successfully
2025/03/06 02:08 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:08 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Rows in Raw Data: 65278
2025/03/06 02:08 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Original file path: output\cleaned_donations.csv
2025/03/06 02:08 INFO:Saved file path: output\cleaned_data.csv
2025/03/06 02:08 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/06 02:08 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/06 02:08 INFO:get_file_modification_time executed successfully
2025/03/06 02:08 INFO:Current modification time: 1741270115.0535436
2025/03/06 02:08 INFO:Last modification time: 1741270018.2539763
2025/03/06 02:08 INFO:is_file_updated executed successfully
2025/03/06 02:08 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:08 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 02:08 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/06 02:08 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/06 02:08 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/06 02:08 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:RegulatedEntityName PreParty Dedupe uniques: 1361
2025/03/06 02:08 DEBUG:PartyUpdate_dict keys: dict_keys(['Conservatives', 'Labour', 'Liberal Democrats', 'Scottish National Party', 'Green Party', 'Plaid Cymru', 'UKIP', 'Unknown'])
2025/03/06 02:08 ERROR:Number of rows in loaddata_df and raw_data do not match 78745 != 65278
2025/03/06 02:08 ERROR:Attempting to remove duplicates
2025/03/06 02:08 DEBUG:loaddata_df PartyName unique values: 1361
2025/03/06 02:08 DEBUG:loaddata_df RegulatedEntityName unique values: 1361
2025/03/06 02:08 INFO:Data Updated with PartyName and PartyId successfully
2025/03/06 02:08 INFO:map_mp_to_party executed successfully
2025/03/06 02:08 DEBUG:Clean Data Prep 150: Map Mps: 65278
2025/03/06 02:08 DEBUG:Group assignment: group
Conservative And Unionist Party    20356
Labour Party                       18126
Liberal Democrats                  12191
Small Medium Entity                 4430
Small Entity                        2251
Uk Independence Party (Ukip)        1810
Very Small Entity                   1492
Medium Large Entity                 1203
Large Entity                        1194
Green Party                         1045
Medium Entity                        694
Single Donation Entity               486
Name: count, dtype: int64
2025/03/06 02:08 DEBUG:Group assignment: group
Very Small Entity                  491
Single Donation Entity             486
Small Entity                       241
Small Medium Entity                127
Medium Entity                        5
Medium Large Entity                  4
Large Entity                         2
Conservative And Unionist Party      1
Green Party                          1
Labour Party                         1
Liberal Democrats                    1
Uk Independence Party (Ukip)         1
Name: count, dtype: int64
2025/03/06 02:08 DEBUG:Clean Data Prep 235: RegEntity_Map: 65278
2025/03/06 02:08 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:08 DEBUG:try to load previous election dates from file.
2025/03/06 02:08 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 INFO:Saved file path: reference_files\elections.csv
2025/03/06 02:08 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 02:08 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 INFO:get_file_modification_time executed successfully
2025/03/06 02:08 INFO:Current modification time: 1741252096.5157416
2025/03/06 02:08 INFO:Last modification time: 1741252096.5157416
2025/03/06 02:08 INFO:is_file_updated executed successfully
2025/03/06 02:08 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1741252096.5157416 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 02:08 INFO:Importing file from reference_files\elections.csv
2025/03/06 02:08 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 02:08 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:08 ERROR:Failed to load election dates from file.
2025/03/06 02:08 INFO:Election_dates_df empty - loading from pdpy.
2025/03/06 02:08 INFO:Election Dates loaded vis pdpy.
2025/03/06 02:08 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/06 02:08 INFO:Election Dates Loaded Successfully.
2025/03/06 02:08 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/06 02:08 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/06 02:08 INFO:load_election_dates executed successfully
2025/03/06 02:08 DEBUG:Clean Data Prep 353: Election dates: 65278
2025/03/06 02:08 DEBUG:Clean Data Prep 386: End of clean: 65278
2025/03/06 02:08 INFO:Cleaned Data completed, shape: (65278, 57)
2025/03/06 02:08 INFO:Data successfully cleaned
2025/03/06 02:08 INFO:Data has 65278 rows and 57 columns
2025/03/06 02:08 INFO:load_cleaned_data executed successfully
2025/03/06 02:08 INFO:get_cleaned_data executed successfully
2025/03/06 02:08 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:08 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Original file path: output\cleaned_data.csv
2025/03/06 02:08 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/06 02:08 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 02:08 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 02:08 INFO:get_file_modification_time executed successfully
2025/03/06 02:08 INFO:Current modification time: 1741270120.543527
2025/03/06 02:08 INFO:Last modification time: 1741269695.371512
2025/03/06 02:08 INFO:is_file_updated executed successfully
2025/03/06 02:08 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:08 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/06 02:08 INFO:Donor Data summary completed
2025/03/06 02:08 INFO:Data shape: (25576, 5)
2025/03/06 02:08 INFO:load_donorList_data executed successfully
2025/03/06 02:08 INFO:get_donor_data executed successfully
2025/03/06 02:08 DEBUG:st.session_state.data_donor: 25576
2025/03/06 02:08 DEBUG:st.session_state.data_clean: 65278
2025/03/06 02:08 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Original file path: output\cleaned_data.csv
2025/03/06 02:08 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/06 02:08 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 02:08 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:08 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 02:08 INFO:get_file_modification_time executed successfully
2025/03/06 02:08 INFO:Current modification time: 1741270120.543527
2025/03/06 02:08 INFO:Last modification time: 1741270120.543527
2025/03/06 02:08 INFO:is_file_updated executed successfully
2025/03/06 02:08 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741270120.543527 instead of output\cleaned_data.csv
2025/03/06 02:08 INFO:Importing file from output\cleaned_regentity.csv
2025/03/06 02:08 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 02:08 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:08 INFO:Regulated entity data saved to output\cleaned_regentity.csv
2025/03/06 02:08 INFO:Raw Data cleanup completed
2025/03/06 02:08 INFO:Data shape: (3289, 6)
2025/03/06 02:08 INFO:load_regulated_entity_data executed successfully
2025/03/06 02:08 INFO:get_regentity_data executed successfully
2025/03/06 02:08 DEBUG:st.session_state.data_regentity: 3289
2025/03/06 02:08 DEBUG:st.session_state.data_donor: 25576
2025/03/06 02:08 DEBUG:st.session_state.data_clean: 65278
2025/03/06 02:08 INFO:firstload executed successfully
2025/03/06 02:08 INFO:Data first load completed successfully.
2025/03/06 02:08 INFO:initialise_data executed successfully
2025/03/06 02:08 INFO:App is fully loaded and ready!
2025/03/06 02:36 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/06 02:36 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:get_git_version executed successfully
2025/03/06 02:36 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:get_git_version executed successfully
2025/03/06 02:36 INFO:Streamlit App Starting...
2025/03/06 02:36 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:36 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 02:36 INFO:Running App setup...
2025/03/06 02:36 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Setting up the package
2025/03/06 02:36 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:36 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:get_git_version executed successfully
2025/03/06 02:36 INFO:Version: v39.164
2025/03/06 02:36 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:36 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:36 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:36 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 02:36 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 02:36 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:36 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:36 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:36 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:36 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 02:36 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 02:36 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:36 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 02:36 DEBUG:Initialised data_dir with value: data
2025/03/06 02:36 DEBUG:Initialised output_dir with value: output
2025/03/06 02:36 DEBUG:Initialised logs_dir with value: logs
2025/03/06 02:36 DEBUG:Initialised components_dir with value: components
2025/03/06 02:36 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 02:36 DEBUG:Initialised utils_dir with value: utils
2025/03/06 02:36 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:36 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:36 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 02:36 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:36 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:36 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:36 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 02:36 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 02:36 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 02:36 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 02:36 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 02:36 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 02:36 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 02:36 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 02:36 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 02:36 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 02:36 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 02:36 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:36 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 02:36 INFO:Session_state variables initialized
2025/03/06 02:36 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 02:36 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 02:36 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 02:36 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 02:36 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 02:36 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 02:36 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 02:36 DEBUG:output_dir: output
2025/03/06 02:36 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 02:36 DEBUG:reference_dir: reference_files
2025/03/06 02:36 DEBUG:logs_dir: logs
2025/03/06 02:36 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 02:36 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:36 DEBUG:components_dir: components
2025/03/06 02:36 DEBUG:data_dir: data
2025/03/06 02:36 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 02:36 DEBUG:Cash_ftr: None
2025/03/06 02:36 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 02:36 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 02:36 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 02:36 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 02:36 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 02:36 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 02:36 DEBUG:app_pages_dir: app_pages
2025/03/06 02:36 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:36 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 02:36 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 02:36 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 02:36 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 02:36 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 02:36 DEBUG:perc_target: 0.5
2025/03/06 02:36 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 02:36 DEBUG:utils_dir: utils
2025/03/06 02:36 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 02:36 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 02:36 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 02:36 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 02:36 INFO:Session state Setup complete
2025/03/06 02:36 INFO:initialize_session_state executed successfully
2025/03/06 02:36 INFO:Package setup complete
2025/03/06 02:36 INFO:setup_package executed successfully
2025/03/06 02:36 INFO:Setup completed successfully.
2025/03/06 02:36 INFO:Running Menu setup...
2025/03/06 02:36 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 02:36 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:get_git_version executed successfully
2025/03/06 02:36 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:get_git_version executed successfully
2025/03/06 02:36 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:get_git_version executed successfully
2025/03/06 02:36 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:get_git_version executed successfully
2025/03/06 02:36 INFO:App Version: v39.193
2025/03/06 02:36 INFO:Switched to page: Introduction
2025/03/06 02:36 INFO:pagesetup executed successfully
2025/03/06 02:36 INFO:Menu setup completed successfully.
2025/03/06 02:36 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Running first load function.
2025/03/06 02:36 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 02:36 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/06 02:36 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/06 02:36 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:36 INFO:Saved file path: output\imported_raw.csv
2025/03/06 02:36 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 02:36 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 02:36 INFO:get_file_modification_time executed successfully
2025/03/06 02:36 INFO:Current modification time: 1741252096.5157416
2025/03/06 02:36 INFO:Last modification time: 1741270115.0535436
2025/03/06 02:36 INFO:is_file_updated executed successfully
2025/03/06 02:36 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741270115.0535436 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 02:36 INFO:Importing file from output\imported_raw.csv
2025/03/06 02:36 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:36 INFO:Preprocessed data loaded successfully.
2025/03/06 02:36 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Cleaning up raw data
2025/03/06 02:36 ERROR:Session state variables not initialized!
2025/03/06 02:36 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Original file path: None
2025/03/06 02:36 INFO:Saved file path: output\cleaned_donations.csv
2025/03/06 02:36 ERROR:Error: originalfilepath is None!
2025/03/06 02:36 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:36 INFO:Data loaded, shape: (65278, 29)
2025/03/06 02:36 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/06 02:36 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:36 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 02:36 INFO:File deduplication complete, shape: (65278, 33)
2025/03/06 02:36 INFO:dedupe_entity_file executed successfully
2025/03/06 02:36 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/06 02:36 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/06 02:36 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/06 02:36 INFO:File deduplication complete, shape: (65278, 37)
2025/03/06 02:36 INFO:dedupe_entity_file executed successfully
2025/03/06 02:36 INFO:Raw Data cleanup completed
2025/03/06 02:36 INFO:Data shape: (65278, 37)
2025/03/06 02:36 INFO:Data saved to output\cleaned_donations.csv
2025/03/06 02:36 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/06 02:36 INFO:raw_data_cleanup executed successfully
2025/03/06 02:36 INFO:load_raw_data executed successfully
2025/03/06 02:36 INFO:get_raw_data executed successfully
2025/03/06 02:36 DEBUG:st.session_state.raw_data: 65278
2025/03/06 02:36 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 DEBUG:Rows in Raw Data: 65278
2025/03/06 02:36 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Original file path: output\cleaned_donations.csv
2025/03/06 02:36 INFO:Saved file path: output\cleaned_data.csv
2025/03/06 02:36 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/06 02:36 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/06 02:36 INFO:get_file_modification_time executed successfully
2025/03/06 02:36 INFO:Current modification time: 1741271786.7317827
2025/03/06 02:36 INFO:Last modification time: 1741270115.0535436
2025/03/06 02:36 INFO:is_file_updated executed successfully
2025/03/06 02:36 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:36 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 02:36 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/06 02:36 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/06 02:36 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/06 02:36 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/06 02:36 DEBUG:RegulatedEntityName PreParty Dedupe uniques: 1361
2025/03/06 02:36 WARNING:Adding missing column: 'PartyName'
2025/03/06 02:36 ERROR:Row count mismatch: 78745 != 65278
2025/03/06 02:36 INFO:Data successfully updated with PartyName and PartyId
2025/03/06 02:36 INFO:map_mp_to_party executed successfully
2025/03/06 02:36 DEBUG:Clean Data Prep 150: Map Mps: 78745
2025/03/06 02:36 DEBUG:Group assignment: group
<na>    78745
Name: count, dtype: int64
2025/03/06 02:36 DEBUG:Group assignment: group
<na>    1
Name: count, dtype: int64
2025/03/06 02:36 DEBUG:Clean Data Prep 235: RegEntity_Map: 78745
2025/03/06 02:36 DEBUG:Calling load_election_dates with args={args}, kwargs={kwargs}
2025/03/06 02:36 DEBUG:st.session_state.ELECTION_DATES: reference_files\elections.csv
2025/03/06 02:36 DEBUG:try to load previous election dates from file.
2025/03/06 02:36 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 02:36 INFO:Saved file path: reference_files\elections.csv
2025/03/06 02:36 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 02:36 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 02:36 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 02:36 INFO:get_file_modification_time executed successfully
2025/03/06 02:36 INFO:Current modification time: 1741252096.5157416
2025/03/06 02:36 INFO:Last modification time: 1741252096.5157416
2025/03/06 02:36 INFO:is_file_updated executed successfully
2025/03/06 02:36 INFO:Loading preprocessed data. Using reference_files\elections.csv dated 1741252096.5157416 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 02:36 INFO:Importing file from reference_files\elections.csv
2025/03/06 02:36 ERROR:Timestamp key election_dates_last_modified not recognised.
2025/03/06 02:36 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 02:36 ERROR:Failed to load election dates from file.
2025/03/06 02:36 INFO:Election_dates_df empty - loading from pdpy.
2025/03/06 02:36 INFO:Election Dates loaded vis pdpy.
2025/03/06 02:36 DEBUG:ElectionDates_dict from pdpy: {'1929': {'dissolution': datetime.date(1929, 5, 10), 'election': datetime.date(1929, 5, 30), 'type': 'General Election'}, '1931': {'dissolution': datetime.date(1931, 10, 7), 'election': datetime.date(1931, 10, 27), 'type': 'General Election'}, '1935': {'dissolution': datetime.date(1935, 10, 25), 'election': datetime.date(1935, 11, 14), 'type': 'General Election'}, '1945': {'dissolution': datetime.date(1945, 6, 15), 'election': datetime.date(1945, 7, 5), 'type': 'General Election'}, '1950': {'dissolution': datetime.date(1950, 2, 3), 'election': datetime.date(1950, 2, 23), 'type': 'General Election'}, '1951': {'dissolution': datetime.date(1951, 10, 5), 'election': datetime.date(1951, 10, 25), 'type': 'General Election'}, '1955': {'dissolution': datetime.date(1955, 5, 6), 'election': datetime.date(1955, 5, 26), 'type': 'General Election'}, '1959': {'dissolution': datetime.date(1959, 9, 18), 'election': datetime.date(1959, 10, 8), 'type': 'General Election'}, '1964': {'dissolution': datetime.date(1964, 9, 25), 'election': datetime.date(1964, 10, 15), 'type': 'General Election'}, '1966': {'dissolution': datetime.date(1966, 3, 10), 'election': datetime.date(1966, 3, 31), 'type': 'General Election'}, '1970': {'dissolution': datetime.date(1970, 5, 29), 'election': datetime.date(1970, 6, 18), 'type': 'General Election'}, '1974 (Feb)': {'dissolution': datetime.date(1974, 2, 8), 'election': datetime.date(1974, 2, 28), 'type': 'General Election'}, '1974 (Oct)': {'dissolution': datetime.date(1974, 9, 20), 'election': datetime.date(1974, 10, 10), 'type': 'General Election'}, '1979': {'dissolution': datetime.date(1979, 4, 7), 'election': datetime.date(1979, 5, 3), 'type': 'General Election'}, '1983': {'dissolution': datetime.date(1983, 5, 13), 'election': datetime.date(1983, 6, 9), 'type': 'General Election'}, '1987': {'dissolution': datetime.date(1987, 5, 18), 'election': datetime.date(1987, 6, 11), 'type': 'General Election'}, '1992': {'dissolution': datetime.date(1992, 3, 16), 'election': datetime.date(1992, 4, 9), 'type': 'General Election'}, '1997': {'dissolution': datetime.date(1997, 4, 8), 'election': datetime.date(1997, 5, 1), 'type': 'General Election'}, '2001': {'dissolution': datetime.date(2001, 5, 14), 'election': datetime.date(2001, 6, 7), 'type': 'General Election'}, '2005': {'dissolution': datetime.date(2005, 4, 11), 'election': datetime.date(2005, 5, 5), 'type': 'General Election'}, '2010': {'dissolution': datetime.date(2010, 4, 12), 'election': datetime.date(2010, 5, 6), 'type': 'General Election'}, '2015': {'dissolution': datetime.date(2015, 3, 30), 'election': datetime.date(2015, 5, 7), 'type': 'General Election'}, '2017': {'dissolution': datetime.date(2017, 5, 3), 'election': datetime.date(2017, 6, 8), 'type': 'General Election'}, '2019': {'dissolution': datetime.date(2019, 11, 6), 'election': datetime.date(2019, 12, 12), 'type': 'General Election'}}
2025/03/06 02:36 INFO:Election Dates Loaded Successfully.
2025/03/06 02:36 DEBUG:ElectionDatesAscend: [datetime.date(1929, 5, 30), datetime.date(1931, 10, 27), datetime.date(1935, 11, 14), datetime.date(1945, 7, 5), datetime.date(1950, 2, 23), datetime.date(1951, 10, 25), datetime.date(1955, 5, 26), datetime.date(1959, 10, 8), datetime.date(1964, 10, 15), datetime.date(1966, 3, 31), datetime.date(1970, 6, 18), datetime.date(1974, 2, 28), datetime.date(1974, 10, 10), datetime.date(1979, 5, 3), datetime.date(1983, 6, 9), datetime.date(1987, 6, 11), datetime.date(1992, 4, 9), datetime.date(1997, 5, 1), datetime.date(2001, 6, 7), datetime.date(2005, 5, 5), datetime.date(2010, 5, 6), datetime.date(2015, 5, 7), datetime.date(2017, 6, 8), datetime.date(2019, 12, 12)]
2025/03/06 02:36 DEBUG:ElectionDatesDescend: [datetime.date(2019, 12, 12), datetime.date(2017, 6, 8), datetime.date(2015, 5, 7), datetime.date(2010, 5, 6), datetime.date(2005, 5, 5), datetime.date(2001, 6, 7), datetime.date(1997, 5, 1), datetime.date(1992, 4, 9), datetime.date(1987, 6, 11), datetime.date(1983, 6, 9), datetime.date(1979, 5, 3), datetime.date(1974, 10, 10), datetime.date(1974, 2, 28), datetime.date(1970, 6, 18), datetime.date(1966, 3, 31), datetime.date(1964, 10, 15), datetime.date(1959, 10, 8), datetime.date(1955, 5, 26), datetime.date(1951, 10, 25), datetime.date(1950, 2, 23), datetime.date(1945, 7, 5), datetime.date(1935, 11, 14), datetime.date(1931, 10, 27), datetime.date(1929, 5, 30)]
2025/03/06 02:36 INFO:load_election_dates executed successfully
2025/03/06 02:36 DEBUG:Clean Data Prep 353: Election dates: 78745
2025/03/06 02:36 ERROR:Number of rows in cleaned data (78745) does not match the number of rows in the original data (65278)! data.clean_and_enhance
2025/03/06 02:36 INFO:Deduplication completed, shape: (78745, 60) data.clean_and_enhance
2025/03/06 02:36 ERROR:Post deduplication: Number of rows in cleaned data (78745) does not match the number of rows in the original data (65278)! data.clean_and_enhance
2025/03/06 02:36 INFO:load_cleaned_data executed successfully
2025/03/06 02:36 INFO:get_cleaned_data executed successfully
2025/03/06 02:36 ERROR:Error in firstload: object of type 'ValueError' has no len()
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 83, in firstload
    f" {len(st.session_state.data_clean)}")
TypeError: object of type 'ValueError' has no len()
2025/03/06 02:36 CRITICAL:First load crashed: object of type 'ValueError' has no len()
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 64, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 83, in firstload
    f" {len(st.session_state.data_clean)}")
TypeError: object of type 'ValueError' has no len()
2025/03/06 03:25 INFO:Logging is set up correctly! Current log level: DEBUG
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 INFO:Streamlit App Starting...
2025/03/06 03:25 INFO:Streamlit App Starting...
2025/03/06 03:25 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 INFO:Current Working Directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 03:25 INFO:running H:\VScode\Golder-Development\dashboard_demo\dashboard_demo, H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py
2025/03/06 03:25 INFO:Running App setup...
2025/03/06 03:25 INFO:Running App setup...
2025/03/06 03:25 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling setup_package with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Setting up the package
2025/03/06 03:25 INFO:Setting up the package
2025/03/06 03:25 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 INFO:Module directory: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 INFO:Version: v39.164
2025/03/06 03:25 INFO:Version: v39.164
2025/03/06 03:25 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling initialize_session_state with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 INFO:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 DEBUG:Initialised BASE_DIR with value: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 03:25 DEBUG:Initialised filenames with value: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 03:25 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 03:25 DEBUG:Initialised PLACEHOLDER_DATE with value: 1900-01-01 00:00:00
2025/03/06 03:25 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 03:25 DEBUG:Initialised PLACEHOLDER_ID with value: 1000001
2025/03/06 03:25 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 03:25 DEBUG:Initialised thresholds with value: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 03:25 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 03:25 DEBUG:Initialised data_remappings with value: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 03:25 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 03:25 DEBUG:Initialised filter_def with value: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 03:25 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 03:25 DEBUG:Initialised security with value: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 03:25 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 03:25 DEBUG:Initialised perc_target with value: 0.5
2025/03/06 03:25 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 03:25 DEBUG:Initialised RERUN_MP_PARTY_MEMBERSHIP with value: False
2025/03/06 03:25 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 03:25 DEBUG:Initialised directories with value: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 03:25 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 03:25 DEBUG:Initialised reference_dir with value: reference_files
2025/03/06 03:25 DEBUG:Initialised data_dir with value: data
2025/03/06 03:25 DEBUG:Initialised data_dir with value: data
2025/03/06 03:25 DEBUG:Initialised output_dir with value: output
2025/03/06 03:25 DEBUG:Initialised output_dir with value: output
2025/03/06 03:25 DEBUG:Initialised logs_dir with value: logs
2025/03/06 03:25 DEBUG:Initialised logs_dir with value: logs
2025/03/06 03:25 DEBUG:Initialised components_dir with value: components
2025/03/06 03:25 DEBUG:Initialised components_dir with value: components
2025/03/06 03:25 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 03:25 DEBUG:Initialised app_pages_dir with value: app_pages
2025/03/06 03:25 DEBUG:Initialised utils_dir with value: utils
2025/03/06 03:25 DEBUG:Initialised utils_dir with value: utils
2025/03/06 03:25 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 03:25 DEBUG:Initialised Donor_dedupe_cleaned_fname with value: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 03:25 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 03:25 DEBUG:Initialised ListofPoliticalPeople_fname with value: reference_files\ListOfPoliticalPeople.csv
2025/03/06 03:25 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 03:25 DEBUG:Initialised mppartymemb_fname with value: reference_files\mppartymemb_pypd.csv
2025/03/06 03:25 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 03:25 DEBUG:Initialised donor_map_fname with value: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 03:25 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 03:25 DEBUG:Initialised politician_party_fname with value: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 03:25 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 03:25 DEBUG:Initialised regentity_map_fname with value: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 03:25 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 03:25 DEBUG:Initialised original_data_fname with value: reference_files\original_data.csv
2025/03/06 03:25 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 03:25 DEBUG:Initialised CREDENTIALS_FILE with value: reference_files\admin_credentials.json
2025/03/06 03:25 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 03:25 DEBUG:Initialised TEXT_FILE with value: reference_files\admin_text.json
2025/03/06 03:25 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 03:25 DEBUG:Initialised ELECTION_DATES with value: reference_files\elections.csv
2025/03/06 03:25 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 03:25 DEBUG:Initialised LAST_MODIFIED_DATES with value: reference_files\last_modified_dates.json
2025/03/06 03:25 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 03:25 DEBUG:Initialised cleaned_data_fname with value: output\cleaned_data.csv
2025/03/06 03:25 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 03:25 DEBUG:Initialised cleaned_donations_fname with value: output\cleaned_donations.csv
2025/03/06 03:25 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 03:25 DEBUG:Initialised cleaned_donorlist_fname with value: output\cleaned_donorlist.csv
2025/03/06 03:25 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 03:25 DEBUG:Initialised cleaned_regentity_fname with value: output\cleaned_regentity.csv
2025/03/06 03:25 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 03:25 DEBUG:Initialised party_summary_fname with value: output\party_summary.csv
2025/03/06 03:25 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 03:25 DEBUG:Initialised imported_raw_fname with value: output\imported_raw.csv
2025/03/06 03:25 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 03:25 DEBUG:Initialised source_data_fname with value: source\Donations_accepted_by_political_parties.csv
2025/03/06 03:25 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 03:25 DEBUG:Initialised Cash_ftr with value: None
2025/03/06 03:25 INFO:Session_state variables initialized
2025/03/06 03:25 INFO:Session_state variables initialized
2025/03/06 03:25 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 03:25 DEBUG:CREDENTIALS_FILE: reference_files\admin_credentials.json
2025/03/06 03:25 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 03:25 DEBUG:data_remappings: {'NatureOfDonation': {'IsBequest': 'Is A Bequest', 'IsAggregation': 'Aggregated Donation', 'IsSponsorship': 'Sponsorship', 'Donation to nan': 'Other', 'Other Payment': 'Other'}, 'PartyParents': {'Conservatives': 52, 'Labour': 53, 'Liberal Democrats': 90, 'Scottish National Party': 102, 'Green Party': 63, 'Plaid Cymru': 77, 'UKIP': 85, 'Unknown': 0}}
2025/03/06 03:25 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 03:25 DEBUG:RERUN_MP_PARTY_MEMBERSHIP: False
2025/03/06 03:25 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 03:25 DEBUG:donor_map_fname: reference_files\PoliticalDonorsDeduped.csv
2025/03/06 03:25 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 03:25 DEBUG:TEXT_FILE: reference_files\admin_text.json
2025/03/06 03:25 DEBUG:output_dir: output
2025/03/06 03:25 DEBUG:output_dir: output
2025/03/06 03:25 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 03:25 DEBUG:ListofPoliticalPeople_fname: reference_files\ListOfPoliticalPeople.csv
2025/03/06 03:25 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 03:25 DEBUG:original_data_fname: reference_files\original_data.csv
2025/03/06 03:25 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 03:25 DEBUG:security: {'is_admin': False, 'is_authenticated': False, 'username': '', 'password': ''}
2025/03/06 03:25 DEBUG:Cash_ftr: None
2025/03/06 03:25 DEBUG:Cash_ftr: None
2025/03/06 03:25 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 03:25 DEBUG:source_data_fname: source\Donations_accepted_by_political_parties.csv
2025/03/06 03:25 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 03:25 DEBUG:imported_raw_fname: output\imported_raw.csv
2025/03/06 03:25 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 03:25 DEBUG:cleaned_donations_fname: output\cleaned_donations.csv
2025/03/06 03:25 DEBUG:utils_dir: utils
2025/03/06 03:25 DEBUG:utils_dir: utils
2025/03/06 03:25 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 03:25 DEBUG:Donor_dedupe_cleaned_fname: reference_files\Donor_dedupe_cleaned_data.csv
2025/03/06 03:25 DEBUG:logs_dir: logs
2025/03/06 03:25 DEBUG:logs_dir: logs
2025/03/06 03:25 DEBUG:app_pages_dir: app_pages
2025/03/06 03:25 DEBUG:app_pages_dir: app_pages
2025/03/06 03:25 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 DEBUG:BASE_DIR: H:\VScode\Golder-Development\dashboard_demo\dashboard_demo
2025/03/06 03:25 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 03:25 DEBUG:directories: {'BASE_DIR': WindowsPath('H:/VScode/Golder-Development/dashboard_demo/dashboard_demo'), 'data_dir': 'data', 'output_dir': 'output', 'logs_dir': 'logs', 'reference_dir': 'reference_files', 'components_dir': 'components', 'app_pages_dir': 'app_pages', 'utils_dir': 'utils', 'source_dir': 'source', 'tests_dir': 'tests'}
2025/03/06 03:25 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 03:25 DEBUG:thresholds: {(0, 0): 'No Relevant Donations', (1, 1): 'Single Donation Entity', (2, 5): 'Very Small Entity', (6, 15): 'Small Entity', (16, 100): 'Small Medium Entity', (101, 200): 'Medium Entity', (201, 500): 'Medium Large Entity', (501, 1000): 'Large Entity'}
2025/03/06 03:25 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 03:25 DEBUG:PLACEHOLDER_DATE: 1900-01-01 00:00:00
2025/03/06 03:25 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 03:25 DEBUG:cleaned_regentity_fname: output\cleaned_regentity.csv
2025/03/06 03:25 DEBUG:components_dir: components
2025/03/06 03:25 DEBUG:components_dir: components
2025/03/06 03:25 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 03:25 DEBUG:filter_def: {'Sponsorships_ftr': {'NatureOfDonation': 'Sponsorship', 'IsSponsorshipInt': 1}, 'ReturnedDonations_ftr': {'DonationAction': ['Returned', 'Forfeited'], 'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonors_ftr': {'DubiousDonor': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'DubiousDonations_ftr': {'DubiousData': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}, 'AggregatedDonations_ftr': {'IsAggregationInt': 1, 'NatureOfDonation': 'Aggregated Donation', 'DonationType': 'Aggregated Donation'}, 'SafeDonors_ftr': {'DonorType': ['Trade Union', 'Registered Political Party', 'Friendly Society', 'Public Fund']}, 'DubiousDonationType_ftr': {'NatureOfDonation': ['Impermissible Donor', 'Unidentified Donor', 'Total value of donations not reported individually', 'Aggregated Donation'], 'DonorStatus': ['Impermissible Donor', 'Unidentified Donor', 'Unidentifiable Donor']}, 'BlankDate_ftr': {'ReceivedDate': ['PLACEHOLDER_DATE', None]}, 'BlankDonor_ftr': {'DonorId': [1000001]}, 'BlankRegEntity_ftr': {'RegulatedEntityId': [1000001]}, 'DonatedVisits_ftr': {'DonationType': 'Visit', 'NatureOfDonation': 'Visit'}, 'Bequests_ftr': {'IsBequestInt': 1, 'NatureOfDonation': 'Bequest', 'DonationType': 'Bequest'}, 'CorporateDonations_ftr': {'DonorStatus': ['Company', 'Partnership', 'Limited Liability Partnership']}, 'RegulatedEntity_ftr': {'RegulatedEntityType': ['Political Party', 'Regulated Donee', 'Permitted Participant', 'Third Party']}, 'PoliticalParty_ftr': {'DonorStatus': 'Registered Political Party'}, 'CashDonations_ftr': {'DonationType': ['Cash', 'Aggregate Donation']}, 'PublicFundsDonations_ftr': {'DonationType': 'Public Funds'}, 'NonCashDonations_ftr': {'DonationType': ['Non Cash', 'Visit', 'Bequest', 'Sponsorship']}}
2025/03/06 03:25 DEBUG:data_dir: data
2025/03/06 03:25 DEBUG:data_dir: data
2025/03/06 03:25 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 03:25 DEBUG:regentity_map_fname: reference_files\PoliticalEntityDeDuped.csv
2025/03/06 03:25 DEBUG:reference_dir: reference_files
2025/03/06 03:25 DEBUG:reference_dir: reference_files
2025/03/06 03:25 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 03:25 DEBUG:mppartymemb_fname: reference_files\mppartymemb_pypd.csv
2025/03/06 03:25 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 03:25 DEBUG:PLACEHOLDER_ID: 1000001
2025/03/06 03:25 DEBUG:perc_target: 0.5
2025/03/06 03:25 DEBUG:perc_target: 0.5
2025/03/06 03:25 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 03:25 DEBUG:filenames: {'reference_dir': {'Donor_dedupe_cleaned_fname': 'Donor_dedupe_cleaned_data.csv', 'ListofPoliticalPeople_fname': 'ListOfPoliticalPeople.csv', 'mppartymemb_fname': 'mppartymemb_pypd.csv', 'donor_map_fname': 'PoliticalDonorsDeduped.csv', 'politician_party_fname': 'ListOfPoliticalPeople_Final.csv', 'regentity_map_fname': 'PoliticalEntityDeDuped.csv', 'original_data_fname': 'original_data.csv', 'CREDENTIALS_FILE': 'admin_credentials.json', 'TEXT_FILE': 'admin_text.json', 'ELECTION_DATES': 'elections.csv', 'LAST_MODIFIED_DATES': 'last_modified_dates.json'}, 'output_dir': {'cleaned_data_fname': 'cleaned_data.csv', 'cleaned_donations_fname': 'cleaned_donations.csv', 'cleaned_donorlist_fname': 'cleaned_donorlist.csv', 'cleaned_regentity_fname': 'cleaned_regentity.csv', 'party_summary_fname': 'party_summary.csv', 'imported_raw_fname': 'imported_raw.csv'}, 'source_dir': {'source_data_fname': 'Donations_accepted_by_political_parties.csv'}}
2025/03/06 03:25 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 03:25 DEBUG:party_summary_fname: output\party_summary.csv
2025/03/06 03:25 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 03:25 DEBUG:ELECTION_DATES: reference_files\elections.csv
2025/03/06 03:25 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 03:25 DEBUG:politician_party_fname: reference_files\ListOfPoliticalPeople_Final.csv
2025/03/06 03:25 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 03:25 DEBUG:cleaned_data_fname: output\cleaned_data.csv
2025/03/06 03:25 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 03:25 DEBUG:LAST_MODIFIED_DATES: reference_files\last_modified_dates.json
2025/03/06 03:25 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 03:25 DEBUG:cleaned_donorlist_fname: output\cleaned_donorlist.csv
2025/03/06 03:25 INFO:Session state Setup complete
2025/03/06 03:25 INFO:Session state Setup complete
2025/03/06 03:25 INFO:initialize_session_state executed successfully
2025/03/06 03:25 INFO:initialize_session_state executed successfully
2025/03/06 03:25 INFO:Package setup complete
2025/03/06 03:25 INFO:Package setup complete
2025/03/06 03:25 INFO:setup_package executed successfully
2025/03/06 03:25 INFO:setup_package executed successfully
2025/03/06 03:25 INFO:Setup completed successfully.
2025/03/06 03:25 INFO:Setup completed successfully.
2025/03/06 03:25 INFO:Running Menu setup...
2025/03/06 03:25 INFO:Running Menu setup...
2025/03/06 03:25 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling pagesetup with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling get_git_version with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 INFO:get_git_version executed successfully
2025/03/06 03:25 INFO:App Version: v39.193
2025/03/06 03:25 INFO:App Version: v39.193
2025/03/06 03:25 INFO:Switched to page: Introduction
2025/03/06 03:25 INFO:Switched to page: Introduction
2025/03/06 03:25 INFO:pagesetup executed successfully
2025/03/06 03:25 INFO:Menu setup completed successfully.
2025/03/06 03:25 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:pagesetup executed successfully
2025/03/06 03:25 INFO:Menu setup completed successfully.
2025/03/06 03:25 INFO:Running first load function.
2025/03/06 03:25 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling load_raw_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Original data file path pre raw data load: source_data_fname
2025/03/06 03:25 DEBUG:Processed data file path pre raw data load: imported_raw_fname
2025/03/06 03:25 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Original file path: source\Donations_accepted_by_political_parties.csv
2025/03/06 03:25 INFO:Saved file path: output\imported_raw.csv
2025/03/06 03:25 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Checking if source\Donations_accepted_by_political_parties.csv has been updated.
2025/03/06 03:25 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Getting modification time for source\Donations_accepted_by_political_parties.csv
2025/03/06 03:25 INFO:get_file_modification_time executed successfully
2025/03/06 03:25 INFO:Current modification time: 1741252096.5157416
2025/03/06 03:25 INFO:Last modification time: 1741271786.7317827
2025/03/06 03:25 INFO:is_file_updated executed successfully
2025/03/06 03:25 INFO:Loading preprocessed data. Using output\imported_raw.csv dated 1741271786.7317827 instead of source\Donations_accepted_by_political_parties.csv
2025/03/06 03:25 INFO:Importing file from output\imported_raw.csv
2025/03/06 03:25 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 03:25 INFO:Preprocessed data loaded successfully.
2025/03/06 03:25 DEBUG:Calling raw_data_cleanup with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Cleaning up raw data
2025/03/06 03:25 ERROR:Session state variables not initialized!
2025/03/06 03:25 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Original file path: None
2025/03/06 03:25 INFO:Saved file path: output\cleaned_donations.csv
2025/03/06 03:25 ERROR:Error: originalfilepath is None!
2025/03/06 03:25 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 03:25 INFO:Data loaded, shape: (65278, 29)
2025/03/06 03:25 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Map file regentity_map_fname exists. Proceeding with deduplication.
2025/03/06 03:25 INFO:File deduplication complete, shape: ECRef                            547
OriginalRegulatedEntityName      547
RegulatedEntityType              547
Value                            547
AcceptedDate                     534
AccountingUnitName               547
DonorName                        547
AccountingUnitsAsCentralParty    547
IsSponsorship                    547
DonorStatus                      547
RegulatedDoneeType               547
CompanyRegistrationNumber        547
Postcode                         547
DonationType                     547
NatureOfDonation                 547
PurposeOfVisit                   547
DonationAction                   547
ReceivedDate                     449
ReportedDate                     547
IsReportedPrePoll                423
ReportingPeriodName              547
IsBequest                        547
IsAggregation                    547
OriginalRegulatedEntityId        547
AccountingUnitId                 547
DonorId                          547
CampaigningName                  547
RegisterName                     547
IsIrishSource                    547
CleanedRegulatedEntityName       547
CleanedRegulatedEntityId         547
RegulatedEntityId                547
RegulatedEntityName              547
dtype: int64 records updated with new RegulatedEntityId and ECRef                            7616
OriginalRegulatedEntityName      7616
RegulatedEntityType              7616
Value                            7616
AcceptedDate                     7406
AccountingUnitName               7616
DonorName                        7616
AccountingUnitsAsCentralParty    7616
IsSponsorship                    7616
DonorStatus                      7616
RegulatedDoneeType               7616
CompanyRegistrationNumber        7616
Postcode                         7616
DonationType                     7616
NatureOfDonation                 7616
PurposeOfVisit                   7616
DonationAction                   7616
ReceivedDate                     5073
ReportedDate                     7606
IsReportedPrePoll                4864
ReportingPeriodName              7616
IsBequest                        7616
IsAggregation                    7616
OriginalRegulatedEntityId        7616
AccountingUnitId                 7616
DonorId                          7616
CampaigningName                  7616
RegisterName                     7616
IsIrishSource                    7616
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                7616
RegulatedEntityName              7616
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 03:25 DEBUG:File deduplication cleaned complete, shape: ECRef                            1261
OriginalRegulatedEntityName      1261
RegulatedEntityType              1261
Value                            1261
AcceptedDate                     1247
AccountingUnitName               1261
DonorName                        1261
AccountingUnitsAsCentralParty    1261
IsSponsorship                    1261
DonorStatus                      1261
RegulatedDoneeType               1261
CompanyRegistrationNumber        1261
Postcode                         1261
DonationType                     1261
NatureOfDonation                 1261
PurposeOfVisit                   1261
DonationAction                   1261
ReceivedDate                     1133
ReportedDate                     1261
IsReportedPrePoll                 449
ReportingPeriodName              1261
IsBequest                        1261
IsAggregation                    1261
OriginalRegulatedEntityId        1261
AccountingUnitId                 1261
DonorId                          1261
CampaigningName                  1261
RegisterName                     1261
IsIrishSource                    1261
CleanedRegulatedEntityName        547
CleanedRegulatedEntityId          547
RegulatedEntityId                1261
RegulatedEntityName              1261
dtype: int64 records updated with new RegulatedEntityId and ECRef                            8330
OriginalRegulatedEntityName      8330
RegulatedEntityType              8330
Value                            8330
AcceptedDate                     8119
AccountingUnitName               8330
DonorName                        8330
AccountingUnitsAsCentralParty    8330
IsSponsorship                    8330
DonorStatus                      8330
RegulatedDoneeType               8330
CompanyRegistrationNumber        8330
Postcode                         8330
DonationType                     8330
NatureOfDonation                 8330
PurposeOfVisit                   8330
DonationAction                   8330
ReceivedDate                     5757
ReportedDate                     8320
IsReportedPrePoll                4890
ReportingPeriodName              8330
IsBequest                        8330
IsAggregation                    8330
OriginalRegulatedEntityId        8330
AccountingUnitId                 8330
DonorId                          8330
CampaigningName                  8330
RegisterName                     8330
IsIrishSource                    8330
CleanedRegulatedEntityName       7616
CleanedRegulatedEntityId         7616
RegulatedEntityId                8330
RegulatedEntityName              8330
dtype: int64 records updated with new RegulatedEntityName
2025/03/06 03:25 INFO:File deduplication complete, shape: (65278, 33)
2025/03/06 03:25 INFO:dedupe_entity_file executed successfully
2025/03/06 03:25 DEBUG:Calling dedupe_entity_file with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Map file donor_map_fname exists. Proceeding with deduplication.
2025/03/06 03:25 INFO:File deduplication complete, shape: ECRef                            29515
OriginalRegulatedEntityName      29515
RegulatedEntityType              29515
Value                            29515
AcceptedDate                     29204
AccountingUnitName               29515
OriginalDonorName                29515
AccountingUnitsAsCentralParty    29515
IsSponsorship                    29515
DonorStatus                      29515
RegulatedDoneeType               29515
CompanyRegistrationNumber        29515
Postcode                         29515
DonationType                     29515
NatureOfDonation                 29515
PurposeOfVisit                   29515
DonationAction                   29515
ReceivedDate                     27966
ReportedDate                     29504
IsReportedPrePoll                22707
ReportingPeriodName              29515
IsBequest                        29515
IsAggregation                    29515
OriginalRegulatedEntityId        29515
AccountingUnitId                 29515
OriginalDonorId                  29515
CampaigningName                  29515
RegisterName                     29515
IsIrishSource                    29515
CleanedRegulatedEntityName       29515
CleanedRegulatedEntityId         29515
RegulatedEntityId                29515
RegulatedEntityName              29515
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          29515
DonorName                        29515
dtype: int64 records updated with new DonorId and ECRef                            15656
OriginalRegulatedEntityName      15656
RegulatedEntityType              15656
Value                            15656
AcceptedDate                     15406
AccountingUnitName               15656
OriginalDonorName                15656
AccountingUnitsAsCentralParty    15656
IsSponsorship                    15656
DonorStatus                      15656
RegulatedDoneeType               15656
CompanyRegistrationNumber        15656
Postcode                         15656
DonationType                     15656
NatureOfDonation                 15656
PurposeOfVisit                   15656
DonationAction                   15656
ReceivedDate                     15143
ReportedDate                     15647
IsReportedPrePoll                13076
ReportingPeriodName              15656
IsBequest                        15656
IsAggregation                    15656
OriginalRegulatedEntityId        15656
AccountingUnitId                 15656
OriginalDonorId                  15656
CampaigningName                  15656
RegisterName                     15656
IsIrishSource                    15656
CleanedRegulatedEntityName       15656
CleanedRegulatedEntityId         15656
RegulatedEntityId                15656
RegulatedEntityName              15656
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          15656
DonorName                        15656
dtype: int64 records updated with new DonorName
2025/03/06 03:25 DEBUG:File deduplication cleaned complete, shape: ECRef                            31517
OriginalRegulatedEntityName      31517
RegulatedEntityType              31517
Value                            31517
AcceptedDate                     31206
AccountingUnitName               31517
OriginalDonorName                31517
AccountingUnitsAsCentralParty    31517
IsSponsorship                    31517
DonorStatus                      31517
RegulatedDoneeType               31517
CompanyRegistrationNumber        31517
Postcode                         31517
DonationType                     31517
NatureOfDonation                 31517
PurposeOfVisit                   31517
DonationAction                   31517
ReceivedDate                     29939
ReportedDate                     31506
IsReportedPrePoll                23658
ReportingPeriodName              31517
IsBequest                        31517
IsAggregation                    31517
OriginalRegulatedEntityId        31517
AccountingUnitId                 31517
OriginalDonorId                  31517
CampaigningName                  31517
RegisterName                     31517
IsIrishSource                    31517
CleanedRegulatedEntityName       30804
CleanedRegulatedEntityId         30804
RegulatedEntityId                31517
RegulatedEntityName              31517
CleanedDonorName                 29515
CleanedDonorId                   29515
DonorId                          31517
DonorName                        31517
dtype: int64 records updated with new DonorId and ECRef                            17658
OriginalRegulatedEntityName      17658
RegulatedEntityType              17658
Value                            17658
AcceptedDate                     17408
AccountingUnitName               17658
OriginalDonorName                17658
AccountingUnitsAsCentralParty    17658
IsSponsorship                    17658
DonorStatus                      17658
RegulatedDoneeType               17658
CompanyRegistrationNumber        17658
Postcode                         17658
DonationType                     17658
NatureOfDonation                 17658
PurposeOfVisit                   17658
DonationAction                   17658
ReceivedDate                     17116
ReportedDate                     17649
IsReportedPrePoll                14027
ReportingPeriodName              17658
IsBequest                        17658
IsAggregation                    17658
OriginalRegulatedEntityId        17658
AccountingUnitId                 17658
OriginalDonorId                  17658
CampaigningName                  17658
RegisterName                     17658
IsIrishSource                    17658
CleanedRegulatedEntityName       16945
CleanedRegulatedEntityId         16945
RegulatedEntityId                17658
RegulatedEntityName              17658
CleanedDonorName                 15656
CleanedDonorId                   15656
DonorId                          17658
DonorName                        17658
dtype: int64 records updated with new DonorName
2025/03/06 03:25 INFO:File deduplication complete, shape: (65278, 37)
2025/03/06 03:25 INFO:dedupe_entity_file executed successfully
2025/03/06 03:25 INFO:Raw Data cleanup completed
2025/03/06 03:25 INFO:Data shape: (65278, 37)
2025/03/06 03:25 INFO:Data saved to output\cleaned_donations.csv
2025/03/06 03:25 INFO:Data cleanup completed, shape: (65278, 37)
2025/03/06 03:25 INFO:raw_data_cleanup executed successfully
2025/03/06 03:25 INFO:load_raw_data executed successfully
2025/03/06 03:25 INFO:get_raw_data executed successfully
2025/03/06 03:25 DEBUG:st.session_state.raw_data: 65278
2025/03/06 03:25 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling load_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Rows in Raw Data: 65278
2025/03/06 03:25 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Original file path: output\cleaned_donations.csv
2025/03/06 03:25 INFO:Saved file path: output\cleaned_data.csv
2025/03/06 03:25 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Checking if output\cleaned_donations.csv has been updated.
2025/03/06 03:25 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Getting modification time for output\cleaned_donations.csv
2025/03/06 03:25 INFO:get_file_modification_time executed successfully
2025/03/06 03:25 INFO:Current modification time: 1741274718.3584645
2025/03/06 03:25 INFO:Last modification time: 1741271786.7317827
2025/03/06 03:25 INFO:is_file_updated executed successfully
2025/03/06 03:25 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 03:25 ERROR:Failed to load data from output\cleaned_donations.csv
2025/03/06 03:25 INFO:Loading and cleaning data... data.clean_and_enhance
2025/03/06 03:25 DEBUG:Clean Data Prep: streamlitdata load: 65278
2025/03/06 03:25 DEBUG:Clean Data Prep 123: streamlitdata load: 65278
2025/03/06 03:25 DEBUG:Calling map_mp_to_party with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:loaddata_df RegulatedEntityName unique values: 1361
2025/03/06 03:25 ERROR:Error in map_mp_to_party: local variable 'PartyUpdate_dict' referenced before assignment
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\politicalperson.py", line 62, in map_mp_to_party
    PartyUpdate_dict = {k.lower(): v for k, v in PartyUpdate_dict.items()}
UnboundLocalError: local variable 'PartyUpdate_dict' referenced before assignment
2025/03/06 03:25 ERROR:Error mapping MPs to party membership: local variable 'PartyUpdate_dict' referenced before assignment
2025/03/06 03:25 INFO:load_cleaned_data executed successfully
2025/03/06 03:25 INFO:get_cleaned_data executed successfully
2025/03/06 03:25 DEBUG:st.session_state.raw_data: 65278
2025/03/06 03:25 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling load_donorList_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Original file path: output\cleaned_data.csv
2025/03/06 03:25 INFO:Saved file path: output\cleaned_donorlist.csv
2025/03/06 03:25 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 03:25 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 03:25 INFO:get_file_modification_time executed successfully
2025/03/06 03:25 INFO:Current modification time: 1741270120.543527
2025/03/06 03:25 INFO:Last modification time: 1741270120.543527
2025/03/06 03:25 INFO:is_file_updated executed successfully
2025/03/06 03:25 INFO:Loading preprocessed data. Using output\cleaned_donorlist.csv dated 1741270120.543527 instead of output\cleaned_data.csv
2025/03/06 03:25 INFO:Importing file from output\cleaned_donorlist.csv
2025/03/06 03:25 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 03:25 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 03:25 INFO:Donor data saved to output\cleaned_donorlist.csv
2025/03/06 03:25 INFO:Donor Data summary completed
2025/03/06 03:25 INFO:Data shape: (25576, 5)
2025/03/06 03:25 INFO:load_donorList_data executed successfully
2025/03/06 03:25 INFO:get_donor_data executed successfully
2025/03/06 03:25 DEBUG:st.session_state.data_donor: 25576
2025/03/06 03:25 DEBUG:st.session_state.data_clean: 65278
2025/03/06 03:25 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling try_to_use_preprocessed_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Original file path: output\cleaned_data.csv
2025/03/06 03:25 INFO:Saved file path: output\cleaned_regentity.csv
2025/03/06 03:25 DEBUG:Calling is_file_updated with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Checking if output\cleaned_data.csv has been updated.
2025/03/06 03:25 DEBUG:Calling get_file_modification_time with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:Getting modification time for output\cleaned_data.csv
2025/03/06 03:25 INFO:get_file_modification_time executed successfully
2025/03/06 03:25 INFO:Current modification time: 1741270120.543527
2025/03/06 03:25 INFO:Last modification time: 1741270120.543527
2025/03/06 03:25 INFO:is_file_updated executed successfully
2025/03/06 03:25 INFO:Loading preprocessed data. Using output\cleaned_regentity.csv dated 1741270120.543527 instead of output\cleaned_data.csv
2025/03/06 03:25 INFO:Importing file from output\cleaned_regentity.csv
2025/03/06 03:25 ERROR:Timestamp key load_donorlist_data_last_modified not recognised.
2025/03/06 03:25 INFO:try_to_use_preprocessed_data executed successfully
2025/03/06 03:25 DEBUG:Calling initialise_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 CRITICAL:First load crashed: 'RegEntity_Group'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 64, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 93, in firstload
    load_data_to_session("data_regentity", get_regentity_data)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 66, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 51, in get_regentity_data
    return load_regulated_entity_data(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\load_donor_regent_lists.py", line 120, in load_regulated_entity_data
    regent_df.groupby(
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "H:\python310\lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "H:\python310\lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'RegEntity_Group'
2025/03/06 03:25 INFO:Running first load function.
2025/03/06 03:25 DEBUG:Calling firstload with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling get_raw_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_raw_data executed successfully
2025/03/06 03:25 DEBUG:st.session_state.raw_data: 65278
2025/03/06 03:25 DEBUG:Calling get_cleaned_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_cleaned_data executed successfully
2025/03/06 03:25 DEBUG:st.session_state.raw_data: 65278
2025/03/06 03:25 DEBUG:Calling get_donor_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 INFO:get_donor_data executed successfully
2025/03/06 03:25 DEBUG:st.session_state.data_donor: 25576
2025/03/06 03:25 DEBUG:st.session_state.data_clean: 65278
2025/03/06 03:25 DEBUG:Calling get_regentity_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 DEBUG:Calling load_regulated_entity_data with args={args}, kwargs={kwargs}
2025/03/06 03:25 ERROR:Error in load_regulated_entity_data: 'RegEntity_Group'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\load_donor_regent_lists.py", line 120, in load_regulated_entity_data
    regent_df.groupby(
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "H:\python310\lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "H:\python310\lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'RegEntity_Group'
2025/03/06 03:25 CRITICAL:First load crashed: 'RegEntity_Group'
Traceback (most recent call last):
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\PoliticalPartyAnalysisDashboard.py", line 64, in <module>
    initialise_data()  # Load the data
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_utils.py", line 50, in initialise_data
    firstload()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 93, in firstload
    load_data_to_session("data_regentity", get_regentity_data)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 66, in load_data_to_session
    st.session_state[key] = loader_function()
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 217, in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 259, in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
  File "H:\python310\lib\site-packages\streamlit\runtime\caching\cache_utils.py", line 317, in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\data_loader.py", line 51, in get_regentity_data
    return load_regulated_entity_data(
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\utils\logger.py", line 41, in wrapper
    result = func(*args, **kwargs)
  File "H:\VScode\Golder-Development\dashboard_demo\dashboard_demo\data\load_donor_regent_lists.py", line 120, in load_regulated_entity_data
    regent_df.groupby(
  File "H:\python310\lib\site-packages\pandas\core\frame.py", line 9183, in groupby
    return DataFrameGroupBy(
  File "H:\python310\lib\site-packages\pandas\core\groupby\groupby.py", line 1329, in __init__
    grouper, exclusions, obj = get_grouper(
  File "H:\python310\lib\site-packages\pandas\core\groupby\grouper.py", line 1043, in get_grouper
    raise KeyError(gpr)
KeyError: 'RegEntity_Group'
